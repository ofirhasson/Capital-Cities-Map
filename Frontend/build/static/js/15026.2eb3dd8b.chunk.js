"use strict";(self.webpackChunknorthwind=self.webpackChunknorthwind||[]).push([[15026],{8623:(t,e,r)=>{r.d(e,{Z:()=>c});var s=r(27366),a=r(11582),n=r(46784),i=r(49861),o=(r(93169),r(32718),r(84936),r(27135)),u=r(69912);let l=class extends((0,a.J)(n.wq)){constructor(t){super(t),this.type="georeferenced",this.origin=null}};(0,s._)([(0,o.J)({georeferenced:"georeferenced"},{readOnly:!0})],l.prototype,"type",void 0),(0,s._)([(0,i.Cb)({type:[Number],nonNullable:!1,json:{write:!0}})],l.prototype,"origin",void 0),l=(0,s._)([(0,u.j)("esri.geometry.support.MeshGeoreferencedVertexSpace")],l);const c=l},50250:(t,e,r)=>{r.d(e,{Z:()=>p});var s=r(27366),a=r(11582),n=r(46784),i=r(49861),o=(r(93169),r(32718),r(84936),r(27135)),u=r(69912),l=r(12400);let c=class extends((0,a.J)(n.wq)){constructor(t){super(t),this.type="local",this.origin=(0,l.Ue)()}};(0,s._)([(0,o.J)({local:"local"},{readOnly:!0})],c.prototype,"type",void 0),(0,s._)([(0,i.Cb)({type:[Number],nonNullable:!0,json:{write:!0}})],c.prototype,"origin",void 0),c=(0,s._)([(0,u.j)("esri.geometry.support.MeshLocalVertexSpace")],c);const p=c},17493:(t,e,r)=>{r.d(e,{CP:()=>o,JG:()=>y,LL:()=>u,NZ:()=>l,fV:()=>g,vj:()=>m,yT:()=>S,zE:()=>v});var s=r(76200),a=r(63780),n=r(66978),i=r(18277);class o{constructor(t,e,r){this.assetName=t,this.assetMimeType=e,this.parts=r}equals(t){return this===t||this.assetName===t.assetName&&this.assetMimeType===t.assetMimeType&&(0,a.fS)(this.parts,t.parts,((t,e)=>t.equals(e)))}isOnService(t){return this.parts.every((e=>e.isOnService(t)))}makeHash(){let t="";for(const e of this.parts)t+=e.partHash;return t}async toBlob(t){const{parts:e}=this;if(1===e.length)return e[0].toBlob(t);const r=await Promise.all(e.map((e=>e.toBlob(t))));return(0,n.k_)(t),new Blob(r)}}class u{constructor(t,e){this.partUrl=t,this.partHash=e}equals(t){return this===t||this.partUrl===t.partUrl&&this.partHash===t.partHash}isOnService(t){return this.partUrl.startsWith("".concat(t.path,"/assets/"))}async toBlob(t){const{data:e}=await(0,s.Z)(this.partUrl,{responseType:"blob"});return(0,n.k_)(t),e}}function l(t){return function(t){if(!t)return!1;if(Array.isArray(t))return t.some(h);return h(t)}(null===t||void 0===t?void 0:t.source)}function c(t){return!!Array.isArray(t)&&t.every((t=>t instanceof o))}const p=/^(model\/gltf\+json)|(model\/gltf-binary)$/,d=/\.(gltf|glb)/i;function h(t){if(t instanceof File){const{type:e,name:r}=t;return p.test(e)||d.test(r)}return p.test(t.assetMimeType)||d.test(t.assetName)}function y(t,e){if(!t)return!1;const{source:r}=t;return function(t,e){if(Array.isArray(t)){const r=t;return r.length>0&&r.every((t=>f(t,e)))}return f(t,e)}(r,e)}function g(t,e){if(t===e)return!0;const{source:r}=t,{source:s}=e;if(r===s)return!0;if(c(r)&&c(s)){if(r.length!==s.length)return!1;const t=(t,e)=>t.assetName<e.assetName?-1:t.assetName>e.assetName?1:0,e=[...r].sort(t),a=[...s].sort(t);for(let r=0;r<e.length;++r)if(!e[r].equals(a[r]))return!1;return!0}return!1}function f(t,e){return t instanceof o&&t.isOnService(e)}function m(t,e){var r;return t instanceof File?(0,i.dm)(t,e):null!==(r=(0,i.S0)(t.assetMimeType,e))&&void 0!==r?r:(0,i.Ow)(t.assetName,e)}function v(t){return Array.isArray(t)?t:[t]}function S(t){return!!t.original}},69048:(t,e,r)=>{r.d(e,{G7:()=>y,QK:()=>d,rU:()=>h,vI:()=>g,z1:()=>c,zZ:()=>p});var s=r(44927),a=r(32718),n=r(32035),i=r(848),o=r(8623),u=r(50250);function l(){return a.Z.getLogger("esri.geometry.Mesh")}function c(t){return!p(t)}function p(t){return null!=t.origin}function d(t){return p(t.vertexSpace)}function h(t,e){if(!p(t))return null;const[r,s,a]=t.origin;return new i.Z({x:r,y:s,z:a,spatialReference:e})}function y(t,e){var r,a;const{x:n,y:i,z:c,spatialReference:p}=t,d=[n,i,null!==c&&void 0!==c?c:0];return void 0!==(null===e||void 0===e?void 0:e.geographic)&&((0,s.x9)(l(),"option: geographic",{replacement:"Use the `vertexSpace` option instead.",version:"4.29",warnOnce:!0}),e.vertexSpace&&l().warn("Deprecated geographic flag ignored since vertexSpace option is provided.")),"local"===(null!==(r=null!==(a=null===e||void 0===e?void 0:e.vertexSpace)&&void 0!==a?a:null==(h=null===e||void 0===e?void 0:e.geographic)?void 0:h?"local":"georeferenced")&&void 0!==r?r:function(t){return t.isGeographic||t.isWebMercator?"local":"georeferenced"}(p))?new u.Z({origin:d}):new o.Z({origin:d});var h}function g(t,e){return t.type===e.type&&(t.origin===e.origin||null!=t.origin&&null!=e.origin&&(0,n.e)(t.origin,e.origin))}},60480:(t,e,r)=>{r.d(e,{g:()=>s});const s={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,supportsQueryByAnonymous:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,supportsDefaultSpatialReference:!1,supportsFullTextSearch:!1,supportsCompactGeometry:!1,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0}},15026:(t,e,r)=>{r.r(e),r.d(e,{default:()=>Q});var s=r(27366),a=r(42265),n=(r(59486),r(76200)),i=r(62044),o=r(63780),u=r(10064),l=r(93169),c=r(43404),p=r(54472),d=r(32718),h=r(18202),y=r(66978),g=r(94172),f=r(35995),m=r(71907),v=r(49861),S=r(69912),w=r(53866),q=r(8623),b=r(69048),O=r(17493),A=r(91836),_=r(63543),E=r(89623),R=r(25899),F=r(62594),x=r(18277),I=r(77946),C=r(62204),T=r(21149),M=r(54789),N=r(78952);const Z=new c.X({originalAndCurrentFeatures:"original-and-current-features",none:"none"}),U=new c.X({Started:"published",Publishing:"publishing",Stopped:"unavailable"});let D=class extends p.Z{constructor(t){super(t),this.type="feature-layer",this.supportedSourceTypes=new Set(["Feature Layer","Oriented Imagery Layer","Table","Catalog Layer"]),this.refresh=(0,y.Ds)((async()=>{var t,e;await this.load();const r=null===(t=this.sourceJSON.editingInfo)||void 0===t?void 0:t.lastEditDate;if(null==r)return{dataChanged:!0,updates:{}};try{await this._fetchService(null)}catch{return{dataChanged:!0,updates:{}}}const s=r!==(null===(e=this.sourceJSON.editingInfo)||void 0===e?void 0:e.lastEditDate);return{dataChanged:s,updates:s?{editingInfo:this.sourceJSON.editingInfo,extent:this.sourceJSON.extent}:null}})),this._ongoingAssetUploads=new Map}load(t){const e=this.layer.sourceJSON,r=this._fetchService(e,{...t}).then((()=>this.layer.setUserPrivileges(this.sourceJSON.serviceItemId,t))).then((()=>this._ensureLatestMetadata(t)));return this.addResolvingPromise(r),Promise.resolve(this)}initialize(){this.addHandles([(0,g.watch)((()=>{const t=this.layer;return t&&"lastEditsEventDate"in t?t.lastEditsEventDate:null}),(t=>this._handleLastEditsEventChange(t)))])}destroy(){this._removeEditInterceptor()}get queryTask(){var t,e;const{capabilities:r,parsedUrl:s,gdbVersion:a,spatialReference:n,fieldsIndex:i}=this.layer,o="infoFor3D"in this.layer?this.layer.infoFor3D:null,u="dynamicDataSource"in this.layer?this.layer.dynamicDataSource:null,c=(0,l.Z)("featurelayer-pbf")&&(null===r||void 0===r?void 0:r.query.supportsFormatPBF)&&null==o,p=null!==(t=null===r||void 0===r||null===(e=r.operations)||void 0===e?void 0:e.supportsQueryAttachments)&&void 0!==t&&t;return new E.Z({url:s.path,pbfSupported:c,fieldsIndex:i,infoFor3D:o,dynamicDataSource:u,gdbVersion:a,sourceSpatialReference:n,queryAttachmentsSupported:p})}async addAttachment(t,e){await this.load();const{layer:r}=this;await(0,F.nU)(r,"editing");const s=t.attributes[r.objectIdField],a=r.parsedUrl.path+"/"+s+"/addAttachment",i=this._getLayerRequestOptions(),o=this._getFormDataForAttachment(e,i.query);try{const t=await(0,n.Z)(a,{body:o});return(0,A.Q7)(t.data.addAttachmentResult)}catch(u){throw this._createAttachmentErrorResult(s,u)}}async updateAttachment(t,e,r){await this.load();const{layer:s}=this;await(0,F.nU)(s,"editing");const a=t.attributes[s.objectIdField],i=s.parsedUrl.path+"/"+a+"/updateAttachment",o=this._getLayerRequestOptions({query:{attachmentId:e}}),u=this._getFormDataForAttachment(r,o.query);try{const t=await(0,n.Z)(i,{body:u});return(0,A.Q7)(t.data.updateAttachmentResult)}catch(l){throw this._createAttachmentErrorResult(a,l)}}async applyEdits(t,e){var r,s,a,i,l;await this.load();const{layer:c}=this;await(0,F.nU)(c,"editing");const p="infoFor3D"in c?c.infoFor3D:null,d=null!=p,h=d||null!==(r=null===e||void 0===e?void 0:e.globalIdUsed)&&void 0!==r&&r,y=d?await this._uploadMeshesAndGetAssetMapEditsJSON(t):null,g=null!==(s=null===(a=t.addFeatures)||void 0===a?void 0:a.map((t=>(0,A.mh)(this.layer,t,p))))&&void 0!==s?s:[],f=(await Promise.all(g)).filter(o.pC),m=null!==(i=null===(l=t.updateFeatures)||void 0===l?void 0:l.map((t=>(0,A.mh)(this.layer,t,p))))&&void 0!==i?i:[],v=(await Promise.all(m)).filter(o.pC),S=(0,A.CJ)(this.layer,t.deleteFeatures,h);(0,C.P)(f,v,c.spatialReference);const w=await(0,A.hw)(this.layer,t),q=c.capabilities.editing.supportsAsyncApplyEdits&&d,b=(null===e||void 0===e?void 0:e.gdbVersion)||c.gdbVersion,O={gdbVersion:b,rollbackOnFailure:null===e||void 0===e?void 0:e.rollbackOnFailureEnabled,useGlobalIds:h,returnEditMoment:null===e||void 0===e?void 0:e.returnEditMoment,usePreviousEditMoment:null===e||void 0===e?void 0:e.usePreviousEditMoment,async:q};await(0,M.Px)(this.layer.url,b,!0);const _=(0,M.JV)(this.layer.url,b||null);if(await(0,M.r9)(c.url,b,c.historicMoment))throw new u.Z("feature-layer-source:historic-version","Editing a historic version is not allowed");null!==e&&void 0!==e&&e.returnServiceEditsOption?(O.edits=JSON.stringify([{id:c.layerId,adds:f.length?f:null,updates:v.length?v:null,deletes:S.length?S:null,attachments:w,assetMaps:y}]),O.returnServiceEditsOption=Z.toJSON(null===e||void 0===e?void 0:e.returnServiceEditsOption),O.returnServiceEditsInSourceSR=null===e||void 0===e?void 0:e.returnServiceEditsInSourceSR):(O.adds=f.length?JSON.stringify(f):null,O.updates=v.length?JSON.stringify(v):null,O.deletes=S.length?h?JSON.stringify(S):S.join(","):null,O.attachments=w&&JSON.stringify(w),O.assetMaps=null!=y?JSON.stringify(y):void 0);const E=this._getLayerRequestOptions({method:"post",query:O});_&&(E.authMode="immediate",E.query.returnEditMoment=!0,E.query.sessionId=M.U8);const R=null!==e&&void 0!==e&&e.returnServiceEditsOption?c.url:c.parsedUrl.path;let x;try{x=q?await this._asyncApplyEdits(R+"/applyEdits",E):await(0,n.Z)(R+"/applyEdits",E)}catch(I){if(!(0,A.JK)(I))throw I;E.authMode="immediate",x=q?await this._asyncApplyEdits(R+"/applyEdits",E):await(0,n.Z)(R+"/applyEdits",E)}return this._createEditsResult(x)}async deleteAttachments(t,e){await this.load();const{layer:r}=this;await(0,F.nU)(r,"editing");const s=t.attributes[r.objectIdField],a=r.parsedUrl.path+"/"+s+"/deleteAttachments";try{return(await(0,n.Z)(a,this._getLayerRequestOptions({query:{attachmentIds:e.join(",")},method:"post"}))).data.deleteAttachmentResults.map(A.Q7)}catch(i){throw this._createAttachmentErrorResult(s,i)}}fetchRecomputedExtents(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=t.signal;return this.load({signal:e}).then((async()=>{const e=this._getLayerRequestOptions({...t,query:{returnUpdates:!0}}),{layerId:r,url:s}=this.layer,{data:a}=await(0,n.Z)("".concat(s,"/").concat(r),e),{id:o,extent:u,fullExtent:l,timeExtent:c}=a,p=u||l;return{id:o,fullExtent:p&&w.Z.fromJSON(p),timeExtent:c&&i.Z.fromJSON({start:c[0],end:c[1]})}}))}async queryAttachments(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};await this.load();const r=this._getLayerRequestOptions(e);return this.queryTask.executeAttachmentQuery(t,r)}async queryFeatures(t,e){var r;await this.load();const s=await this.queryTask.execute(t,{...e,query:this._createRequestQueryOptions(e)});return null!==(r=t.outStatistics)&&void 0!==r&&r.length&&s.features.length&&s.features.forEach((e=>{var r;const s=e.attributes;null===(r=t.outStatistics)||void 0===r||r.forEach((t=>{let{outStatisticFieldName:e}=t;if(e){const t=e.toLowerCase();t&&t in s&&e!==t&&(s[e]=s[t],delete s[t])}}))})),s}async queryFeaturesJSON(t,e){return await this.load(),this.queryTask.executeJSON(t,{...e,query:this._createRequestQueryOptions(e)})}async queryObjectIds(t,e){return await this.load(),this.queryTask.executeForIds(t,{...e,query:this._createRequestQueryOptions(e)})}async queryFeatureCount(t,e){return await this.load(),this.queryTask.executeForCount(t,{...e,query:this._createRequestQueryOptions(e)})}async queryExtent(t,e){return await this.load(),this.queryTask.executeForExtent(t,{...e,query:this._createRequestQueryOptions(e)})}async queryRelatedFeatures(t,e){return await this.load(),this.queryTask.executeRelationshipQuery(t,{...e,query:this._createRequestQueryOptions(e)})}async queryRelatedFeaturesCount(t,e){return await this.load(),this.queryTask.executeRelationshipQueryForCount(t,{...e,query:this._createRequestQueryOptions(e)})}async queryTopFeatures(t,e){return await this.load(),this.queryTask.executeTopFeaturesQuery(t,{...e,query:this._createRequestQueryOptions(e)})}async queryTopObjectIds(t,e){return await this.load(),this.queryTask.executeForTopIds(t,{...e,query:this._createRequestQueryOptions(e)})}async queryTopExtents(t,e){return await this.load(),this.queryTask.executeForTopExtents(t,{...e,query:this._createRequestQueryOptions(e)})}async queryTopCount(t,e){return await this.load(),this.queryTask.executeForTopCount(t,{...e,query:this._createRequestQueryOptions(e)})}async fetchPublishingStatus(){if(!(0,R.M8)(this.layer.url))return"unavailable";const t=(0,f.v_)(this.layer.url,"status"),e=await(0,n.Z)(t,{query:{f:"json"}});return U.fromJSON(e.data.status)}async uploadAssets(t,e){const{uploadAssets:s}=await r.e(25532).then(r.bind(r,25532));return s(t,{layer:this.layer,ongoingUploads:this._ongoingAssetUploads},e)}_handleLastEditsEventChange(t){var e,r;const s=this.layer;if(null==t||!("capabilities"in s)||!("effectiveCapabilities"in s))return;if(null!==(e=s.capabilities)&&void 0!==e&&null!==(e=e.operations)&&void 0!==e&&e.supportsEditing||null===(r=s.effectiveCapabilities)||void 0===r||null===(r=r.operations)||void 0===r||!r.supportsEditing)return;const a=s.url;null!=a&&("layerId"in s&&(0,f.v_)(a,s.layerId.toString()),this._getOrCreateEditInterceptor(a).before=e=>{var r;const s=null!==(r=e.requestOptions.method)&&void 0!==r?r:"auto";if("auto"===s||"head"===s){var a;const r=null!==(a=e.requestOptions.query)&&void 0!==a?a:{};r._ts=t.getTime(),e.requestOptions.query=r}})}_getOrCreateEditInterceptor(t){return null==this._editInterceptor&&(this._editInterceptor={urls:t},a.default.request.internalInterceptors.push(this._editInterceptor)),this._editInterceptor}_removeEditInterceptor(){null!=this._editInterceptor&&((0,o.Od)(a.default.request.internalInterceptors,this._editInterceptor),this._editInterceptor=null)}async _asyncApplyEdits(t,e){const r=(await(0,n.Z)(t,e)).data.statusUrl;for(;;){const t=(await(0,n.Z)(r,{query:{f:"json"},responseType:"json"})).data;switch(t.status){case"Completed":return(0,n.Z)(t.resultUrl,{query:{f:"json"},responseType:"json"});case"CompletedWithErrors":throw new u.Z("async-applyEdits-failed","asynchronous applyEdits call failed.");case"Failed ImportChanges":case"InProgress":case"Pending":case"ExportAttachments":case"ExportChanges":case"ExportingData":case"ExportingSnapshot":case"ImportAttachments":case"ProvisioningReplica":case"UnRegisteringReplica":break;default:throw new u.Z("async-applyEdits-failed","asynchronous applyEdits call failed (undefined response status)")}await(0,y.e4)(J)}}_createRequestQueryOptions(t){const e={...this.layer.customParameters,token:this.layer.apiKey,...null===t||void 0===t?void 0:t.query};return this.layer.datesInUnknownTimezone&&(e.timeReferenceUnknownClient=!0),e}async _fetchService(t,e){if(!t){const r={};(0,l.Z)("featurelayer-advanced-symbols")&&(r.returnAdvancedSymbols=!0),(null===e||void 0===e?void 0:e.cacheBust)&&(r._ts=Date.now());const{data:s}=await(0,n.Z)(this.layer.parsedUrl.path,this._getLayerRequestOptions({query:r,signal:null===e||void 0===e?void 0:e.signal}));t=s}this.sourceJSON=await this._patchServiceJSON(t,null===e||void 0===e?void 0:e.signal);const r=t.type;if(!this.supportedSourceTypes.has(r))throw new u.Z("feature-layer-source:unsupported-type",'Source type "'.concat(r,'" is not supported'))}async _patchServiceJSON(t,e){var r;if("Table"!==t.type&&t.geometryType&&(null===t||void 0===t||null===(r=t.drawingInfo)||void 0===r||!r.renderer)&&!t.defaultSymbol){const e=(0,_.bU)(t.geometryType).renderer;(0,h.RB)("drawingInfo.renderer",e,t)}if("esriGeometryMultiPatch"===t.geometryType&&t.infoFor3D&&(t.geometryType="mesh"),null==t.extent)try{const{data:r}=await(0,n.Z)(this.layer.url,this._getLayerRequestOptions({signal:e}));r.spatialReference&&(t.extent={xmin:0,ymin:0,xmax:0,ymax:0,spatialReference:r.spatialReference})}catch(s){(0,y.r9)(s)}return t}async _ensureLatestMetadata(t){if(this.layer.userHasUpdateItemPrivileges&&this.sourceJSON.cacheMaxAge>0)return this._fetchService(null,{...t,cacheBust:!0})}async _uploadMeshesAndGetAssetMapEditsJSON(t){const{addAssetFeatures:e}=t;if(null===e||void 0===e||!e.length)return null;if(await this._areAllAssetsAlreadyMapped(e))return null;const s=t.addFeatures.filter((t=>t.geometry));if(e.length!==s.length+t.updateFeatures.length)throw new u.Z("feature-layer-source:unsupported-mesh-edits","Mixing attribute only edits with mesh geometry edits is not currently supported");const a=new Array,n=new Map;for(const o of e){const{geometry:t}=o,{vertexSpace:e}=t;if((0,b.zZ)(e))a.push(t);else{var i;const e=t.anchor,{convertMeshVertexSpace:s}=await Promise.all([r.e(25158),r.e(11837)]).then(r.bind(r,11837)),u=await s(t,new q.Z({origin:[e.x,e.y,null!==(i=e.z)&&void 0!==i?i:0]}));n.set(u,t),o.geometry=u,a.push(u)}}await this.uploadAssets(a);for(const[r,o]of n)o.addExternalSources(r.metadata.externalSources.items);return{adds:this._getAssetMapEditsJSON(e),updates:[],deletes:[]}}_getAssetMapEditsJSON(t){const e=new Array,r=this.layer.globalIdField,s=this.layer.parsedUrl;for(const n of t){var a;const t=n.geometry,{metadata:i}=t,o=i.getExternalSourcesOnService(s),u=n.getAttribute(r);if(0===o.length){d.Z.getLogger(this).error("Skipping feature ".concat(u,". The mesh it is associated with has not been uploaded to the service and cannot be mapped to it."));continue}const{source:l}=null!==(a=o.find(O.yT))&&void 0!==a?a:o[0];for(const r of l)1===r.parts.length?e.push({globalId:(0,m.zS)(),parentGlobalId:u,assetName:r.assetName,assetHash:r.parts[0].partHash,flags:[]}):d.Z.getLogger(this).error("Skipping asset ".concat(r.assetName,". It does not have exactly one part, so we cannot map it to a feature."))}return e}_createEditsResult(t){const e=t.data,{layerId:r}=this.layer,s=[];let a=null;if(Array.isArray(e))for(const l of e){var n,i,o;s.push({id:l.id,editedFeatures:l.editedFeatures}),l.id===r&&(a={addResults:null!==(n=l.addResults)&&void 0!==n?n:[],updateResults:null!==(i=l.updateResults)&&void 0!==i?i:[],deleteResults:null!==(o=l.deleteResults)&&void 0!==o?o:[],attachments:l.attachments,editMoment:l.editMoment})}else a=e;const u=(0,A.RZ)(a);if(s.length>0){u.editedFeatureResults=[];for(const t of s){const{editedFeatures:e}=t,r=null!==e&&void 0!==e&&e.spatialReference?new N.Z(e.spatialReference):null;u.editedFeatureResults.push({layerId:t.id,editedFeatures:(0,A.JX)(e,r)})}}return u}_createAttachmentErrorResult(t,e){var r;const s=(null===(r=e.details.messages)||void 0===r?void 0:r[0])||e.message,a=e.details.httpStatus||e.details.messageCode;return{objectId:t,globalId:null,error:new u.Z("feature-layer-source:attachment-failure",s,{code:a})}}_getFormDataForAttachment(t,e){const r=t instanceof FormData?t:t&&t.elements?new FormData(t):null;if(r)for(const s in e){const t=e[s];null!=t&&(r.set?r.set(s,t):r.append(s,t))}return r}_getLayerRequestOptions(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{layer:e,layer:{parsedUrl:r,gdbVersion:s}}=this;return{...t,query:{gdbVersion:s,layer:"dynamicDataSource"in e&&e.dynamicDataSource?JSON.stringify({source:e.dynamicDataSource}):void 0,...r.query,f:"json",...this._createRequestQueryOptions(t)},responseType:"json"}}async _areAllAssetsAlreadyMapped(t){const{layer:e}=this,{globalIdField:r,parsedUrl:s}=e,a="infoFor3D"in e?e.infoFor3D:null;if(null==a||null==r)return!1;const n=(0,x.$6)(a);if(null==n)return!1;const i=(0,f.v_)(s.path,"../".concat(n.id)),u=new Array;for(const o of t){if(!(o.geometry.metadata.getExternalSourcesOnService(s).length>0))return!1;u.push(o)}const l=u.map((t=>t.getAttribute(r))).filter(o.pC);if(0===l.length)return!1;const{assetMapFieldRoles:{parentGlobalId:c,assetHash:p}}=a,d=new T.Z({where:"".concat(c," IN (").concat(l.map((t=>"'".concat(t,"'"))),")"),outFields:[p,c],returnGeometry:!1}),h=await(0,I.e)(i,d),{features:y}=h;return 0!==y.length&&!u.some((t=>{const e=t.getAttribute(r);if(!e)return!0;const{metadata:a}=t.geometry,n=y.filter((t=>t.getAttribute(c)===e));if(0===n.length)return!0;const i=n.map((t=>t.getAttribute(p)));return a.getExternalSourcesOnService(s).flatMap((t=>{let{source:e}=t;return e.flatMap((t=>t.parts.map((t=>t.partHash))))})).some((t=>i.every((e=>t!==e))))}))}};(0,s._)([(0,v.Cb)()],D.prototype,"type",void 0),(0,s._)([(0,v.Cb)({constructOnly:!0})],D.prototype,"layer",void 0),(0,s._)([(0,v.Cb)({constructOnly:!0})],D.prototype,"supportedSourceTypes",void 0),(0,s._)([(0,v.Cb)({readOnly:!0})],D.prototype,"queryTask",null),D=(0,s._)([(0,S.j)("esri.layers.graphics.sources.FeatureLayerSource")],D);const J=1e3,Q=D},63543:(t,e,r)=>{r.d(e,{Dm:()=>c,Hq:()=>d,MS:()=>h,bU:()=>o});var s=r(93169),a=r(84652),n=r(60480),i=r(76115);function o(t){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===t||"esriGeometryMultipoint"===t?i.I4:"esriGeometryPolyline"===t?i.ET:i.lF}}}const u=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/;let l=1;function c(t,e){if((0,s.Z)("esri-csp-restrictions"))return()=>({[e]:null,...t});try{let r="this".concat(p(e)," = null;");for(const e in t)r+="this".concat(p(e)," = ").concat(JSON.stringify(t[e]),";");const s=new Function("\n      return class AttributesClass$".concat(l++," {\n        constructor() {\n          ").concat(r,";\n        }\n      }\n    "))();return()=>new s}catch(r){return()=>({[e]:null,...t})}}function p(t){return u.test(t)?".".concat(t):'["'.concat(t,'"]')}function d(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[{name:"New Feature",description:"",prototype:{attributes:(0,a.d9)(t)}}]}function h(t,e){return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:t},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:e,supportsDelete:e,supportsEditing:e,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:e,supportsExceedsLimitStatistics:!0,supportsAsyncConvert3D:!1},query:n.g,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},editing:{supportsGeometryUpdate:e,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsAsyncApplyEdits:!1,zDefault:void 0}}}}}]);
//# sourceMappingURL=15026.2eb3dd8b.chunk.js.map