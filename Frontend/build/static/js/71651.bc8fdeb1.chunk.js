"use strict";(self.webpackChunknorthwind=self.webpackChunknorthwind||[]).push([[71651],{91953:(e,t,i)=>{i.d(t,{b$:()=>s,mR:()=>n,uS:()=>o});i(59166);var l=i(8704);function n(e){return e.icon?e.icon:"image"in e&&e.image||e.className?void 0:"question"}function o(e){return e?{backgroundImage:"url(".concat(e,")")}:{}}function s(e){let{action:t,feature:i}=e;const n=null===i||void 0===i?void 0:i.attributes,o="image"in t?t.image:void 0;return o&&n?(0,l.n)(o,n):null!==o&&void 0!==o?o:""}},71651:(e,t,i)=>{i.r(t),i.d(t,{default:()=>Z});var l=i(27366),n=i(80987),o=i(44927),s=i(79056),a=i(32718),r=i(94172),c=i(49861),d=(i(93169),i(84936),i(69912)),u=i(91953),m=i(33565),h=i(91505),p=i(89500),v=i(9309);const b="view",g="basemap",_="base-layers",y="reference-layers",f="reference-layers-list-mode",I="base-layers-list-mode",C="base-layer-views",L="reference-layer-views",w="children",E=n.Z.ofType(p.Z);let F=class extends h.Z.EventedAccessor{constructor(e){super(e),this.baseItems=new E,this.baseListItemCreatedFunction=null,this.checkPublishStatusEnabled=!1,this.listModeDisabled=!1,this.referenceListItemCreatedFunction=null,this.referenceItems=new E,this.view=null,this._compileBaseList=this._compileBaseList.bind(this),this._compileReferenceList=this._compileReferenceList.bind(this)}initialize(){this.addHandles([(0,r.watch)((()=>{var e,t,i;return[null===(e=this.view)||void 0===e||null===(e=e.map)||void 0===e?void 0:e.basemap,!0===(null===(t=this.view)||void 0===t?void 0:t.ready),null===(i=this.view)||void 0===i?void 0:i.basemapView]}),(()=>this._watchBasemapLayers()),r.initial),(0,r.watch)((()=>[this.baseListItemCreatedFunction,this.checkPublishStatusEnabled,this.listModeDisabled]),(()=>this._baseListItemCreatedFunctionChanged())),(0,r.watch)((()=>[this.referenceListItemCreatedFunction,this.checkPublishStatusEnabled,this.listModeDisabled]),(()=>this._referenceListItemCreatedFunctionChanged()))],b)}destroy(){this.view=null,this._removeAllBaseItems(),this._removeAllReferenceItems()}get basemapTitle(){var e,t;return null!==(e=null===(t=this.view)||void 0===t||null===(t=t.map)||void 0===t||null===(t=t.basemap)||void 0===t?void 0:t.title)&&void 0!==e?e:null}set basemapTitle(e){this._override("basemapTitle",e)}get state(){var e;return null!==(e=this.view)&&void 0!==e&&e.ready?"ready":this.view?"loading":"disabled"}get totalBaseItems(){return this.baseItems.flatten((e=>e.children)).length}get totalReferenceItems(){return this.referenceItems.flatten((e=>e.children)).length}triggerAction(e,t){e&&!e.disabled&&this.emit("trigger-action",{action:e,item:t})}moveListItem(e){var t;let{targetItem:i,fromParentItem:l,toParentItem:n,from:o,to:s,newIndex:a}=e;const r=null===i||void 0===i?void 0:i.layer;if(!r||"subtype-sublayer"===r.type||"sublayer"===r.type)return;const c=null===(t=this.view)||void 0===t||null===(t=t.map)||void 0===t?void 0:t.basemap,d=null===c||void 0===c?void 0:c.baseLayers,u=null===c||void 0===c?void 0:c.referenceLayers,m=l?(0,v.Hh)(l):"base"===o?d:u,h=n?(0,v.Hh)(n):"base"===s?d:u;if(!m||!h)return;const{baseItems:p,referenceItems:b}=this,g="base"===o?p:b,_="base"===s?p:b,y=(null===l||void 0===l?void 0:l.children)||g,f=(null===n||void 0===n?void 0:n.children)||_,I=h.length-a;i.parent=n||null,y.remove(i),m.remove(r),f.includes(i)||f.add(i,I),h.includes(r)||h.add(r,I),this._compileLists()}_createItemChangeHandles(e){let{items:t,key:i,callback:l}=e;this.removeHandles(i),l(),t&&this.addHandles(t.on("change",(()=>l())),i)}_createListItem(e){let{layer:t,type:i}=e;const{view:l,baseListItemCreatedFunction:n,referenceListItemCreatedFunction:o,checkPublishStatusEnabled:s,listModeDisabled:a}=this;return new p.Z({layer:t,checkPublishStatusEnabled:s,listItemCreatedFunction:"base"===i?n:o,listModeDisabled:a,view:l})}_watchLayersListMode(e){let{layers:t,key:i,callback:l}=e;this.removeHandles(i),t&&!this.listModeDisabled&&this.addHandles((0,r.watch)((()=>t.filter((e=>"listMode"in e)).map((e=>e.listMode)).toArray()),(()=>l())),i)}_getViewableLayers(e){return e?this.listModeDisabled?e:e.filter((e=>"hide"!==(0,v.aV)(e))):void 0}_compileListItems(e){let{layers:t,items:i,key:l,type:n,callback:o}=e;this._watchLayersListMode({layers:t,key:l,callback:o});const s=this._getViewableLayers(t);null!==s&&void 0!==s&&s.length?(this._createNewItems({type:n,items:i,layers:s}),this._removeItems({items:i,layers:s}),this._sortItems(i,s)):"base"===n?this._removeAllBaseItems():this._removeAllReferenceItems()}_compileReferenceList(){var e;const{referenceItems:t}=this,i=null===(e=this.view)||void 0===e||null===(e=e.map)||void 0===e||null===(e=e.basemap)||void 0===e?void 0:e.referenceLayers;this._compileListItems({type:"reference",layers:i,items:t,key:I,callback:this._compileReferenceList})}_compileBaseList(){var e;const{baseItems:t}=this,i=null===(e=this.view)||void 0===e||null===(e=e.map)||void 0===e||null===(e=e.basemap)||void 0===e?void 0:e.baseLayers;this._compileListItems({type:"base",layers:i,items:t,key:f,callback:this._compileBaseList})}_compileLists(){this._compileReferenceList(),this._compileBaseList()}_createNewItems(e){let{items:t,layers:i,type:l}=e;null===i||void 0===i||i.forEach((e=>{t.some((t=>t.layer===e))||t.add(this._createListItem({type:l,layer:e}))}))}_removeItems(e){let{items:t,layers:i}=e;t&&t.forEach((e=>{if(!e)return;const l=null===i||void 0===i?void 0:i.some((t=>e.layer===t));l||(this.removeHandles("".concat(w,"-").concat(e.uid)),t.remove(e),e.destroy())}))}_sortItems(e,t){e&&t&&e.sort(((e,i)=>{const l=t.indexOf(e.layer),n=t.indexOf(i.layer);return l>n?-1:l<n?1:0}))}_removeAllBaseItems(){this.baseItems.drain((e=>{this.removeHandles("".concat(w,"-").concat(e.uid)),e.destroy()}))}_removeAllReferenceItems(){this.referenceItems.drain((e=>{this.removeHandles("".concat(w,"-").concat(e.uid)),e.destroy()}))}_baseListItemCreatedFunctionChanged(){this._removeAllBaseItems(),this._compileLists()}_referenceListItemCreatedFunctionChanged(){this._removeAllReferenceItems(),this._compileLists()}_watchBasemapLayers(){const{view:e}=this;if(this.removeHandles([_,y,g,C,L]),null===e||void 0===e||!e.ready)return this._removeAllBaseItems(),void this._removeAllReferenceItems();this._compileLists(),this.addHandles([(0,r.watch)((()=>{var e;return null===(e=this.view)||void 0===e||null===(e=e.map)||void 0===e||null===(e=e.basemap)||void 0===e?void 0:e.baseLayers}),(e=>this._createItemChangeHandles({items:e,key:_,callback:this._compileBaseList})),r.initial),(0,r.watch)((()=>{var e;return null===(e=this.view)||void 0===e||null===(e=e.map)||void 0===e||null===(e=e.basemap)||void 0===e?void 0:e.referenceLayers}),(e=>this._createItemChangeHandles({items:e,key:y,callback:this._compileReferenceList})),r.initial),(0,r.watch)((()=>{var e;return null===(e=this.view)||void 0===e||null===(e=e.basemapView)||void 0===e?void 0:e.baseLayerViews}),(e=>this._createItemChangeHandles({items:e,key:C,callback:this._compileBaseList})),r.initial),(0,r.watch)((()=>{var e;return null===(e=this.view)||void 0===e||null===(e=e.basemapView)||void 0===e?void 0:e.referenceLayerViews}),(e=>this._createItemChangeHandles({items:e,key:L,callback:this._compileReferenceList})),r.initial)],g)}};(0,l._)([(0,c.Cb)({type:E,readOnly:!0})],F.prototype,"baseItems",void 0),(0,l._)([(0,c.Cb)()],F.prototype,"basemapTitle",null),(0,l._)([(0,c.Cb)()],F.prototype,"baseListItemCreatedFunction",void 0),(0,l._)([(0,c.Cb)()],F.prototype,"checkPublishStatusEnabled",void 0),(0,l._)([(0,c.Cb)({nonNullable:!0})],F.prototype,"listModeDisabled",void 0),(0,l._)([(0,c.Cb)()],F.prototype,"referenceListItemCreatedFunction",void 0),(0,l._)([(0,c.Cb)({type:E,readOnly:!0})],F.prototype,"referenceItems",void 0),(0,l._)([(0,c.Cb)({readOnly:!0})],F.prototype,"state",null),(0,l._)([(0,c.Cb)()],F.prototype,"totalBaseItems",null),(0,l._)([(0,c.Cb)()],F.prototype,"totalReferenceItems",null),(0,l._)([(0,c.Cb)()],F.prototype,"view",void 0),F=(0,l._)([(0,d.j)("esri.widgets.BasemapLayerList.BasemapLayerListViewModel")],F);const M=F;var T=i(7138);let k=class extends T.default{constructor(){super(...arguments),this.baseLayers=!0,this.catalogLayerList=!0,this.closeButton=!1,this.collapseButton=!1,this.editTitleButton=!1,this.errors=!1,this.filter=!1,this.flow=!0,this.heading=!0,this.referenceLayers=!0,this.statusIndicators=!0,this.temporaryLayerIndicators=!1}};(0,l._)([(0,c.Cb)({type:Boolean,nonNullable:!0})],k.prototype,"baseLayers",void 0),(0,l._)([(0,c.Cb)({type:Boolean,nonNullable:!0})],k.prototype,"catalogLayerList",void 0),(0,l._)([(0,c.Cb)({type:Boolean,nonNullable:!0})],k.prototype,"closeButton",void 0),(0,l._)([(0,c.Cb)({type:Boolean,nonNullable:!0})],k.prototype,"collapseButton",void 0),(0,l._)([(0,c.Cb)({type:Boolean,nonNullable:!0})],k.prototype,"editTitleButton",void 0),(0,l._)([(0,c.Cb)({type:Boolean,nonNullable:!0})],k.prototype,"errors",void 0),(0,l._)([(0,c.Cb)({type:Boolean,nonNullable:!0})],k.prototype,"filter",void 0),(0,l._)([(0,c.Cb)({type:Boolean,nonNullable:!0})],k.prototype,"flow",void 0),(0,l._)([(0,c.Cb)({type:Boolean,nonNullable:!0})],k.prototype,"heading",void 0),(0,l._)([(0,c.Cb)({type:Boolean,nonNullable:!0})],k.prototype,"referenceLayers",void 0),(0,l._)([(0,c.Cb)({type:Boolean,nonNullable:!0})],k.prototype,"statusIndicators",void 0),(0,l._)([(0,c.Cb)({type:Boolean,nonNullable:!0})],k.prototype,"temporaryLayerIndicators",void 0),k=(0,l._)([(0,d.j)("esri.widgets.BasemapLayerList.BasemapLayerListVisibleElements")],k);const A=k,B="esri-basemap-layer-list",P="".concat(B,"__item"),S={base:B,actionMenu:"".concat(B,"__action-menu"),actionGroup:"".concat(B,"__action-group"),filterNoResults:"".concat(B,"__filter-no-results"),item:P,itemActive:"".concat(P,"--active"),itemContent:"".concat(P,"-content"),itemContentBottom:"".concat(P,"-content-bottom"),itemMessage:"".concat(P,"-message"),itemInvisible:"".concat(P,"--invisible"),itemActionIcon:"".concat(P,"-action-icon"),itemActionImage:"".concat(P,"-action-image"),itemTemporaryIcon:"".concat(P,"-temporary-icon"),itemCatalogIcon:"".concat(P,"-catalog-icon"),statusIndicator:"".concat(B,"__status-indicator"),publishing:"".concat(B,"__publishing"),updating:"".concat(B,"__updating"),editing:"".concat(B,"__editing"),connectionStatus:"".concat(B,"__connection-status"),connectionStatusConnected:"".concat(B,"__connection-status--connected"),visibleToggle:"".concat(B,"__visible-toggle"),visibleIcon:"".concat(B,"__visible-icon"),section:"".concat(B,"__section")};var R=i(8905),x=i(7021),N=i(96919),D=(i(80975),i(80532)),H=i(28907),V=i(67005);const O=n.Z.ofType(p.Z);let U=class extends((0,s.IG)(m.Z)){constructor(e,t){super(e,t),this._activeItem=null,this._tooltipReferenceMap=new Map,this._editTitleInput=null,this._focusRootFlowItem=!1,this._focusPanelFlowItem=!1,this._focusEditingFlowItem=!1,this._focusCatalogFlowItem=!1,this._lastDragDetail=null,this._selectedDragItemLayerUid=null,this._rootGroupUid="basemap-".concat(this.uid),this.catalogLayerList=null,this.catalogOptions=null,this.collapsed=!1,this.dragEnabled=!1,this.editingTitle=!1,this.filterPlaceholder="",this.baseFilterText="",this.referenceFilterText="",this.listItemCanGiveFunction=null,this.listItemCanReceiveFunction=null,this.headingLevel=2,this.messages=null,this.messagesCommon=null,this.minFilterItems=v.Kp,this.openCatalogItem=null,this.selectedItems=new O,this.selectionMode="none",this.viewModel=new M,this.visibilityAppearance="default",this.visibleElements=new A,this._canMove=(e,t)=>{var i,l,n,o,s;let{dragEl:a,fromEl:r,toEl:c}=e;const d="pull"===t?this.listItemCanGiveFunction:this.listItemCanReceiveFunction,u=(0,v.rV)(a);if(null===u||void 0===u||!u.sortable)return!1;const m=(0,v.rV)(r),h=(0,v.Gr)(r),p=(0,v.rV)(c),b=(0,v.Gr)(c),g=!!h&&!!b&&h===b,_={selected:u,from:m,to:p},y=r.group,f=c.group,I=null!==(i=null===m||void 0===m||null===(l=m.layer)||void 0===l?void 0:l.type)&&void 0!==i?i:"",C=null!==(n=null===p||void 0===p||null===(o=p.layer)||void 0===o?void 0:o.type)&&void 0!==n?n:"",L=new Set(["map-image","catalog","knowledge-graph"]);return y&&f&&"function"==typeof d?d.call(null,_):g&&!L.has(I)&&!L.has(C)&&"sublayer"!==(null===u||void 0===u||null===(s=u.layer)||void 0===s?void 0:s.type)},this._clearActiveItem=()=>{this._activeItem=null},this._setActiveItem=e=>{if("default"!==this.visibilityAppearance)return;const t=Array.from(e.composedPath()).find((e=>{var t;return null===(t=e.classList)||void 0===t?void 0:t.contains(S.item)}));this._activeItem=(0,v.rV)(t)},this._onCalciteListOrderChange=e=>{const{_lastDragDetail:t}=this,{toEl:i,fromEl:l,dragEl:n,newIndex:o}=e;if(!l||!i||(null===t||void 0===t?void 0:t.newIndex)===o&&(null===t||void 0===t?void 0:t.dragEl)===n&&(null===t||void 0===t?void 0:t.toEl)===i&&(null===t||void 0===t?void 0:t.fromEl)===l)return;this._lastDragDetail=e;const s=l,a=i;if(s!==a)this._moveLayerFromChildList({toEl:a,fromEl:s,dragEl:n,newIndex:o});else{const e=Array.from(l.children).filter((e=>null===e||void 0===e?void 0:e.matches("calcite-list-item"))).map((e=>e.value));this._sortLayers(s,e)}}}initialize(){this.addHandles([(0,r.watch)((()=>this.openCatalogItem),(e=>e?this._createCatalog():this._destroyCatalog()))])}normalizeCtorArgs(e){return null!=(null===e||void 0===e?void 0:e.editingEnabled)&&null!=e.visibleElements?{...e,visibleElements:new A({...e.visibleElements,editTitleButton:e.editingEnabled})}:e}loadDependencies(){return(0,R.h)({action:()=>Promise.all([i.e(92358),i.e(46895),i.e(65138),i.e(91741)]).then(i.bind(i,6814)),"action-group":()=>Promise.all([i.e(92358),i.e(46895),i.e(89219),i.e(63839),i.e(65138),i.e(2654),i.e(23635),i.e(70405)]).then(i.bind(i,70405)),"action-menu":()=>Promise.all([i.e(92358),i.e(46895),i.e(89219),i.e(63839),i.e(65138),i.e(2654),i.e(23635),i.e(24745)]).then(i.bind(i,24745)),block:()=>Promise.all([i.e(92358),i.e(46895),i.e(89219),i.e(63839),i.e(65138),i.e(2654),i.e(23635),i.e(4758)]).then(i.bind(i,4758)),label:()=>Promise.all([i.e(92358),i.e(35738)]).then(i.bind(i,35738)),input:()=>Promise.all([i.e(92358),i.e(46895),i.e(54438),i.e(8715),i.e(16746)]).then(i.bind(i,75655)),button:()=>Promise.all([i.e(92358),i.e(46895),i.e(54438),i.e(14105),i.e(32275)]).then(i.bind(i,32275)),flow:()=>i.e(53049).then(i.bind(i,53049)),"flow-item":()=>Promise.all([i.e(92358),i.e(46895),i.e(89219),i.e(63839),i.e(65138),i.e(2654),i.e(23635),i.e(89524),i.e(48926)]).then(i.bind(i,48926)),icon:()=>Promise.all([i.e(92358),i.e(87474)]).then(i.bind(i,87474)),list:()=>Promise.all([i.e(92358),i.e(46895),i.e(54438),i.e(34504),i.e(8715),i.e(38782)]).then(i.bind(i,38782)),"list-item":()=>Promise.all([i.e(92358),i.e(46895),i.e(65138),i.e(21340)]).then(i.bind(i,67994)),notice:()=>Promise.all([i.e(92358),i.e(46895),i.e(15669)]).then(i.bind(i,15669)),tooltip:()=>Promise.all([i.e(92358),i.e(89219),i.e(94730)]).then(i.bind(i,94730))})}destroy(){this._tooltipReferenceMap.clear()}get _totalBaseItems(){return this.viewModel.baseItems.flatten((e=>e.children.filter((e=>"catalog-dynamic-group"!==e.layer.type)))).length}get _totalReferenceItems(){return this.viewModel.referenceItems.flatten((e=>e.children.filter((e=>"catalog-dynamic-group"!==e.layer.type)))).length}get _baseFilterEnabled(){return this._totalBaseItems>=this.minFilterItems&&this.visibleElements.filter}get _referenceFilterEnabled(){return this._totalReferenceItems>=this.minFilterItems&&this.visibleElements.filter}get basemapTitle(){return this.viewModel.basemapTitle}set basemapTitle(e){this.viewModel.basemapTitle=e}get baseListItemCreatedFunction(){return this.viewModel.baseListItemCreatedFunction}set baseListItemCreatedFunction(e){this.viewModel.baseListItemCreatedFunction=e}get editingEnabled(){return(0,o.Mr)(a.Z.getLogger(this),"editingEnabled",{replacement:"selectionMode, dragEnabled, visibleElements.editTitleButton",version:"4.29",warnOnce:!0}),"none"!==this.selectionMode&&this.dragEnabled&&this.visibleElements.editTitleButton}set editingEnabled(e){(0,o.Mr)(a.Z.getLogger(this),"editingEnabled",{replacement:"selectionMode, dragEnabled, visibleElements.editTitleButton",version:"4.29",warnOnce:!0}),this.dragEnabled=e,this.visibleElements.editTitleButton=e,this.selectionMode=e?this.multipleSelectionEnabled?"multiple":"single":"none"}get icon(){return"layers"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e,t;return null!==(e=null===(t=this.messages)||void 0===t?void 0:t.widgetLabel)&&void 0!==e?e:""}set label(e){this._overrideIfSome("label",e)}get multipleSelectionEnabled(){return(0,o.Mr)(a.Z.getLogger(this),"multipleSelectionEnabled",{replacement:"selectionMode",version:"4.29",warnOnce:!0}),"multiple"===this.selectionMode}set multipleSelectionEnabled(e){(0,o.Mr)(a.Z.getLogger(this),"multipleSelectionEnabled",{replacement:"selectionMode",version:"4.29",warnOnce:!0}),this.selectionMode=e?"multiple":this.editingEnabled?"single":"none"}get referenceListItemCreatedFunction(){return this.viewModel.referenceListItemCreatedFunction}set referenceListItemCreatedFunction(e){this.viewModel.referenceListItemCreatedFunction=e}get baseItems(){return this.viewModel.baseItems}get referenceItems(){return this.viewModel.referenceItems}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}triggerAction(e,t){return this.viewModel.triggerAction(e,t)}render(){const{state:e}=this.viewModel,t={[x.z.hidden]:"loading"===e,[x.z.disabled]:"disabled"===e};return(0,V.u)("div",{class:this.classes(S.base,x.z.widget,x.z.panel,t)},this._renderItems())}_renderItemTooltip(e){return e?(0,V.u)("calcite-tooltip",{key:"tooltip-".concat(e.layer.uid),referenceElement:this._tooltipReferenceMap.get(e.layer.uid)},this.messages.layerIncompatibleTooltip):null}_renderItemTooltipNodes(e){var t;return e.incompatible?this._renderItemTooltip(e):null===(t=e.children)||void 0===t?void 0:t.filter((e=>!e.hidden)).toArray().map((e=>this._renderItemTooltipNodes(e)))}_renderItemTooltips(e){return null===e||void 0===e?void 0:e.toArray().map((e=>this._renderItemTooltipNodes(e)))}async _createCatalog(){var e;this._destroyCatalog();const{default:t}=await i.e(97145).then(i.bind(i,97145)),{headingLevel:l,catalogOptions:n,view:o,filterPlaceholder:s,baseListItemCreatedFunction:a,referenceListItemCreatedFunction:r,minFilterItems:c,selectionMode:d,visibilityAppearance:u,openCatalogItem:m,referenceItems:h}=this,p=m&&h.flatten((e=>e.children)).includes(m)?"reference":"base",v=null===(e=this.openCatalogItem)||void 0===e?void 0:e.layer;this._set("catalogLayerList",new t({headingLevel:l,view:o,filterPlaceholder:s,minFilterItems:c,selectionMode:d,listItemCreatedFunction:"base"===p?a:r,visibilityAppearance:u,...n,catalogLayer:v}))}_destroyCatalog(){var e;null!==(e=this.catalogLayerList)&&void 0!==e&&e.destroy(),this._set("catalogLayerList",null)}_renderCatalogFlowItem(){var e;const{openCatalogItem:t,messages:i}=this;if(!t)return null;const l=this._getLayerTitle(t);return(0,V.u)("calcite-flow-item",{afterCreate:this._focusCatalogFlowItemNode,afterUpdate:this._focusCatalogFlowItemNode,bind:this,description:l,heading:i.catalogLayers,headingLevel:this.headingLevel,key:"flow-catalog-".concat(t.uid),onCalciteFlowItemBack:e=>{e.preventDefault(),this.openCatalogItem=null,this._focusRootFlowItem=!0}},null===(e=this.catalogLayerList)||void 0===e?void 0:e.render())}_focusCatalogFlowItemNode(e){this._focusCatalogFlowItem&&(this._focusCatalogFlowItem=!1,requestAnimationFrame((()=>null===e||void 0===e?void 0:e.setFocus())))}_renderPanelFlowItems(e){return e?e.flatten((e=>e.children)).filter((e=>{let{hidden:t,panel:i}=e;return!t&&(null===i||void 0===i?void 0:i.open)&&!i.disabled&&i.flowEnabled})).toArray().map((e=>{let{title:t,panel:i}=e;const l=()=>this._handlePanelFlowItemBack(i);return(0,V.u)("calcite-flow-item",{afterCreate:this._focusPanelFlowItemNode,afterUpdate:this._focusPanelFlowItemNode,bind:this,description:t,heading:i.title,headingLevel:this.headingLevel,key:"flow-panel-".concat(i.uid),onCalciteFlowItemBack:e=>{e.preventDefault(),l()}},i.render(),(0,V.u)("calcite-button",{appearance:"transparent",onclick:l,slot:"footer-actions",width:"full"},this.messagesCommon.back))})):[]}_handlePanelFlowItemBack(e){e.open=!1,this._focusRootFlowItem=!0}_focusEditingFlowItemNode(e){this._focusEditingFlowItem&&(this._focusEditingFlowItem=!1,requestAnimationFrame((()=>null===e||void 0===e?void 0:e.setFocus())))}_focusRootFlowItemNode(e){this._focusRootFlowItem&&(this._focusRootFlowItem=!1,requestAnimationFrame((()=>null===e||void 0===e?void 0:e.setFocus())))}_focusPanelFlowItemNode(e){this._focusPanelFlowItem&&(this._focusPanelFlowItem=!1,requestAnimationFrame((()=>null===e||void 0===e?void 0:e.setFocus())))}_renderItemMessage(e){return e.error?(0,V.u)("div",{class:S.itemMessage,key:"esri-layer-list__error",slot:"content-bottom"},(0,V.u)("calcite-notice",{icon:"exclamation-mark-triangle",kind:"warning",open:!0,scale:"s",width:"full"},(0,V.u)("div",{slot:"message"},this.messages.layerError))):e.incompatible?(0,V.u)("div",{class:S.itemMessage,key:"esri-layer-list__incompatible",slot:"content-bottom"},(0,V.u)("calcite-notice",{afterCreate:t=>this._setTooltipReference(t,e),afterRemoved:()=>this._removeTooltipReference(e),icon:"exclamation-mark-triangle",kind:"warning",open:!0,scale:"s",tabIndex:0,width:"full"},(0,V.u)("div",{slot:"message"},this.messages.layerIncompatible))):null}_getLayerTitle(e){return e.title||this.messages.untitledLayer}_renderItem(e,t,i,l,n){var o,s,a;const{_activeItem:r,_selectedDragItemLayerUid:c,selectionMode:d,selectedItems:u,messages:m,visibleElements:h}=this,p=this._getLayerTitle(e),v=e.visibleAtCurrentTimeExtent?e.visibleAtCurrentScale?p:"".concat(p," (").concat(m.layerInvisibleAtScale,")"):"".concat(p," (").concat(m.layerInvisibleAtTime,")"),b=this._filterActions(e.actionsSections),g=this._countActions(b),_="catalog"===(null===(o=e.parent)||void 0===o||null===(o=o.layer)||void 0===o?void 0:o.type),y="catalog-footprint"===(null===(s=e.layer)||void 0===s?void 0:s.type),f="catalog-dynamic-group"===(null===(a=e.layer)||void 0===a?void 0:a.type),I=y?(0,V.u)("calcite-icon",{class:S.itemCatalogIcon,icon:"footprint",key:"footprint",scale:"s",slot:"content-start"}):null,C=h.catalogLayerList&&f?(0,V.u)("calcite-icon",{class:S.itemCatalogIcon,icon:"catalog-dataset",key:"catalog-dataset",scale:"s",slot:"content-start"}):null,L=f?(0,V.u)("calcite-action",{appearance:"transparent",icon:"chevron-right",iconFlipRtl:!0,onclick:()=>{this.openCatalogItem=l,this._focusCatalogFlowItem=!0},scale:"s",slot:"actions-end",text:p}):null;return(0,V.u)("calcite-list-item",{afterCreate:t=>this._focusSelectedDragEl(t,e),afterUpdate:t=>this._focusSelectedDragEl(t,e),class:this.classes(S.item,{[S.itemActive]:r===e}),"data-item":e,"data-layer-id":e.layer.id,dragDisabled:!e.sortable||i||_,dragSelected:e.layer.uid===c,id:e.layer.uid,key:"list-item-".concat(e.layer.uid),label:p,metadata:{parentTitles:n,title:p},open:e.open,selected:"none"!==d&&u.includes(e),title:v,value:e.layer.uid,onCalciteListItemDragHandleChange:t=>this._handleCalciteListItemDragHandleChange(t,e),onCalciteListItemSelect:t=>this._handleCalciteListItemSelect(t,e,l),onCalciteListItemToggle:t=>this._handleCalciteListItemToggle(t,e)},I,C,(0,V.u)("div",{class:this.classes({[S.itemContent]:!0,[S.itemInvisible]:!e.visibleAtCurrentScale||!e.visibleAtCurrentTimeExtent}),slot:"content"},p),this._renderItemStatus(e,l),this._renderItemToggle(e,l),L,this._renderItemTemporaryIcon(e),this._renderChildList(e,t,n),this._renderItemMessage(e),this._renderPanel(e.panel),this._renderPanelAction(e.panel),g>1?this._renderActionsSections(e,b):1===g?this._renderAction({item:e,action:this._getSingleAction(b),textEnabled:!1}):null)}_renderItemStatus(e,t){const{visibleElements:i}=this;if(!i.statusIndicators)return null;const{connectionStatus:l,publishing:n,updating:o}=e,s=o&&!t,a=!!l;return(0,V.u)("calcite-icon",{class:this.classes({[S.statusIndicator]:!0,[S.publishing]:n,[S.updating]:s,[S.connectionStatus]:a,[S.connectionStatusConnected]:a&&"connected"===l}),icon:(0,v.XO)({connectionStatus:l,publishing:n}),key:"layer-item-status",scale:"s",slot:"actions-end"})}_renderItemTemporaryIcon(e){return this.visibleElements.temporaryLayerIndicators&&"persistenceEnabled"in e.layer&&!e.layer.persistenceEnabled?(0,V.u)("calcite-icon",{class:S.itemTemporaryIcon,icon:"temporary",key:"temporary-icon",scale:"s",slot:"actions-start",title:this.messages.temporary}):null}_renderItemToggle(e,t){const{messages:i,visibilityAppearance:l}=this,{visible:n}=e,o=null===t||void 0===t?void 0:t.visibilityMode;if("inherited"===o)return null;const s=(0,v.gk)({visible:n,exclusive:"exclusive"===o,visibilityAppearance:l}),a="checkbox"===l,r=i.layerVisibility;return(0,V.u)("calcite-action",{appearance:"transparent",class:S.visibleToggle,icon:a?s:void 0,key:"visibility-toggle",onclick:()=>this._toggleVisibility(e,t),scale:"s",slot:a?"actions-start":"actions-end",text:r,title:r},a?null:(0,V.u)("calcite-icon",{class:this.classes({[S.visibleIcon]:"exclusive"!==o&&n}),icon:s,scale:"s"}))}_renderPanel(e){return null===e||void 0===e||!e.open||e.disabled||e.flowEnabled?null:(0,V.u)("div",{class:S.itemContentBottom,key:"content-panel-".concat(e.uid),slot:"content-bottom"},e.render())}_renderPanelAction(e){if(null===e||void 0===e||!e.visible)return null;const{open:t,title:i,disabled:l}=e;return(0,V.u)("calcite-action",{active:t,appearance:"transparent",disabled:l,icon:(0,u.mR)(e),key:"action-".concat(e.uid),onclick:()=>this._togglePanel(e),scale:"s",slot:"actions-end",text:null!==i&&void 0!==i?i:"",title:null!==i&&void 0!==i?i:void 0},this._renderFallbackIcon(e))}_renderActionsSections(e,t){const i=this.messagesCommon.options;return(0,V.u)("calcite-action-menu",{appearance:"transparent",class:S.actionMenu,key:"item-action-menu",label:this.messagesCommon.menu,open:e.actionsOpen,overlayPositioning:"fixed",placement:"bottom-end",scale:"s",slot:"actions-end",onCalciteActionMenuOpen:t=>e.actionsOpen=t.target.open},(0,V.u)("calcite-action",{appearance:"transparent",icon:"ellipsis",scale:"s",slot:"trigger",text:i,title:i}),t.toArray().map(((t,i)=>this._renderActionSection(e,t,i))))}_renderActionSection(e,t,i){return(0,V.u)("calcite-action-group",{class:S.actionGroup,key:"action-section-".concat(i)},t.toArray().map((t=>this._renderAction({item:e,action:t,textEnabled:!0}))))}_renderFallbackIcon(e){const{className:t,icon:i}=e;if(i)return null;const l="image"in e?e.image:void 0,n={[S.itemActionIcon]:!!t,[S.itemActionImage]:!!l};return t&&(n[t]=!0),l||t?(0,V.u)("span",{"aria-hidden":"true",class:this.classes(S.itemActionIcon,n),key:"icon",styles:(0,u.uS)(l)}):null}_renderAction(e){const{item:t,action:i,textEnabled:l}=e;if(!i)return null;const{active:n,disabled:o,title:s,type:a,indicator:r}=i;return(0,V.u)("calcite-action",{active:"toggle"===a&&i.value,appearance:"transparent",disabled:o,icon:(0,u.mR)(i),indicator:r,key:"action-".concat(i.uid),loading:n,onclick:()=>this._triggerAction(t,i),scale:"s",slot:l?void 0:"actions-end",text:null!==s&&void 0!==s?s:"",textEnabled:l,title:null!==s&&void 0!==s?s:void 0},this._renderFallbackIcon(i))}_setTooltipReference(e,t){this._tooltipReferenceMap.set(t.layer.uid,e)}_removeTooltipReference(e){this._tooltipReferenceMap.delete(e.layer.uid)}_moveLayerFromChildList(e){let{toEl:t,fromEl:i,dragEl:l,newIndex:n}=e;const o=(0,v.rV)(l),s=(0,v.rV)(t),a=(0,v.rV)(i),r=G(i),c=G(t);r&&c&&this.viewModel.moveListItem({targetItem:o,fromParentItem:a,toParentItem:s,newIndex:n,from:r,to:c})}_handleCalciteListDragEnd(e){const{fromEl:t,dragEl:i,oldIndex:l}=e;t.insertBefore(i,t.children[l])}_sortLayers(e,t){if(e)if(e.group===this._rootGroupUid){var i,l;const n=G(e),o="base"===n?null===(i=this.view)||void 0===i||null===(i=i.map)||void 0===i||null===(i=i.basemap)||void 0===i?void 0:i.baseLayers:"reference"===n?null===(l=this.view)||void 0===l||null===(l=l.map)||void 0===l||null===(l=l.basemap)||void 0===l?void 0:l.referenceLayers:null;(0,v.Cl)(o,t)}else{const i=(0,v.rV)(e);if(!i)return;(0,v.YO)(i,t)}}_getSingleAction(e){return e.reduce((e=>e)).find((e=>e&&("button"===e.type||"toggle"===e.type)))}_filterActions(e){return e.map((e=>e.filter((e=>e.visible))))}_countActions(e){return e.reduce(((e,t)=>e+t.length),0)}_triggerAction(e,t){t&&e&&("toggle"===t.type&&(t.value=!t.value),this.triggerAction(t,e))}_handleCalciteListChange(e){const{selectionMode:t,selectedItems:i}=this;if("none"===t)return;const l=e.target.selectedItems.map((e=>(0,v.rV)(e))).filter(Boolean);i.removeAll(),i.addMany(l)}_handleCalciteListItemToggle(e,t){e.stopPropagation(),t.open=e.target.open}_focusSelectedDragEl(e,t){this._selectedDragItemLayerUid===t.layer.uid&&requestAnimationFrame((()=>null===e||void 0===e?void 0:e.setFocus()))}_handleCalciteListItemDragHandleChange(e,t){e.stopPropagation();const i=e.target.dragSelected;this._selectedDragItemLayerUid=i?t.layer.uid:null}_handleCalciteListItemSelect(e,t,i){(0,v.rV)(e.target)===t&&"none"===this.selectionMode&&"inherited"!==(null===i||void 0===i?void 0:i.visibilityMode)&&this._toggleVisibility(t,i)}_togglePanel(e){e.open=!e.open,e.open&&(this._focusPanelFlowItem=!0)}_toggleVisibility(e,t){if(!e)return;"exclusive"===(null===t||void 0===t?void 0:t.visibilityMode)&&e.visible||(e.visible=!e.visible)}_renderEditingInput(){const{messages:e}=this,{basemapTitle:t}=this.viewModel;return(0,V.u)("div",{class:S.editing},(0,V.u)("calcite-label",null,e.basemapTitle,(0,V.u)("calcite-input",{afterCreate:e=>this._editTitleInput=e,label:e.basemapTitle,name:"basemaptitle",pattern:".*\\S+.*",placeholder:e.basemapTitle,required:!0,title:e.basemapTitle,type:"text",value:null!==t&&void 0!==t?t:void 0})))}_renderCancelButton(){const{messagesCommon:{cancel:e}}=this;return(0,V.u)("calcite-button",{appearance:"outline",bind:this,label:e,onclick:this._toggleEditingTitle,slot:"footer",title:e,width:"half"},e)}_renderSubmitButton(){const{messagesCommon:e}=this;return(0,V.u)("calcite-button",{label:e.form.submit,slot:"footer",title:e.form.submit,type:"submit",width:"half"},e.form.ok)}_renderEditingForm(){return this.editingTitle?(0,V.u)("form",{bind:this,onsubmit:this._formSubmit},(0,V.u)("calcite-flow-item",{afterCreate:this._focusEditingFlowItemNode,afterUpdate:this._focusEditingFlowItemNode,bind:this,heading:this.visibleElements.heading?this.messages.basemapTitle:void 0,headingLevel:this.headingLevel,onCalciteFlowItemBack:e=>{e.preventDefault(),this._toggleEditingTitle()}},this._renderEditingInput(),this._renderCancelButton(),this._renderSubmitButton())):null}_renderEditTitleButton(){const{editingTitle:e,visibleElements:t,messagesCommon:i}=this,l=i.edit;return t.editTitleButton&&!e?(0,V.u)("calcite-action",{bind:this,icon:"pencil",onclick:this._toggleEditingTitle,slot:"header-actions-end",text:l,title:l}):null}_renderNoLayersInfoMessage(e){return(0,V.u)("div",{slot:"message"},e)}_renderNoLayersInfo(e,t){return(0,V.u)("div",{class:S.itemMessage},(0,V.u)("calcite-notice",{icon:"information",key:t,kind:"info",open:!0,width:"full"},this._renderNoLayersInfoMessage(e)))}_getFilteredItems(e){return null===e||void 0===e?void 0:e.filter((e=>!e.hidden&&(this.visibleElements.errors||!e.error)))}_renderItems(){var e;const{collapsed:t,visible:i,visibleElements:{closeButton:l,collapseButton:n,heading:o,flow:s},messages:a,viewModel:r,referenceItems:c,baseItems:d}=this,u=this.visibleElements.referenceLayers?this._getFilteredItems(c):null,m=this.visibleElements.baseLayers?this._getFilteredItems(d):null,h=[(0,V.u)("calcite-flow-item",{afterCreate:this._focusRootFlowItemNode,afterUpdate:this._focusRootFlowItemNode,bind:this,closable:l,closed:!i,collapsed:t,collapsible:n,heading:o?null!==(e=r.basemapTitle)&&void 0!==e?e:a.widgetLabel:void 0,headingLevel:this.headingLevel,key:"root-flow-item",onCalciteFlowItemClose:()=>this.visible=!1},this._renderEditTitleButton(),this._renderReferenceSection(u),this._renderBaseSection(m,1===(null===m||void 0===m?void 0:m.length))),this._renderEditingForm(),this._renderPanelFlowItems(m),this._renderPanelFlowItems(u),this._renderCatalogFlowItem()];return i?[s?(0,V.u)("calcite-flow",{key:"root-flow"},h):h,this._renderItemTooltips(u),this._renderItemTooltips(m)]:null}_renderChildList(e,t){var i,l;let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const{_rootGroupUid:o,dragEnabled:s,viewModel:{listModeDisabled:a},selectionMode:r}=this,{children:c}=e,d="catalog-dynamic-group"!==(null===(i=e.layer)||void 0===i?void 0:i.type)&&(0,v.bB)(e),u=!(!a&&(0,v.Kf)(e.layer))&&!d&&s&&"group"===(null===(l=e.layer)||void 0===l?void 0:l.type);return d||u?(0,V.u)("calcite-list",{canPull:e=>this._canMove(e,"pull"),canPut:e=>this._canMove(e,"put"),"data-basemap-layer-type":t,"data-item":e,"data-layer-type":o,dragEnabled:!!s&&e.childrenSortable&&(0,v.xA)(e),group:"".concat(o,"-").concat(e.layer.uid),key:"child-list-".concat(e.layer.uid),selectionAppearance:"border",selectionMode:r},null===c||void 0===c?void 0:c.filter((e=>!e.hidden)).toArray().map((i=>this._renderItem(i,t,!1,e,[...n,e.title])))):null}_renderList(e,t,i){const{messages:l,dragEnabled:n,selectionMode:o,filterPlaceholder:s,baseFilterText:a,referenceFilterText:r,_baseFilterEnabled:c,_referenceFilterEnabled:d,_rootGroupUid:u}=this,m="reference"===t?l.noReferenceLayers:l.noBaseLayers,h="reference"===t?d:c;return(0,V.u)("calcite-block",{class:S.section,collapsible:!0,heading:"reference"===t?l.referenceHeading:l.baseHeading,headingLevel:(0,N.M)(this.headingLevel),key:"block-".concat(t),open:!0},0===(null===e||void 0===e?void 0:e.length)?this._renderNoLayersInfo(m,t):null,(0,V.u)("calcite-list",{afterCreate:e=>{e.addEventListener("focusin",this._setActiveItem),e.addEventListener("focusout",this._clearActiveItem)},afterRemoved:e=>{e.removeEventListener("focusin",this._setActiveItem),e.removeEventListener("focusout",this._clearActiveItem)},canPull:e=>this._canMove(e,"pull"),canPut:e=>this._canMove(e,"put"),"data-basemap-layer-type":t,"data-layer-type":u,dragEnabled:n,filterEnabled:h,filterPlaceholder:s,filterText:h?"reference"===t?r:a:"",group:u,key:"list-".concat(t),label:l.widgetLabel,onmouseleave:this._clearActiveItem,onmouseover:this._setActiveItem,selectionAppearance:"border",selectionMode:o,onCalciteListChange:e=>this._handleCalciteListChange(e),onCalciteListDragEnd:e=>this._handleCalciteListDragEnd(e.detail),onCalciteListFilter:e=>{var i,l;return this["reference"===t?"referenceFilterText":"baseFilterText"]=null!==(i=null===(l=e.target)||void 0===l?void 0:l.filterText)&&void 0!==i?i:""},onCalciteListOrderChange:e=>this._onCalciteListOrderChange(e.detail)},null===e||void 0===e?void 0:e.toArray().map((e=>this._renderItem(e,t,i))),null!==e&&void 0!==e&&e.length&&h?(0,V.u)("div",{class:S.filterNoResults,slot:"filter-no-results"},(0,V.u)("calcite-notice",{kind:"info",open:!0,width:"full"},this._renderNoLayersInfoMessage(m))):null))}_renderBaseSection(e,t){return this.visibleElements.baseLayers?this._renderList(e,"base",t):null}_renderReferenceSection(e){return this.visibleElements.referenceLayers?this._renderList(e,"reference",!1):null}_toggleEditingTitle(){const{editingTitle:e}=this,t=!e;this.editingTitle=t,t?this._focusEditingFlowItem=!0:this._focusRootFlowItem=!0}_formSubmit(e){var t;e.preventDefault();const i=null===(t=this._editTitleInput)||void 0===t?void 0:t.value;null!==i&&void 0!==i&&i.trim()&&(this.basemapTitle=i),this._toggleEditingTitle()}};function G(e){return null===e||void 0===e?void 0:e.getAttribute("data-basemap-layer-type")}(0,l._)([(0,c.Cb)()],U.prototype,"_activeItem",void 0),(0,l._)([(0,c.Cb)()],U.prototype,"_tooltipReferenceMap",void 0),(0,l._)([(0,c.Cb)()],U.prototype,"_focusRootFlowItem",void 0),(0,l._)([(0,c.Cb)()],U.prototype,"_focusPanelFlowItem",void 0),(0,l._)([(0,c.Cb)()],U.prototype,"_focusEditingFlowItem",void 0),(0,l._)([(0,c.Cb)()],U.prototype,"_focusCatalogFlowItem",void 0),(0,l._)([(0,c.Cb)()],U.prototype,"_totalBaseItems",null),(0,l._)([(0,c.Cb)()],U.prototype,"_totalReferenceItems",null),(0,l._)([(0,c.Cb)()],U.prototype,"_baseFilterEnabled",null),(0,l._)([(0,c.Cb)()],U.prototype,"_referenceFilterEnabled",null),(0,l._)([(0,c.Cb)()],U.prototype,"basemapTitle",null),(0,l._)([(0,c.Cb)({readOnly:!0})],U.prototype,"catalogLayerList",void 0),(0,l._)([(0,c.Cb)()],U.prototype,"catalogOptions",void 0),(0,l._)([(0,c.Cb)()],U.prototype,"collapsed",void 0),(0,l._)([(0,c.Cb)()],U.prototype,"dragEnabled",void 0),(0,l._)([(0,c.Cb)()],U.prototype,"editingTitle",void 0),(0,l._)([(0,c.Cb)()],U.prototype,"filterPlaceholder",void 0),(0,l._)([(0,c.Cb)()],U.prototype,"baseFilterText",void 0),(0,l._)([(0,c.Cb)()],U.prototype,"referenceFilterText",void 0),(0,l._)([(0,c.Cb)()],U.prototype,"listItemCanGiveFunction",void 0),(0,l._)([(0,c.Cb)()],U.prototype,"listItemCanReceiveFunction",void 0),(0,l._)([(0,c.Cb)()],U.prototype,"baseListItemCreatedFunction",null),(0,l._)([(0,c.Cb)()],U.prototype,"editingEnabled",null),(0,l._)([(0,c.Cb)()],U.prototype,"headingLevel",void 0),(0,l._)([(0,c.Cb)()],U.prototype,"icon",null),(0,l._)([(0,c.Cb)()],U.prototype,"label",null),(0,l._)([(0,c.Cb)(),(0,D.H)("esri/widgets/BasemapLayerList/t9n/BasemapLayerList")],U.prototype,"messages",void 0),(0,l._)([(0,c.Cb)(),(0,D.H)("esri/t9n/common")],U.prototype,"messagesCommon",void 0),(0,l._)([(0,c.Cb)()],U.prototype,"minFilterItems",void 0),(0,l._)([(0,c.Cb)()],U.prototype,"multipleSelectionEnabled",null),(0,l._)([(0,c.Cb)()],U.prototype,"referenceListItemCreatedFunction",null),(0,l._)([(0,c.Cb)({readOnly:!0})],U.prototype,"baseItems",null),(0,l._)([(0,c.Cb)()],U.prototype,"openCatalogItem",void 0),(0,l._)([(0,c.Cb)({readOnly:!0})],U.prototype,"referenceItems",null),(0,l._)([(0,c.Cb)()],U.prototype,"selectedItems",void 0),(0,l._)([(0,c.Cb)()],U.prototype,"selectionMode",void 0),(0,l._)([(0,c.Cb)()],U.prototype,"view",null),(0,l._)([(0,H.s)("trigger-action"),(0,c.Cb)({type:M})],U.prototype,"viewModel",void 0),(0,l._)([(0,c.Cb)()],U.prototype,"visibilityAppearance",void 0),(0,l._)([(0,c.Cb)({type:A,nonNullable:!0})],U.prototype,"visibleElements",void 0),U=(0,l._)([(0,d.j)("esri.widgets.BasemapLayerList")],U);const Z=U}}]);
//# sourceMappingURL=71651.bc8fdeb1.chunk.js.map