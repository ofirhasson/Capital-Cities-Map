"use strict";(self.webpackChunknorthwind=self.webpackChunknorthwind||[]).push([[56589,92463,15440,2170,93655],{46798:(e,t,i)=>{i.d(t,{q:()=>l});var a=i(63780),r=i(42537),o=i(32718),n=i(66978),s=i(70431);class l{constructor(e,t,i,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};this._mainMethod=t,this._transferLists=i,this._listeners=[],this._promise=(0,s.bA)(e,{...r,schedule:a}).then((e=>{if(void 0===this._thread){this._thread=e,this._promise=null,r.hasInitialize&&this.broadcast({},"initialize");for(const e of this._listeners)this._connectListener(e)}else e.close()})),this._promise.catch((t=>o.Z.getLogger("esri.core.workers.WorkerHandle").error("Failed to initialize ".concat(e," worker: ").concat(t))))}on(e,t){const i={removed:!1,eventName:e,callback:t,threadHandle:null};return this._listeners.push(i),this._connectListener(i),(0,r.kB)((()=>{i.removed=!0,(0,a.Od)(this._listeners,i),this._thread&&null!=i.threadHandle&&i.threadHandle.remove()}))}destroy(){this._thread&&(this._thread.close(),this._thread=null),this._promise=null,this._listeners.length=0,this._transferLists={}}invoke(e,t){return this.invokeMethod(this._mainMethod,e,t)}invokeMethod(e,t,i){if(this._thread){const a=this._transferLists[e],r=a?a(t):[];return this._thread.invoke(e,t,{transferList:r,signal:i})}return this._promise?this._promise.then((()=>((0,n.k_)(i),this.invokeMethod(e,t,i)))):Promise.reject(null)}broadcast(e,t){return this._thread?Promise.all(this._thread.broadcast(t,e)).then((()=>{})):this._promise?this._promise.then((()=>this.broadcast(e,t))):Promise.reject()}get promise(){return this._promise}_connectListener(e){this._thread&&this._thread.on(e.eventName,e.callback).then((t=>{e.removed||(e.threadHandle=t)}))}}},42137:(e,t,i)=>{i.d(t,{Z:()=>v});var a,r=i(27366),o=i(68860),n=i(49861),s=(i(93169),i(32718),i(84936),i(69912)),l=i(83448),c=i(848),h=i(80885),d=i(78952),u=i(15559),p=i(81753),m=i(89093);let g=a=class extends h.Z{constructor(){super(...arguments),this.center=null,this.geodesic=!1,this.numberOfPoints=60,this.radius=1e3,this.radiusUnit="meters"}normalizeCtorArgs(e,t){let i;if(null!==e&&void 0!==e&&e.center)i=e;else{if(null!==e&&void 0!==e&&e.rings)return super.normalizeCtorArgs(e,t);i={center:e}}return{...super.normalizeCtorArgs(),...i,...t}}initialize(){var e;const t=this.center,i=this.numberOfPoints;if(this.hasZ=null!==(e=null===t||void 0===t?void 0:t.hasZ)&&void 0!==e&&e,0!==this.rings.length||!t)return;const a=(0,o.En)(this.radius,this.radiusUnit,"meters"),r=t.spatialReference;let n,s="geographic";if(r.isWebMercator?s="webMercator":(null!=(r.wkid&&m.Z[r.wkid])||(r.wkt2||r.wkt)&&(0,o.s_)(r.wkt2||r.wkt))&&(s="projected"),this.geodesic){let e;switch(s){case"webMercator":e=(0,p.Sx)(t);break;case"projected":console.error("Creating a geodesic circle requires the center to be specified in web mercator or geographic coordinate system");break;case"geographic":e=t}n=this._createGeodesicCircle(e,a,i),"webMercator"===s&&(n=(0,p.$)(n))}else{let e;"webMercator"===s||"projected"===s?e=a/(0,o.Z7)(t.spatialReference):"geographic"===s&&(e=(0,o.ty)(a,"meters",(0,l.Iu)(t.spatialReference).radius)),n=this._createPlanarCircle(t,e,i)}this.spatialReference=n.spatialReference,this.addRing(n.rings[0])}clone(){const{center:e,numberOfPoints:t,radius:i,radiusUnit:r,geodesic:o}=this;return new a({center:null===e||void 0===e?void 0:e.clone(),numberOfPoints:t,radius:i,radiusUnit:r,geodesic:o})}_createGeodesicCircle(e,t,i){let a=0;const r=[];for(;a<360;){const o=[0,0],n=[e.x,e.y];(0,u.TB)(o,n,a,t,d.Z.WGS84),this.hasZ&&o.push(e.z),r.push(o),a+=360/i}return r.push(r[0]),new h.Z(r)}_createPlanarCircle(e,t,i){const a=[],r=2*Math.PI/i;for(let o=0;o<i;++o){const i=r*o,n=[e.x+Math.cos(-i)*t,e.y+Math.sin(-i)*t];this.hasZ&&n.push(e.z),a.push(n)}return a.push(a[0]),new h.Z({spatialReference:e.spatialReference,rings:[a]})}};(0,r._)([(0,n.Cb)({type:c.Z})],g.prototype,"center",void 0),(0,r._)([(0,n.Cb)()],g.prototype,"geodesic",void 0),(0,r._)([(0,n.Cb)()],g.prototype,"numberOfPoints",void 0),(0,r._)([(0,n.Cb)()],g.prototype,"radius",void 0),(0,r._)([(0,n.Cb)()],g.prototype,"radiusUnit",void 0),g=a=(0,r._)([(0,s.j)("esri.geometry.Circle")],g);const v=g},92463:(e,t,i)=>{i.r(t),i.d(t,{hydratedAdapter:()=>l});var a=i(53866),r=i(77577),o=i(848),n=i(80885),s=i(29909);const l={convertToGEGeometry:function(e,t){if(null==t)return null;let i="cache"in t?t.cache._geVersion:void 0;return null==i&&(i=e.convertJSONToGeometry(t),"cache"in t&&(t.cache._geVersion=i)),i},exportPoint:function(e,t,i){const a=e.hasZ(t),r=e.hasM(t),n=new o.Z({x:e.getPointX(t),y:e.getPointY(t),spatialReference:i});return a&&(n.z=e.getPointZ(t)),r&&(n.m=e.getPointM(t)),n.cache._geVersion=t,n},exportPolygon:function(e,t,i){const a=new n.Z({rings:e.exportPaths(t),hasZ:e.hasZ(t),hasM:e.hasM(t),spatialReference:i});return a.cache._geVersion=t,a},exportPolyline:function(e,t,i){const a=new s.Z({paths:e.exportPaths(t),hasZ:e.hasZ(t),hasM:e.hasM(t),spatialReference:i});return a.cache._geVersion=t,a},exportMultipoint:function(e,t,i){const a=new r.Z({hasZ:e.hasZ(t),hasM:e.hasM(t),points:e.exportPoints(t),spatialReference:i});return a.cache._geVersion=t,a},exportExtent:function(e,t,i){const r=e.hasZ(t),o=e.hasM(t),n=new a.Z({xmin:e.getXMin(t),ymin:e.getYMin(t),xmax:e.getXMax(t),ymax:e.getYMax(t),spatialReference:i});if(r){const i=e.getZExtent(t);n.zmin=i.vmin,n.zmax=i.vmax}if(o){const i=e.getMExtent(t);n.mmin=i.vmin,n.mmax=i.vmax}return n.cache._geVersion=t,n}}},2170:(e,t,i)=>{i.r(t),i.d(t,{buffer:()=>P,changeDefaultSpatialReferenceTolerance:()=>W,clearDefaultSpatialReferenceTolerance:()=>B,clip:()=>s,contains:()=>c,convexHull:()=>_,crosses:()=>h,cut:()=>l,densify:()=>N,difference:()=>C,disjoint:()=>v,distance:()=>d,equals:()=>u,extendedSpatialReferenceInfo:()=>n,flipHorizontal:()=>Z,flipVertical:()=>T,generalize:()=>E,geodesicArea:()=>j,geodesicBuffer:()=>F,geodesicDensify:()=>L,geodesicLength:()=>G,intersect:()=>x,intersectLinesToPoints:()=>H,intersects:()=>p,isSimple:()=>b,nearestCoordinate:()=>R,nearestVertex:()=>z,nearestVertices:()=>O,offset:()=>S,overlaps:()=>y,planarArea:()=>D,planarLength:()=>k,relate:()=>f,rotate:()=>V,simplify:()=>w,symmetricDifference:()=>M,touches:()=>m,union:()=>I,within:()=>g});var a=i(99058),r=i(92463);function o(e){return Array.isArray(e)?e[0].spatialReference:e&&e.spatialReference}function n(e){return a.G.extendedSpatialReferenceInfo(e)}function s(e,t){return a.G.clip(r.hydratedAdapter,o(e),e,t)}function l(e,t){return a.G.cut(r.hydratedAdapter,o(e),e,t)}function c(e,t){return a.G.contains(r.hydratedAdapter,o(e),e,t)}function h(e,t){return a.G.crosses(r.hydratedAdapter,o(e),e,t)}function d(e,t,i){return a.G.distance(r.hydratedAdapter,o(e),e,t,i)}function u(e,t){return a.G.equals(r.hydratedAdapter,o(e),e,t)}function p(e,t){return a.G.intersects(r.hydratedAdapter,o(e),e,t)}function m(e,t){return a.G.touches(r.hydratedAdapter,o(e),e,t)}function g(e,t){return a.G.within(r.hydratedAdapter,o(e),e,t)}function v(e,t){return a.G.disjoint(r.hydratedAdapter,o(e),e,t)}function y(e,t){return a.G.overlaps(r.hydratedAdapter,o(e),e,t)}function f(e,t,i){return a.G.relate(r.hydratedAdapter,o(e),e,t,i)}function b(e){return a.G.isSimple(r.hydratedAdapter,o(e),e)}function w(e){return a.G.simplify(r.hydratedAdapter,o(e),e)}function _(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return a.G.convexHull(r.hydratedAdapter,o(e),e,t)}function C(e,t){return a.G.difference(r.hydratedAdapter,o(e),e,t)}function M(e,t){return a.G.symmetricDifference(r.hydratedAdapter,o(e),e,t)}function x(e,t){return a.G.intersect(r.hydratedAdapter,o(e),e,t)}function I(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return a.G.union(r.hydratedAdapter,o(e),e,t)}function S(e,t,i,n,s,l){return a.G.offset(r.hydratedAdapter,o(e),e,t,i,n,s,l)}function P(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return a.G.buffer(r.hydratedAdapter,o(e),e,t,i,n)}function F(e,t,i,n,s,l){return a.G.geodesicBuffer(r.hydratedAdapter,o(e),e,t,i,n,s,l)}function R(e,t){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return a.G.nearestCoordinate(r.hydratedAdapter,o(e),e,t,i)}function z(e,t){return a.G.nearestVertex(r.hydratedAdapter,o(e),e,t)}function O(e,t,i,n){return a.G.nearestVertices(r.hydratedAdapter,o(e),e,t,i,n)}function A(e){var t,i;return"xmin"in e?"center"in e?e.center:null:"x"in e?e:"extent"in e&&null!==(t=null===(i=e.extent)||void 0===i?void 0:i.center)&&void 0!==t?t:null}function V(e,t,i){var r;if(null==e)throw new q;const o=e.spatialReference;if(null==(i=null!==(r=i)&&void 0!==r?r:A(e)))throw new q;const n=e.constructor.fromJSON(a.G.rotate(e,t,i));return n.spatialReference=o,n}function Z(e,t){var i;if(null==e)throw new q;const r=e.spatialReference;if(null==(t=null!==(i=t)&&void 0!==i?i:A(e)))throw new q;const o=e.constructor.fromJSON(a.G.flipHorizontal(e,t));return o.spatialReference=r,o}function T(e,t){var i;if(null==e)throw new q;const r=e.spatialReference;if(null==(t=null!==(i=t)&&void 0!==i?i:A(e)))throw new q;const o=e.constructor.fromJSON(a.G.flipVertical(e,t));return o.spatialReference=r,o}function E(e,t,i,n){return a.G.generalize(r.hydratedAdapter,o(e),e,t,i,n)}function N(e,t,i){return a.G.densify(r.hydratedAdapter,o(e),e,t,i)}function L(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return a.G.geodesicDensify(r.hydratedAdapter,o(e),e,t,i,n)}function D(e,t){return a.G.planarArea(r.hydratedAdapter,o(e),e,t)}function k(e,t){return a.G.planarLength(r.hydratedAdapter,o(e),e,t)}function j(e,t,i){return a.G.geodesicArea(r.hydratedAdapter,o(e),e,t,i)}function G(e,t,i){return a.G.geodesicLength(r.hydratedAdapter,o(e),e,t,i)}function H(e,t){return a.G.intersectLinesToPoints(r.hydratedAdapter,o(e),e,t)}function W(e,t){a.G.changeDefaultSpatialReferenceTolerance(e,t)}function B(e){a.G.clearDefaultSpatialReferenceTolerance(e)}class q extends Error{constructor(){super("Illegal Argument Exception")}}},15559:(e,t,i)=>{i.d(t,{Gb:()=>p,Jf:()=>g,Lc:()=>w,TB:()=>f,_q:()=>y,cA:()=>b,j2:()=>v,p8:()=>m});i(59486);var a=i(10064),r=i(68860),o=i(38516),n=i(92975),s=i(29909),l=i(80885),c=(i(848),i(78952));function h(e){if(!e)return null;if((0,n.sT)(e)&&e.wkid){const t=o.Dg[e.wkid];if(t)return t}const t=e.wkt2||e.wkt;if(t){const e=function(e){const t=o.FQ.exec(e);if(!t||2!==t.length)return null;const i=t[1].split(",");if(!i||i.length<3)return null;const a=parseFloat(i[1]),r=parseFloat(i[2]);return isNaN(a)||isNaN(r)?null:{a:a,f:0===r?0:1/r}}(t);if(e)return e}return null}function d(e){const t=h(e);if(function(e){return null!=e&&"b"in e&&"eSq"in e&&"radius"in e}(t))return t;const i=t.a*(1-t.f);return Object.assign(t,{b:i,eSq:1-(i/t.a)**2,radius:(2*t.a+i)/3,densificationRatio:1e4/((2*t.a+i)/3)})}function u(e,t,i){const{a:a,eSq:r}=d(i),n=Math.sqrt(r),s=Math.sin(t[1]*o.Yr),l=a*t[0]*o.Yr;let c;return c=r>0?a*((1-r)*(s/(1-r*(s*s))-1/(2*n)*Math.log((1-n*s)/(1+n*s))))*.5:a*s,e[0]=l,e[1]=c,e}function p(e){return null!==h(e)}function m(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"square-meters";if(e.some((e=>!p(e.spatialReference))))throw new a.Z("geodesic-areas:invalid-spatial-reference","the input geometries spatial reference is not supported");const i=[];for(let a=0;a<e.length;a++){const t=e[a],r=t.spatialReference,{radius:o,densificationRatio:n}=d(r),s=o*n;i.push(v(t,s))}const o=[],n=[0,0],s=[0,0];for(let a=0;a<i.length;a++){const{rings:e,spatialReference:l}=i[a];let c=0;for(let t=0;t<e.length;t++){const i=e[t];u(n,i[0],l),u(s,i[i.length-1],l);let a=s[0]*n[1]-n[0]*s[1];for(let e=0;e<i.length-1;e++)u(n,i[e+1],l),u(s,i[e],l),a+=s[0]*n[1]-n[0]*s[1];c+=a}c=(0,r.En)(c,"square-meters",t),o.push(c/-2)}return o}function g(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"meters";if(!e)throw new a.Z("geodesic-lengths:invalid-geometries","the input geometries type is not supported");if(e.some((e=>!p(e.spatialReference))))throw new a.Z("geodesic-lengths:invalid-spatial-reference","the input geometries spatial reference is not supported");const i=[];for(let a=0;a<e.length;a++){const o=e[a],{spatialReference:n}=o,s="polyline"===o.type?o.paths:o.rings;let l=0;for(let e=0;e<s.length;e++){const t=s[e];let i=0;for(let e=1;e<t.length;e++){const a=t[e-1][0],r=t[e][0],o=t[e-1][1],s=t[e][1];if(o!==s||a!==r){const e=new y;b(e,[a,o],[r,s],n),i+=e.distance}}l+=i}l=(0,r.En)(l,"meters",t),i.push(l)}return i}function v(e,t){if("polyline"!==e.type&&"polygon"!==e.type)throw new a.Z("geodesic-densify:invalid-geometry","the input geometry is neither polyline nor polygon");const{spatialReference:i}=e;if(!p(i))throw new a.Z("geodesic-densify:invalid-spatial-reference","the input geometry spatial reference is not supported");const r="polyline"===e.type?e.paths:e.rings,o=[],n=[0,0],c=new y;for(const a of r){const e=[];o.push(e),e.push([a[0][0],a[0][1]]);let r,s,l=a[0][0],h=a[0][1];for(let o=0;o<a.length-1;o++){if(r=a[o+1][0],s=a[o+1][1],l===r&&h===s)continue;const d=[l,h];b(c,[l,h],[r,s],i);const{azimuth:u,distance:p}=c,m=p/t;if(m>1){for(let a=1;a<=m-1;a++)f(n,d,u,a*t,i),e.push(n.slice(0));f(n,d,u,(p+Math.floor(m-1)*t)/2,i),e.push(n.slice(0))}f(n,d,u,p,i),e.push(n.slice(0)),l=n[0],h=n[1]}}return"polyline"===e.type?new s.Z({paths:o,spatialReference:i}):new l.Z({rings:o,spatialReference:i})}class y{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;this.distance=e,this.azimuth=t,this.reverseAzimuth=i}}function f(e,t,i,a,r){const n=t[0],s=t[1],l=n*o.Yr,c=s*o.Yr,h=(null!==i&&void 0!==i?i:0)*o.Yr,{a:u,b:p,f:m}=d(r),g=Math.sin(h),v=Math.cos(h),y=(1-m)*Math.tan(c),f=1/Math.sqrt(1+y*y),b=y*f,w=Math.atan2(y,v),_=f*g,C=_*_,M=1-C,x=M*(u*u-p*p)/(p*p),I=1+x/16384*(4096+x*(x*(320-175*x)-768)),S=x/1024*(256+x*(x*(74-47*x)-128));let P,F,R,z,O=a/(p*I),A=2*Math.PI;for(;Math.abs(O-A)>1e-12;)R=Math.cos(2*w+O),P=Math.sin(O),F=Math.cos(O),z=S*P*(R+S/4*(F*(2*R*R-1)-S/6*R*(4*P*P-3)*(4*R*R-3))),A=O,O=a/(p*I)+z;const V=b*P-f*F*v,Z=Math.atan2(b*F+f*P*v,(1-m)*Math.sqrt(C+V*V)),T=Math.atan2(P*g,f*F-b*P*v),E=m/16*M*(4+m*(4-3*M)),N=Z/o.Yr,L=(l+(T-(1-E)*m*_*(O+E*P*(R+E*F*(2*R*R-1)))))/o.Yr;return e[0]=L,e[1]=N,e}function b(e,t,i,a){const r=t[0]*o.Yr,n=t[1]*o.Yr,s=i[0]*o.Yr,l=i[1]*o.Yr,{a:c,b:h,f:u,radius:p}=d(a),m=s-r,g=Math.atan((1-u)*Math.tan(n)),v=Math.atan((1-u)*Math.tan(l)),y=Math.sin(g),f=Math.cos(g),b=Math.sin(v),w=Math.cos(v);let _,C,M,x,I,S,P,F,R,z,O=1e3,A=m;do{if(P=Math.sin(A),F=Math.cos(A),M=Math.sqrt(w*P*(w*P)+(f*b-y*w*F)*(f*b-y*w*F)),0===M)return e.distance=0,e.azimuth=void 0,e.reverseAzimuth=void 0,e;I=y*b+f*w*F,S=Math.atan2(M,I),R=f*w*P/M,C=1-R*R,x=I-2*y*b/C,isNaN(x)&&(x=0),z=u/16*C*(4+u*(4-3*C)),_=A,A=m+(1-z)*u*R*(S+z*M*(x+z*I*(2*x*x-1)))}while(Math.abs(A-_)>1e-12&&--O>0);if(0===O){const t=p,i=Math.acos(Math.sin(n)*Math.sin(l)+Math.cos(n)*Math.cos(l)*Math.cos(s-r))*t,a=s-r,c=Math.sin(a)*Math.cos(l),h=Math.cos(n)*Math.sin(l)-Math.sin(n)*Math.cos(l)*Math.cos(a),d=Math.atan2(c,h);return e.azimuth=d/o.Yr,e.distance=i,e.reverseAzimuth=void 0,e}const V=C*(c*c-h*h)/(h*h),Z=V/1024*(256+V*(V*(74-47*V)-128)),T=h*(1+V/16384*(4096+V*(V*(320-175*V)-768)))*(S-Z*M*(x+Z/4*(I*(2*x*x-1)-Z/6*x*(4*M*M-3)*(4*x*x-3)))),E=Math.atan2(w*Math.sin(A),f*b-y*w*Math.cos(A)),N=Math.atan2(f*Math.sin(A),f*b*Math.cos(A)-y*w);return e.azimuth=E/o.Yr,e.distance=T,e.reverseAzimuth=N/o.Yr,e}function w(e){return p(e)?e:(0,n.sS)(e)?c.Z.WGS84:null}},42785:(e,t,i)=>{i.r(t),i.d(t,{default:()=>x});var a=i(27366),r=i(76200),o=i(10064),n=i(92026),s=i(97642),l=i(66978),c=i(35995),h=i(49861),d=(i(93169),i(32718),i(84936),i(38511)),u=i(69912),p=i(90724),m=i(30651),g=i(17775),v=i(11936),y=i(6061),f=i(29598),b=i(70361),w=i(48932),_=i(41665);let C=class extends((0,g.Z)((0,v.Y)((0,y.q)((0,f.I)((0,s.R)(m.Z)))))){constructor(){super(...arguments),this.capabilities={operations:{supportsTileMap:!1}},this.copyright=null,this.heightModelInfo=null,this.path=null,this.minScale=void 0,this.maxScale=void 0,this.opacity=1,this.operationalLayerType="ArcGISTiledElevationServiceLayer",this.sourceJSON=null,this.type="elevation",this.url=null,this.version=null,this._lercDecoder=(0,_.w)()}normalizeCtorArgs(e,t){return"string"==typeof e?{url:e,...t}:e}destroy(){this._lercDecoder=(0,n.RY)(this._lercDecoder)}readCapabilities(e,t){const i=t.capabilities&&t.capabilities.split(",").map((e=>e.toLowerCase().trim()));return i?{operations:{supportsTileMap:i.includes("tilemap")}}:{operations:{supportsTileMap:!1}}}readVersion(e,t){let i=t.currentVersion;return i||(i=9.3),i}load(e){const t=null!=e?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Image Service"],supportsData:!1,validateItem:e=>{if(e.typeKeywords)for(let t=0;t<e.typeKeywords.length;t++)if("elevation 3d layer"===e.typeKeywords[t].toLowerCase())return!0;throw new o.Z("portal:invalid-layer-item-type","Invalid layer item type '${type}', expected '${expectedType}' ",{type:"Image Service",expectedType:"Image Service Elevation 3D Layer"})}},e).catch(l.r9).then((()=>this._fetchImageService(t)))),Promise.resolve(this)}fetchTile(e,t,i,a){const o=null!=(a=a||{signal:null}).signal?a.signal:a.signal=(new AbortController).signal,n={responseType:"array-buffer",signal:o},s={noDataValue:a.noDataValue,returnFileInfo:!0};return this.load().then((()=>this._fetchTileAvailability(e,t,i,a))).then((()=>(0,r.Z)(this.getTileUrl(e,t,i),n))).then((e=>this._lercDecoder.decode(e.data,s,o))).then((e=>new w.v(e)))}getTileUrl(e,t,i){const a=!this.capabilities.operations.supportsTileMap&&this.supportsBlankTile,r=(0,c.B7)({...this.parsedUrl.query,blankTile:!a&&null});return"".concat(this.parsedUrl.path,"/tile/").concat(e,"/").concat(t,"/").concat(i).concat(r?"?"+r:"")}async queryElevation(e,t){const{ElevationQuery:a}=await Promise.all([i.e(77043),i.e(35975)]).then(i.bind(i,77043));return(0,l.k_)(t),(new a).query(this,e,t)}async createElevationSampler(e,t){const{ElevationQuery:a}=await Promise.all([i.e(77043),i.e(35975)]).then(i.bind(i,77043));return(0,l.k_)(t),(new a).createSampler(this,e,t)}_fetchTileAvailability(e,t,i,a){return this.tilemapCache?this.tilemapCache.fetchAvailability(e,t,i,a):Promise.resolve("unknown")}async _fetchImageService(e){var t;if(this.sourceJSON)return this.sourceJSON;const i={query:{f:"json",...this.parsedUrl.query},responseType:"json",signal:e},a=await(0,r.Z)(this.parsedUrl.path,i);a.ssl&&(this.url=null===(t=this.url)||void 0===t?void 0:t.replace(/^http:/i,"https:")),this.sourceJSON=a.data,this.read(a.data,{origin:"service",url:this.parsedUrl})}get hasOverriddenFetchTile(){return!this.fetchTile[M]}};(0,a._)([(0,h.Cb)({readOnly:!0})],C.prototype,"capabilities",void 0),(0,a._)([(0,d.r)("service","capabilities",["capabilities"])],C.prototype,"readCapabilities",null),(0,a._)([(0,h.Cb)({json:{read:{source:"copyrightText"}}})],C.prototype,"copyright",void 0),(0,a._)([(0,h.Cb)({readOnly:!0,type:p.Z})],C.prototype,"heightModelInfo",void 0),(0,a._)([(0,h.Cb)({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],C.prototype,"path",void 0),(0,a._)([(0,h.Cb)({type:["show","hide"]})],C.prototype,"listMode",void 0),(0,a._)([(0,h.Cb)({json:{read:!1,write:!1,origins:{service:{read:!1,write:!1},"portal-item":{read:!1,write:!1},"web-document":{read:!1,write:!1}}},readOnly:!0})],C.prototype,"minScale",void 0),(0,a._)([(0,h.Cb)({json:{read:!1,write:!1,origins:{service:{read:!1,write:!1},"portal-item":{read:!1,write:!1},"web-document":{read:!1,write:!1}}},readOnly:!0})],C.prototype,"maxScale",void 0),(0,a._)([(0,h.Cb)({json:{read:!1,write:!1,origins:{"web-document":{read:!1,write:!1}}}})],C.prototype,"opacity",void 0),(0,a._)([(0,h.Cb)({type:["ArcGISTiledElevationServiceLayer"]})],C.prototype,"operationalLayerType",void 0),(0,a._)([(0,h.Cb)()],C.prototype,"sourceJSON",void 0),(0,a._)([(0,h.Cb)({json:{read:!1},value:"elevation",readOnly:!0})],C.prototype,"type",void 0),(0,a._)([(0,h.Cb)(b.HQ)],C.prototype,"url",void 0),(0,a._)([(0,h.Cb)()],C.prototype,"version",void 0),(0,a._)([(0,d.r)("version",["currentVersion"])],C.prototype,"readVersion",null),C=(0,a._)([(0,u.j)("esri.layers.ElevationLayer")],C);const M=Symbol("default-fetch-tile");C.prototype.fetchTile[M]=!0;const x=C},93655:(e,t,i)=>{i.r(t),i.d(t,{default:()=>p});var a=i(27366),r=i(49861),o=(i(93169),i(32718),i(84936),i(69912)),n=i(68748),s=i(30651),l=i(6693),c=i(56811),h=i(78983),d=i(64575);let u=class extends((0,l.h7)((0,c.M)(s.Z))){constructor(e){super(e),this.elevationInfo=null,this.graphics=new h.J,this.screenSizePerspectiveEnabled=!0,this.type="graphics",this.internal=!1}destroy(){this.removeAll(),this.graphics.destroy()}add(e){return this.graphics.add(e),this}addMany(e){return this.graphics.addMany(e),this}removeAll(){return this.graphics.removeAll(),this}remove(e){this.graphics.remove(e)}removeMany(e){this.graphics.removeMany(e)}on(e,t){return super.on(e,t)}graphicChanged(e){this.emit("graphic-update",e)}};(0,a._)([(0,r.Cb)({type:d.Z})],u.prototype,"elevationInfo",void 0),(0,a._)([(0,r.Cb)((0,n.z)(h.J,"graphics"))],u.prototype,"graphics",void 0),(0,a._)([(0,r.Cb)({type:["show","hide"]})],u.prototype,"listMode",void 0),(0,a._)([(0,r.Cb)()],u.prototype,"screenSizePerspectiveEnabled",void 0),(0,a._)([(0,r.Cb)({readOnly:!0})],u.prototype,"type",void 0),(0,a._)([(0,r.Cb)({constructOnly:!0})],u.prototype,"internal",void 0),u=(0,a._)([(0,o.j)("esri.layers.GraphicsLayer")],u);const p=u},15440:(e,t,i)=>{i.r(t),i.d(t,{default:()=>p});var a=i(27366),r=i(10064),o=i(43404),n=i(49861),s=i(89125),l=i(69912),c=i(64326),h=i(63967);function d(e,t,i){return{name:"orientedImageryProperties.".concat(e),write:!t||{target:"orientedImageryProperties.".concat(e),writer:t},origins:{service:{name:"orientedImageryInfo.orientedImageryProperties.".concat(e),write:t,read:i}}}}let u=class extends c.default{constructor(){super(...arguments),this.cameraHeading=null,this.cameraHeight=null,this.cameraPitch=null,this.cameraRoll=null,this.coveragePercent=null,this.demPathPrefix=null,this.demPathSuffix=null,this.depthImagePathPrefix=null,this.depthImagePathSuffix=null,this.elevationSource=null,this.farDistance=null,this.geometryType="point",this.horizontalFieldOfView=null,this.horizontalMeasurementUnit=null,this.imagePathPrefix=null,this.imagePathSuffix=null,this.imageRotation=null,this.maximumDistance=null,this.nearDistance=null,this.operationalLayerType="OrientedImageryLayer",this.orientationAccuracy=null,this.orientedImageryType=null,this.supportedSourceTypes=new Set(["Oriented Imagery Layer"]),this.type="oriented-imagery",this.timeIntervalUnit=null,this.verticalFieldOfView=null,this.verticalMeasurementUnit=null,this.videoPathPrefix=null,this.videoPathSuffix=null}get effectiveElevationSource(){const{elevationSource:e,demPathPrefix:t,demPathSuffix:i}=this;return(0,h.d6)(e,t,i)}findFirstValidLayerId(e){var t;return null===(t=e.layers)||void 0===t||null===(t=t.find((e=>this.supportedSourceTypes.has(e.type))))||void 0===t?void 0:t.id}_verifySource(){if(super._verifySource(),"point"!==this.geometryType)throw new r.Z("oriented-imagery-layer:invalid-geometry-type","OrientedImageryLayer only supports point geometry type")}};(0,a._)([(0,n.Cb)({type:Number,json:d("cameraHeading")})],u.prototype,"cameraHeading",void 0),(0,a._)([(0,n.Cb)({type:Number,json:d("cameraHeight")})],u.prototype,"cameraHeight",void 0),(0,a._)([(0,n.Cb)({type:Number,json:d("cameraPitch")})],u.prototype,"cameraPitch",void 0),(0,a._)([(0,n.Cb)({type:Number,json:d("cameraRoll")})],u.prototype,"cameraRoll",void 0),(0,a._)([(0,n.Cb)({type:Number,json:d("coveragePercent")})],u.prototype,"coveragePercent",void 0),(0,a._)([(0,n.Cb)({type:String,json:d("demPathPrefix")})],u.prototype,"demPathPrefix",void 0),(0,a._)([(0,n.Cb)({type:String,json:d("demPathSuffix")})],u.prototype,"demPathSuffix",void 0),(0,a._)([(0,n.Cb)({type:String,json:d("depthImagePathPrefix")})],u.prototype,"depthImagePathPrefix",void 0),(0,a._)([(0,n.Cb)({type:String,json:d("depthImagePathSuffix")})],u.prototype,"depthImagePathSuffix",void 0),(0,a._)([(0,n.Cb)({type:Object,json:d("elevationSource")})],u.prototype,"elevationSource",void 0),(0,a._)([(0,n.Cb)()],u.prototype,"effectiveElevationSource",null),(0,a._)([(0,n.Cb)({type:Number,json:d("farDistance")})],u.prototype,"farDistance",void 0),(0,a._)([(0,n.Cb)({json:{write:!0}})],u.prototype,"geometryType",void 0),(0,a._)([(0,n.Cb)({type:Number,json:d("horizontalFieldOfView")})],u.prototype,"horizontalFieldOfView",void 0),(0,a._)([(0,n.Cb)({type:String,json:d("horizontalMeasurementUnit")})],u.prototype,"horizontalMeasurementUnit",void 0),(0,a._)([(0,n.Cb)({type:String,json:d("imagePathPrefix")})],u.prototype,"imagePathPrefix",void 0),(0,a._)([(0,n.Cb)({type:String,json:d("imagePathSuffix")})],u.prototype,"imagePathSuffix",void 0),(0,a._)([(0,n.Cb)({type:Number,json:d("imageRotation")})],u.prototype,"imageRotation",void 0),(0,a._)([(0,n.Cb)({type:Number,json:d("maximumDistance")})],u.prototype,"maximumDistance",void 0),(0,a._)([(0,n.Cb)({type:Number,json:d("nearDistance")})],u.prototype,"nearDistance",void 0),(0,a._)([(0,n.Cb)({type:["OrientedImageryLayer"]})],u.prototype,"operationalLayerType",void 0),(0,a._)([(0,n.Cb)({json:d("orientationAccuracy",((e,t)=>{e&&(t.orientationAccuracy=e.join(","))}))}),(0,s.p)((e=>e?e.trim().split(",").map(Number):null))],u.prototype,"orientationAccuracy",void 0),(0,a._)([(0,n.Cb)({json:{...d("orientedImageryType",h.oh.write,h.oh.read),type:h.oh.apiValues}})],u.prototype,"orientedImageryType",void 0),(0,a._)([(0,n.Cb)({json:{read:!1},value:"oriented-imagery",readOnly:!0})],u.prototype,"type",void 0),(0,a._)([(0,n.Cb)({json:{...d("timeIntervalUnit",h.gs.write,h.gs.read),type:h.gs.apiValues}})],u.prototype,"timeIntervalUnit",void 0),(0,a._)([(0,n.Cb)({type:Number,json:d("verticalFieldOfView")})],u.prototype,"verticalFieldOfView",void 0),(0,a._)([(0,n.Cb)({json:{...d("verticalMeasurementUnit"),type:new o.X({Feet:"feet",Meter:"meter"}).apiValues}})],u.prototype,"verticalMeasurementUnit",void 0),(0,a._)([(0,n.Cb)({type:String,json:d("videoPathPrefix")})],u.prototype,"videoPathPrefix",void 0),(0,a._)([(0,n.Cb)({type:String,json:d("videoPathSuffix")})],u.prototype,"videoPathSuffix",void 0),u=(0,a._)([(0,l.j)("esri.layers.OrientedImageryLayer")],u);const p=u},17775:(e,t,i)=>{i.d(t,{Z:()=>d});var a=i(27366),r=(i(59486),i(49861)),o=(i(93169),i(32718),i(84936),i(38511)),n=i(69912),s=i(22824),l=i(53184),c=i(34810),h=i(78952);const d=e=>{let t=class extends e{constructor(){super(...arguments),this.copyright=null,this.minScale=0,this.maxScale=0,this.spatialReference=null,this.tileInfo=null,this.tilemapCache=null}destroy(){var e,t;null===(e=this.tilemapCache)||void 0===e||null===(t=e.destroy)||void 0===t||t.call(e)}readMinScale(e,t){return null!=t.minLOD&&null!=t.maxLOD?e:0}readMaxScale(e,t){return null!=t.minLOD&&null!=t.maxLOD?e:0}get supportsBlankTile(){return this.version>=10.2}readTilemapCache(e,t,i){var a;const r=null===(a=t.capabilities)||void 0===a?void 0:a.includes("Tilemap");let{minLOD:o,maxLOD:n,minScale:h,maxScale:d}=t;if(null==o&&null==n&&0!==h&&0!==d){const e=e=>Math.round(1e4*e)/1e4;h=e(h||t.tileInfo.lods[0].scale),d=e(d||t.tileInfo.lods[t.tileInfo.lods.length-1].scale);for(const i of t.tileInfo.lods){const t=e(i.scale);o=t>=h?i.level:o,n=t>=d?i.level:n}}if(r)return new c.y({layer:this,minLOD:o,maxLOD:n});if(t.tileInfo){const e=new s.Z;return e.read(t.tileInfo,i),new l.Z(e,o,n)}return null}};return(0,a._)([(0,r.Cb)({json:{read:{source:"copyrightText"}}})],t.prototype,"copyright",void 0),(0,a._)([(0,r.Cb)()],t.prototype,"minScale",void 0),(0,a._)([(0,o.r)("service","minScale")],t.prototype,"readMinScale",null),(0,a._)([(0,r.Cb)()],t.prototype,"maxScale",void 0),(0,a._)([(0,o.r)("service","maxScale")],t.prototype,"readMaxScale",null),(0,a._)([(0,r.Cb)({type:h.Z})],t.prototype,"spatialReference",void 0),(0,a._)([(0,r.Cb)({readOnly:!0})],t.prototype,"supportsBlankTile",null),(0,a._)([(0,r.Cb)({type:s.Z})],t.prototype,"tileInfo",void 0),(0,a._)([(0,r.Cb)()],t.prototype,"tilemapCache",void 0),(0,a._)([(0,o.r)("service","tilemapCache",["capabilities","tileInfo"])],t.prototype,"readTilemapCache",null),(0,a._)([(0,r.Cb)()],t.prototype,"version",void 0),t=(0,a._)([(0,n.j)("esri.layers.mixins.ArcGISCachedService")],t),t}},76767:(e,t,i)=>{i.d(t,{Z:()=>m});var a=i(27366),r=i(7138),o=i(49861),n=(i(93169),i(32718),i(84936),i(69912));const s=[2155,2194,2204,2222,2223,2224,2225,2226,2227,2228,2229,2230,2231,2232,2233,2234,2235,2236,2237,2238,2239,2240,2241,2242,2243,2244,2245,2246,2247,2248,2249,2250,2251,2252,2253,2254,2255,2256,2257,2258,2259,2260,2261,2262,2263,2264,2265,2266,2267,2268,2269,2270,2271,2272,2273,2274,2275,2276,2277,2278,2279,2280,2281,2282,2283,2284,2285,2286,2287,2288,2289,2314,2867,2868,2869,2870,2871,2872,2873,2874,2875,2876,2877,2878,2879,2880,2881,2882,2883,2884,2885,2886,2887,2888,2889,2890,2891,2892,2893,2894,2895,2896,2897,2898,2899,2900,2901,2902,2903,2904,2905,2906,2907,2908,2909,2910,2911,2912,2913,2914,2915,2916,2917,2918,2919,2920,2921,2922,2923,2924,2925,2926,2927,2928,2929,2930,2964,2965,2966,2967,2968,2992,2994,3080,3089,3091,3102,3359,3359,3361,3363,3365,3366,3404,3407,3417,3418,3419,3420,3421,3422,3423,3424,3425,3426,3427,3428,3429,3430,3431,3432,3433,3434,3435,3436,3437,3438,3441,3442,3443,3444,3445,3446,3451,3452,3453,3454,3455,3456,3457,3458,3459,3479,3481,3483,3485,3487,3490,3492,3494,3496,3498,3500,3502,3504,3506,3508,3510,3512,3515,3517,3519,3521,3523,3525,3527,3529,3531,3533,3535,3537,3539,3541,3543,3545,3547,3549,3551,3553,3560,3561,3562,3563,3564,3565,3566,3567,3568,3569,3570,3582,3584,3586,3588,3590,3593,3598,3600,3605,3608,3610,3612,3614,3616,3618,3620,3622,3624,3626,3628,3630,3632,3634,3636,3640,3642,3644,3646,3648,3650,3652,3654,3656,3658,3660,3662,3664,3668,3670,3672,3674,3676,3677,3679,3680,3682,3683,3686,3688,3690,3692,3696,3698,3700,3728,3729,3730,3731,3732,3733,3734,3735,3736,3737,3738,3739,3753,3754,3755,3756,3757,3758,3759,3760,3991,3992,4217,4399,4400,4401,4402,4403,4404,4405,4406,4407,4408,4409,4410,4411,4412,4413,4418,4419,4420,4421,4422,4423,4424,4425,4426,4427,4428,4429,4430,4431,4432,4433,4438,4439,4455,4456,4457,5466,5588,5589,5623,5624,5625,5646,5654,5655,6128,6129,6141,6200,6201,6202,6391,6405,6407,6409,6411,6413,6416,6418,6420,6422,6424,6426,6428,6430,6432,6434,6436,6438,6441,6443,6445,6447,6449,6451,6453,6455,6457,6459,6461,6463,6465,6467,6469,6471,6473,6475,6477,6479,6484,6486,6488,6490,6492,6494,6496,6499,6501,6503,6505,6507,6510,6515,6517,6519,6521,6523,6525,6527,6529,6531,6533,6535,6537,6539,6541,6543,6545,6547,6549,6551,6553,6555,6557,6559,6561,6563,6565,6568,6570,6572,6574,6576,6578,6582,6584,6586,6588,6590,6593,6595,6597,6599,6601,6603,6605,6607,6609,6612,6614,6616,6618,6625,6626,6627,6633,6785,6787,6789,6791,6793,6795,6797,6799,6801,6803,6805,6807,6809,6811,6813,6815,6817,6819,6821,6823,6825,6827,6829,6831,6833,6835,6837,6839,6841,6843,6845,6847,6849,6851,6853,6855,6857,6859,6861,6863,6868,6880,6885,6887,6923,6925,6966,6997,7057,7058,7059,7060,7061,7062,7063,7064,7065,7066,7067,7068,7069,7070,7119,7120,7121,7122,7123,7124,7125,7126,7127,7128,7132,7258,7260,7262,7264,7266,7268,7270,7272,7274,7276,7278,7280,7282,7284,7286,7288,7290,7292,7294,7296,7298,7300,7302,7304,7306,7308,7310,7312,7314,7316,7318,7320,7322,7324,7326,7328,7330,7332,7334,7336,7338,7340,7342,7344,7346,7348,7350,7352,7354,7356,7358,7360,7362,7364,7366,7368,7370,7558,7587,7588,7589,7590,7591,7592,7593,7594,7595,7596,7597,7598,7599,7600,7601,7602,7603,7604,7605,7606,7607,7608,7609,7610,7611,7612,7613,7614,7615,7616,7617,7618,7619,7620,7621,7622,7623,7624,7625,7626,7627,7628,7629,7630,7631,7632,7633,7634,7635,7636,7637,7638,7639,7640,7641,7642,7643,7644,7645,24100,26729,26730,26731,26732,26733,26734,26735,26736,26737,26738,26739,26740,26741,26742,26743,26744,26745,26746,26747,26748,26749,26750,26751,26752,26753,26754,26755,26756,26757,26758,26759,26760,26766,26767,26768,26769,26770,26771,26772,26773,26774,26775,26776,26777,26778,26779,26780,26781,26782,26783,26784,26785,26786,26787,26791,26792,26793,26794,26795,26796,26797,26798,26799,26801,26802,26803,26811,26812,26813,26814,26815,26819,26820,26821,26822,26825,26826,26830,26831,26832,26833,26836,26837,26841,26842,26843,26844,26847,26848,26849,26850,26851,26852,26853,26854,26855,26856,26857,26858,26859,26860,26861,26862,26863,26864,26865,26866,26867,26868,26869,26870,32001,32002,32003,32005,32006,32007,32008,32009,32010,32011,32012,32013,32014,32015,32016,32017,32018,32019,32020,32021,32022,32023,32024,32025,32026,32027,32028,32029,32030,32031,32033,32034,32035,32036,32037,32038,32039,32040,32041,32042,32043,32044,32045,32046,32047,32048,32049,32050,32051,32052,32053,32054,32055,32056,32057,32058,32064,32065,32066,32067,32074,32075,32076,32077,32099,32164,32165,32166,32167,32664,32665,32666,32667,65061,102120,102121,102629,102630,102631,102632,102633,102634,102635,102636,102637,102638,102639,102640,102641,102642,102643,102644,102645,102646,102648,102649,102650,102651,102652,102653,102654,102655,102656,102657,102658,102659,102660,102661,102662,102663,102664,102665,102666,102667,102668,102669,102670,102671,102672,102673,102674,102675,102676,102677,102678,102679,102680,102681,102682,102683,102684,102685,102686,102687,102688,102689,102690,102691,102692,102693,102694,102695,102696,102697,102698,102700,102704,102707,102708,102709,102710,102711,102712,102713,102714,102715,102716,102717,102718,102719,102720,102721,102722,102723,102724,102725,102726,102727,102728,102729,102730,102733,102734,102735,102736,102737,102738,102739,102740,102741,102742,102743,102744,102745,102746,102747,102748,102749,102750,102751,102752,102753,102754,102755,102756,102757,102758,102761,102766],l=[5614,5702,6130,6131,6132,6358,6359,6360],c=[115700,4326];function h(e){return s.includes(e)?"feet":"meters"}function d(e,t){return"number"==typeof e?l.includes(e)?"feet":"meters":h(t)}function u(e,t){return e&&c.includes(e)||4326===t?"ellipsoidal":"gravity-related-height"}let p=class extends r.default{constructor(){super(...arguments),this.verticalWKID=null}get isAdvanced(){const{affineTransformations:e,focalLength:t,principalOffsetPoint:i,radialDistortionCoefficients:a,tangentialDistortionCoefficients:r}=this;return(null===e||void 0===e?void 0:e.length)>1&&!Number.isNaN(t)&&(null===i||void 0===i?void 0:i.length)>1&&(null===a||void 0===a?void 0:a.length)>1&&(null===r||void 0===r?void 0:r.length)>1}get unitAndHeightInfo(){const{horizontalWKID:e,verticalWKID:t}=this;let i=e,a=t;const r=this;if(4===r.type){const{properties:e}=r;i=4326,a=e.verticalWKID}return{heightModel:u(a,i),heightUnit:d(a,i),horizontalUnit:h(i)}}};(0,a._)([(0,o.Cb)({json:{write:!0}})],p.prototype,"affineTransformations",void 0),(0,a._)([(0,o.Cb)({json:{write:!0}})],p.prototype,"focalLength",void 0),(0,a._)([(0,o.Cb)({json:{write:!0}})],p.prototype,"principalOffsetPoint",void 0),(0,a._)([(0,o.Cb)({json:{write:!0}})],p.prototype,"radialDistortionCoefficients",void 0),(0,a._)([(0,o.Cb)({json:{write:!0}})],p.prototype,"tangentialDistortionCoefficients",void 0),(0,a._)([(0,o.Cb)({json:{write:!0}})],p.prototype,"horizontalWKID",void 0),(0,a._)([(0,o.Cb)({json:{write:!0}})],p.prototype,"verticalWKID",void 0),(0,a._)([(0,o.Cb)({json:{write:!0}})],p.prototype,"x",void 0),(0,a._)([(0,o.Cb)({json:{write:!0}})],p.prototype,"y",void 0),(0,a._)([(0,o.Cb)({json:{write:!0}})],p.prototype,"z",void 0),(0,a._)([(0,o.Cb)({json:{write:!0}})],p.prototype,"type",void 0),(0,a._)([(0,o.Cb)({readOnly:!0})],p.prototype,"unitAndHeightInfo",null),p=(0,a._)([(0,n.j)("esri.layers.orientedImagery.core.CameraOrientation")],p);const m=p},87676:(e,t,i)=>{i.d(t,{nn:()=>h,t5:()=>c,tB:()=>d,xr:()=>u});var a=i(27366),r=i(10064),o=i(46784),n=i(49861),s=(i(93169),i(32718),i(84936),i(69912)),l=i(41226);let c=class extends o.wq{constructor(){super(...arguments),this.url=null}};(0,a._)([(0,n.Cb)({type:Number,json:{write:!0}})],c.prototype,"lod",void 0),(0,a._)([(0,n.Cb)({type:String,json:{write:!0}})],c.prototype,"rasterFunction",void 0),(0,a._)([(0,n.Cb)({type:String,json:{write:!0}})],c.prototype,"url",void 0),c=(0,a._)([(0,s.j)("esri.layers.orientedImagery.core.ElevationSourceDefinitions.ElevationSource")],c);let h=class extends o.wq{constructor(){super(...arguments),this.constantElevation=null}};(0,a._)([(0,n.Cb)({type:Number,json:{write:!0}})],h.prototype,"constantElevation",void 0),h=(0,a._)([(0,s.j)("esri.layers.orientedImagery.core.ElevationSourceDefinitions.ConstantElevation")],h);const d=e=>null!=e&&"constantElevation"in e&&"number"==typeof e.constantElevation;async function u(e){var t;const i=await(0,l.T)(e),{tileInfo:a,cacheType:o}=i;return i.hasOwnProperty("bandCount")&&i.hasOwnProperty("pixelSizeX")?"LERC"!==(null===a||void 0===a||null===(t=a.format)||void 0===t?void 0:t.toUpperCase())||o&&"elevation"!==o.toLowerCase()?{isSupported:!0,isDynamic:!0}:{isSupported:!0}:{isSupported:!1,error:new r.Z("elevation-source:invalid-service-url","ElevationSource URL expects an elevation 3D image service but given ".concat(e))}}},29754:(e,t,i)=>{i.d(t,{Z:()=>_});var a=i(27366),r=(i(59486),i(11582)),o=i(10064),n=i(46784),s=i(32718),l=i(49861),c=i(89125),h=i(27135),d=i(38511),u=i(69912),p=i(31201),m=i(76767),g=(i(93169),i(84936),i(63967));let v=class{static getCameraOrientation(e){return(0,g.RS)(e)}static register(e,t,i){g.sU.set(e,{desc:t,constructor:i})}};v=(0,a._)([(0,u.j)("esri.layers.orientedImagery.core.cameraOrientationFactory")],v);const y=v;var f=i(48425),b=i(848);let w=class extends((0,r.J)(n.wq)){constructor(e){super(e),this.cameraOrientation=null,this.elevation=null,this.elevationSource=null,this.name=null,this.sourceMap=null}read(e,t){const i={},{attributes:a,layer:r,geometry:o}=e,n={};for(const s in a)i[s.toLowerCase()]=a[s],n[s.toLowerCase()]=s;super.read({geometry:o,layer:null!==r&&void 0!==r?r:{},sourceMap:n,...i},t)}write(e,t){const i=super.write(e,t),{sourceMap:a}=this;if(!a||!i)return i;const r={};for(const o in i){const e=a[o.toLowerCase()];e&&(r[e]=i[o])}return r}readCameraHeading(e,t){var i;const{cameraheading:a,camheading:r,layer:o}=t;return null!==(i=null!==a&&void 0!==a?a:r)&&void 0!==i?i:o.cameraHeading}readCameraHeight(e,t){var i;const{cameraheight:a,avghtag:r,layer:o}=t;return null!==(i=null!==a&&void 0!==a?a:r)&&void 0!==i?i:o.cameraHeight}readCamOffset(e,t){var i,a;const{cameraoffset:r,camoffset:o}=t;return null!==(i=null!==(a=null===r||void 0===r?void 0:r.split(";").map(Number))&&void 0!==a?a:null===o||void 0===o?void 0:o.split(";").map(Number))&&void 0!==i?i:null}writeCameraOffset(e,t){e&&(t.cameraOffset=e.join(";"))}readCameraOrientation(e,t){const{cameraorientation:i,camori:a}=t;return null!==i&&void 0!==i?i:a}readCameraPitch(e,t){var i;const{camerapitch:a,campitch:r,layer:o}=t;return null!==(i=null!==a&&void 0!==a?a:r)&&void 0!==i?i:o.cameraPitch}readCameraRoll(e,t){var i;const{cameraroll:a,camroll:r,layer:o}=t;return null!==(i=null!==a&&void 0!==a?a:r)&&void 0!==i?i:o.cameraRoll}readDepthImage(e,t){var i;const{depthimage:a,depthimg:r,layer:o}=t,n=null!==(i=null!==a&&void 0!==a?a:r)&&void 0!==i?i:null,{depthImagePathPrefix:s,depthImagePathSuffix:l}=null!==o&&void 0!==o?o:{};return(0,g.MI)(n,s,l)}readElevationSource(e,t){const{elevationsource:i,layer:a}=t,{demPathSuffix:r,demPathPrefix:o}=a;if(i){const e=this._parseIfJSON(i);return(0,g.d6)(e,o,r)}return a.effectiveElevationSource}readFarDistance(e,t){var i;const{fardistance:a,fardist:r,layer:o}=t;return null!==(i=null!==a&&void 0!==a?a:r)&&void 0!==i?i:o.farDistance}readHFOV(e,t){var i;const{horizontalfieldofview:a,hfov:r,layer:o}=t;return null!==(i=null!==a&&void 0!==a?a:r)&&void 0!==i?i:o.horizontalFieldOfView}readImageURL(e,t){const{imagepath:i,layer:a}=t;i||function(e,t){throw new o.Z("exposure-point:missing-attribute-value","a value for ".concat(e," is missing in attribute table"),{exposurePoint:t})}("imagePath",this);const{imagePathPrefix:r,imagePathSuffix:n}=a;return(0,g.MI)(i,r,n)}readImageRotation(e,t){var i;const{imagerotation:a,imgrot:r,layer:o}=t;return null!==(i=null!==a&&void 0!==a?a:r)&&void 0!==i?i:o.imageRotation}get isHorizontal(){return"horizontal"===this.orientedImageryType}get isInspection(){return"inspection"===this.orientedImageryType}get isNadir(){return"nadir"===this.orientedImageryType}get isOblique(){return"oblique"===this.orientedImageryType}get isSpherical(){return"360"===this.orientedImageryType}get location(){const{cameraOrientation:e,cameraHeight:t,elevation:i}=this;if(e){const{type:t,x:i,y:a,z:r,horizontalWKID:o}=e;return new b.Z({x:i,y:a,z:r,spatialReference:{wkid:t===f.d.LTP?4326:o}})}if("number"!=typeof t)throw function(e){throw new o.Z("exposure-point:missing-default-value","a value for ".concat(e," is missing in default properties"))}("cameraHeight");const a=this.geometry.clone();return a.z=a.hasZ?a.z:(null!==i&&void 0!==i?i:0)+t,a}readNearDistance(e,t){var i;const{neardistance:a,neardist:r,layer:o}=t;return null!==(i=null!==a&&void 0!==a?a:r)&&void 0!==i?i:o.nearDistance}readOrientationAccuracy(e,t){var i,a;const{accuracy:r,orientationaccuracy:o}=t;return null!==(i=null!==(a=null===o||void 0===o?void 0:o.split(";").map(Number))&&void 0!==a?a:null===r||void 0===r?void 0:r.split(";").map(Number))&&void 0!==i?i:null}writeOrientationAccuracy(e,t){e&&(t.orientationAccuracy=e.join(";"))}readOIType(e,t){var i,a;const{orientedimagerytype:r,oitype:o,camerapitch:n,campitch:s,layer:l}=t,c=g.oh.read(null!==(i=null!==r&&void 0!==r?r:o)&&void 0!==i?i:l.orientedImageryType),h=null!==(a=null!==n&&void 0!==n?n:s)&&void 0!==a?a:l.cameraPitch;return"oblique"===c?h<10?"nadir":"oblique":c}readVFOV(e,t){var i;const{verticalfieldofview:a,vfov:r,layer:o}=t;return null!==(i=null!==a&&void 0!==a?a:r)&&void 0!==i?i:o.verticalFieldOfView}_parseIfJSON(e){let t=null;try{t=JSON.parse(e)}catch(i){s.Z.getLogger(this).error("couldn't parse the given elevation source JSON",e,i)}return t}};(0,a._)([(0,l.Cb)({type:Date,json:{write:{enabled:!0,target:"aquisitionDate"},name:"acquisitiondate"}})],w.prototype,"acquisitionDate",void 0),(0,a._)([(0,l.Cb)({type:Number,json:{write:!0,read:{source:["cameraheading","camheading","layer.cameraHeading"]}}})],w.prototype,"cameraHeading",void 0),(0,a._)([(0,d.r)("cameraHeading")],w.prototype,"readCameraHeading",null),(0,a._)([(0,l.Cb)({type:Number,json:{write:!0}})],w.prototype,"cameraHeight",void 0),(0,a._)([(0,d.r)("cameraHeight",["cameraheight","avghtag","layer.cameraHeight"])],w.prototype,"readCameraHeight",null),(0,a._)([(0,l.Cb)()],w.prototype,"cameraOffset",void 0),(0,a._)([(0,d.r)("cameraOffset",["cameraoffset","camoffset"])],w.prototype,"readCamOffset",null),(0,a._)([(0,p.c)("cameraOffset")],w.prototype,"writeCameraOffset",null),(0,a._)([(0,l.Cb)({json:{write:{writer:(e,t,i)=>{t[i]=e.toString()}}},type:m.Z}),(0,c.p)((e=>e?y.getCameraOrientation(e):null))],w.prototype,"cameraOrientation",void 0),(0,a._)([(0,d.r)("cameraOrientation",["cameraorientation","camori"])],w.prototype,"readCameraOrientation",null),(0,a._)([(0,l.Cb)({type:Number,json:{write:!0}})],w.prototype,"cameraPitch",void 0),(0,a._)([(0,d.r)("cameraPitch",["camerapitch","campitch","layer.cameraPitch"])],w.prototype,"readCameraPitch",null),(0,a._)([(0,l.Cb)({type:Number,json:{write:!0}})],w.prototype,"cameraRoll",void 0),(0,a._)([(0,d.r)("cameraRoll",["cameraroll","camroll","layer.cameraRoll"])],w.prototype,"readCameraRoll",null),(0,a._)([(0,l.Cb)({json:{write:!0},type:String})],w.prototype,"depthImage",void 0),(0,a._)([(0,d.r)("depthImage",["depthimage","depthimg"])],w.prototype,"readDepthImage",null),(0,a._)([(0,l.Cb)({type:Number,json:{write:!0}})],w.prototype,"elevation",void 0),(0,a._)([(0,l.Cb)({json:{write:!0},clonable:"reference"})],w.prototype,"elevationSource",void 0),(0,a._)([(0,d.r)("elevationSource",["elevationsource","layer.effectiveElevationSource"])],w.prototype,"readElevationSource",null),(0,a._)([(0,l.Cb)({json:{name:"exposurestationid",write:{target:"exposureStationId"}},type:String})],w.prototype,"exposureStationId",void 0),(0,a._)([(0,l.Cb)({type:Number,json:{write:!0}})],w.prototype,"farDistance",void 0),(0,a._)([(0,d.r)("farDistance",["fardistance","fardist","layer.farDistance"])],w.prototype,"readFarDistance",null),(0,a._)([(0,l.Cb)({type:b.Z,json:{name:"geometry"}})],w.prototype,"geometry",void 0),(0,a._)([(0,l.Cb)({type:Number,json:{write:!0}})],w.prototype,"horizontalFieldOfView",void 0),(0,a._)([(0,d.r)("horizontalFieldOfView",["horizontalfieldofview","hfov","layer.horizontalFieldOfView"])],w.prototype,"readHFOV",null),(0,a._)([(0,l.Cb)({json:{write:!0},type:String})],w.prototype,"imagePath",void 0),(0,a._)([(0,d.r)("imagePath",["imagepath"])],w.prototype,"readImageURL",null),(0,a._)([(0,l.Cb)({type:Number,json:{write:!0}})],w.prototype,"imageRotation",void 0),(0,a._)([(0,d.r)("imageRotation",["imagerotation","imgrot","layer.imageRotation"])],w.prototype,"readImageRotation",null),(0,a._)([(0,l.Cb)()],w.prototype,"isHorizontal",null),(0,a._)([(0,l.Cb)()],w.prototype,"isInspection",null),(0,a._)([(0,l.Cb)()],w.prototype,"isNadir",null),(0,a._)([(0,l.Cb)()],w.prototype,"isOblique",null),(0,a._)([(0,l.Cb)()],w.prototype,"isSpherical",null),(0,a._)([(0,l.Cb)()],w.prototype,"location",null),(0,a._)([(0,l.Cb)({json:{write:!0},type:String})],w.prototype,"name",void 0),(0,a._)([(0,l.Cb)({type:Number,json:{write:!0}})],w.prototype,"nearDistance",void 0),(0,a._)([(0,d.r)("nearDistance",["neardistance","neardist","layer.nearDistance"])],w.prototype,"readNearDistance",null),(0,a._)([(0,l.Cb)({json:{write:!0,name:"objectid"},type:Number})],w.prototype,"objectId",void 0),(0,a._)([(0,l.Cb)()],w.prototype,"orientationAccuracy",void 0),(0,a._)([(0,d.r)("orientationAccuracy",["accuracy","orientationaccuracy"])],w.prototype,"readOrientationAccuracy",null),(0,a._)([(0,p.c)("orientationAccuracy")],w.prototype,"writeOrientationAccuracy",null),(0,a._)([(0,h.J)(g.oh)],w.prototype,"orientedImageryType",void 0),(0,a._)([(0,d.r)("orientedImageryType",["orientedimagerytype","oitype","layer.orientedImageryType"])],w.prototype,"readOIType",null),(0,a._)([(0,l.Cb)({type:Number,json:{name:"sortorder",write:{target:"sortOrder"}}})],w.prototype,"sortOrder",void 0),(0,a._)([(0,l.Cb)({type:Object})],w.prototype,"sourceMap",void 0),(0,a._)([(0,l.Cb)({type:Number,json:{write:!0}})],w.prototype,"verticalFieldOfView",void 0),(0,a._)([(0,d.r)("verticalFieldOfView",["verticalfieldofview","vfov","layer.verticalFieldOfView"])],w.prototype,"readVFOV",null),w=(0,a._)([(0,u.j)("esri.layers.orientedImagery.core.ExposurePoint")],w);const _=w},64248:(e,t,i)=>{i.d(t,{DC:()=>O,Ff:()=>F,QX:()=>w,RS:()=>M,Zk:()=>P,eC:()=>I,wM:()=>C});i(59486);var a=i(66978),r=i(12400),o=i(32035),n=i(42137),s=i(63899),l=i(79803),c=i(22186),h=i(85981),d=i(64995),u=i(27474),p=i(55652),m=i(92975),g=i(46426),v=i(80885),y=i(78952),f=i(77577);const b=Math.PI/180;function w(e){return e.isSpherical?function(e){const{geometry:t,farDistance:i,objectId:a,nearDistance:r,cameraHeight:o}=e,l=(0,g.lj)(t),c=new n.Z({center:t.clone(),radius:i*l});if(c.imageID=a,r){const e=new n.Z({center:t.clone(),radius:r*l});c.addRing(e.rings[0])}const h=t.clone();h.z=o-i*l;const d=s.Z.createSphere(h,{size:2*i*l});return d.imageID=a,{polygon:c,frustum:d}}(e):function(e){const{horizontalFieldOfView:t,verticalFieldOfView:i,geometry:a,cameraHeading:r}=e,o=(0,g.lj)(a);let n=e.cameraPitch,s=e.cameraRoll,l=150;t>150&&(n=90,s=0,l=5);const c=Math.ceil(t/l),h=function(e,t,i){const a=[];if(e%2==0)for(let r=0;r<e/2;r++)a.push(t-i/e*(r+.5),t+i/e*(r+.5));else{a.push(t);for(let r=1;r<e/2;r++)a.push(t-i/e*r,t+i/e*r)}return a.sort(),a}(c,r,t);let d=e.farDistance?e.farDistance*o:e.cameraHeight*o/Math.cos(n*b);e.cameraPitch+i/2>=90&&(d=(e.farDistance||20)*o);const u=new v.Z({spatialReference:null===a||void 0===a?void 0:a.spatialReference});u.imageID=e.objectId;let p=null;for(const m of h)p=_(m,n,s,e,a,d,o,i,t,c,u);return p.imageID=e.objectId,{polygon:u,frustum:p}}(e)}function _(e,t,i,a,n,l,c,h,d,p,m){const v=(0,g.oE)("HPR",[e,t,i]),y=function(e,t,i){const{cameraHeight:a,cameraPitch:n,farDistance:l,geometry:c,horizontalFieldOfView:h,nearDistance:d,verticalFieldOfView:p}=e,m=S(c),v=d<0?0:d*m;let y=a*m/Math.cos(n*b),f=!0;n+p/2>=90&&(y=(null!==l&&void 0!==l?l:20)*m,f=!1);const w=2*Math.tan(p*b/2)*v,_=2*Math.tan(h*b/2)*v,C=2*Math.tan(p*b/2)*y,M=2*Math.tan(h*b/2)*y;let x,I;I=[0,0,-1],I=(0,g.kK)(I,t),x=(0,g.s3)([c.x,c.y,a],I,y,m),f&&(x[2]=0);const P=(0,g.s3)([c.x,c.y,a],I,v,m);let F=[0,1,0];F=(0,g.kK)(F,t);let R=[1,0,0];R=(0,g.kK)(R,t);let z=[],O=[];v?(O=[{faces:[4,0,3,4,7,3]},{faces:[5,1,2,5,6,2]},{faces:[4,0,1,4,5,1]},{faces:[6,2,3,6,7,3]}],z=z.concat((0,o.g)((0,r.ll)(),P,(0,o.z)((0,r.ll)(),(0,g.SW)(F,w/2,m),(0,g.SW)(R,_/2,m)))),z=z.concat((0,o.g)((0,r.ll)(),P,(0,o.g)((0,r.ll)(),(0,g.SW)(F,w/2,m),(0,g.SW)(R,_/2,m)))),z=z.concat((0,o.z)((0,r.ll)(),P,(0,o.z)((0,r.ll)(),(0,g.SW)(F,w/2,m),(0,g.SW)(R,_/2,m)))),z=z.concat((0,o.z)((0,r.ll)(),P,(0,o.g)((0,r.ll)(),(0,g.SW)(F,w/2,m),(0,g.SW)(R,_/2,m))))):(z=[c.x,c.y,a],O=[{faces:[0,1,2,0,2,3,0,3,4,0,4,1]}]),z=z.concat((0,o.g)((0,r.ll)(),x,(0,o.z)((0,r.ll)(),(0,g.SW)(F,C/2,m),(0,g.SW)(R,M/2,m)))),z=z.concat((0,o.g)((0,r.ll)(),x,(0,o.g)((0,r.ll)(),(0,g.SW)(F,C/2,m),(0,g.SW)(R,M/2,m)))),z=z.concat((0,o.z)((0,r.ll)(),x,(0,o.z)((0,r.ll)(),(0,g.SW)(F,C/2,m),(0,g.SW)(R,M/2,m)))),z=z.concat((0,o.z)((0,r.ll)(),x,(0,o.g)((0,r.ll)(),(0,g.SW)(F,C/2,m),(0,g.SW)(R,M/2,m))));const A=new u.Q({position:Float64Array.from(z)});return new s.Z({vertexAttributes:A,components:O,spatialReference:c.spatialReference})}(a,v),f=(0,g.kK)([0,0,-1],v),{x:w,y:_}=n,M=(0,g.s3)([w,_,a.cameraHeight],f,l,c),x=2*Math.tan(h*b/2)*l,I=2*Math.tan(d/p*b/2)*l,P=(0,g.kK)([0,1,0],v),F=(0,g.kK)([1,0,0],v),R=(0,g.SW)(P,x/2,c),z=(0,g.SW)(F,I/2,c),O=(0,o.z)((0,r.ll)(),R,z),A=(0,o.g)((0,r.ll)(),R,z),V=C([(0,o.g)((0,r.ll)(),M,O),(0,o.g)((0,r.ll)(),M,A),(0,o.z)((0,r.ll)(),M,O),(0,o.z)((0,r.ll)(),M,A)],a.cameraHeight,n,c);return V.push(V[0]),m.addRing(V),y}function C(e,t,i,a){return e.map((e=>function(e,t,i,a){{const n=Math.sqrt((e[2]-t)**2+(Math.sqrt((e[0]-i.x)**2+(e[1]-i.y)**2)/a)**2)*a,s=(0,g.SW)((0,o.z)((0,r.ll)(),[e[0],e[1],e[2]],[i.x,i.y,t]),1/n,1/a),l=t/(t-e[2]),c={x:(1-l)*i.x+l*e[0],y:(1-l)*i.y+l*e[1],z:(1-l)*t+l*e[2]},h=Math.sqrt((c.z-t)**2+(Math.sqrt((c.x-i.x)**2+(c.y-i.y)**2)/a)**2)*a,d=(0,g.SW)((0,o.z)((0,r.ll)(),[c.x,c.y,c.z],[i.x,i.y,t]),1/h,1/a);return x(s[0],d[0])&&x(s[1],d[1])&&x(s[2],d[2])||e[2]>=0?[e[0],e[1],0]:[c.x,c.y,c.z]}}(e,t,i,a)))}function M(e,t){return e.contains(t)}function x(e,t){return Math.sign(e)!==Math.sign(t)}function I(e){const{spatialReference:t,x:i,y:a}=e.geometry,{cameraHeading:r,cameraPitch:o,farDistance:n,nearDistance:s}=e,l=S(e.geometry),c=new v.Z({spatialReference:t}),h=Math.abs(1.44*n*l);let d=Math.abs(1.44*s*l);(o<20||null==r)&&(d=h);const u=[];return u[0]={x:i+h*Math.sin((r-45)*b),y:a+h*Math.cos((r-45)*b)},u[1]={x:i+h*Math.sin((r+45)*b),y:a+h*Math.cos((r+45)*b)},u[2]={x:i+d*Math.sin((r+135)*b),y:a+d*Math.cos((r+135)*b)},u[3]={x:i+d*Math.sin((r+225)*b),y:a+d*Math.cos((r+225)*b)},c.addRing([[u[0].x,u[0].y,0],[u[1].x,u[1].y,0],[u[2].x,u[2].y,0],[u[3].x,u[3].y,0],[u[0].x,u[0].y,0]]),c}function S(e){return e&&(0,m.sS)(null===e||void 0===e?void 0:e.spatialReference)?1/Math.cos(Math.PI/2-2*Math.atan(Math.exp(-1*e.y/c.sv.radius))):1}function P(e,t){const i=1+t/100;if("esri.geometry.Circle"===e.declaredClass){const{radius:t,center:a}=e,r=new n.Z({radius:t*i,center:a});return e.rings.length>1&&r.addRing(e.rings[1]),r}if("esri.geometry.Polygon"===e.declaredClass){const t=new v.Z({spatialReference:e.spatialReference}),a=e.centroid;if(a){const n=[];for(let t=0;t<e.rings[0].length;t++){const s=Math.sqrt((a.x-e.rings[0][t][0])**2+(a.y-e.rings[0][t][1])**2),l=(0,g.SW)((0,o.z)((0,r.ll)(),[e.rings[0][t][0],e.rings[0][t][1],0],[a.x,a.y,0]),1/s,1),c=(0,g.s3)([a.x,a.y,0],l,s*i,1);n.push({x:c[0],y:c[1]})}t.addRing([[n[0].x,n[0].y,0],[n[1].x,n[1].y,0],[n[2].x,n[2].y,0],[n[3].x,n[3].y,0],[n[0].x,n[0].y,0]])}return t}return e}async function F(e,t,i){const{cameraHeight:a,cameraLocation:r,cameraPitch:o,frustumVertices:n,horizontalFieldOfView:l,imageHeight:c,imageWidth:h,inSRS:d,outSRS:p,verticalFieldOfView:m,cameraRoll:v,imageRotation:f,options:w}=i,_=new y.Z(d),C=new y.Z(p),M=(0,g.o4)(l,m,null!==v&&void 0!==v?v:0),x=n.length>15;return o+M.vfov/2>=90?await async function(e,t,i,a,r,o,n){let l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,c=arguments.length>8?arguments[8]:void 0;const h=Math.cos((null!==l&&void 0!==l?l:0)*b),d=Math.sin((null!==l&&void 0!==l?l:0)*b),p=Math.abs(i*h+a*d),m=Math.abs(i*-d+a*h);let v,y,f=n?new Array:[e[0],e[1],e[2]],w=new Array;const _=t.length;for(let s=0;s<_;s++){const r=[p/2,m/2],o=t[s];y=[(o[0]-r[0])*h-(o[1]-r[1])*d+r[0],(o[0]-r[0])*d+(o[1]-r[1])*h+r[1]],n?(v=(0,g.E7)({x:y[0],y:y[1],z:1},{x:0,y:0,z:1},{x:i,y:0,z:1},{x:i,y:a,z:1},{x:0,y:a,z:1},{x:e[0],y:e[1],z:e[2]},{x:e[3],y:e[4],z:e[5]},{x:e[6],y:e[7],z:e[8]},{x:e[9],y:e[10],z:e[11]}),f=f.concat([v.x,v.y,v.z]),v=(0,g.E7)({x:y[0],y:y[1],z:1},{x:0,y:0,z:1},{x:i,y:0,z:1},{x:i,y:a,z:1},{x:0,y:a,z:1},{x:e[12],y:e[13],z:e[14]},{x:e[15],y:e[16],z:e[17]},{x:e[18],y:e[19],z:e[20]},{x:e[21],y:e[22],z:e[23]}),w=w.concat([v.x,v.y,v.z])):(v=(0,g.E7)({x:y[0],y:y[1],z:1},{x:0,y:0,z:1},{x:i,y:0,z:1},{x:i,y:a,z:1},{x:0,y:a,z:1},{x:e[3],y:e[4],z:e[5]},{x:e[6],y:e[7],z:e[8]},{x:e[9],y:e[10],z:e[11]},{x:e[12],y:e[13],z:e[14]}),f=f.concat([v.x,v.y,v.z]))}f=f.concat(w);const C=await O(f,r,o,c);return new s.Z({vertexAttributes:new u.Q({position:C}),components:T(Z(n)),spatialReference:o})}(n,e,h,c,_,C,x,f,w):await async function(e,t,i,a,r,o,n,l,c){var h;const d=function(e,t,i,a,r){const o=V(e),n=V(e,"near");if(!o)return;const{coefficients:s}=o,l=t.length;for(let d=0;d<l;d++){var c,h;const e=A([i[d][0],i[d][1]],s),t=i[d];t[2]=null!==(c=t[2]>=0?e:t[2])&&void 0!==c?c:0;const l=[t[0]-a[0],t[1]-a[1],t[2]-(null!==(h=a[2])&&void 0!==h?h:r)];z(a,l,d,n),R(a,l,d,o,i,e)}return{farPlane:o,nearPlane:n}}(e,t,i,a,r);if(!d)return;const{farPlane:p,nearPlane:m}=d,g=await O([...null!==(h=null===m||void 0===m?void 0:m.vertexPositions)&&void 0!==h?h:e.slice(0,3),...p.vertexPositions],n,l,c);return new s.Z({vertexAttributes:new u.Q({position:g}),components:T(Z(o)),spatialReference:l})}(n,e,t,r,a,x,_,C,w)}function R(e,t,i,a,o,n){const{coefficients:s,vertexPositions:l}=a;if(null!=n&&n>=0)l.splice(3*i,3,...o[i]);else{const a=(0,r.Ue)();(0,p.dZ)(s,(0,h.re)(e,t),a)&&l.splice(3*i,3,...a)}}function z(e,t,i,a){if(!a)return;const o=(0,r.Ue)();(0,p.dZ)(a.coefficients,(0,h.re)(e,t),o)&&a.vertexPositions.splice(3*i,3,...o)}async function O(e,t,i,r){if(t.equals(i))return e;const o=e.reduce(((e,t,i)=>{const a=Math.floor(i/3);return e[a]||(e[a]=new Array),e[a].push(t),e}),new Array),{points:n}=await(0,l.projectWithZConversion)(new f.Z(o,t),i,r);return(0,a.k_)(r),n.flat()}function A(e,t){if(t)return(-t[3]-t[0]*e[0]-t[1]*e[1])/t[2]}function V(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"far";const i=(0,p.Ue)();let a;switch(t){case"far":if(a=Array.from(15===e.length?e.slice(3):e.slice(12)),(0,p.nI)(i,a,!1))return{coefficients:i,vertexPositions:a};break;case"near":if(a=Array.from(e.slice(0,12)),15===e.length||!(0,p.nI)(i,a,!1))return;return{coefficients:i,vertexPositions:a}}}const Z=e=>e?[{faces:new Uint32Array([4,0,3,4,7,3])},{faces:new Uint32Array([5,1,2,5,6,2])},{faces:new Uint32Array([4,0,1,4,5,1])},{faces:new Uint32Array([6,2,3,6,7,3])}]:[{faces:new Uint32Array([0,1,2,0,2,3,0,3,4,0,4,1])}],T=e=>e.map((e=>new d.Z(e)))},63967:(e,t,i)=>{i.d(t,{MI:()=>b,sU:()=>M,RS:()=>I,d6:()=>w,oh:()=>C,gs:()=>_});var a=i(43404),r=i(27366),o=i(11582),n=i(46784),s=i(49861),l=(i(93169),i(32718),i(84936),i(69912)),c=i(76767);let h=class extends((0,o.J)((0,n.eC)(c.Z))){constructor(){super(...arguments),this.type=1}toString(){const{type:e,horizontalWKID:t,verticalWKID:i,x:a,y:r,z:o,heading:n,pitch:s,roll:l,affineTransformations:c,focalLength:h,principalOffsetPoint:d,radialDistortionCoefficients:u,tangentialDistortionCoefficients:p}=this,m=[e,t,i,a,r,o,n,s,l];return this.isAdvanced&&(null!==c&&void 0!==c&&c.forEach((e=>m.push(e))),m.push(h),null!==d&&void 0!==d&&d.forEach((e=>m.push(e))),null!==u&&void 0!==u&&u.forEach((e=>m.push(e))),null!==p&&void 0!==p&&p.forEach((e=>m.push(e)))),m.map((e=>Number.isNaN(e)?"":e)).join("|")}};(0,r._)([(0,s.Cb)({json:{write:!0}})],h.prototype,"type",void 0),(0,r._)([(0,s.Cb)({type:[Number],json:{write:!0}})],h.prototype,"affineTransformations",void 0),(0,r._)([(0,s.Cb)({type:Number,json:{write:!0}})],h.prototype,"focalLength",void 0),(0,r._)([(0,s.Cb)({type:[Number],json:{write:!0}})],h.prototype,"principalOffsetPoint",void 0),(0,r._)([(0,s.Cb)({type:[Number],json:{write:!0}})],h.prototype,"radialDistortionCoefficients",void 0),(0,r._)([(0,s.Cb)({type:[Number],json:{write:!0}})],h.prototype,"tangentialDistortionCoefficients",void 0),(0,r._)([(0,s.Cb)({type:Number,json:{write:!0}})],h.prototype,"heading",void 0),(0,r._)([(0,s.Cb)({type:Number,json:{write:!0}})],h.prototype,"pitch",void 0),(0,r._)([(0,s.Cb)({type:Number,json:{write:!0}})],h.prototype,"roll",void 0),(0,r._)([(0,s.Cb)({type:Number,json:{write:!0}})],h.prototype,"horizontalWKID",void 0),(0,r._)([(0,s.Cb)({type:Number,json:{write:!0}})],h.prototype,"verticalWKID",void 0),(0,r._)([(0,s.Cb)({type:Number,json:{write:!0}})],h.prototype,"x",void 0),(0,r._)([(0,s.Cb)({type:Number,json:{write:!0}})],h.prototype,"y",void 0),(0,r._)([(0,s.Cb)({type:Number,json:{write:!0}})],h.prototype,"z",void 0),h=(0,r._)([(0,l.j)("esri.layers.orientedImagery.core.CameraOrientationHPR")],h);const d=h;let u=class extends((0,o.J)((0,n.eC)(c.Z))){constructor(){super(...arguments),this.type=2,this.verticalWKID=null}toString(){const{type:e,horizontalWKID:t,verticalWKID:i,x:a,y:r,z:o,omega:n,phi:s,kappa:l,affineTransformations:c,focalLength:h,principalOffsetPoint:d,radialDistortionCoefficients:u,tangentialDistortionCoefficients:p}=this,m=[e,t,i,a,r,o,n,s,l];return this.isAdvanced&&(null!==c&&void 0!==c&&c.forEach((e=>m.push(e))),m.push(h),null!==d&&void 0!==d&&d.forEach((e=>m.push(e))),null!==u&&void 0!==u&&u.forEach((e=>m.push(e))),null!==p&&void 0!==p&&p.forEach((e=>m.push(e)))),m.map((e=>isNaN(e)?"":e)).join("|")}};(0,r._)([(0,s.Cb)({json:{write:!0}})],u.prototype,"type",void 0),(0,r._)([(0,s.Cb)({type:[Number],json:{write:!0}})],u.prototype,"affineTransformations",void 0),(0,r._)([(0,s.Cb)({type:Number,json:{write:!0}})],u.prototype,"focalLength",void 0),(0,r._)([(0,s.Cb)({type:[Number],json:{write:!0}})],u.prototype,"principalOffsetPoint",void 0),(0,r._)([(0,s.Cb)({type:[Number],json:{write:!0}})],u.prototype,"radialDistortionCoefficients",void 0),(0,r._)([(0,s.Cb)({type:[Number],json:{write:!0}})],u.prototype,"tangentialDistortionCoefficients",void 0),(0,r._)([(0,s.Cb)({type:Number,json:{write:!0}})],u.prototype,"omega",void 0),(0,r._)([(0,s.Cb)({type:Number,json:{write:!0}})],u.prototype,"phi",void 0),(0,r._)([(0,s.Cb)({type:Number,json:{write:!0}})],u.prototype,"kappa",void 0),(0,r._)([(0,s.Cb)({type:Number,json:{write:!0}})],u.prototype,"horizontalWKID",void 0),(0,r._)([(0,s.Cb)({type:Number,json:{write:!0}})],u.prototype,"verticalWKID",void 0),(0,r._)([(0,s.Cb)({type:Number,json:{write:!0}})],u.prototype,"x",void 0),(0,r._)([(0,s.Cb)({type:Number,json:{write:!0}})],u.prototype,"y",void 0),(0,r._)([(0,s.Cb)({type:Number,json:{write:!0}})],u.prototype,"z",void 0),u=(0,r._)([(0,l.j)("esri.layers.orientedImagery.core.CameraOrientationOPK")],u);const p=u;let m=class extends((0,o.J)((0,n.eC)(c.Z))){constructor(){super(...arguments),this.type=3}get isAdvanced(){const{affineTransformations:e,focalLength:t,principalOffsetPoint:i,radialDistortionCoefficients:a,tangentialDistortionCoefficients:r}=this;return(null===e||void 0===e?void 0:e.length)>1||!Number.isNaN(t)||(null===i||void 0===i?void 0:i.length)>1||(null===a||void 0===a?void 0:a.length)>1||(null===r||void 0===r?void 0:r.length)>1}toString(){const{type:e,horizontalWKID:t,verticalWKID:i,x:a,y:r,z:o,yaw:n,pitch:s,roll:l,affineTransformations:c,focalLength:h,principalOffsetPoint:d,radialDistortionCoefficients:u,tangentialDistortionCoefficients:p}=this,m=[e,t,i,a,r,o,n,s,l];return this.isAdvanced&&(null!==c&&void 0!==c&&c.forEach((e=>m.push(e))),m.push(h),null!==d&&void 0!==d&&d.forEach((e=>m.push(e))),null!==d&&void 0!==d&&d.forEach((e=>m.push(e))),null!==u&&void 0!==u&&u.forEach((e=>m.push(e))),null!==p&&void 0!==p&&p.forEach((e=>m.push(e)))),m.map((e=>Number.isNaN(e)?"":e)).join("|")}};(0,r._)([(0,s.Cb)({json:{write:!0}})],m.prototype,"type",void 0),(0,r._)([(0,s.Cb)({type:[Number],json:{write:!0}})],m.prototype,"affineTransformations",void 0),(0,r._)([(0,s.Cb)({type:Number,json:{write:!0}})],m.prototype,"focalLength",void 0),(0,r._)([(0,s.Cb)({type:[Number],json:{write:!0}})],m.prototype,"principalOffsetPoint",void 0),(0,r._)([(0,s.Cb)({type:[Number],json:{write:!0}})],m.prototype,"radialDistortionCoefficients",void 0),(0,r._)([(0,s.Cb)({type:[Number],json:{write:!0}})],m.prototype,"tangentialDistortionCoefficients",void 0),(0,r._)([(0,s.Cb)({type:Number,json:{write:!0}})],m.prototype,"yaw",void 0),(0,r._)([(0,s.Cb)({type:Number,json:{write:!0}})],m.prototype,"pitch",void 0),(0,r._)([(0,s.Cb)({type:Number,json:{write:!0}})],m.prototype,"roll",void 0),(0,r._)([(0,s.Cb)({type:Number,json:{write:!0}})],m.prototype,"horizontalWKID",void 0),(0,r._)([(0,s.Cb)({type:Number,json:{write:!0}})],m.prototype,"verticalWKID",void 0),(0,r._)([(0,s.Cb)({type:Number,json:{write:!0}})],m.prototype,"x",void 0),(0,r._)([(0,s.Cb)({type:Number,json:{write:!0}})],m.prototype,"y",void 0),(0,r._)([(0,s.Cb)({type:Number,json:{write:!0}})],m.prototype,"z",void 0),m=(0,r._)([(0,l.j)("esri.layers.orientedImagery.core.CameraOrientationYPR")],m);const g=m;var v=i(87676),y=i(48425),f=i(36496);function b(e,t,i){return t&&(e="".concat(t).concat(e)),i&&(e+="".concat(i)),e}function w(e,t,i){return e?(0,v.tB)(e)?new v.nn(e):function(e,t,i){let{url:a}=e;return a?(a=b(a,t,i),new v.t5({...e,url:a})):null}(e,t,i):e}const _=new a.X({Minutes:"minutes",Hours:"hours",Days:"days",Weeks:"weeks",Months:"months",Years:"years"}),C=new a.X({360:"360",Horizontal:"horizontal",Inspection:"inspection",Nadir:"nadir",Oblique:"oblique","":null}),M=new Map;M.set("".concat(y.d.OPK),{desc:"Using Omega Phi Kappa",constructor:p}),M.set("".concat(y.d.HPR),{desc:"Using Heading, Pitch and Roll",constructor:d}),M.set("".concat(y.d.YPR),{desc:"Using Yaw, Pitch and Roll",constructor:g});const x=new Map;function I(e){if(!e)return null;const t="".concat(e).split("|");if(0===t.length)return null;const i=M.get(t[0]);if(!i)return null;const a=x.get(t[0]);return a?new(0,i.constructor)(a(t)):null}x.set("".concat(y.d.HPR),(function(e){const[t,i,a,r,o,n,s,l,c,h,d,u,p,m,g,v,y,b,w,_,C,M]=e.slice(1),x=[c,h,d,u,p,m].map((e=>Number(e))),I=[v,y].map((e=>Number(e))),S=[b,w,_],P=[C,M];return{horizontalWKID:t,verticalWKID:i,x:a,y:r,z:o,heading:n,pitch:s,roll:l,affineTransformations:6===x.filter(f.h).length?x:null,focalLength:g,principalOffsetPoint:2!==I.filter(f.h).length?null:I,radialDistortionCoefficients:3!==S.filter(f.h).length?null:S,tangentialDistortionCoefficients:2!==P.filter(f.h).length?null:P}})),x.set("".concat(y.d.YPR),(function(e){const[t,i,a,r,o,n,s,l,c,h,d,u,p,m,g,v,y,b,w,_,C,M]=e.slice(1),x=[c,h,d,u,p,m].map((e=>Number(e))),I=[v,y].map((e=>Number(e))),S=[b,w,_],P=[C,M];return{horizontalWKID:t,verticalWKID:i,x:a,y:r,z:o,yaw:n,pitch:s,roll:l,affineTransformations:6===x.filter(f.h).length?x:null,focalLength:g,principalOffsetPoint:2!==I.filter(f.h).length?null:I,radialDistortionCoefficients:3!==S.filter(f.h).length?null:S,tangentialDistortionCoefficients:2!==P.filter(f.h).length?null:P}})),x.set("".concat(y.d.OPK),(function(e){const[t,i,a,r,o,n,s,l,c,h,d,u,p,m,g,v,y,b,w,_,C,M]=e.slice(1),x=[c,h,d,u,p,m].map((e=>Number(e))),I=[v,y].map((e=>Number(e))),S=[b,w,_].map((e=>Number(e))),P=[C,M].map((e=>Number(e)));return{horizontalWKID:t,verticalWKID:i,x:a,y:r,z:o,omega:n,phi:s,kappa:l,affineTransformations:6===x.filter(f.h).length?x:null,focalLength:g,principalOffsetPoint:2!==I.filter(f.h).length?null:I,radialDistortionCoefficients:3!==S.filter(f.h).length?[0,0,0]:S,tangentialDistortionCoefficients:2!==P.filter(f.h).length?[0,0]:P}})),x.set("".concat(y.d.LTP),(function(e){const[t,i,a,r,o,...n]=e.slice(1),s=x.get(o);return s?{latitude:t,longitude:i,ellipsoidRadius:a,squaredEccentricity:r,properties:s([o,"",...n])}:null}))},48425:(e,t,i)=>{var a;i.d(t,{d:()=>a}),function(e){e[e.HPR=1]="HPR",e[e.OPK=2]="OPK",e[e.YPR=3]="YPR",e[e.LTP=4]="LTP"}(a||(a={}))},43780:(e,t,i)=>{i.d(t,{sg:()=>x,y5:()=>M});var a=i(10064),r=i(32718),o=i(66978),n=i(29303),s=i(848),l=i(79803),c=i(65156),h=i(41258),d=i(81753),u=i(42785),p=i(39685),m=i(87676),g=i(46426),v=i(8904),y=i(76081),f=i(48932),b=i(22824),w=i(87960),_=i(49885);const C=Math.PI/180;async function M(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!e)return[];e=e.map((e=>"esri.geometry.Point"===e.declaredClass?e:s.Z.fromJSON(e)));const{feature:r}=t,{attributes:o}=r;if(isNaN(parseFloat(o.elevation))){const e=await x([r.geometry],t);r.attributes.elevation=e[0].z}return x(e,t,i).then((e=>function(e,t){var i;const{attributes:r}=t.feature;return r.isSpherical||360===r.horizontalFieldOfView?async function(e,t){var i,a;const r=Array.isArray(e)?e:[e],o=new Array,{location:n,cameraOrientation:c,cameraHeading:u}=t.feature.attributes,p=null!==(i=t.imageProperties.height)&&void 0!==i?i:1,m=null!==(a=t.imageProperties.width)&&void 0!==a?a:1;return await async function(e,t,i,a,r,o,n){const c=e.spatialReference.isWGS84&&4!==(null===n||void 0===n?void 0:n.type)?(0,d.$)(e):new s.Z(e),{latitude:u,longitude:p,ellipsoidRadius:m,squaredEccentricity:v}=null!==n&&void 0!==n?n:{};for(const d of t){var y,f;const e=d.spatialReference.isWGS84&&4===(null===n||void 0===n?void 0:n.type)?new s.Z((0,g.SA)(d,[u,p,m,v])):d.spatialReference.equals(c.spatialReference)?new s.Z(d):await(0,l.projectWithZConversion)(d,c.spatialReference),t=(0,h.TE)(c,e);e.x-=c.x,e.y-=c.y,e.z=(null!==(y=e.z)&&void 0!==y?y:0)-(null!==(f=c.z)&&void 0!==f?f:0);const b=(0,g.mV)(e,t);b.heading=(b.heading-i)%360;const{x:w,y:C}=(0,g.cZ)(b.heading,b.pitch,a,r);o.push(new s.Z(w,C,_.wz.spatialReference))}}(n,r,u,m,p,o,c),o}(e,t):null!==(i=r.cameraOrientation)&&void 0!==i&&i.isAdvanced?function(e,t){var i;const{feature:r}=t,{attributes:o}=r,n=o.cameraOrientation;if(!n)throw new a.Z("groundToImageUtils:missing-camera-orientation-parameters","CameraOrientation Parameters are required to perform advanced transformations");let c=new s.Z(o.location);c.spatialReference.isWGS84&&4!==(null===(i=o.cameraOrientation)||void 0===i?void 0:i.type)&&(c=(0,d.$)(c));const h=c.spatialReference.isWebMercator?1/Math.cos(Math.PI/2-2*Math.atan(Math.exp(-1*c.y/6378137))):1;let u;if("esri.layers.orientedImagery.core.CameraOrientationOPK"===n.declaredClass){const{omega:e,phi:t,kappa:i}=n;u=(0,g.oE)("OPK",[e,t,i])}else{const{cameraHeading:e,cameraPitch:t,cameraRoll:i}=o;u=(0,g.oE)("HPR",[e,t,i])}const{principalOffsetPoint:p,focalLength:m,radialDistortionCoefficients:v,affineTransformations:y,tangentialDistortionCoefficients:f}=n;return Promise.all(e.map((async i=>{let a;return i.spatialReference.equals(c.spatialReference)?(a=new s.Z(i),r(a)):(await(0,l.initializeProjection)(e[0].spatialReference,c.spatialReference,null,t.options),a=(0,l.project)(i,c.spatialReference),r(a));function r(e){var t,i,a,r,n,l,b,w;if(e.spatialReference.isWGS84)if(4===(null===(t=o.cameraOrientation)||void 0===t?void 0:t.type)){const t=o.cameraOrientation;e=new s.Z((0,g.SA)(e,[t.latitude,t.longitude,t.ellipsoidRadius,t.squaredEccentricity]))}else e=new s.Z((0,d.$)(e));const _=(null!==(i=e.z)&&void 0!==i?i:0)-(null!==(a=c.z)&&void 0!==a?a:0),C=(e.x-c.x)/h,M=(e.y-c.y)/h,x=(u[0]*C+u[1]*M+u[2]*_)/(u[6]*C+u[7]*M+u[8]*_),I=(u[3]*C+u[4]*M+u[5]*_)/(u[6]*C+u[7]*M+u[8]*_),S=x**2+I**2;let P=0,F=0,R=0,z=0,O=0,A=0,V=0;v&&(P=null!==(r=v[0])&&void 0!==r?r:0,F=null!==(n=v[1])&&void 0!==n?n:0,R=null!==(l=v[2])&&void 0!==l?l:0),f&&(z=f[0],O=f[1]),p&&(A=null!==(b=p[0])&&void 0!==b?b:0,V=null!==(w=p[1])&&void 0!==w?w:0);const Z=1+(P||0)*S+(F||0)*S*S+(R||0)*S*S*S;let T=x*Z+(z||0)*(S+2*x**2)+2*(O||0)*x*I,E=I*Z+(O||0)*(S+2*I**2)+2*(z||0)*x*I;return T=-(null!==m&&void 0!==m?m:0)*T+A,E=-(null!==m&&void 0!==m?m:0)*E+V,{x:Number(y[0])+Number(y[1])*T+Number(y[2])*E,y:Number(y[3])+Number(y[4])*T+Number(y[5])*E}}})))}(e,t):Promise.resolve(function(e,t){var i,a,r;const{feature:o,imageProperties:l}=t,{width:c,height:h}=l,{attributes:u}=o,p=(0,g.oE)("HPR",[u.cameraHeading,u.cameraPitch,u.cameraRoll]),m=Math.sin(null!==(i=u.imageRotation)&&void 0!==i?i:0*C),v=Math.cos(null!==(a=u.imageRotation)&&void 0!==a?a:0*C),y=null!==c&&void 0!==c?c:1,f=null!==h&&void 0!==h?h:1,b=[Math.abs(v*y+m*f),Math.abs(v*f-m*y)],w={horizontal:1/(2*Math.tan(u.horizontalFieldOfView*C/2)),vertical:1/(2*Math.tan(u.verticalFieldOfView*C/2))},_=[-w.horizontal,0,.5,0,w.vertical,.5,0,0,1];let M=new s.Z(u.location);M.spatialReference.isWGS84&&4!==(null===(r=u.cameraOrientation)||void 0===r?void 0:r.type)&&(M=(0,d.$)(M));const x=M.spatialReference.isWebMercator?1/Math.cos(Math.PI/2-2*Math.atan(Math.exp(-1*M.y/6378137))):1,I=(0,n.dC)(new Array(9),p,_);return e.map((e=>{var t,i,a;let r=new s.Z(e);if(r.spatialReference.isWGS84)if(4===(null===(t=u.cameraOrientation)||void 0===t?void 0:t.type)){const e=u.cameraOrientation;r=new s.Z((0,g.SA)(r,[e.latitude,e.longitude,e.ellipsoidRadius,e.squaredEccentricity]))}else r=new s.Z((0,d.$)(r));const o=(null!==(i=r.z)&&void 0!==i?i:0)-(null!==(a=M.z)&&void 0!==a?a:0),n=(r.x-M.x)/x,l=(r.y-M.y)/x,c=(I[0]*n+I[1]*l+I[2]*o)/(I[6]*n+I[7]*l+I[8]*o),h=(I[3]*n+I[4]*l+I[5]*o)/(I[6]*n+I[7]*l+I[8]*o),p={x:c*b[0],y:h*b[1]};return{x:v*(p.x-b[0]/2)+m*(p.y-b[1]/2)+y/2,y:-m*(p.x-b[0]/2)+v*(p.y-b[1]/2)+f/2}}))}(e,t))}(e,t)))}async function x(e,t){var i;if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return e;const{feature:{attributes:{cameraOrientation:a,elevationSource:n,cameraHeight:s,location:h},elevationSample:d}}=t;return d?Promise.all(e.map(I(d,t.options))):n&&((0,m.tB)(n)||null!==(i=n.url)&&void 0!==i&&i.length)?async function(e,t){const{feature:i,options:a,footprintExtent:n}=t,s=i.attributes.elevationSource;if(!s)return e;if((0,m.tB)(s)){const{constantElevation:t}=s;return"number"!=typeof t?e:S(e,t)}const{url:h}=s;if(!h)return e;const{elevationSample:d}=i;if(!d){if(!n)return e;const t=n.clone(),{error:l,isSupported:d,isDynamic:M}=await(0,m.xr)(h);if(!d){r.Z.getLogger(s).warn(l);const{location:t,cameraHeight:a,cameraOrientation:o}=i.attributes;return S(e,o&&"number"==typeof t.z?t.z-a:0)}let x,P=e;try{if(M){var g;x=new p.default({url:h,format:"lerc",rasterFunction:{functionName:null!==(g=s.rasterFunction)&&void 0!==g?g:"None"}}),await x.load(a);let e,r=512,o=512;const l=n.width/n.height;l>1?(o/=l,e=t.height/o):(r*=l,e=t.width/r);const d=await x.fetchImage(n,r,o,a),u=b.Z.create({scales:[e],size:512,spatialReference:n.spatialReference}),m=new w.f(null,0,0,0,(0,c.oJ)(n)),_=new f.v(d.pixelData.pixelBlock.pixels[0],r,o,0),C=new y.R(m,_);i.elevationSample=new v.OB(C,u,void 0)}else x=new u.default(h),await x.load(),i.elevationSample=await x.createElevationSampler(t,a);P=await Promise.all(e.map(I(i.elevationSample,a)))}catch(C){if(!(0,o.D_)(C)){r.Z.getLogger("esri.layers.orientedImagery.transformations.groundToImageUtils").warn("#updateElevation() failed to update elevation using the provided elevation source URL: ".concat(h,". Please provide a valid elevation source url."),C);const{location:t,cameraHeight:a,cameraOrientation:o}=i.attributes;e=S(e,o&&"number"==typeof t.z?t.z-a:0)}}finally{var _;null===(_=x)||void 0===_||_.destroy()}return P}return await(0,l.initializeProjection)(e[0].spatialReference,d.spatialReference,null,t.options),Promise.all(e.map(I(d,a)))}(e,t):S(e,a&&"number"==typeof h.z?h.z-s:0)}function I(e,t){return(0,o.k_)(t),async i=>{i.z=1;const a=e.queryElevation((0,l.project)(i,e.spatialReference));return null!==a&&void 0!==a&&a.z&&(i.z=(await(0,l.projectWithZConversion)(a,i.spatialReference,t)).z),i}}function S(e,t){return e.map((e=>(e.z=t,e)))}},8835:(e,t,i)=>{i.d(t,{y:()=>b});i(59486),i(93169),i(32718);var a=i(16889),r=i(12400),o=i(32035),n=i(848),s=i(79803),l=i(40885),c=i(23470),h=i(81753),d=i(64248),u=i(29754),p=i(43780),m=i(46426),g=i(49885),v=i(36496),y=i(80885),f=i(78952);function b(e,t){if(!e)return Promise.resolve([]);const i=t.feature;let y=i.attributes;return y instanceof u.Z||(y=u.Z.fromJSON(i),y&&(i.attributes=y)),function(e,t){const{attributes:i}=t.feature;if(i.isSpherical||360===i.horizontalFieldOfView){const{location:a,cameraOrientation:o,farDistance:s,cameraHeading:d,cameraHeight:u}=i;return async function(e,t,i,a,o,s,d){let u=new n.Z(t);u.spatialReference.isGeographic&&u.spatialReference.isWGS84&&4!==(null===d||void 0===d?void 0:d.type)&&(u=(0,h.$)(u));const p=(0,m.lj)(u),y=new Array,[f,b,w]=u.toArray(),_=(0,c.k)([f,b,null!==w&&void 0!==w?w:0],i*p),C=g.wz.toArray();for(const h of e){var M;let e,t;if((0,v.h)(h.heading)&&(0,v.h)(h.pitch))e=h.heading,t=h.pitch;else{const i=(0,m.If)({x:h.x,y:h.y},a[0],a[1]);e=i.heading,t=i.pitch}e=(e+o)%360;const i=(0,l.zk)([C[0],C[1],C[2]],(0,m.n_)(e,t)),d=(0,l.al)([f,b,null!==w&&void 0!==w?w:0],i.direction),g=(0,r.Ue)();(0,c.i)(_,d,g);const x=(null!==(M=u.z)&&void 0!==M?M:0)-s;if(g[2]<x){const e=Math.abs((u.z-x)/-i.direction[2])*p;(0,m.s3)([u.x,u.y,u.z],i.direction,e,p,g)}else g[2]=x;y.push(new n.Z(g,u.spatialReference))}return y}(e,a,s,[t.imageProperties.width,t.imageProperties.height],d,u,o)}return async function(e,t){const{feature:i,footprintExtent:l,options:c}=t,{attributes:{cameraHeight:u,cameraOrientation:g,cameraPitch:v,cameraRoll:y,elevationSource:f,horizontalFieldOfView:b,location:_,verticalFieldOfView:x},elevationSample:I}=i,S=(0,m.I6)(g),{vfov:P}=(0,m.o4)(b,x,null!==y&&void 0!==y?y:0);let F=new n.Z(_),R=!1;S&&(F=new n.Z((0,m.c4)(F,[g.latitude,g.longitude,g.ellipsoidRadius,g.squaredEccentricity]))),F.spatialReference.isWGS84&&(R=!0,F=(0,h.$)(F));const z=(0,m.lj)(F),O=function(e,t,i){var s;const{feature:l}=e,{attributes:c}=l,h=2*Math.tan((0,a.Vl)(c.verticalFieldOfView)/2)*c.farDistance*i,d=2*Math.tan((0,a.Vl)(c.horizontalFieldOfView)/2)*c.farDistance*i,u=(0,m.oE)("HPR",[c.cameraHeading,c.cameraPitch,null!==(s=c.cameraRoll)&&void 0!==s?s:0]),p=(0,m.kK)([0,0,-1],u),g=(0,m.s3)([t.x,t.y,t.z],p,c.farDistance*i,i),v=(0,m.kK)([0,1,0],u),y=(0,m.kK)([1,0,0],u),f=(0,m.SW)(v,h/2,i),b=(0,m.SW)(y,d/2,i),w=(0,o.z)((0,r.ll)(),f,b),_=(0,o.g)((0,r.ll)(),f,b);return[(0,o.g)((0,r.ll)(),g,w),(0,o.g)((0,r.ll)(),g,_),(0,o.z)((0,r.ll)(),g,w),(0,o.z)((0,r.ll)(),g,_)].map((e=>{const[i,a,r]=e;return new n.Z({x:i,y:a,z:r,spatialReference:t.spatialReference})}))}(t,F,z),A=S?O.map((e=>(0,h.Sx)(new n.Z(e)))):O,V=await(0,p.y5)(A,t,!0).then((e=>e.map((e=>({x:e.x,y:e.y,z:1}))))),Z=new Array;for(const a of e){const e={...a,z:1},r={...(0,m.NT)(e,V,A),spatialReference:F.spatialReference},[o]=await(0,p.y5)([S?(0,h.Sx)(new n.Z(r)):new n.Z(r)],t,!0);await M(e,o,V,A,F,r,S,t);const g=i.attributes.clone();g.geometry=F.clone();const{polygon:y}=(0,d.QX)(g),b=y.rings[0].map((e=>new n.Z(e,y.spatialReference))),_=await(0,s.projectWithZConversion)(f||I?await w({cameraLocation:F,groundFootPrint:b,projectedPoint:r,webMercatorScalingFactor:z,vfov:P,shouldConvertToLatLong:R,isCameraOrientationLTP:S,imgPoint:e},t):new n.Z(C(r,F,z,F.z-u,v,P,R)),l.spatialReference,c);Z.push(_)}return Z}(e,t)}(e,t)}async function w(e,t){var i;const{cameraLocation:a,groundFootPrint:r,projectedPoint:o,webMercatorScalingFactor:l,vfov:c,shouldConvertToLatLong:u,isCameraOrientationLTP:g,imgPoint:v}=e,{cameraHeight:b,cameraPitch:w}=t.feature.attributes;await(0,s.initializeProjection)(a.spatialReference,t.footprintExtent.spatialReference,null,t.options);let M=await async function(e,t){const i=e[0].spatialReference.isWGS84?f.Z.WebMercator:e[0].spatialReference,{cameraHeight:a,location:r,elevation:o}=t.feature.attributes,l="number"==typeof r.z&&"number"==typeof o?r.z-o:a,c=(0,d.wM)(e.map((e=>{let{x:t,y:i,z:a}=e;return[t,i,a]})),l,r,(0,m.lj)(r)),h=(await(0,p.sg)(c.map((e=>new n.Z(e,r.spatialReference))),t,!1)).map((e=>(0,s.project)(e,i)));return new y.Z({hasZ:!0,rings:[h.map((e=>[e.x,e.y,e.z]))],spatialReference:i})}(r,t),S=0,P=(null!==(i=a.z)&&void 0!==i?i:0)-b,F=0;for(;F<10;){var R,z;const e=x(M,a,o);if(!e||!_([a.x,a.y,a.z],[e.x,e.y,e.z],[o.x,o.y,o.z]))return new n.Z(C(o,a,l,P,w,c,u));const i=new n.Z({x:e.x,y:e.y,z:e.z,spatialReference:a.spatialReference}),r=await(0,p.y5)([g?(0,h.Sx)(i):i],t);if(S=Math.abs(v.x-r[0].x)+Math.abs(v.y-r[0].y),P=e.z,S<=1)return new n.Z(C(o,a,l,P,w,c,u));F+=1;const{extent:s}=M,d=(null!==(R=null===s||void 0===s?void 0:s.width)&&void 0!==R?R:0)/10,m=(null!==(z=null===s||void 0===s?void 0:s.height)&&void 0!==z?z:0)/10;if(d<1||m<1)return new n.Z(C(o,a,l,P,w,c,u));const{x:f,y:b}=e,O=await(0,p.sg)(I(d,m).map((e=>{let[t,i]=e;return new n.Z({x:f+t,y:b+i,spatialReference:a.spatialReference})})),t,!1);O.push(O[0]),M=new y.Z({rings:[O.map((e=>e.toArray()))],spatialReference:a.spatialReference})}return new n.Z(C(o,a,l,P,w,c,u))}const _=(e,t,i)=>(0,o.m)((0,o.z)((0,r.ll)(),t,e),(0,o.z)((0,r.ll)(),i,e))>0;function C(e,t,i,a,s,l,c){const d=Math.sqrt((e.z-t.z)**2+(Math.sqrt((e.x-t.x)**2+(e.y-t.y)**2)/i)**2)*i,u=(0,m.SW)((0,o.z)((0,r.ll)(),[e.x,e.y,e.z],[t.x,t.y,t.z]),1/d,1/i);if(e.z<a||s+l/2<90){const r=Math.abs((t.z-a)/-u[2])*i,o=(0,m.s3)([t.x,t.y,t.z],u,r,i);e.x=o[0],e.y=o[1],e.z=o[2]}else e.z=a;return c?(0,h.Sx)(new n.Z(e)).toJSON():e}async function M(e,t,i,a,r,o,s,l){let c=0;for(let d=0;d<=8;d+=1){if(c=Math.abs(e.x-t.x)+Math.abs(e.y-t.y),c<=1)return;const[d,u,g,v]=I(c,c).map((t=>{let[o,n]=t;return{...(0,m.E7)({x:e.x+o,y:e.y+n,z:1},i[0],i[1],i[2],i[3],{x:a[0].x,y:a[0].y,z:a[0].z},{x:a[1].x,y:a[1].y,z:a[1].z},{x:a[2].x,y:a[2].y,z:a[2].z},{x:a[3].x,y:a[3].y,z:a[3].z}),spatialReference:r.spatialReference}})),[y,f,b,w]=await(0,p.y5)(s?[(0,h.Sx)(new n.Z(d)),(0,h.Sx)(new n.Z(u)),(0,h.Sx)(new n.Z(g)),(0,h.Sx)(new n.Z(v))]:[new n.Z(d),new n.Z(u),new n.Z(g),new n.Z(v)],l,!0).then((e=>e.map((e=>({...e,z:0}))))),{x:_,y:C,z:M}=(0,m.E7)(e,y,f,b,w,d,u,g,v);o.x=_,o.y=C,o.z=M,[t]=await(0,p.y5)([s?(0,h.Sx)(new n.Z(o)):new n.Z(o)],l,!0)}}function x(e,t,i){const a=e.rings[0][0][0],r=e.rings[0][0][1],o=e.rings[0][0][2],n=e.rings[0][1][0],s=e.rings[0][1][1],l=e.rings[0][1][2],c=e.rings[0][1][0],h=e.rings[0][1][1],d=e.rings[0][1][2],u=e.rings[0][2][0],p=e.rings[0][2][1],g=e.rings[0][2][2],v=(g-d)*(s-r)-(p-h)*(l-o),y=-((g-d)*(n-a)-(l-o)*(u-c)),f=(p-h)*(n-a)-(s-r)*(u-c),b=-(v*a+y*r+f*o);return(0,m.Gm)(t.toJSON(),i,v,y,f,b)}const I=(e,t)=>[[-e,-t],[e,-t],[e,t],[-e,t]]},46426:(e,t,i)=>{i.d(t,{E7:()=>p,Gm:()=>w,I6:()=>O,If:()=>x,NT:()=>u,SA:()=>_,SW:()=>v,Xt:()=>z,_6:()=>R,c4:()=>C,cZ:()=>S,e4:()=>I,kK:()=>y,lj:()=>M,mV:()=>P,n_:()=>F,o4:()=>b,oE:()=>f,s3:()=>g});i(59486);var a=i(16889),r=i(21389),o=i(7025),n=i(12400),s=i(29134),l=i(79803),c=i(22186),h=i(92975),d=(i(81753),i(49885));i(848);function u(e,t,i){const[a,r,o,n]=t,[s,l,c,h]=i;return p(e,a,r,o,n,s,l,c,h)}function p(e,t,i,a,r,n,l,c,h){var d,u,p,g,v,y,f,b;let w=!1;0===t.z&&0===i.z&&0===a.z&&0===r.z&&(t.z=i.z=a.z=r.z=1,e.z=1),t.z=null!==(d=t.z)&&void 0!==d?d:1,i.z=null!==(u=i.z)&&void 0!==u?u:1,a.z=null!==(p=a.z)&&void 0!==p?p:1,r.z=null!==(g=r.z)&&void 0!==g?g:1,0===n.z&&0===l.z&&0===c.z&&0===h.z&&(w=!0,n.z=l.z=c.z=h.z=1),n.z=null!==(v=n.z)&&void 0!==v?v:1,l.z=null!==(y=l.z)&&void 0!==y?y:1,c.z=null!==(f=c.z)&&void 0!==f?f:1,h.z=null!==(b=h.z)&&void 0!==b?b:1;const _=m(t,i,a,r),C=m(n,l,c,h),M=(0,s.iS)((0,o.Ue)(),_),x=(0,o.Ue)();x[0]=C[0]*M[0]+C[1]*M[4]+C[2]*M[8]+C[3]*M[12],x[1]=C[0]*M[1]+C[1]*M[5]+C[2]*M[9]+C[3]*M[13],x[2]=C[0]*M[2]+C[1]*M[6]+C[2]*M[10]+C[3]*M[14],x[3]=C[0]*M[3]+C[1]*M[7]+C[2]*M[11]+C[3]*M[15],x[4]=C[4]*M[0]+C[5]*M[4]+C[6]*M[8]+C[7]*M[12],x[5]=C[4]*M[1]+C[5]*M[5]+C[6]*M[9]+C[7]*M[13],x[6]=C[4]*M[2]+C[5]*M[6]+C[6]*M[10]+C[7]*M[14],x[7]=C[4]*M[3]+C[5]*M[7]+C[6]*M[11]+C[7]*M[15],x[8]=C[8]*M[0]+C[9]*M[4]+C[10]*M[8]+C[11]*M[12],x[9]=C[8]*M[1]+C[9]*M[5]+C[10]*M[9]+C[11]*M[13],x[10]=C[8]*M[2]+C[9]*M[6]+C[10]*M[10]+C[11]*M[14],x[11]=C[8]*M[3]+C[9]*M[7]+C[10]*M[11]+C[11]*M[15],x[12]=C[12]*M[0]+C[13]*M[4]+C[14]*M[8]+C[15]*M[12],x[13]=C[12]*M[1]+C[13]*M[5]+C[14]*M[9]+C[15]*M[13],x[14]=C[12]*M[2]+C[13]*M[6]+C[14]*M[10]+C[15]*M[14],x[15]=C[12]*M[3]+C[13]*M[7]+C[14]*M[11]+C[15]*M[15];const I=x[0]*e.x+x[1]*e.y+x[2]*e.z+x[3],S=x[4]*e.x+x[5]*e.y+x[6]*e.z+x[7],P=x[8]*e.x+x[9]*e.y+x[10]*e.z+x[11];let F=x[12]*e.x+x[13]*e.y+x[14]*e.z+x[15];return 0===F&&(F=1),{x:I/F,y:S/F,z:w?0:P/F}}function m(e,t,i,a){const r=function(e,t){const[i,a,r,o]=e,n=new Array(4);return n[0]=i*t[0]+a*t[1]+r*t[2]+o*t[3],n[1]=i*t[4]+a*t[5]+r*t[6]+o*t[7],n[2]=i*t[8]+a*t[9]+r*t[10]+o*t[11],n[3]=i*t[12]+a*t[13]+r*t[14]+o*t[15],n}([a.x,a.y,a.z,1],(0,s.iS)(new Array(16),[e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,1,1,1,1])),o=r[0],n=r[1],l=r[2],c=new Array(16);return c[0]=o*e.x,c[1]=n*t.x,c[2]=l*i.x,c[3]=0,c[4]=o*e.y,c[5]=n*t.y,c[6]=l*i.y,c[7]=0,c[8]=o*e.z,c[9]=n*t.z,c[10]=l*i.z,c[11]=0,c[12]=o,c[13]=n,c[14]=l,c[15]=1,c}function g(e,t,i,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:(0,n.ll)();return r[0]=e[0]+t[0]*i,r[1]=e[1]+t[1]*i,r[2]=e[2]+t[2]*(i/a),r}function v(e,t,i){const a=(0,n.ll)();return a[0]=e[0]*t,a[1]=e[1]*t,a[2]=e[2]*(t/i),a}function y(e,t){const[i,a,r]=e,o=(0,n.ll)();return o[0]=i*t[0]+a*t[3]+r*t[6],o[1]=i*t[1]+a*t[4]+r*t[7],o[2]=i*t[2]+a*t[5]+r*t[8],o}function f(e,t){const i=Math.PI/180,a=(0,r.Ue)();if("OPK"===e){const e=Number(t[0])*i,r=Number(t[1])*i,o=Number(t[2])*i;a[0]=Math.cos(r)*Math.cos(o),a[1]=Math.cos(e)*Math.sin(o)+Math.sin(e)*Math.sin(r)*Math.cos(o),a[2]=Math.sin(e)*Math.sin(o)-Math.cos(e)*Math.sin(r)*Math.cos(o),a[3]=-Math.cos(r)*Math.sin(o),a[4]=Math.cos(e)*Math.cos(o)-Math.sin(e)*Math.sin(r)*Math.sin(o),a[5]=Math.sin(e)*Math.cos(o)+Math.cos(e)*Math.sin(r)*Math.sin(o),a[6]=Math.sin(r),a[7]=-Math.sin(e)*Math.cos(r),a[8]=Math.cos(e)*Math.cos(r)}else{const e=Number(t[0])*i,r=Number(t[1])*i,o=Number(t[2])*i;a[0]=Math.cos(e)*Math.cos(o)-Math.sin(e)*Math.cos(r)*Math.sin(o),a[1]=Math.sin(e)*Math.cos(o)*-1-Math.cos(e)*Math.cos(r)*Math.sin(o),a[2]=Math.sin(o)*Math.sin(r)*-1,a[3]=Math.cos(e)*Math.sin(o)+Math.sin(e)*Math.cos(r)*Math.cos(o),a[4]=Math.sin(e)*Math.sin(o)*-1+Math.cos(e)*Math.cos(r)*Math.cos(o),a[5]=Math.cos(o)*Math.sin(r),a[6]=Math.sin(e)*Math.sin(r)*-1,a[7]=Math.cos(e)*Math.sin(r)*-1,a[8]=Math.cos(r)}return a}function b(e,t,i){const a=Math.sin(i*Math.PI/180),r=Math.cos(i*Math.PI/180),o=[[e,0],[e,t],[0,t]];o.forEach(((e,t)=>{o[t]=[r*e[0]-a*e[1],a*e[0]+r*e[1]]}));const n=Math.min(0,o[0][0],o[1][0],o[2][0]),s=Math.max(0,o[0][0],o[1][0],o[2][0]),l=Math.min(0,o[0][1],o[1][1],o[2][1]),c=Math.max(0,o[0][1],o[1][1],o[2][1]);return{hfov:Math.abs(s-n),vfov:Math.abs(c-l)}}function w(e,t,i,a,r,o){const n=i*(t.x-e.x)+a*(t.y-e.y)+r*(t.z-e.z);if(0===n)return null;const s=-(i*e.x+a*e.y+r*e.z+o)/n;return{x:e.x+s*(t.x-e.x),y:e.y+s*(t.y-e.y),z:e.z+s*(t.z-e.z)}}function _(e,t){const i=Math.PI/180,a=e.y*i,r=e.x*i,o=e.z||0,n=t[0]*i,s=t[1]*i,l=t[2]/Math.sqrt(1-t[3]*Math.sin(n)**2),c=r-s,h=t[2]/Math.sqrt(1-t[3]*Math.sin(a)**2),d=t[3]*(l*Math.sin(n)-h*Math.sin(a));return{x:(h+o)*Math.cos(a)*Math.sin(c),y:(h+o)*(Math.sin(a)*Math.cos(n)-Math.sin(n)*Math.cos(a)*Math.cos(c))+d*Math.cos(n),z:(h+o)*(Math.sin(a)*Math.sin(n)+Math.cos(n)*Math.cos(a)*Math.cos(c))-l+d*Math.sin(n)}}function C(e,t){const i=Math.PI/180,a=Number(e.x),r=Number(e.y),o=Number(e.z),n=t[0]*i,s=t[1]*i,l=t[2]/Math.sqrt(1-t[3]*Math.sin(n)**2),c=a/l,h=r/l,d=o/l,u=Math.cos(n)-Math.sin(n)*h+Math.cos(n)*d,p=Math.sin(n)+Math.cos(n)*h+Math.sin(n)*d,m=Math.sqrt(u**2+c**2),g=t[3]*l*Math.sin(n),v=n,y=Math.atan(p/m-(g-t[3]*(t[2]/Math.sqrt(1-t[3]*Math.sin(v)**2))*Math.sin(v))/(l*m)),f=Math.atan(p/m-(g-t[3]*(t[2]/Math.sqrt(1-t[3]*Math.sin(y)**2))*Math.sin(y))/(l*m)),b=Math.atan(p/m-(g-t[3]*(t[2]/Math.sqrt(1-t[3]*Math.sin(f)**2))*Math.sin(f))/(l*m)),w=Math.atan(p/m-(g-t[3]*(t[2]/Math.sqrt(1-t[3]*Math.sin(b)**2))*Math.sin(b))/(l*m)),_=Math.atan(a/(l*u))+s;return{x:_/i,y:w/i,z:a/(Math.cos(w)*Math.sin(_-s))-t[2]/Math.sqrt(1-t[3]*Math.sin(w)**2),spatialReference:{wkid:4326}}}function M(e){return e&&(0,h.sS)(null===e||void 0===e?void 0:e.spatialReference)?1/Math.cos(Math.PI/2-2*Math.atan(Math.exp(-1*e.y/c.sv.radius))):1}function x(e,t,i){const a=360/t,r=180/i;return{heading:(e.x-t/2)*a,pitch:90-(e.y-i/2)*r}}function I(e,t,i){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:d.SL/2;const{heading:r,pitch:o}=P(e,a);return S(r,o,t,i)}function S(e,t,i,a){return{x:i/2+e/(360/i),y:a-t/(180/a),heading:e,pitch:t}}function P(e,t){const i=(0,a.BV)(Math.acos(-e.z/t));return{heading:(0,a.BV)(Math.atan2(e.x,e.y)),pitch:i}}function F(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:d.SL/2;return[i*(Math.sin((0,a.Vl)(e))*Math.sin((0,a.Vl)(t))),i*(Math.cos((0,a.Vl)(e))*Math.sin((0,a.Vl)(t))),i*Math.cos((0,a.Vl)(180-t))]}async function R(e,t,i){await(0,l.initializeProjection)(t.spatialReference,e.spatialReference,null,i);const r=await(0,l.projectWithZConversion)(t,e.spatialReference,i);let o=(0,a.BV)(Math.atan2(r.y-e.y,r.x-e.x));return o=o>=0&&o<=90?90-o:o>90&&o<=180?360-o+90:90+Math.abs(o),o}function z(e,t,i){const a=Math.cos(i),r=Math.sin(i),o=[1,0,0,1,0,0],n=o[0]*a+o[2]*r,s=o[1]*a+o[3]*r,l=-o[0]*r+o[2]*a,c=-o[1]*r+o[3]*a;return o[0]=n,o[1]=s,o[2]=l,o[3]=c,[e*o[0]+t*o[2]+o[4],e*o[1]+t*o[3]+o[5]]}function O(e){return 4===(null===e||void 0===e?void 0:e.type)}},76081:(e,t,i)=>{i.d(t,{R:()=>r});var a=i(11939);class r{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.tile=e,null!=t&&null!=e){const i=e.extent;this._samplerData=new a.K(t,i)}}get zmin(){return null!=this._samplerData?this._samplerData.data.minValue:0}get zmax(){return null!=this._samplerData?this._samplerData.data.maxValue:0}get hasNoDataValues(){var e;return!(null===(e=this._samplerData)||void 0===e||!e.data.hasNoDataValues)}sample(e,t){if(null==this._samplerData)return;const{safeWidth:i,data:a,dx:r,dy:n,y1:s,x0:l}=this._samplerData,{width:c,values:h,noDataValue:d}=a,u=o(n*(s-t),0,i),p=o(r*(e-l),0,i),m=Math.floor(u),g=Math.floor(p),v=m*c+g,y=v+c,f=h[v],b=h[y],w=h[v+1],_=h[y+1];if(f!==d&&b!==d&&w!==d&&_!==d){const e=p-g,t=f+(w-f)*e;return t+(b+(_-b)*e-t)*(u-m)}}}function o(e,t,i){return e<t?t:e>i?i:e}},48932:(e,t,i)=>{i.d(t,{v:()=>a});class a{constructor(e,t,i,a){this._hasNoDataValues=null,this._minValue=null,this._maxValue=null,"pixelData"in e?(this.values=e.pixelData,this.width=e.width,this.height=e.height,this.noDataValue=e.noDataValue):(this.values=e,this.width=t,this.height=i,this.noDataValue=a)}get hasNoDataValues(){if(null==this._hasNoDataValues){const e=this.noDataValue;this._hasNoDataValues=this.values.includes(e)}return this._hasNoDataValues}get minValue(){return this._ensureBounds(),this._minValue}get maxValue(){return this._ensureBounds(),this._maxValue}_ensureBounds(){if(null!=this._minValue)return;const{noDataValue:e,values:t}=this;let i=1/0,a=-1/0,r=!0;for(const o of t)o===e?this._hasNoDataValues=!0:(i=o<i?o:i,a=o>a?o:a,r=!1);r?(this._minValue=0,this._maxValue=0):(this._minValue=i,this._maxValue=a>-3e38?a:0)}}},41665:(e,t,i)=>{i.d(t,{w:()=>n});var a=i(46798);class r extends a.q{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;super("LercWorker","_decode",{_decode:e=>[e.buffer]},e,{strategy:"dedicated"}),this.schedule=e,this.ref=0}decode(e,t,i){return e&&0!==e.byteLength?this.invoke({buffer:e,options:t},i):Promise.resolve(null)}release(){--this.ref<=0&&(o.forEach(((e,t)=>{e===this&&o.delete(t)})),this.destroy())}}const o=new Map;function n(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=o.get(e);return t||(null!=e?(t=new r((t=>e.immediate.schedule(t))),o.set(e,t)):(t=new r,o.set(null,t))),++t.ref,t}},53184:(e,t,i)=>{i.d(t,{Z:()=>o});var a=i(10064),r=i(66978);class o{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.lods[e.lods.length-1].level;this.tileInfo=e,this.minLOD=t,this.maxLOD=i,e.lodAt(t)||(this.minLOD=e.lods[0].level),e.lodAt(i)||(this.maxLOD=e.lods[e.lods.length-1].level)}get effectiveMinLOD(){var e;return null!==(e=this.minLOD)&&void 0!==e?e:this.tileInfo.lods[0].level}get effectiveMaxLOD(){var e;return null!==(e=this.maxLOD)&&void 0!==e?e:this.tileInfo.lods[this.tileInfo.lods.length-1].level}getAvailability(e,t,i){var a;const r=null===(a=this.tileInfo)||void 0===a?void 0:a.lodAt(e);return!r||e<this.minLOD||e>this.maxLOD?"unavailable":r.cols&&r.rows?i>=r.cols[0]&&i<=r.cols[1]&&t>=r.rows[0]&&t<=r.rows[1]?"unknown":"unavailable":"unknown"}async fetchAvailability(e,t,i,o){await(0,r.Yn)(o);const n=this.getAvailability(e,t,i);if("unavailable"===n)throw new a.Z("tile-map:tile-unavailable","Tile is not available",{level:e,row:t,col:i});return n}async fetchAvailabilityUpsample(e,t,i,a,o){await(0,r.Yn)(o),a.level=e,a.row=t,a.col=i;const n=this.tileInfo;return n.updateTileInfo(a),this.fetchAvailability(e,t,i,o).catch((e=>{if((0,r.D_)(e))throw e;if(n.upsampleTile(a))return this.fetchAvailabilityUpsample(a.level,a.row,a.col,a,o);throw e}))}}},18277:(e,t,i)=>{i.d(t,{$6:()=>v,$z:()=>o,F7:()=>r,Ow:()=>l,S0:()=>s,d1:()=>c,dm:()=>h,ir:()=>n});const a=[["binary","application/octet-stream","bin",""]];function r(e,t){var i;return null!=u(t.name,null!==(i=null===e||void 0===e?void 0:e.supportedFormats)&&void 0!==i?i:[])}function o(e,t){var i;if(!e)return!1;const a=h(t,null!==(i=e.supportedFormats)&&void 0!==i?i:[]);return null!=a&&e.editFormats.includes(a)}function n(e){var t;return d(null!==(t=null===e||void 0===e?void 0:e.supportedFormats)&&void 0!==t?t:[]).flatMap(g).map((e=>".".concat(e)))}function s(e,t){return p(function(e,t){const i=e.toLowerCase();return d(t).find((e=>m(e)===i))}(e,t))}function l(e,t){return p(u(e,t))}function c(e,t){return m(function(e,t){return d(t).find((t=>p(t)===e))}(e,t))}function h(e,t){var i;return null!==(i=l(e.name,t))&&void 0!==i?i:s(e.type,t)}function d(e){return[...a,...e]}function u(e,t){const i=e.toLowerCase();return d(t).find((e=>g(e).some((e=>i.endsWith(e)))))}function p(e){return null===e||void 0===e?void 0:e[0]}function m(e){return null===e||void 0===e?void 0:e[1].toLowerCase()}function g(e){var t;return null!==(t=null===e||void 0===e?void 0:e[2].split(",").map((e=>e.toLowerCase())))&&void 0!==t?t:[]}function v(e){var t;return null===(t=e.tables)||void 0===t?void 0:t.find((e=>"assetMaps"===e.role))}},41226:(e,t,i)=>{i.d(t,{T:()=>r});var a=i(76200);async function r(e,t){const{data:i}=await(0,a.Z)(e,{responseType:"json",query:{f:"json",...null===t||void 0===t?void 0:t.customParameters,token:null===t||void 0===t?void 0:t.apiKey}});return i}},86856:(e,t,i)=>{i.r(t),i.d(t,{default:()=>gt});var a=i(27366),r=(i(59166),i(90193)),o=i(44927),n=i(32718),s=i(16889),l=i(94172),c=i(49861),h=(i(93169),i(84936),i(69912)),d=i(46426),u=i(70047),p=i(33565);function m(e,t,i,a){return[[[i-e/Math.SQRT2,a-e/Math.SQRT2],[i+e/Math.SQRT2,a-e/Math.SQRT2],[i+t/Math.SQRT2,a-t/Math.SQRT2],[i-t/Math.SQRT2,a-t/Math.SQRT2]],[[i+e/Math.SQRT2,a-e/Math.SQRT2],[i+e/Math.SQRT2,a+e/Math.SQRT2],[i+t/Math.SQRT2,a+t/Math.SQRT2],[i+t/Math.SQRT2,a-t/Math.SQRT2]],[[i+e/Math.SQRT2,a+e/Math.SQRT2],[i-e/Math.SQRT2,a+e/Math.SQRT2],[i-t/Math.SQRT2,a+t/Math.SQRT2],[i+t/Math.SQRT2,a+t/Math.SQRT2]],[[i-e/Math.SQRT2,a+e/Math.SQRT2],[i-e/Math.SQRT2,a-e/Math.SQRT2],[i-t/Math.SQRT2,a-t/Math.SQRT2],[i-t/Math.SQRT2,a+t/Math.SQRT2]]]}function g(e,t,i){const[a,r,o,n]=e;return"M ".concat(a.join(" ")," A ").concat(t," ").concat(t," 0 0 1 ").concat(r.join(" ")," L ").concat(o.join(" ")," A ").concat(i," ").concat(i," 0 0 0 ").concat(n.join(" ")," Z")}function v(e,t,i){const[a,r,o,n]=[...e,0];return[...m(a,r,t,i).map((e=>g(e,a,r))),...m(r,o,t,i).map((e=>g(e,r,o))),...m(o,n,t,i).map((e=>g(e,o,n)))]}const y="esri-oriented-imagery-viewer",f="".concat(y,"__carousel"),b="".concat(y,"__image-enhancement"),w="".concat(y,"__navigation"),_={addCoverage:"".concat(y,"__body-additional-coverage"),addExpPoints:"".concat(y,"__body-additional-camera-locations"),body:"".concat(y,"__body"),carousel:"".concat(y,"__carousel"),carouselContainer:"".concat(f,"-container"),carouselContent:"".concat(f,"-content"),carouselItem:"".concat(f,"-item"),carouselItemWrapper:"".concat(f,"-item-wrapper"),close:"".concat(y,"__close"),currentCoverage:"".concat(y,"__body-current-coverage"),dock:"".concat(y,"--docked"),feature:"".concat(w,"-feature"),float:"".concat(y,"--floating"),footprint:"".concat(y,"__body-footprint"),imageEnhancementWrapper:"".concat(b,"-wrapper"),imageEnhancementTools:"".concat(b,"-tools"),imageEnhancementToolContainer:"".concat(b,"-tool-container"),messageBox:"".concat(y,"__message-box"),navigationPathOffset0:"".concat(w,"-feature-path-stop-offset-0"),navigationPathOffset1:"".concat(w,"-feature-path-stop-offset-1"),navigationWrapper:"".concat(w,"-wrapper"),navigationZoomed:"".concat(w,"-wrapper--zoomed"),north:"".concat(w,"-pointer-north"),outerSector:"".concat(w,"-sector-outer"),pointer:"".concat(w,"-pointer"),rotateWithAnimation:"".concat(w,"-animate"),selectedFeaturePath:"".concat(w,"-feature-path"),sector:"".concat(w,"-sector"),sectorCross:"".concat(w,"-sector-cross"),sectorDisabled:"".concat(w,"-sector-disabled"),sectorEnabled:"".concat(w,"-sector-enabled"),sectorSeparator:"".concat(w,"-sector-separator"),submenu:"".concat(y,"__submenu"),viewer:"".concat(y,"__viewer"),viewerContainer:"".concat(y,"__viewer-container")},C=[21,36,51,60],M=["FAR_WEST","FAR_NORTH","FAR_EAST","FAR_SOUTH","WEST","NORTH","EAST","SOUTH","NEAR_WEST","NEAR_NORTH","NEAR_EAST","NEAR_SOUTH"],x=23.937554159486076,I=96.06244584051393,S={EAST:[x,x,I,x,60,x],NORTH:[x,I,x,x,x,60],SOUTH:[I,x,I,I,I,60],WEST:[I,I,x,I,60,I]};i(59486);var P=i(52639),F=i(63780),R=i(14921),z=i(80987),O=i(10064),A=i(91505),V=i(46784),Z=i(84652),T=i(92026),E=i(66978),N=i(77981),L=i(81753),D=i(93655),k=i(15440),j=i(29754),G=i(21149),H=i(53866);const W={};async function B(e,t){var i,a,r,o,n;const{point:s,queryParams:l}=e;if(null==s)return null;const c={};let h=e.layerInstanceOrURL;const d=s.spatialReference.isGeographic?(0,L.$)(s.clone()):s.clone();if(c.outSpatialReference=d.spatialReference,l&&(c.maxRecordCountFactor=null!==(i=l.maxRecordCountFactor)&&void 0!==i?i:5,c.outFields=null!==(a=l.outFields)&&void 0!==a?a:["*"],c.where=null!==(r=l.where)&&void 0!==r?r:"1=1",c.returnGeometry=null===(o=l.returnGeometry)||void 0===o||o,c.outSpatialReference=l.outSpatialReference),"string"==typeof h&&(W.layer&&W.layer.url===h?h=W.layer:(null!==(n=W.layer)&&void 0!==n&&n.destroy(),h=W.layer=new k.default({url:h}))),h)try{var u,p;await h.load();const e=h,i=function(e,t){const i=e.x-t,a=e.x+t,r=e.y-t,o=e.y+t;return new H.Z({xmin:i,xmax:a,ymin:r,ymax:o,spatialReference:e.spatialReference})}(d,null!==(u=null!==(p=null===l||void 0===l?void 0:l.maximumDistance)&&void 0!==p?p:e.maximumDistance)&&void 0!==u?u:1e3);c.returnZ=e.hasZ;const a=new G.Z({geometry:i,...c}),r=await e.queryFeatures(a,t);return function(e){return t=>{const{features:i,spatialReference:a}=t;return i.forEach((t=>{t.geometry&&(t.geometry.spatialReference=a);const i=j.Z.fromJSON({...t.toJSON(),layer:e});i&&(t.attributes=i),t.layer=e,t.spatialReference=a})),t}}(e)(r)}catch(gt){(0,E.H9)(gt)}return null}var q=i(22186),U=i(41258);function K(e){var t;const{camera:i,features:a,selectedPoint:r}=e;if(!a.length)return[];null!==(t=e.currentImage)&&void 0!==t||(e.currentImage={attributes:{cameraHeading:0,cameraPitch:0}});const o=function(e,t,i){var a,r;return null!==(a=t.z)&&void 0!==a||(t.z=0),null!==(r=t.elevation)&&void 0!==r||(t.elevation=0),a=>{var r,o,n,s;const{hfovWeight:l,vfovWeight:c,distanceWeight:h}=function(e,t){const i="isOblique"in e?e:new j.Z(e),{isOblique:a,isSpherical:r,isNadir:o}=i;return r?{hfovWeight:"2d"===t?0:1,vfovWeight:"2d"===t?0:.6,distanceWeight:"2d"===t?1:.5}:o?{hfovWeight:.25,vfovWeight:1,distanceWeight:1}:a?{hfovWeight:1,vfovWeight:.25,distanceWeight:1}:{hfovWeight:1,vfovWeight:1,distanceWeight:1}}(a.attributes,e?"3d":"2d"),d=a.attributes,{cameraHeight:u,cameraHeading:p,cameraPitch:m,farDistance:g,horizontalFieldOfView:v,verticalFieldOfView:y,isOblique:f}=d,b=d.geometry,w=180*Math.atan2(b.y-t.y,b.x-t.x)/Math.PI,_=(0,U.TE)(t,b);let C,M,x=v,I=y,S=!1;e?(C=e.heading,M=e.tilt,x=180,I=180,S=!0):!f||m<10?(C=p,M=m,S=!1):(C=i.attributes.cameraHeading,M=m,S=!0,x=180),C>180&&(C-=360);let P=1;b.spatialReference.isWebMercator&&(P=1/Math.cos(Math.PI/2-2*Math.atan(Math.exp(-1*b.y/q.sv.radius))));const F=Math.sqrt((Math.sqrt((t.x-b.x)**2+(t.y-b.y)**2)/P)**2+((null!==(r=t.z)&&void 0!==r?r:0)-(null!==(o=t.elevation)&&void 0!==o?o:0)-u)**2),R=90-180*Math.atan2(t.y-b.y,t.x-b.x)/Math.PI;let z=(Math.abs(R-C)>180?Math.abs(360-Math.abs(R-C)):Math.abs(R-C))/x;z=4*z+1;const O=180*Math.acos((d.cameraHeight-(null!==(n=t.z)&&void 0!==n?n:0)+(null!==(s=t.elevation)&&void 0!==s?s:0))/F)/Math.PI;let A=Math.abs(O-M)/I;A=4*A+1;let V=F/Math.sqrt(g**2+u**2);V=4*V+1;const Z=l*z+c*A+h*V;let T;if(S){const e=p>180?p-360:p;T=l*((Math.abs(R-e)>180?Math.abs(360-Math.abs(R-e)):Math.abs(R-e))/v*4+1)+c*(Math.abs(O-m)/y*4+1)+h*V}else T=Z;return{suitability:Z,trueSuitability:T,feature:a,angle:w,distance:_,verticalAngle:Math.abs(180*Math.atan(_/u)/Math.PI)}}}(i,r,e.currentImage);return a.map(o)}var Q=i(64248),J=i(43780),Y=i(8835),$=i(99837),X=i(1614),ee=i(63665),te=i(85276),ie=i(62565),ae=i(60762),re=i(76200),oe=i(43404),ne=i(27135),se=i(29966);function le(e){return"3d"===(null===e||void 0===e?void 0:e.type)}function ce(e){return"esri.Graphic"===(null===e||void 0===e?void 0:e.declaredClass)}function he(e){return/.*\.(tif|mrf)$/i.test(null!==e&&void 0!==e?e:"")}const de=e=>"".concat(e,":missing-property"),ue=(e,t)=>"Property ".concat(t," is missing in ").concat(e),pe=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"esri.widgets.OrientedImageryViewer",t=arguments.length>1?arguments[1]:void 0;throw n.Z.getLogger(e).error(t),t};var me=i(49885),ge=i(11582);let ve=class extends((0,ge.J)(V.wq)){constructor(e){super(e),this.maxFOV=0,this.minFOV=0,this.view=null,this.zoomFactor=5}get canZoomIn(){return!!this.view&&(0===this.minFOV||this.view.camera.fov>this.minFOV)}get canZoomOut(){return!!this.view&&(0===this.maxFOV||this.view.camera.fov<this.maxFOV)}};(0,a._)([(0,c.Cb)({type:Boolean,readOnly:!0})],ve.prototype,"canZoomIn",null),(0,a._)([(0,c.Cb)({type:Boolean,readOnly:!0})],ve.prototype,"canZoomOut",null),(0,a._)([(0,c.Cb)({type:Number})],ve.prototype,"maxFOV",void 0),(0,a._)([(0,c.Cb)({type:Number})],ve.prototype,"minFOV",void 0),(0,a._)([(0,c.Cb)({type:te.default})],ve.prototype,"view",void 0),(0,a._)([(0,c.Cb)({type:Number})],ve.prototype,"zoomFactor",void 0),ve=(0,a._)([(0,h.j)("esri.widgets.PanoramicViewer.PanoramicZoomConditions")],ve);const ye=ve;var fe=i(58266);let be=class extends fe.Z{constructor(e){super(e),this.panoramicZoomConditions=new ye,this.zoomTo=e=>{this.view.camera.fov=this.constrainFOV(e),this.view.camera=this.view.camera.clone()}}initialize(){this.addHandles([(0,l.watch)((()=>{var e;return[null===(e=this.view)||void 0===e?void 0:e.ready,this.panoramicZoomConditions]}),(()=>{var e;(null===(e=this.view)||void 0===e?void 0:e.ready)&&(this.panoramicZoomConditions.view=this.view,this.zoomTo(this.view.camera.fov))}),l.syncAndInitial),(0,l.watch)((()=>[this.panoramicZoomConditions.maxFOV,this.panoramicZoomConditions.minFOV]),(e=>{let[t,i]=e;null!=t&&null!=i&&this.zoomTo(this.view.camera.fov)}),l.sync)])}get canZoomIn(){return this.panoramicZoomConditions.canZoomIn}get canZoomOut(){return this.panoramicZoomConditions.canZoomOut}get state(){var e;return null!==(e=this.view)&&void 0!==e&&e.ready?"ready":"disabled"}set view(e){this._set("view",e)}constrainFOV(e){const{maxFOV:t,minFOV:i}=this.panoramicZoomConditions;return(0,s.uZ)(e,i,t)}zoomIn(){if(!this.canZoomIn)return;const e=this.view.camera.fov-this.panoramicZoomConditions.zoomFactor;this.zoomTo(e)}zoomOut(){if(!this.canZoomOut)return;const e=this.view.camera.fov+this.panoramicZoomConditions.zoomFactor;this.zoomTo(e)}};(0,a._)([(0,c.Cb)()],be.prototype,"canZoomIn",null),(0,a._)([(0,c.Cb)()],be.prototype,"canZoomOut",null),(0,a._)([(0,c.Cb)({type:ye})],be.prototype,"panoramicZoomConditions",void 0),(0,a._)([(0,c.Cb)()],be.prototype,"state",null),(0,a._)([(0,c.Cb)({type:te.default})],be.prototype,"view",null),be=(0,a._)([(0,h.j)("esri.widgets.PanoramicViewer.PanoramicZoomViewModel")],be);const we=be;i(51508);var _e=i(63899),Ce=i(10891),Me=i(79694),xe=i(16915),Ie=i(43977);function Se(e,t){return 2*(0,s.BV)(Math.atan(Math.tan((0,s.Vl)(e/2))*Math.sqrt(t**2+1)))}var Pe=i(78952);const Fe="default",Re="navigation",ze="fov-constraint",Oe="image-click-action";let Ae=class extends A.Z.EventedAccessor{constructor(e){super(e),this._startPosition=null,this._targetPosition=null,this._graphics=new D.default({elevationInfo:{mode:"relative-to-ground"}}),this._imageGraphic=null,this._loadController=null,this._map=new ae.Z({ground:new ie.Z({opacity:0,navigationConstraint:null}),layers:new z.Z([this._graphics])}),this._zoomViewModel=null,this.autoLoad=!1,this.clickAction="none",this.imageSize=null,this.imageSource=null,this.pitch=90,this.state="ready",this.yaw=0,this._addNavigationHandles=()=>{this.imageRenderer.basemapTerrain.suspended=!0,this.imageRenderer.constraints.tilt.max=180,this.removeHandles(Re),this.addHandles([this.imageRenderer.on("mouse-wheel",this._handleWheel),this.imageRenderer.on("double-click",this._handleDoubleClick),this.imageRenderer.on("drag",this._handleDrag),this.imageRenderer.on("key-down",(e=>{const t=e.key;["+","-","Shift","_","=","ArrowUp","ArrowDown","ArrowRight","ArrowLeft"].includes(t)&&e.stopPropagation()}))],Re)},this._addHFOVHandles=()=>{this.removeHandles(ze),this.addHandles((0,l.watch)((()=>[this.maxHFOV,this.minHFOV]),(()=>{this._zoomViewModel&&(this._zoomViewModel.panoramicZoomConditions=new ye({view:this.imageRenderer,maxFOV:this.maxHFOV,minFOV:this.minHFOV}))}),l.syncAndInitial),ze)},this._addZoomHandles=()=>{this._zoomViewModel=new we({view:this.imageRenderer,panoramicZoomConditions:new ye({maxFOV:this.maxHFOV,minFOV:this.minHFOV})});const e=new se.default({viewModel:this._zoomViewModel});this.imageRenderer.ui.add(e,"top-left"),this._addHFOVHandles()},this._cancelLoadWithController=()=>{var e;null!==(e=this._loadController)&&void 0!==e&&e.abort(),this._loadController=null},this._handleDoubleClick=e=>{e.stopPropagation(),e.native.ctrlKey?this._zoomOut():this._zoomIn()},this._handleDrag=e=>{e.stopPropagation();const{action:t,x:i,y:a}=e;switch(t){case"start":this._startPosition=this._targetPosition={x:i,y:a};break;case"update":this._targetPosition={x:i,y:a},this._updateCameraHeadingAndTilt()}},this._handleImageClick=e=>{if("image-loaded"===this.state&&this.imageRenderer.ready)switch(this.clickAction){case"emit":e.stopPropagation(),this.emit("click",e);break;case"hittest":e.stopPropagation(),e.async((async()=>{const t=await this.imageRenderer.hitTest(e.screenPoint,{include:this._graphics});this.emit("hittest-response",t)}));break;case"pixel-location":{if(e.stopPropagation(),!this.imageSize||!e.mapPoint)return void this.emit("pixel-location",null);const t=(0,d.e4)(e.mapPoint,this.imageSize[0],this.imageSize[1]);this.emit("pixel-location",{...t,spatialReference:Pe.Z.WebMercator,meshVertex:e.mapPoint});break}}},this._handleWheel=e=>{var t;const i=null!==(t=e.deltaX)&&void 0!==t?t:e.native.deltaX;e.stopPropagation(),i>0||e.deltaY>0?this._zoomOut():this._zoomIn()},this._loadWithController=()=>{this._cancelLoadWithController(),this._loadController=new AbortController,this.loadImage(this._loadController)},this._zoomIn=()=>{var e;return null===(e=this._zoomViewModel)||void 0===e?void 0:e.zoomIn()},this._zoomOut=()=>{var e;return null===(e=this._zoomViewModel)||void 0===e?void 0:e.zoomOut()},this.addGraphic=(e,t)=>"image-loaded"===this.state&&!this._graphics.graphics.includes(e)&&(this._graphics.graphics.add(e,t),!0),this.addManyGraphics=e=>{if("image-loaded"!==this.state)return!1;const t=e.filter((e=>!this._graphics.graphics.includes(e)));return this._graphics.graphics.addMany(t),!0},this.clearGraphics=()=>{this._graphics.graphics.removeAll()},this.clearImage=()=>{this.imageSize=null,this._removeImageSphere()},this.removeGraphic=e=>!("image-loaded"!==this.state||!this._graphics.graphics.includes(e))&&(this._graphics.remove(e),!0),this.removeManyGraphics=e=>{if("image-loaded"!==this.state)return!1;const t=e.filter((e=>this._graphics.graphics.includes(e)));return this._graphics.removeMany(t),!0},this._imageRenderer=new te.default({map:this._map,viewingMode:"local",camera:{position:me.wz},environment:{atmosphereEnabled:!1,starsEnabled:!1,lighting:{type:"virtual"}},popupEnabled:!1,spatialReference:Pe.Z.WebMercator,ui:{components:["attribution"]}})}initialize(){this.state="initialized",this.addHandles([(0,l.watch)((()=>this.imageSource),(()=>{this.imageSource&&this.autoLoad&&this._loadWithController()}),l.syncAndInitial),(0,l.watch)((()=>this.fov),(()=>{this._reloadCamera()}),l.syncAndInitial),(0,l.watch)((()=>this.yaw),(e=>{this.camera.heading=e,this._reloadCamera()}),l.syncAndInitial),(0,l.watch)((()=>this.pitch),(e=>{this.camera.tilt=e,this._reloadCamera()}),l.syncAndInitial),(0,l.when)((()=>this.imageRenderer.ready),(()=>{this._addNavigationHandles(),this._addZoomHandles()}),l.syncAndInitial),(0,l.watch)((()=>this.clickAction),(e=>{this.removeHandles(Oe),"none"!==e&&this.addHandles(this.imageRenderer.on("click",this._handleImageClick))}),l.syncAndInitial)],Fe)}get camera(){return this.imageRenderer.camera}set camera(e){e&&(this.imageRenderer.camera=e.clone())}get fov(){return this.camera.fov}set fov(e){var t;Number.isFinite(e)&&(null===(t=this._zoomViewModel)||void 0===t||t.zoomTo(e))}get hfov(){const{fov:e}=this.camera,{size:[t,i]}=this.imageRenderer,a=t/i,r=Math.atan(a);return 2*(0,s.BV)(Math.atan(Math.tan((0,s.Vl)(e/2))*Math.sin(r)))}get imageRenderer(){return this._imageRenderer}get maxHFOV(){const{size:[e,t]}=this.imageRenderer;return Se(me.e1,e/t)}get minHFOV(){const{size:[e,t]}=this.imageRenderer;return Se(me.Ex,e/t)}get vfov(){const{fov:e}=this.camera,{size:[t,i]}=this.imageRenderer,a=t/i,r=Math.atan(a);return 2*(0,s.BV)(Math.atan(Math.tan((0,s.Vl)(e/2))*Math.cos(r)))}async _loadImageInternal(e,t){let i;this.state="image-loading";try{i=(await(0,re.Z)(e,{responseType:"image",...t})).data}catch(f){throw(0,E.D_)(f)?this.state="image-load-aborted":this.state="image-load-error",f}return this._updateImageSphere(i,t)}_reloadCamera(){this.camera=this.camera.clone()}_removeImageSphere(){this._imageGraphic&&(this._graphics.remove(this._imageGraphic),this._imageGraphic=(0,T.SC)(this._imageGraphic)),this.state="ready",this.imageSize=null}_updateCameraHeadingAndTilt(){if(!this._startPosition||!this._targetPosition)return;const e=this.camera.heading+(this._startPosition.x-this._targetPosition.x)/this.imageRenderer.width*this.camera.fov;this.yaw=(e+360)%360;const t=this.camera.tilt-(this._startPosition.y-this._targetPosition.y)/this.imageRenderer.height*this.imageRenderer.camera.tilt;this.pitch=Math.min(179.5,Math.max(.5,t)),this._startPosition=this._targetPosition}async _updateImageSphere(e,t){await(0,E.Yn)(t);const{size:[i,a]}=this.imageRenderer;return this._imageGraphic=function(e){return new P.Z({geometry:e,symbol:new xe.Z({symbolLayers:new z.Z([new Ie.Z])})})}(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:me.wz,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:me.SL;const a=t.clone();a.z=-me.SL/2;const r=_e.Z.createSphere(a,{size:i,densificationFactor:2,vertexSpace:"georeferenced",material:new Ce.Z({colorTexture:new Me.Z({data:e})})});if(r.components[0].trustSourceNormals=!0,r.vertexAttributes.uv){var o;const e=null!==(o=r.vertexAttributes.uv.length)&&void 0!==o?o:0;for(let t=0;t<e;t++)r.vertexAttributes.uv[2*t+0]=1-r.vertexAttributes.uv[2*t+0],r.vertexAttributes.uv[2*t+1]=r.vertexAttributes.uv[2*t+1]}return r.centerAt(a),r}(e)),this._graphics.add(this._imageGraphic),this.fov=Se(me.K0,i/a),this.state="image-loaded",this.imageSize=[e.width,e.height],this._imageGraphic.geometry}async loadImage(e){return this._removeImageSphere(),this.imageSource?this._loadImageInternal(this.imageSource,e):pe(this.declaredClass,new O.Z(de("panoramic-viewer"),ue("PanoramicViewerViewModel","imageSource")))}};(0,a._)([(0,c.Cb)()],Ae.prototype,"_graphics",void 0),(0,a._)([(0,c.Cb)()],Ae.prototype,"_imageGraphic",void 0),(0,a._)([(0,c.Cb)()],Ae.prototype,"_imageRenderer",void 0),(0,a._)([(0,c.Cb)()],Ae.prototype,"_loadController",void 0),(0,a._)([(0,c.Cb)()],Ae.prototype,"_map",void 0),(0,a._)([(0,c.Cb)()],Ae.prototype,"_zoomViewModel",void 0),(0,a._)([(0,c.Cb)({type:Boolean})],Ae.prototype,"autoLoad",void 0),(0,a._)([(0,c.Cb)({type:ee.Z})],Ae.prototype,"camera",null),(0,a._)([(0,ne.J)(new oe.X({emit:"emit",hittest:"hittest",none:"none","pixel-location":"pixel-location"}))],Ae.prototype,"clickAction",void 0),(0,a._)([(0,c.Cb)({type:Number})],Ae.prototype,"fov",null),(0,a._)([(0,c.Cb)({readOnly:!0})],Ae.prototype,"hfov",null),(0,a._)([(0,c.Cb)({readOnly:!0})],Ae.prototype,"imageRenderer",null),(0,a._)([(0,c.Cb)()],Ae.prototype,"imageSize",void 0),(0,a._)([(0,c.Cb)()],Ae.prototype,"imageSource",void 0),(0,a._)([(0,c.Cb)({readOnly:!0})],Ae.prototype,"maxHFOV",null),(0,a._)([(0,c.Cb)({readOnly:!0})],Ae.prototype,"minHFOV",null),(0,a._)([(0,c.Cb)({type:Number})],Ae.prototype,"pitch",void 0),(0,a._)([(0,c.Cb)()],Ae.prototype,"state",void 0),(0,a._)([(0,c.Cb)({readOnly:!0})],Ae.prototype,"vfov",null),(0,a._)([(0,c.Cb)({type:Number})],Ae.prototype,"yaw",void 0),Ae=(0,a._)([(0,h.j)("esri.widgets.PanoramicViewer.PanoramicViewerViewModel")],Ae);const Ve=Ae;var Ze=i(7021),Te=(i(80975),i(28907)),Ee=i(67005);let Ne=class extends p.Z{constructor(e){super(e),this.viewModel=new Ve,this._afterContainerCreate=e=>{this.imageRenderer.container=e},this.addGraphic=(e,t)=>{this.viewModel.addGraphic(e,t)},this.addManyGraphics=e=>{this.viewModel.addManyGraphics(e)},this.clearGraphics=()=>{this.viewModel.clearGraphics()},this.clearImage=()=>{this.viewModel.clearImage()},this.loadImage=e=>this.viewModel.loadImage(e),this.removeGraphic=e=>{this.viewModel.removeGraphic(e)},this.removeManyGraphics=e=>{this.viewModel.removeManyGraphics(e)}}get autoLoad(){return this.viewModel.autoLoad}set autoLoad(e){this.viewModel.autoLoad=e}get camera(){return this.viewModel.camera}set camera(e){e&&(this.viewModel.camera=e)}get clickAction(){return this.viewModel.clickAction}set clickAction(e){this.viewModel.clickAction=e}get fov(){return this.camera.fov}set fov(e){this.viewModel.fov=e}get hfov(){return this.viewModel.hfov}get icon(){return"360-view"}set icon(e){this._overrideIfSome("icon",e)}get imageRenderer(){return this.viewModel.imageRenderer}get imageSize(){return this.viewModel.imageSize}get imageSource(){return this.viewModel.imageSource}set imageSource(e){this.viewModel.imageSource=e}get pitch(){return this.viewModel.pitch}set pitch(e){this.viewModel.pitch=e}get state(){return this.viewModel.state}get vfov(){return this.viewModel.vfov}get yaw(){return this.viewModel.yaw}set yaw(e){this.viewModel.yaw=e}render(){return(0,Ee.u)("div",{afterCreate:this._afterContainerCreate,bind:this,class:this.classes(Ze.z.widget,"esri-panoramic-viewer")})}};(0,a._)([(0,c.Cb)({type:Boolean})],Ne.prototype,"autoLoad",null),(0,a._)([(0,c.Cb)({type:ee.Z})],Ne.prototype,"camera",null),(0,a._)([(0,c.Cb)()],Ne.prototype,"clickAction",null),(0,a._)([(0,c.Cb)({type:Number})],Ne.prototype,"fov",null),(0,a._)([(0,c.Cb)({readOnly:!0,type:Number})],Ne.prototype,"hfov",null),(0,a._)([(0,c.Cb)()],Ne.prototype,"icon",null),(0,a._)([(0,c.Cb)({readOnly:!0,type:te.default})],Ne.prototype,"imageRenderer",null),(0,a._)([(0,c.Cb)({readOnly:!0})],Ne.prototype,"imageSize",null),(0,a._)([(0,c.Cb)()],Ne.prototype,"imageSource",null),(0,a._)([(0,c.Cb)({type:Number})],Ne.prototype,"pitch",null),(0,a._)([(0,c.Cb)({readOnly:!0})],Ne.prototype,"state",null),(0,a._)([(0,c.Cb)({readOnly:!0,type:Number})],Ne.prototype,"vfov",null),(0,a._)([(0,Te.s)(["click","hittest-response","pixel-location"]),(0,c.Cb)({type:Ve})],Ne.prototype,"viewModel",void 0),(0,a._)([(0,c.Cb)({type:Number})],Ne.prototype,"yaw",null),Ne=(0,a._)([(0,h.j)("esri.widgets.PanoramicViewer")],Ne);const Le=Ne;var De=i(28429),ke=i(86934),je=i(2170),Ge=i(23842),He=i(41625),We=i(66612),Be=i(22824),qe=i(86226),Ue=i(80885),Ke=i(848);const Qe="click-handle",Je="enhancements-handle";let Ye=class extends A.Z.EventedAccessor{constructor(e){var t;super(e),t=this,this._imageChanged=!1,this._panConstraint=null,this._image=null,this._loadController=null,this._overlays=new D.default,this._map=new ae.Z,this.autoLoad=!1,this.clickAction="none",this.error=null,this.imageSource=null,this.imageRotation=0,this.state="ready",this._cancelLoadWithController=()=>{var e;null!==(e=this._loadController)&&void 0!==e&&e.abort(),this._loadController=null},this._createImageHandles=()=>{this.removeHandles(Je),this.addHandles((0,l.watch)((()=>[this.brightness,this.contrast,this.sharpness]),(e=>{var t;let[i,a,r]=e;(null===(t=this.image)||void 0===t?void 0:t.loaded)&&(this.image.effect="contrast(".concat(10*(a+10),"%) brightness(").concat(10*(i+10),"%)"),this.sharpenImage(this.image,r))}),l.syncAndInitial))},this._createPanConstraint=()=>{const{image:e,imageRenderer:t}=this,i=i=>{if(!(e&&t&&i.targetGeometry&&e.serviceRasterInfo))return i;const{extent:a}=e.serviceRasterInfo,{constraints:r,rotation:o,width:n,height:s}=t,{extent:l}=(0,je.rotate)(Ue.Z.fromExtent(a),o),{width:c,height:h}=l,d=i.targetGeometry.clone(),u=r.scaleToZoom(i.scale),p=1/2**u,m=n/s;let g=p*c,v=p*h;u&&(c/n>h/s?v=g/m:g=v*m);const y=l.clone();return y.xmin+=g/2,y.xmax-=g/2,y.ymin+=v/2,y.ymax-=v/2,i.targetGeometry=(0,je.nearestCoordinate)(y,d).coordinate,this.state="image-loaded",i};return{constrain:i,applyPanConstraint:i}},this._createResizeHandles=e=>{e.removeHandles("resize"),e.addHandles((0,l.watch)((()=>{if(!this.imageRenderer.ready)return;const{extent:t}=e.serviceRasterInfo,{width:i,height:a,rotation:r}=this.imageRenderer,{extent:o}=(0,je.rotate)(Ue.Z.fromExtent(t),r),{width:n,height:s}=o;return Math.max(n/i,s/a)}),(e=>{if(!this.imageRenderer||null==e)return;const{constraints:t,scale:i,spatialReference:a}=this.imageRenderer,r=t.minScale,o=(0,qe.VS)(a),n=.25*o,s=o*e;let l=s;const c=[];for(;l>n;)c.push(l),l/=2;c.push(l);const{lods:h}=Be.Z.create({scales:c});if(t.set({minScale:s,lods:h}),this._imageChanged)return this.imageRenderer.scale=s,void(this._imageChanged=!1);this.imageRenderer.scale=Math.abs(i-r)<=1e-6?s:i}),l.syncAndInitial),"resize")},this._loadImageInternal=function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.clearImage(),t.error=null,t._imageChanged=!0,t.state="image-loading";const a="string"==typeof e,r=a?void 0:e.datasetFormat,o=a?e:e.url,{customParameters:s,options:l}=i;return t._image=new Ge.default({ioConfig:{skipExtensions:["aux.xml","jgw"],skipMapInfo:!0,datasetFormat:r},url:o,customParameters:s}),t._image.when((e=>{t._updatePanConstraint(),t._createResizeHandles(e),t._map.add(e),t.state="image-loaded"}),(i=>{(0,E.D_)(i)?t.state="image-load-aborted":(t.state="image-load-error",t.error=i,n.Z.getLogger(t).error("error occurred while loading image ".concat(a?e:JSON.stringify(e)),i),t.imageSource=null)})),t._image.load(l)},this._loadWithController=()=>{this._cancelLoadWithController(),this._loadController=new AbortController,this.loadImage(this._loadController)},this._updatePanConstraint=()=>{this._panConstraint&&this.imageRenderer.constraints.customConstraints.remove(this._panConstraint),this._panConstraint=this._createPanConstraint(),this.imageRenderer.constraints.customConstraints.add(this._panConstraint)},this.addGraphic=(e,t)=>{this._overlays.graphics.add(e,t)},this.addManyGraphics=e=>{this._overlays.addMany(e)},this.clearGraphics=()=>{this._overlays.graphics.removeAll()},this.clearImage=()=>{this.image&&(this._map.layers.remove(this.image),this._image=(0,T.SC)(this._image))},this.loadImage=e=>{const{customParameters:t,imageSource:i}=this;return i?this._loadImageInternal(i,{customParameters:t,options:e}):pe(this.declaredClass,new O.Z(de("image-viewer"),ue("ImageViewerViewModel","imageSource")))},this.removeGraphic=e=>{this._overlays.remove(e)},this.removeManyGraphics=e=>{this._overlays.removeMany(e)},this._imageRenderer=new ke.default({constraints:{snapToZoom:!0,rotationEnabled:!1},map:this._map,popupEnabled:!1,spatialReference:Pe.Z.WebMercator,ui:{components:["zoom"]}})}initialize(){this.state="initialized",this.addHandles([(0,l.watch)((()=>this.imageSource),(e=>{e&&this.autoLoad&&this._loadWithController()}),l.syncAndInitial),(0,l.watch)((()=>{var e;return null===(e=this.image)||void 0===e?void 0:e.loaded}),(()=>{this._createImageHandles()})),(0,l.watch)((()=>this.imageRotation),(()=>{this._rotateImage()})),(0,l.watch)((()=>this.imageRenderer.map),((e,t)=>{null!==t&&void 0!==t&&t.layers.remove(this._overlays),null===e||void 0===e||e.layers.add(this._overlays)}),l.initial),(0,l.watch)((()=>this.imageRenderer.map.allLayers.length),(e=>{e&&this.imageRenderer.map.layers.reorder(this._overlays,e-1)}),l.syncAndInitial),(0,l.watch)((()=>this.clickAction),(e=>{this.removeHandles(Qe),"none"!==e&&this.addHandles(this.imageRenderer.on("click",(t=>{var i;if(null!==(i=this.image)&&void 0!==i&&i.loaded&&this.imageRenderer.ready)switch(e){case"emit":t.stopPropagation(),this.emit("click",t);break;case"hittest":t.stopPropagation(),t.async((async()=>{const e=await this.imageRenderer.hitTest(t.screenPoint,{include:this._overlays});this.emit("hittest-response",e)}));break;case"pixel-location":{var a;if(t.stopPropagation(),null===(a=this.image)||void 0===a||!a.serviceRasterInfo||!t.mapPoint)return void this.emit("pixel-location",null);const{extent:e,pixelSize:i}=this.image.serviceRasterInfo,r=(t.mapPoint.x-e.xmin)*i.x,o=(e.ymax-t.mapPoint.y)*i.y,n=new Ke.Z({x:r,y:o,spatialReference:e.spatialReference});this.emit("pixel-location",n);break}}})))}),l.syncAndInitial)])}get brightness(){var e;return null!==(e=this._get("brightness"))&&void 0!==e?e:0}set brightness(e){this._set("brightness",(0,s.uZ)(e,-10,10))}get contrast(){var e;return null!==(e=this._get("contrast"))&&void 0!==e?e:0}set contrast(e){this._set("contrast",(0,s.uZ)(e,-10,10))}get image(){return this._image}get imagePointsInView(){var e,t,i;const{extent:a,ready:r}=this.imageRenderer,o=this.imageRotation,n=null===(e=this.image)||void 0===e?void 0:e.fullExtent,s=null===(t=this.image)||void 0===t?void 0:t.serviceRasterInfo,l=!0===(null===(i=this._imageRenderer.allLayerViews.find((e=>{let{layer:t}=e;return t===this.image})))||void 0===i?void 0:i.attached);if(!(r&&a&&n&&s&&l))return null;const c=(0,je.rotate)(Ue.Z.fromExtent(a),o),h=Ue.Z.fromExtent(n),d=(0,je.intersect)(c,h),{rings:u}=d;return u.flat().map((e=>{let[t,i]=e;return{x:(t-s.extent.xmin)*s.pixelSize.x,y:(s.extent.ymax-i)*s.pixelSize.y}}))}get imageSize(){const{image:e}=this;if(null===e||void 0===e||!e.raster)return null;const{width:t,height:i}=e.raster.rasterInfo;return[t,i]}get imageRenderer(){return this._imageRenderer}get imageView(){return this.imageRenderer.allLayerViews.find((e=>e.layer===this.image))}get sharpness(){var e;return null!==(e=this._get("sharpness"))&&void 0!==e?e:0}set sharpness(e){this._set("sharpness",(0,s.uZ)(e,0,1))}_rotateImage(){this.imageRenderer.constraints.rotationEnabled=!0,this.imageRenderer.rotation=this.imageRotation,this.imageRenderer.constraints.rotationEnabled=!1}sharpenImage(e,t){if(!t)return void(e.rasterFunction=null);const i=[0,-1*t,0,-1*t,4*t+1,-1*t,0,-1*t,0],a=new He.Z({functionName:"Convolution",functionArguments:{type:We.z8.userDefined,cols:3,rows:3,kernel:i,convolutionType:We.z8.userDefined}});e.rasterFunction=a}};(0,a._)([(0,c.Cb)()],Ye.prototype,"_image",void 0),(0,a._)([(0,c.Cb)()],Ye.prototype,"_imageRenderer",void 0),(0,a._)([(0,c.Cb)()],Ye.prototype,"_loadController",void 0),(0,a._)([(0,c.Cb)()],Ye.prototype,"_overlays",void 0),(0,a._)([(0,c.Cb)()],Ye.prototype,"_map",void 0),(0,a._)([(0,c.Cb)({type:Boolean})],Ye.prototype,"autoLoad",void 0),(0,a._)([(0,c.Cb)({type:Number})],Ye.prototype,"brightness",null),(0,a._)([(0,c.Cb)()],Ye.prototype,"clickAction",void 0),(0,a._)([(0,c.Cb)({type:Number})],Ye.prototype,"contrast",null),(0,a._)([(0,c.Cb)({type:Object})],Ye.prototype,"customParameters",void 0),(0,a._)([(0,c.Cb)({type:O.Z})],Ye.prototype,"error",void 0),(0,a._)([(0,c.Cb)({readOnly:!0})],Ye.prototype,"image",null),(0,a._)([(0,c.Cb)({readOnly:!0})],Ye.prototype,"imagePointsInView",null),(0,a._)([(0,c.Cb)({readOnly:!0})],Ye.prototype,"imageSize",null),(0,a._)([(0,c.Cb)({cast:function(e){return"string"==typeof e&&e.length?e:function(e){return e&&e.url&&e.datasetFormat?e:null}(e)}})],Ye.prototype,"imageSource",void 0),(0,a._)([(0,c.Cb)({readOnly:!0})],Ye.prototype,"imageRenderer",null),(0,a._)([(0,c.Cb)({type:Number})],Ye.prototype,"imageRotation",void 0),(0,a._)([(0,c.Cb)()],Ye.prototype,"imageView",null),(0,a._)([(0,c.Cb)({type:Number})],Ye.prototype,"sharpness",null),(0,a._)([(0,c.Cb)()],Ye.prototype,"state",void 0),Ye=(0,a._)([(0,h.j)("esri.widgets.OrientedImageryViewer.components.ImageViewerViewModel")],Ye);const $e=Ye;let Xe=class extends p.Z{constructor(){super(...arguments),this.viewModel=new $e,this._afterContainerCreate=e=>{this.imageRenderer.container=e},this.addGraphic=(e,t)=>{this.viewModel.addGraphic(e,t)},this.addManyGraphics=e=>{this.viewModel.addManyGraphics(e)},this.clearGraphics=()=>{this.viewModel.clearGraphics()},this.clearImage=()=>{this.viewModel.clearImage()},this.loadImage=async e=>this.viewModel.loadImage(e),this.removeGraphic=e=>{this.viewModel.removeGraphic(e)},this.removeManyGraphics=e=>{this.viewModel.removeManyGraphics(e)}}get autoLoad(){return this.viewModel.autoLoad}set autoLoad(e){this.viewModel.autoLoad=e}get brightness(){return this.viewModel.brightness}set brightness(e){this.viewModel.brightness=e}get clickAction(){return this.viewModel.clickAction}set clickAction(e){this.viewModel.clickAction=e}get contrast(){return this.viewModel.contrast}set contrast(e){this.viewModel.contrast=e}get customParameters(){return this.viewModel.customParameters}set customParameters(e){this.viewModel.customParameters=e}get error(){return this.viewModel.error}get imageSize(){var e;const t=null===(e=this.viewModel.image)||void 0===e?void 0:e.serviceRasterInfo;return t?[t.width,t.height]:[0,0]}get imagePointsInView(){return this.viewModel.imagePointsInView}get imageRenderer(){return this.viewModel.imageRenderer}get imageRotation(){return this.viewModel.imageRotation}set imageRotation(e){this.viewModel.imageRotation=e}get imageSource(){return this.viewModel.imageSource}set imageSource(e){this.viewModel.imageSource=e}get sharpness(){return this.viewModel.sharpness}set sharpness(e){this.viewModel.sharpness=e}get state(){return this.viewModel.state}render(){return(0,Ee.u)("div",{afterCreate:this._afterContainerCreate,bind:this,class:this.classes(Ze.z.widget,"esri-image-viewer")})}};(0,a._)([(0,c.Cb)({type:Boolean})],Xe.prototype,"autoLoad",null),(0,a._)([(0,c.Cb)({type:Number}),(0,c.Cb)()],Xe.prototype,"brightness",null),(0,a._)([(0,c.Cb)()],Xe.prototype,"clickAction",null),(0,a._)([(0,c.Cb)({type:Number})],Xe.prototype,"contrast",null),(0,a._)([(0,c.Cb)({type:Object})],Xe.prototype,"customParameters",null),(0,a._)([(0,c.Cb)({readOnly:!0})],Xe.prototype,"error",null),(0,a._)([(0,c.Cb)()],Xe.prototype,"imageSize",null),(0,a._)([(0,c.Cb)({readOnly:!0})],Xe.prototype,"imagePointsInView",null),(0,a._)([(0,c.Cb)({readOnly:!0,type:ke.default})],Xe.prototype,"imageRenderer",null),(0,a._)([(0,c.Cb)()],Xe.prototype,"imageRotation",null),(0,a._)([(0,c.Cb)()],Xe.prototype,"imageSource",null),(0,a._)([(0,Te.s)(["click","hittest-response","pixel-location"]),(0,c.Cb)({type:$e})],Xe.prototype,"viewModel",void 0),(0,a._)([(0,c.Cb)({type:Number})],Xe.prototype,"sharpness",null),(0,a._)([(0,c.Cb)({readOnly:!0})],Xe.prototype,"state",null),Xe=(0,a._)([(0,h.j)("esri.widgets.OrientedImageryViewer.components.ImageViewer")],Xe);const et=Xe,tt="view-click",it="image-click",at="interaction-handles",rt=new Set(["JPG","JPEG"]),ot=/\.(\w+)$/;let nt=class extends A.Z.EventedAccessor{constructor(e){super(e),this.additionalFeatures=new z.Z,this.bestFeatureAngle=0,this.coverageFrustums=new z.Z,this.coveragePolygons=new z.Z,this.currentBestFeature=null,this.currentCoverageVisible=!0,this.determineWorkflowForFeature=()=>{(0,T.IM)(this._featureChangedTask),this._featureChangedTask=(0,R.vr)((async e=>{const{currentBestFeature:t,selectedPoint:i,view:a}=this;if(null!==a&&void 0!==a&&a.closePopup(),t&&i){this._initialCurrentCoverageUpdate=!0;try{await this._updatePointsAndPolygons({signal:e}),await this._loadImage({signal:e})}catch(f){(0,E.D_)(f)||(this.loadImageError(f),n.Z.getLogger(this).error("#loadIImage()","error occured while loading image",f))}}}))},this.disabled=!1,this.displayMessage={key:"onLoadMessage",type:"info"},this.drawFootprint=()=>{this.bestFeatureFootprint&&this.updateCurrentCoveragePolygon(this.bestFeatureFootprint)},this.features=new z.Z,this.isAdditionalCoverageVisible=!1,this.isAdditionalPointSourcesVisible=!1,this.layer=null,this.localPort=null,this.mapImageConversionToolState=!1,this.navigatorCurrentBestFeature=null,this.pointSources=new z.Z,this.previousFeatureAngle=0,this.selectedPoint=null,this.shouldShowSelectedImage=!1,this.updateFootprint=async(e,t)=>{var i;"image-loaded"===this.state&&await(null===(i=this._adapter)||void 0===i?void 0:i.updateFootprint(e,t))},this.updateFootprintPanorama=async(e,t)=>{var i;await(null===(i=this._adapter)||void 0===i?void 0:i.updateFootprintPanorama(e,t))},this._adapter=null,this.additionalFootprints=new z.Z,this.additionalCameraLocations=new z.Z,this.bestFeatureCurrentFootprint=null,this._fetchFeaturesController=null,this._highlightedFeatureHandle=null,this._imageViewer=new et,this.bestFeatureFootprint=null,this._initialCurrentCoverageUpdate=!0,this._loading=!1,this._overlays=new D.default({listMode:"hide",internal:!0,elevationInfo:{mode:"absolute-height"}}),this._panoramicViewer=new Le,this._referencePointOnGround=null,this._referencePointOnImage=null,this._sectorData=null,this._crossSymbol=null,this.footprintExtent=null,this._featureChangedTask=null,this._openPopupTask=null,this._suitabilities=null,this._transformController=new AbortController,this._updateFootprintTask=null,this.highlight=e=>{var t;if(!this._overlaysView)return;this.removeHighlight();const i=this.additionalFootprints.find((t=>{let{attributes:{imageID:i}}=t;return i===Number(e)}));this._highlightedFeatureHandle=i?null===(t=this._overlaysView)||void 0===t?void 0:t.highlight(i):null},this.loadImageFromSource=async(e,t)=>{var i,a;const{mode:r,imageRotation:o,options:s}=t,l="string"==typeof e,c=l?e:e.url;let h=l?null!==(i=null===(a=e.match(ot))||void 0===a?void 0:a[1])&&void 0!==i?i:"":e.datasetFormat;if(!h){var u;const e=await(async(e,t)=>{try{var i;const a=await(0,re.Z)(e,{...t,method:"head"});return null===a||void 0===a||null===(i=a.getHeader)||void 0===i?void 0:i.call(a,"Content-Type")}catch(s){return n.Z.getLogger("esri.widgets.OrientedImagery").error("failed to fetch Content-Type",s),null}})(c,{...t.options});e&&(h=e.split("/")[1]),null!==(u=h)&&void 0!==u||(h="UNKNOWN FORMAT")}switch(r){case"default":{this._imageViewer.imageSource={datasetFormat:h.toUpperCase(),url:c};const e=new URL(c);this._imageViewer.customParameters=Object.fromEntries(e.searchParams),this._imageViewer.imageRotation=null!==o&&void 0!==o?o:0,await this._imageViewer.loadImage(s);break}case"panoramic":if(this._loading=!0,rt.has(h.toUpperCase())){const{selectedPoint:e}=this,{pitch:i,yaw:a,cameraLocation:r,viewAngle:o}=t;this._panoramicViewer.imageSource=c;let n=null!==a&&void 0!==a?a:0;"number"==typeof o?n=o-n:r&&e&&(n=await(0,d._6)(r,e)-n),this._panoramicViewer.pitch=null!==i&&void 0!==i?i:0,this._panoramicViewer.yaw=n,this._loading=!1,await this._panoramicViewer.loadImage(s)}else this.setMessage("unsupportedPanoramicImageryError","error",void 0,{datasetFormat:h})}},this.loadImageViewer=e=>{this._imageViewer.container=e},this.loadPanoramicViewer=e=>{this._panoramicViewer.container=e},this.removeHighlight=()=>{var e;return null===(e=this._highlightedFeatureHandle)||void 0===e?void 0:e.remove()},this.toggleImageAttributes=()=>{(0,T.IM)(this._openPopupTask),this._openPopupTask=(0,R.vr)((async e=>{const{currentBestFeature:t,popupEnabled:i,layer:a,view:r}=this;if(null!==r&&void 0!==r&&r.closePopup(),!(r&&t&&i&&a))return;const{attributes:o,geometry:n}=t,s=new P.Z({geometry:n,attributes:o.toJSON(),popupTemplate:a.popupTemplate});(0,E.k_)(e),await r.openPopup({features:[s],location:o.location.clone()})}))},this._getImageSourceFromAttachment=async(e,t,i)=>{var a;const r=new $.Z({objectIds:[t]}),o=null===(a=(await e.queryAttachments(r,i))["".concat(t)])||void 0===a?void 0:a[0],n=null===o||void 0===o?void 0:o.url;if(!n)throw new O.Z("NoAttachmentError","no attachments found",{[e.objectIdField]:t,layer:e});return{datasetFormat:o.contentType.split("/")[1].toUpperCase(),url:n}},this._loadImage=async e=>{const{currentBestFeature:t,layer:i,mode:a}=this;if(this.clearGraphics(),!i||!t||"none"===a)return;const{attributes:r}=t,{imagePath:o,imageRotation:s,cameraHeading:l,cameraRoll:c,cameraPitch:h,objectId:d,cameraOrientation:u,location:p}=r,m=(null!==c&&void 0!==c?c:0)+(null!==s&&void 0!==s?s:0),g=p.spatialReference.isWGS84&&4!==(null===u||void 0===u?void 0:u.type)?(0,L.$)(p):new Ke.Z(p);let v=o;if((e=>"FA"===e)(o))try{v=await this._getImageSourceFromAttachment(i,d,e)}catch(y){if((0,E.D_)(y))return;return function(e){return"NoAttachmentError"===(null===e||void 0===e?void 0:e.name)}(y)?(n.Z.getLogger(this).error(y),void this.setMessage("noAttachment","error","".concat(i.objectIdField,": ").concat(d))):(n.Z.getLogger(this).error(y,{[i.objectIdField]:d,layer:i}),void this.setMessage("imageLoadError","error","query-attachments-failed:".concat(i.objectIdField," ").concat(d)))}try{await this.loadImageFromSource(v,{imageRotation:m,options:e,pitch:h,yaw:l,mode:a,cameraLocation:g}),(0,E.k_)(e),await this.transformAndPlotSelectedLocation(e)}catch(y){(0,E.D_)(y)||this.loadImageError(y)}},this._mapImageConversionToolViewClickHandler=e=>{e.stopPropagation(),e.preventDefault(),e.mapPoint&&this.plotMapPoint(e.mapPoint)},this._viewClickHandler=e=>{"mouse"===e.pointerType&&0!==e.button||(e.stopPropagation(),e.preventDefault(),e.mapPoint&&this.loadBestImage(e.mapPoint))},this.plotSelectedPointOnImage=async(e,t)=>{if(await(0,E.Yn)(t),!e)return;const i=new Ke.Z({...(0,V.AK)(e)?e.toJSON():e,spatialReference:Pe.Z.WebMercator});if("default"===this.mode)i.x-=.5,i.y=.5-i.y,this._crossSymbol=new P.Z({geometry:i,symbol:De.tA}),this._imageViewer.addGraphic(this._crossSymbol,0);else if("panoramic"===this.mode){const{imageSize:t}=this._panoramicViewer;if(!t)return;const[i,a]=t,{heading:r,pitch:o}=(0,d.If)(e,i,a),n=(0,d.n_)(r,o);this._crossSymbol=new P.Z({geometry:new Ke.Z(n,Pe.Z.WebMercator),symbol:De.OH}),this._panoramicViewer.addGraphic(this._crossSymbol,0)}},this.handleSectorClick=this.handleSectorClick.bind(this),this.searchBestImage=this.searchBestImage.bind(this),this.transformAndPlotReferencePointOnImage=this.transformAndPlotReferencePointOnImage.bind(this),this.updateSuitabilities=this.updateSuitabilities.bind(this),this.determineWorkflowForFeature=this.determineWorkflowForFeature.bind(this),this.selectBestFeature=this.selectBestFeature.bind(this),this.drawFootprint=this.drawFootprint.bind(this)}initialize(){this.addHandles([(0,l.watch)((()=>this.view),(async e=>{if(e){switch(this._loading=!0,e.type){case"2d":{const{default:e}=await i.e(3044).then(i.bind(i,3044));this._adapter=new e(this);break}case"3d":{const{default:e}=await i.e(22705).then(i.bind(i,22705));this._adapter=new e(this);break}}this._loading=!1}else this._adapter=null}),l.syncAndInitial),(0,l.watch)((()=>{var e;return null===(e=this.view)||void 0===e?void 0:e.map}),((e,t)=>{null!==t&&void 0!==t&&t.layers.remove(this._overlays),null===e||void 0===e||e.layers.add(this._overlays)}),l.initial),(0,l.watch)((()=>{var e;return null===(e=this.view)||void 0===e||null===(e=e.map)||void 0===e||null===(e=e.allLayers)||void 0===e?void 0:e.length}),(e=>{var t;e&&(null===(t=this.view)||void 0===t||null===(t=t.map)||void 0===t||t.layers.reorder(this._overlays,e-1))}),l.initial),(0,l.watch)((()=>[this.state,this.mapImageConversionToolState,this.view]),(()=>{if(this.removeHandles(tt),"disabled"===this.state||null==this.view)return;const e=this.mapImageConversionToolState&&"image-loaded"===this.state?this._mapImageConversionToolViewClickHandler:this._viewClickHandler;this.addHandles(this.view.on("click",e,X.f.WIDGET),tt),this.removeHandles(it);const{mapImageConversionToolState:t,mode:i}=this;if(t&&"none"!==i)switch(i){case"default":this._imageViewer.clickAction="pixel-location",this.addHandles(this._imageViewer.on("pixel-location",(async e=>{this.plotReferencePointOnImage(e);const t=this.currentBestFeature;if(t){var i;const a=(await(0,Y.y)([e.toJSON()],{feature:t,imageProperties:{width:this._imageViewer.imageSize[0],height:this._imageViewer.imageSize[1]},options:{signal:null===(i=this._transformController)||void 0===i?void 0:i.signal},footprintExtent:this.footprintExtent}))[0];a&&this.plotReferencePointOnGround(a)}})),it);break;case"panoramic":this._panoramicViewer.clickAction="pixel-location",this.addHandles(this._panoramicViewer.on("pixel-location",(async e=>{this.plotReferencePointOnImage(e);const t=this.currentBestFeature,{imageSize:i}=this._panoramicViewer;if(t&&e&&i){var a;const r=(await(0,Y.y)([e],{feature:t,imageProperties:{width:i[0],height:i[1]},options:{signal:null===(a=this._transformController)||void 0===a?void 0:a.signal},footprintExtent:this.footprintExtent}))[0];r&&this.plotReferencePointOnGround(r)}})),it)}}),l.syncAndInitial),(0,l.watch)((()=>this.bestFeatureAngle),((e,t)=>{this.previousFeatureAngle=null!==t&&void 0!==t?t:0}),l.syncAndInitial),(0,l.watch)((()=>this.currentBestFeature),((e,t)=>{this.determineWorkflowForFeature(e,t)}),{sync:!0}),(0,l.watch)((()=>this.mode),(e=>{switch(this.removeHandles(at),e){case"default":this.addHandles((0,l.watch)((()=>this._imageViewer.imagePointsInView),(e=>{e&&((0,T.IM)(this._updateFootprintTask),this._updateFootprintTask=(0,R.vr)((async t=>{await this.updateFootprint(e,{signal:t})})))}),{...l.syncAndInitial,equals:(e,t)=>(0,F.fS)(e,t,Z.y7)}),at);break;case"panoramic":this.addHandles((0,l.watch)((()=>{const{currentBestFeature:e}=this,{imageSize:t,vfov:i,hfov:a,pitch:r,yaw:o}=this._panoramicViewer;return e&&t?[i,a,o,r]:null}),(e=>{if(!e||"image-loading"===this.state)return;const[t,i,a,r]=e;(0,T.IM)(this._updateFootprintTask),this._updateFootprintTask=(0,R.vr)((async e=>{await this.updateFootprintPanorama({verticalFieldOfView:t,horizontalFieldOfView:i,yaw:a,pitch:r},{signal:e})}))}),{...l.syncAndInitial,equals:(e,t)=>(0,F.fS)(e,t,Z.y7)}),at)}}),l.syncAndInitial),(0,l.watch)((()=>[this.brightness,this.contrast,this.sharpness]),(()=>{const{_imageViewer:e,brightness:t,contrast:i,mode:a,sharpness:r}=this;"default"===a&&(e.brightness=t,e.contrast=i,e.sharpness=r)}),l.syncAndInitial)])}destroy(){var e;this._updateFootprintTask=(0,T.IM)(this._updateFootprintTask),this._cancelFetchingFeatures(),this.coverageFrustums.destroy(),this.coveragePolygons.destroy(),this.pointSources.destroy(),this.additionalFootprints.destroy(),this.additionalCameraLocations.destroy(),this.bestFeatureFootprint=(0,T.SC)(this.bestFeatureFootprint),this.bestFeatureCurrentFootprint=(0,T.SC)(this.bestFeatureCurrentFootprint),this._crossSymbol=(0,T.SC)(this._crossSymbol),this._referencePointOnGround=(0,T.SC)(this._referencePointOnGround),this._referencePointOnImage=(0,T.SC)(this._referencePointOnImage),this._overlays&&null!==(e=this.view)&&void 0!==e&&null!==(e=e.map)&&void 0!==e&&e.remove(this._overlays),this._overlays.destroy()}get activeLayer(){return(0,o.Mr)(n.Z.getLogger(this),"activeLayer",{replacement:"layer"}),this.layer}set activeLayer(e){(0,o.Mr)(n.Z.getLogger(this),"activeLayer",{replacement:"layer"}),this.layer=e}get activeViewer(){const{_imageViewer:e,_panoramicViewer:t,mode:i}=this;switch(i){case"default":return e;case"panoramic":return t;default:return null}}get brightness(){var e;return null!==(e=this._get("brightness"))&&void 0!==e?e:0}set brightness(e){this._set("brightness",e>10?10:e<-10?-10:e)}get contrast(){var e;return null!==(e=this._get("contrast"))&&void 0!==e?e:0}set contrast(e){this._set("contrast",(0,s.uZ)(e,-10,10))}get featureCount(){var e,t;return null!==(e=null===(t=this.features)||void 0===t?void 0:t.length)&&void 0!==e?e:0}get imageGalleryEnabled(){var e;return he(null===(e=this.currentBestFeature)||void 0===e?void 0:e.attributes.imagePath.trim())}get imageLoaded(){return(0,o.Mr)(n.Z.getLogger(this),"imageLoaded",{replacement:'Use OrientedImageryViewer.state === "image-loaded"',version:"4.29",warnOnce:!0}),"image-loaded"===this.state}get imagePointsInView(){const{mode:e,_imageViewer:t}=this;return"default"===e?t.imagePointsInView:null}get mode(){var e;const t=null===(e=this.currentBestFeature)||void 0===e?void 0:e.attributes;if(!t)return"none";const{horizontalFieldOfView:i,isSpherical:a}=t;return 360===i||a?"panoramic":"default"}get popupEnabled(){return null!==this.layer&&this.layer.popupEnabled}get referencePoint(){var e;return null===(e=this._referencePointOnGround)||void 0===e?void 0:e.geometry}get sectorData(){const{_sectorData:e}=this;return e?M.map((t=>e[t])):null}get sharpness(){var e;return null!==(e=this._get("sharpness"))&&void 0!==e?e:0}set sharpness(e){this._set("sharpness",(0,s.uZ)(e,0,1))}get state(){const{mode:e,disabled:t}=this;if(t)return"disabled";if(this._loading)return"image-loading";switch(e){case"default":return this._imageViewer.state;case"panoramic":return this._panoramicViewer.state}return"ready"}get thumbnails(){const{features:e}=this;return e?new z.Z(e.map((e=>{let{attributes:{imagePath:t,objectId:i,cameraRoll:a,imageRotation:r}}=e;const o=t.trim();return he(o)?{url:o,objectId:i,rotation:(null!==a&&void 0!==a?a:0)+(null!==r&&void 0!==r?r:0)}:null})).filter(F.pC)):null}set view(e){this._set("view",e)}get _overlaysView(){var e;return null===(e=this.view)||void 0===e?void 0:e.layerViews.find((e=>{let{layer:t}=e;return t===this._overlays}))}filterByFootprints(e,t){const i=[],a=[],r=[];return e.forEach((e=>{const{layer:{coveragePercent:o},attributes:n}=e;let s;const{polygon:l,frustum:c}=(0,Q.QX)(n);if(s=l.clone(),n.isInspection&&(s=(0,Q.eC)(n)),o&&(s=(0,Q.Zk)(s,o)),(0,Q.RS)(s,t)){r.push(e);const{cameraHeading:t,geometry:o,objectId:s,cameraHeight:h}=n,d=o.clone();d.z=h,d.imageID=s,this.pointSources.push(d),-999!==t&&(i.push(l),c&&a.push(c))}})),{features:r,polygons:i,frustums:a}}getCurrentCoveragePolygon(){return this.bestFeatureCurrentFootprint}getCurrentBestFeaturePolygon(){return this.bestFeatureFootprint}handleSectorClick(e){var t;if(isNaN(e))return;const i=null===(t=this._sectorData)||void 0===t?void 0:t[M[e]];(null===i||void 0===i?void 0:i.length)&&this._updateCurrentBestFeature(i.at(0))}handleFeatureClick(e){var t;const{sector:i,featureIndexInSector:a}=e;if(isNaN(a))return;const r=null===(t=this._sectorData)||void 0===t?void 0:t[i];(null===r||void 0===r?void 0:r.length)&&this._updateCurrentBestFeature(r.at(a))}async loadBestImage(e){var t,i;this._loading=!0,null!==(t=this.view)&&void 0!==t&&t.closePopup(),this.displayMessage=null,this.selectedPoint=e.spatialReference.isGeographic?(0,L.$)(e):e.clone(),this.features.removeAll(),this.currentBestFeature=null,this.additionalFeatures.removeAll(),this.additionalFootprints.removeAll(),this.additionalCameraLocations.removeAll(),this.bestFeatureCurrentFootprint=(0,T.SC)(this.bestFeatureCurrentFootprint),null!==(i=this._overlays)&&void 0!==i&&i.removeAll(),await this._fetchFeaturesWithController(e)}loadImageError(e){n.Z.getLogger(this).error("oriented-imagery-viewer:load-image",e),this.setMessage("imageLoadError","error",e.message)}async plotMapPoint(e){var t;return this.plotReferencePoint(e),this.transformAndPlotReferencePointOnImage({feature:this.currentBestFeature,selectedLocation:e,options:{signal:null===(t=this._transformController)||void 0===t?void 0:t.signal}})}plotReferencePointOnGround(e){var t,i,a;this._referencePointOnGround&&(null!==(t=this._overlays)&&void 0!==t&&t.remove(this._referencePointOnGround),this._referencePointOnGround.destroy()),null!=e&&(this._referencePointOnGround=new P.Z({geometry:new Ke.Z({...e.toJSON()}),symbol:De.C$}),this.view?null===(i=this._overlays)||void 0===i||i.add(this._referencePointOnGround):this.emit("plot-ground-point",{data:{point:null===(a=this._referencePointOnGround)||void 0===a?void 0:a.geometry}}))}plotReferencePointOnImage(e){if("image-loaded"===this.state)switch(this._referencePointOnImage&&(this._imageViewer.removeGraphic(this._referencePointOnImage),this._panoramicViewer.removeGraphic(this._referencePointOnImage),this._referencePointOnImage.destroy()),this.mode){case"default":{const t=(0,V.AK)(e)?e.toJSON():e;t.x-=.5,t.y=.5-t.y,this._referencePointOnImage=new P.Z({geometry:new Ke.Z({spatialReference:this._imageViewer.imageRenderer.spatialReference,...t}),symbol:De.C$}),this._imageViewer.addGraphic(this._referencePointOnImage,0);break}case"panoramic":{const{imageSize:t}=this._panoramicViewer;if(!t)return;const[i,a]=t,{heading:r,pitch:o}=(0,d.If)(e,i,a),n=(0,d.n_)(r,o);this._referencePointOnImage=new P.Z({geometry:new Ke.Z(n,Pe.Z.WebMercator),symbol:De.mH}),this._panoramicViewer.addGraphic(this._referencePointOnImage,0);break}}}resetImage(){switch(this.setMessage("onLoadMessage","info"),this.mode){case"default":this._imageViewer.clearImage(),this._imageViewer.clearGraphics();break;case"panoramic":this._panoramicViewer.clearGraphics()}this._cancelFetchingFeatures()}async searchBestImage(e,t){try{const i=await B(e,t);i&&await this._processFeatureResponse(i,e.point,{signal:null===t||void 0===t?void 0:t.signal})}catch(i){(0,E.D_)(i)||(this.setMessage("imageLoadError","error",i.message),n.Z.getLogger(this).error("error occurred while finding best image",i))}}selectBestFeature(e){var t;this.currentBestFeature=null===(t=this.features)||void 0===t?void 0:t.find((t=>{let{attributes:i}=t;return i.objectId===Number(e)}))}setAdditionalCameraLocationsVisibility(e){this.additionalCameraLocations.forEach((t=>{t.visible=e}))}setAdditionalCoverageVisibility(e){this.additionalFootprints.forEach((t=>{t.visible=e}))}setCurrentCoverageVisibility(e){this.bestFeatureCurrentFootprint&&(this.bestFeatureCurrentFootprint.visible=e),this.currentBestFeatureLocation&&(this.currentBestFeatureLocation.visible=e)}setMapImageConversionToolState(e){this.mapImageConversionToolState=e}async transformAndPlotReferencePointOnImage(e){var t;const{selectedLocation:i,options:a}=e,r=null===(t=this.bestFeatureFootprint)||void 0===t?void 0:t.geometry,o=(0,N.oU)(r)&&r.contains(i),n="mesh"===(null===r||void 0===r?void 0:r.type)&&(null===r||void 0===r?void 0:r.extent.contains(i));if(!o&&!n)return;const s=await this.transformPoint(i,a);return s?(this.plotReferencePointOnImage(s),{x:s.x,y:s.y}):void 0}updateSuitabilities(e){this._suitabilities=e.sort(((e,t)=>e.suitability-t.suitability));const t=this._suitabilities.map((e=>e.feature));this._updateFeatures(t),this._groupFeaturesBySectors(),this._initialCurrentCoverageUpdate=!0}_cancelFetchingFeatures(e){const t=this._fetchFeaturesController;t&&t.abort(e),this._fetchFeaturesController=null}async _fetchFeatures(e,t){if(!this.view)return;const i=this.layer;if(i){const a={include:i},r=this.view.toScreen(e);if(!r)return;const o=await this.view.hitTest(r,a);this._processHitTestResults(i,o,t)}}async _fetchFeaturesWithController(e){this._cancelFetchingFeatures();const t=new AbortController,{signal:i}=t;this._fetchFeaturesController=t;try{await this._fetchFeatures(e,{signal:i}).finally((()=>{this._fetchFeaturesController=null}))}catch(a){this.setMessage("imageLoadError","error"),n.Z.getLogger(this).error("error occurred while fetching features",a)}}_groupFeaturesBySectors(){const{_suitabilities:e,additionalFeatures:t,currentBestFeature:i,features:a}=this;if(!(e&&t&&i&&a))return void(this._sectorData=null);this._sectorData={};for(const s of M)this._sectorData[s]=new z.Z;const r=e.map(((e,t)=>({...e,featureIndex:t})));r.sort(((e,t)=>e.trueSuitability-t.trueSuitability));const o=r.map((e=>{let{distance:t}=e;return t})),n=Math.max(...o);r.forEach((e=>{var t,i;const{distance:r,angle:o,featureIndex:s}=e,l=r/n*C[2],c=function(e,t){const i=e/t*C[2];return i<=C[0]?"NEAR":i<=C[1]?"":"FAR"}(r,n),h=function(e){return Math.abs(e)>=135?"WEST":e<-45&&e>-135?"SOUTH":e<=45?"EAST":"NORTH"}(o);if(!this._sectorData)return;const d=C[3]+l*Math.sin(o*Math.PI/180),u=C[3]+l*Math.cos(o*Math.PI/180);let p;const m=a.at(s),g=m===this.currentBestFeature,v=(null===(t=this.currentBestFeature)||void 0===t?void 0:t.attributes.cameraPitch)&&(null===(i=this.currentBestFeature)||void 0===i?void 0:i.attributes.cameraPitch)<5;if(g&&v)p=-90;else{const e=d-C[3],t=u-C[3],i=t/Math.sqrt(e**2+t**2);let a=180*Math.acos(i)/Math.PI;(e<0&&t<0||e<0&&t>0)&&(a*=-1),p=a}const y=""===c?h:"".concat(c,"_").concat(h);g&&(p===this.bestFeatureAngle?this.previousFeatureAngle=p:this.bestFeatureAngle=p,this.navigatorCurrentBestFeature=v?null:{x:d,y:u,direction:h});const f=this._sectorData[y];f.add({angle:o,featureIndex:s,x:d,y:u,objectID:m.attributes.objectId,sector:y,featureIndexInSector:f.length})}))}async _processFeatureResponse(e,t,i){var a;const{features:r}=e;if(null===r||void 0===r||!r.length)return this.setMessage("noImageError","error"),void(this.currentBestFeature=null);this.coveragePolygons.removeAll(),this.coverageFrustums.removeAll(),this.pointSources.removeAll();const{features:o,polygons:s,frustums:l}=this.filterByFootprints(r,t);if(!o.length)return this.setMessage("noImageError","error"),void(this.currentBestFeature=null);this.coveragePolygons.addMany(s),this.coverageFrustums.addMany(l);const c=new Ue.Z({spatialReference:s[0].spatialReference});for(const{rings:n}of s)c.addRing(n[0]);const h=[];for(const{geometry:n}of o)c.contains(n)||h.push(n);c.addRing(h);const d=c.extent;let u;if(function(e,t){0!==t&&(e.xmin/=t,e.xmax*=t,e.ymin/=t,e.ymax*=t)}(d,2),this.footprintExtent=d,null!==(a=this.view)&&void 0!==a&&a.supportsGround)try{u=await this.view.map.ground.createElevationSampler(d,i)}catch(I){(0,E.D_)(I)||n.Z.getLogger(this).error(I)}if(o[0].elevationSample=u,(u||o[0].attributes.elevationSource)&&d){const e=await(0,J.sg)([t],{feature:o[0],footprintExtent:d,options:i});if(e[0]){const i=e[0];t.elevation=i.z}}o[0].elevationSample&&o.forEach((e=>{e.elevationSample=o[0].elevationSample})),this._suitabilities=K({features:o,selectedPoint:t,camera:le(this.view)?this.view.camera:null,currentImage:this.currentBestFeature}),this.updateSuitabilities(this._suitabilities);const p=this._suitabilities.map((e=>e.feature));this.currentBestFeature=p[0],this._loading=!1}async _processHitTestResults(e,t,i){var a,r,o;const{screenPoint:n,results:[s]}=t,l="graphic"===(null===s||void 0===s?void 0:s.type)&&this.shouldShowSelectedImage,c=null!==(a=null===s||void 0===s?void 0:s.mapPoint)&&void 0!==a?a:null===(r=this.view)||void 0===r?void 0:r.toMap(n);if(!c)return;const h={layerInstanceOrURL:e,point:c,queryParams:{where:null!==(o=e.definitionExpression)&&void 0!==o?o:"1=1",maximumDistance:e.maximumDistance,objectIds:l?[s.graphic.getAttribute(e.objectIdField)]:void 0}};await this.searchBestImage(h,i)}_updateFeatures(e){if(!e.length)return this.currentBestFeature=null,void this.additionalFeatures.removeAll();this.features.removeAll(),this.features.addMany(e),this.currentBestFeature=e[0],e.length>1?this.additionalFeatures.addMany(e.slice(1)):this.additionalFeatures.removeAll()}async _updatePointsAndPolygons(e){const{pointSources:t,currentBestFeature:i,currentCoverageVisible:a,isAdditionalPointSourcesVisible:r}=this;if(i){var o;this.additionalFootprints.removeAll(),this.additionalCameraLocations.removeAll(),this.bestFeatureCurrentFootprint&&(this.bestFeatureCurrentFootprint.destroy(),this.bestFeatureCurrentFootprint=null,this.bestFeatureFootprint=null),await(null===(o=this._adapter)||void 0===o?void 0:o.createFootprints(e)),(0,E.k_)(e);for(const e of t)e.imageID===i.attributes.objectId?this.currentBestFeatureLocation=new P.Z({attributes:{imageID:e.imageID},geometry:e,symbol:De.Lr,visible:a}):this.additionalCameraLocations.push(new P.Z({attributes:{imageID:e.imageID},geometry:e,symbol:De.FH,visible:r}))}}_updateCurrentBestFeature(e){var t,i,a;if(!e)return;this.currentBestFeature=null===(t=this.features)||void 0===t?void 0:t.at(e.featureIndex);const r=(null===(i=this.currentBestFeature)||void 0===i?void 0:i.attributes.cameraPitch)&&(null===(a=this.currentBestFeature)||void 0===a?void 0:a.attributes.cameraPitch)<5;let o;if(r)o=-90;else{const t=e.x-C[3],i=e.y-C[3],a=i/Math.sqrt(t**2+i**2);let r=180*Math.acos(a)/Math.PI;(t<0&&i<0||t<0&&i>0)&&(r*=-1),o=r}o===this.bestFeatureAngle?this.previousFeatureAngle=o:this.bestFeatureAngle=o,this.navigatorCurrentBestFeature=r?null:{x:e.x,y:e.y,direction:e.sector.includes("_")?e.sector.split("_")[1]:e.sector}}clearGraphics(){this._imageViewer.clearGraphics(),this._panoramicViewer.clearGraphics()}plotReferencePoint(e){"mapPoint"in e?this.plotReferencePointOnGround(e.mapPoint):this.plotReferencePointOnGround(e)}setMessage(e,t,i,a){this._loading=!1,this.displayMessage={key:e,type:t,data:i,map:a}}async transformAndPlotSelectedLocation(e){const{currentBestFeature:t,selectedPoint:i,state:a}=this;if(this._crossSymbol&&(this._panoramicViewer.removeGraphic(this._crossSymbol),this._imageViewer.removeGraphic(this._crossSymbol),this._crossSymbol=(0,T.SC)(this._crossSymbol)),!i||!t||"image-loaded"!==a)return;let r;try{r=await this.transformPoint(i,e),(0,E.k_)(e),await this.plotSelectedPointOnImage(r,e)}catch(W){(0,E.D_)(W)||n.Z.getLogger(this).error("failed to transform map point to pixel, cross symbol will not be plotted on image",{error:W,selectedPoint:i,feature:t})}}async transformPoint(e,t){var i,a,r;if("none"===this.mode)return;const o=this.currentBestFeature,n=await(0,J.y5)([e],{feature:o,imageProperties:"default"===this.mode?this._imageViewer.viewModel.image.serviceRasterInfo:{width:null===(i=this._panoramicViewer.imageSize)||void 0===i?void 0:i[0],height:null===(a=this._panoramicViewer.imageSize)||void 0===a?void 0:a[1]},options:t},"3d"===(null===(r=this.view)||void 0===r?void 0:r.type));return n.length?n[0]:void 0}updateCurrentCoveragePolygon(e){const{additionalFootprints:t,additionalCameraLocations:i,currentBestFeature:a,currentBestFeatureLocation:r,currentCoverageVisible:o,selectedPoint:n,view:s,_adapter:l}=this,{attributes:{objectId:c},elevationSample:h}=a;var d;if(this._initialCurrentCoverageUpdate){if(null!==(d=this._overlays)&&void 0!==d&&d.removeAll(),this._initialCurrentCoverageUpdate=!1,this.bestFeatureCurrentFootprint=(0,T.SC)(this.bestFeatureCurrentFootprint),e&&(e.visible=o,this.bestFeatureCurrentFootprint=e),s){const e=[...t,...i,this.bestFeatureCurrentFootprint,r].filter(ce);s.supportsGround&&h&&null!==l&&void 0!==l&&l.updateGroundElevation&&l.updateGroundElevation(e,h),n&&e.push(new P.Z({geometry:n.clone(),symbol:De.tA.clone(),attributes:{imageID:c}})),this._overlays.graphics.addMany(e)}}else if(s){var u,p;this.bestFeatureCurrentFootprint&&(null!==(u=this._overlays)&&void 0!==u&&u.remove(this.bestFeatureCurrentFootprint),this.bestFeatureCurrentFootprint=(0,T.SC)(this.bestFeatureCurrentFootprint));const t=this.bestFeatureCurrentFootprint&&this._overlays?this._overlays.graphics.indexOf(this.bestFeatureCurrentFootprint):-1;e&&(this.bestFeatureCurrentFootprint=e,null!==s&&void 0!==s&&s.supportsGround&&h&&null!==l&&void 0!==l&&l.updateGroundElevation&&l.updateGroundElevation([e],h),e.visible=this.currentCoverageVisible,null===(p=this._overlays)||void 0===p||p.graphics.add(this.bestFeatureCurrentFootprint,t>=0?t:this._overlays.graphics.length-1))}}};(0,a._)([(0,c.Cb)()],nt.prototype,"activeLayer",null),(0,a._)([(0,c.Cb)({readOnly:!0})],nt.prototype,"activeViewer",null),(0,a._)([(0,c.Cb)()],nt.prototype,"additionalFeatures",void 0),(0,a._)([(0,c.Cb)()],nt.prototype,"bestFeatureAngle",void 0),(0,a._)([(0,c.Cb)({type:Number})],nt.prototype,"brightness",null),(0,a._)([(0,c.Cb)({type:Number})],nt.prototype,"contrast",null),(0,a._)([(0,c.Cb)()],nt.prototype,"coverageFrustums",void 0),(0,a._)([(0,c.Cb)()],nt.prototype,"coveragePolygons",void 0),(0,a._)([(0,c.Cb)()],nt.prototype,"currentBestFeature",void 0),(0,a._)([(0,c.Cb)()],nt.prototype,"currentCoverageVisible",void 0),(0,a._)([(0,c.Cb)({json:{write:!1}})],nt.prototype,"determineWorkflowForFeature",void 0),(0,a._)([(0,c.Cb)()],nt.prototype,"disabled",void 0),(0,a._)([(0,c.Cb)()],nt.prototype,"displayMessage",void 0),(0,a._)([(0,c.Cb)()],nt.prototype,"drawFootprint",void 0),(0,a._)([(0,c.Cb)({readOnly:!0})],nt.prototype,"featureCount",null),(0,a._)([(0,c.Cb)()],nt.prototype,"features",void 0),(0,a._)([(0,c.Cb)({readOnly:!0})],nt.prototype,"imageGalleryEnabled",null),(0,a._)([(0,c.Cb)({readOnly:!0})],nt.prototype,"imageLoaded",null),(0,a._)([(0,c.Cb)()],nt.prototype,"imagePointsInView",null),(0,a._)([(0,c.Cb)()],nt.prototype,"isAdditionalCoverageVisible",void 0),(0,a._)([(0,c.Cb)()],nt.prototype,"isAdditionalPointSourcesVisible",void 0),(0,a._)([(0,c.Cb)()],nt.prototype,"layer",void 0),(0,a._)([(0,c.Cb)({type:Number})],nt.prototype,"localPort",void 0),(0,a._)([(0,c.Cb)()],nt.prototype,"mapImageConversionToolState",void 0),(0,a._)([(0,c.Cb)({readOnly:!0,value:"none"})],nt.prototype,"mode",null),(0,a._)([(0,c.Cb)()],nt.prototype,"navigatorCurrentBestFeature",void 0),(0,a._)([(0,c.Cb)()],nt.prototype,"pointSources",void 0),(0,a._)([(0,c.Cb)({readOnly:!0})],nt.prototype,"popupEnabled",null),(0,a._)([(0,c.Cb)()],nt.prototype,"previousFeatureAngle",void 0),(0,a._)([(0,c.Cb)()],nt.prototype,"referencePoint",null),(0,a._)([(0,c.Cb)({readOnly:!0})],nt.prototype,"sectorData",null),(0,a._)([(0,c.Cb)()],nt.prototype,"selectedPoint",void 0),(0,a._)([(0,c.Cb)({type:Number})],nt.prototype,"sharpness",null),(0,a._)([(0,c.Cb)()],nt.prototype,"shouldShowSelectedImage",void 0),(0,a._)([(0,c.Cb)({readOnly:!0})],nt.prototype,"state",null),(0,a._)([(0,c.Cb)({readOnly:!0})],nt.prototype,"thumbnails",null),(0,a._)([(0,c.Cb)()],nt.prototype,"updateFootprint",void 0),(0,a._)([(0,c.Cb)()],nt.prototype,"updateFootprintPanorama",void 0),(0,a._)([(0,c.Cb)({value:null})],nt.prototype,"view",null),(0,a._)([(0,c.Cb)()],nt.prototype,"_adapter",void 0),(0,a._)([(0,c.Cb)({type:z.Z.ofType(P.Z)})],nt.prototype,"additionalFootprints",void 0),(0,a._)([(0,c.Cb)({type:z.Z.ofType(P.Z)})],nt.prototype,"additionalCameraLocations",void 0),(0,a._)([(0,c.Cb)()],nt.prototype,"bestFeatureCurrentFootprint",void 0),(0,a._)([(0,c.Cb)()],nt.prototype,"_fetchFeaturesController",void 0),(0,a._)([(0,c.Cb)()],nt.prototype,"_highlightedFeatureHandle",void 0),(0,a._)([(0,c.Cb)()],nt.prototype,"_imageViewer",void 0),(0,a._)([(0,c.Cb)({type:P.Z})],nt.prototype,"bestFeatureFootprint",void 0),(0,a._)([(0,c.Cb)()],nt.prototype,"_initialCurrentCoverageUpdate",void 0),(0,a._)([(0,c.Cb)()],nt.prototype,"_loading",void 0),(0,a._)([(0,c.Cb)()],nt.prototype,"_overlays",void 0),(0,a._)([(0,c.Cb)({readOnly:!0})],nt.prototype,"_overlaysView",null),(0,a._)([(0,c.Cb)()],nt.prototype,"_panoramicViewer",void 0),(0,a._)([(0,c.Cb)()],nt.prototype,"_referencePointOnGround",void 0),(0,a._)([(0,c.Cb)()],nt.prototype,"_referencePointOnImage",void 0),(0,a._)([(0,c.Cb)()],nt.prototype,"currentBestFeatureLocation",void 0),(0,a._)([(0,c.Cb)()],nt.prototype,"_sectorData",void 0),(0,a._)([(0,c.Cb)()],nt.prototype,"footprintExtent",void 0),nt=(0,a._)([(0,h.j)("esri.widgets.OrientedImageryViewer.OrientedImageryViewerViewModel")],nt);const st=nt;var lt=i(7138);let ct=class extends lt.default{constructor(){super(...arguments),this.closeButton=!0,this.coverageMenu=!0,this.imageEnhancement=!0,this.imageGallery=!0,this.mapImageConversionTool=!0,this.navigationTool=!0,this.title=!0,this.viewerTools=!0,this.showPopupsAction=!0}};(0,a._)([(0,c.Cb)({type:Boolean,nonNullable:!0})],ct.prototype,"closeButton",void 0),(0,a._)([(0,c.Cb)({type:Boolean,nonNullable:!0})],ct.prototype,"coverageMenu",void 0),(0,a._)([(0,c.Cb)({type:Boolean,nonNullable:!0})],ct.prototype,"imageEnhancement",void 0),(0,a._)([(0,c.Cb)({type:Boolean,nonNullable:!0})],ct.prototype,"imageGallery",void 0),(0,a._)([(0,c.Cb)({type:Boolean,nonNullable:!0})],ct.prototype,"mapImageConversionTool",void 0),(0,a._)([(0,c.Cb)({type:Boolean,nonNullable:!0})],ct.prototype,"navigationTool",void 0),(0,a._)([(0,c.Cb)({type:Boolean,nonNullable:!0})],ct.prototype,"title",void 0),(0,a._)([(0,c.Cb)({type:Boolean,nonNullable:!0})],ct.prototype,"viewerTools",void 0),(0,a._)([(0,c.Cb)({type:Boolean,nonNullable:!0})],ct.prototype,"showPopupsAction",void 0),ct=(0,a._)([(0,h.j)("esri.widgets.OrientedImageryViewer.OrientedImageryViewerVisibleElements")],ct);const ht=ct;var dt=i(8905),ut=i(80532),pt=i(8704);let mt=class extends p.Z{constructor(e,t){super(e,t),this.dockEnabled=!1,this.galleryOpened=!1,this.imageEnhancementToolActive=!1,this.navigationToolActive=!1,this.viewModel=new st,this.messagesCommon=null,this.visibleElements=new ht,this._navigationToolExpanded=!1,this._navigationTool=null,this._actionItems=new Map,this._galleryController=new AbortController,this._galleryObserver=new IntersectionObserver(this._lazyLoadImage.bind(this)),this._highlight=e=>{var t;const i=null===(t=e.target)||void 0===t?void 0:t.dataset.objectid;i&&this.viewModel.highlight(i)},this._removeHighlight=()=>this.viewModel.removeHighlight(),this._scaleNavigationTool=()=>{this._navigationToolExpanded=!this._navigationToolExpanded},this._toogleImageAttributes=()=>{this.viewModel.toggleImageAttributes()},this._loadImageFromGallery=this._loadImageFromGallery.bind(this),this._registerGalleryItem=this._registerGalleryItem.bind(this),this._unregisterGalleryItem=this._unregisterGalleryItem.bind(this),this._renderViewerContainer=this._renderViewerContainer.bind(this),this.loadImageFromSource=this.loadImageFromSource.bind(this),this.updateSuitabilities=this.updateSuitabilities.bind(this)}initialize(){this.addHandles([(0,l.watch)((()=>{var e;return[null===(e=this.viewModel)||void 0===e?void 0:e.bestFeatureAngle,this._navigationTool]}),(e=>{let[t,i]=e;i&&this._updateNavigationTool(i)}),l.initial),(0,l.watch)((()=>this.currentCoverageVisible),(e=>this._onCurrentCoverageVisibilityChange(e))),(0,l.watch)((()=>this.isAdditionalCoverageVisible),(e=>this._onAdditionalCoverageVisibilityChange(e))),(0,l.watch)((()=>this.isAdditionalPointSourcesVisible),(e=>this._onAdditionalCameraLocationsVisibility(e)))])}loadDependencies(){return(0,dt.h)({tooltip:()=>Promise.all([i.e(92358),i.e(89219),i.e(94730)]).then(i.bind(i,94730)),action:()=>Promise.all([i.e(92358),i.e(46895),i.e(65138),i.e(91741)]).then(i.bind(i,6814)),"action-group":()=>Promise.all([i.e(92358),i.e(46895),i.e(89219),i.e(63839),i.e(65138),i.e(2654),i.e(23635),i.e(70405)]).then(i.bind(i,70405)),"action-bar":()=>Promise.all([i.e(92358),i.e(46895),i.e(89219),i.e(63839),i.e(65138),i.e(2654),i.e(23635),i.e(68698)]).then(i.bind(i,68698)),label:()=>Promise.all([i.e(92358),i.e(35738)]).then(i.bind(i,35738)),panel:()=>Promise.all([i.e(92358),i.e(46895),i.e(89219),i.e(63839),i.e(65138),i.e(2654),i.e(23635),i.e(89524),i.e(85026)]).then(i.bind(i,85026)),slider:()=>Promise.all([i.e(92358),i.e(46895),i.e(54438),i.e(69008)]).then(i.bind(i,69008))})}destroy(){this._galleryController.abort(),this._galleryObserver.disconnect()}get activeLayer(){return(0,o.Mr)(n.Z.getLogger(this),"activeLayer",{replacement:"layer"}),this.layer}set activeLayer(e){(0,o.Mr)(n.Z.getLogger(this),"activeLayer",{replacement:"layer"}),this.layer=e}get currentBestFeature(){return this.viewModel.currentBestFeature}set currentBestFeature(e){this.viewModel.currentBestFeature=e}get currentCoverageVisible(){return this.viewModel.currentCoverageVisible}set currentCoverageVisible(e){this.viewModel.currentCoverageVisible=e}get disabled(){return this.viewModel.disabled}set disabled(e){this.viewModel.disabled=e}get displayMessage(){return this.viewModel.displayMessage}set drawFootprint(e){this.viewModel.drawFootprint=e}get drawFootprint(){return this.viewModel.drawFootprint}get features(){return this.viewModel.features}get imagePointsInView(){return this.viewModel.imagePointsInView}get isDocked(){return(0,o.Mr)(n.Z.getLogger(this),"isDocked",{replacement:"dockEnabled"}),this.dockEnabled}set isDocked(e){(0,o.Mr)(n.Z.getLogger(this),"isDocked",{replacement:"dockEnabled"}),this.dockEnabled=e}get icon(){return"oriented-imagery-widget"}set icon(e){this._overrideIfSome("icon",e)}get imageGalleryEnabled(){return this.viewModel.imageGalleryEnabled}get isAdditionalCoverageVisible(){return this.viewModel.isAdditionalCoverageVisible}set isAdditionalCoverageVisible(e){this.viewModel.isAdditionalCoverageVisible=e}get isAdditionalPointSourcesVisible(){return this.viewModel.isAdditionalPointSourcesVisible}set isAdditionalPointSourcesVisible(e){this.viewModel.isAdditionalPointSourcesVisible=e}get mapImageConversionToolState(){return this.viewModel.mapImageConversionToolState}set mapImageConversionToolState(e){this.viewModel.mapImageConversionToolState=e}get layer(){return this.viewModel.layer}set layer(e){this.viewModel.layer=e}get popupEnabled(){const{popupEnabled:e,state:t}=this.viewModel;return"image-loaded"===t&&e}get referencePoint(){var e;return null!==(e=this.viewModel.referencePoint)&&void 0!==e?e:null}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}set determineWorkflowForFeature(e){this.viewModel.determineWorkflowForFeature=e}get determineWorkflowForFeature(){return this.viewModel.determineWorkflowForFeature}set updateFootprint(e){this.viewModel.updateFootprint=e}get updateFootprint(){return this.viewModel.updateFootprint}async _getThumbnailPixelBlockInternal(e,t){const{level:i,offset:a,size:r}=this._getMaxLevelRasterParameters(e);try{const{pixelBlock:o}=await e.fetchRawPixels(i,a,r,t);return o}catch(o){n.Z.getLogger(this).warn("failed to create canvas with pixel data",o)}return null}_getMaxLevelRasterParameters(e){const{storageInfo:t,width:i,height:a}=e.rasterInfo,{maximumPyramidLevel:r,pyramidScalingFactor:o}=t,n=null!==o&&void 0!==o?o:2;return{level:r,offset:{x:0,y:0},size:{width:Math.ceil(i/n**r),height:Math.ceil(a/n**r)}}}async _getThumbnailPixelBlock(e){const{signal:t}=this._galleryController;try{const i=await u.Z.open({url:e,signal:t});return i?await this._getThumbnailPixelBlockInternal(i,{signal:t}):null}catch(i){n.Z.getLogger(this).error("failed to create thumbnail",i)}return null}_handleBrightnessChange(e){var t;this.viewModel.brightness=null!==(t=e.target.value)&&void 0!==t?t:0}_handleContrastChange(e){var t;this.viewModel.contrast=null!==(t=e.target.value)&&void 0!==t?t:0}_handleSharpnessChange(e){var t;this.viewModel.sharpness=null!==(t=e.target.value)&&void 0!==t?t:0}_lazyLoadImage(e,t){e.forEach((async e=>{if(e.isIntersecting){const i=e.target,a=i.getAttribute("data-src"),r=i.getAttribute("data-rotation"),o=r?parseFloat(r)%360:null;if(!a)return;const l=await this._getThumbnailPixelBlock(a);if(!l)return;i.width=l.width,i.height=l.height;const c=i.getContext("2d");if(!c)return;const h=c.createImageData(i.width,i.height);if(h.data.set(l.getAsRGBA()),"number"==typeof o&&0!==o){const e=(0,s.Vl)(o),a=document.createElement("canvas"),r=a.getContext("2d");if(r){a.width=h.width,a.height=h.height,r.putImageData(h,0,0);const o=(0,d.Xt)(0,0,e),n=(0,d.Xt)(h.width,0,e),s=(0,d.Xt)(h.width,h.height,e),l=(0,d.Xt)(0,h.height,e),u=Math.max(o[0],n[0],s[0],l[0])-Math.min(o[0],n[0],s[0],l[0]),p=Math.max(o[1],n[1],s[1],l[1])-Math.min(o[1],n[1],s[1],l[1]),m=Math.min(i.width/u,i.height/p);return c.save(),c.clearRect(0,0,i.width,i.height),c.translate(i.width/2,i.height/2),c.rotate(e),c.scale(m,m),c.drawImage(a,-h.width/2,-h.height/2,h.width,h.height),c.restore(),t.unobserve(i)}n.Z.getLogger(this).warn("oriented-imagery-viewer:image-gallery","failed to apply rotation on thumbnail")}c.putImageData(h,0,0),t.unobserve(i)}}))}_loadImageFromGallery(e){var t;const{target:i}=e;if(!i)return;const a=i.getAttribute("data-objectid");a&&(null===(t=this.viewModel.currentBestFeature)||void 0===t?void 0:t.attributes.objectId)!==Number(a)&&this.viewModel.selectBestFeature(a)}_onAdditionalCoverageVisibilityChange(e){this.viewModel.setAdditionalCoverageVisibility(e)}_onAdditionalCameraLocationsVisibility(e){this.viewModel.setAdditionalCameraLocationsVisibility(e)}_onCurrentCoverageVisibilityChange(e){this.viewModel.setCurrentCoverageVisibility(e)}_registerGalleryItem(e){this._galleryObserver.observe(e)}_renderActionTooltips(){return[...this._actionItems].map((e=>{let[t,i]=e;return(0,Ee.u)("calcite-tooltip",{key:t,referenceElement:i},(0,Ee.u)("span",null,t))}))}_renderBody(){return(0,Ee.u)("div",{class:_.body},this._renderViewerContainer(),this._renderImageGallery(),this._renderImageEnhancementTools(),this._renderNavigation())}_renderImageEnhancementTools(){const{imageEnhancementToolActive:e,viewModel:{brightness:t,contrast:i,sharpness:a}}=this;return e&&(0,Ee.u)("calcite-panel",{bind:this,class:_.imageEnhancementWrapper,closable:!0,closed:!e,heading:this.messages.imageEnhancement,key:this.messages.imageEnhancement,onCalcitePanelClose:this._toggleImageEnhancementToolState},(0,Ee.u)("div",{class:_.imageEnhancementTools},(0,Ee.u)("div",{class:_.imageEnhancementToolContainer},(0,Ee.u)("calcite-label",null,this.messages.brightness,(0,Ee.u)("calcite-slider",{bind:this,labelTicks:!0,max:10,min:-10,ticks:5,value:t,onCalciteSliderInput:this._handleBrightnessChange}))),(0,Ee.u)("div",{class:_.imageEnhancementToolContainer},(0,Ee.u)("calcite-label",null,this.messages.contrast,(0,Ee.u)("calcite-slider",{bind:this,labelTicks:!0,max:10,min:-10,ticks:5,value:i,onCalciteSliderInput:this._handleContrastChange}))),(0,Ee.u)("div",{class:_.imageEnhancementToolContainer},(0,Ee.u)("calcite-label",null,this.messages.sharpness,(0,Ee.u)("calcite-slider",{bind:this,labelTicks:!0,max:1,min:0,step:.1,ticks:.5,value:a,onCalciteSliderInput:this._handleSharpnessChange})))),(0,Ee.u)("calcite-action",{bind:this,icon:"reset",onclick:this._resetImageTools,slot:"header-actions-end",text:this.messagesCommon.reset}))}_renderImageGallery(){const{container:e,galleryOpened:t,imageGalleryEnabled:i,viewModel:{thumbnails:a}}=this;return i&&t&&e&&a?(0,Ee.u)("calcite-panel",{bind:this,class:_.carousel,closable:!0,closed:!t,heading:this.messages.imageGallery,key:this.messages.imageGallery,onCalcitePanelClose:this._toggleImageGallery},(0,Ee.u)("div",{class:_.carouselContainer},this._renderThumbnails(a))):null}_renderMapImageConversionTool(){const{mapImageConversionToolState:e,viewModel:{state:t}}=this;return(0,Ee.u)("calcite-action",{active:e,afterCreate:this._storeActionElement,bind:this,disabled:"image-loaded"!==t,icon:"image-pin",onclick:this._toggleMapImageConversionToolState,text:this.messages.mapImageConversionTool})}_renderNavigation(){const{viewModel:{sectorData:e,navigatorCurrentBestFeature:t,currentBestFeature:i,state:a}}=this;if(!this.container||!i)return null;let o,n,s,l,c;if(t){const{x:e,y:i,direction:a}=t,[r,h,d,u]=S[a];o="M ".concat(e," ").concat(i," L ").concat(r," ").concat(h," A ").concat(C[2]," ").concat(C[2]," 0 0 1 ").concat(d," ").concat(u," Z"),n=e,l=i,s=S[a][4],c=S[a][5]}const h=e=>{var t;const i=null===(t=e.target.dataset)||void 0===t?void 0:t.sector;i&&this.viewModel.handleSectorClick(+i)},d=e=>{const t=e.target.dataset;if(!t)return;const{featureIndexInSector:i,sector:a}=t;i&&a&&this.viewModel.handleFeatureClick({sector:a,featureIndexInSector:+i})},u=e=>{e.removeEventListener("click",d)},p=i.attributes.objectId,m=null===e||void 0===e?void 0:e.map((e=>null===e||void 0===e?void 0:e.items)).filter(Boolean).flatMap((e=>null===e||void 0===e?void 0:e.map((e=>{let{x:t,y:i,objectID:a,featureIndexInSector:r,sector:o}=e;return(0,Ee.u)("circle",{afterRemoved:u,class:this.classes(_.feature,{selected:p===a}),cx:t,cy:i,"data-feature-index-in-sector":r,"data-sector":o,key:"".concat(_.feature,"-").concat(a),onclick:d,r:3.5})})))),g=e=>{e.removeEventListener("click",h)},y=this.classes({[_.navigationWrapper]:!0,[_.navigationZoomed]:this._navigationToolExpanded});return this.navigationToolActive&&"image-loaded"===a?(0,Ee.u)("div",{bind:this,class:y,key:this.messages.navigationTool},(0,Ee.u)("svg",{afterCreate:e=>this._storeNavigationToolReference(e),class:(0,r.n)()?w:_.rotateWithAnimation,focusable:"false",height:120,role:"img",width:120,xmlns:"http://www.w3.org/2000/svg"},(0,Ee.u)("defs",null,(0,Ee.u)("linearGradient",{gradientUnits:"userSpaceOnUse",id:"".concat(this.id,"-coverage-fill"),x1:n,x2:s,y1:l,y2:c},(0,Ee.u)("stop",{class:_.navigationPathOffset0,offset:0}),(0,Ee.u)("stop",{class:_.navigationPathOffset1,offset:1}))),(0,Ee.u)("g",null,(0,Ee.u)("circle",{class:this.classes(_.sector,_.outerSector),cx:C[3],cy:C[3],onclick:this._scaleNavigationTool,r:C[3]}),(0,Ee.u)("circle",{class:_.sector,cx:C[3],cy:C[3],r:C[2]}),(0,Ee.u)("circle",{class:_.sector,cx:C[3],cy:C[3],r:C[1]}),(0,Ee.u)("circle",{class:_.sector,cx:C[3],cy:C[3],r:C[0]}),(0,Ee.u)("path",{class:_.pointer,d:"M 56.5 6.06217782649107 L 60 0 L 63.5 6.06217782649107 Z",key:"".concat(_.pointer,"-west")}),(0,Ee.u)("path",{class:this.classes(_.pointer,_.north),d:"M 113.93782217350893 56.5 L 120 60 L 113.93782217350893 63.5 Z",key:"".concat(_.pointer,"-north")}),(0,Ee.u)("path",{class:_.pointer,d:"M 56.5 113.93782217350893 L 60 120 L 63.5 113.93782217350893 Z",key:"".concat(_.pointer,"-east")}),(0,Ee.u)("path",{class:_.pointer,d:"M 6.06217782649107 56.5 L 0 60 L 6.06217782649107 63.5 Z",key:"".concat(_.pointer,"-south")}),(0,Ee.u)("path",{class:this.classes(_.sector,_.sectorSeparator),d:"M 23.937554159486076 23.937554159486076 L 96.06244584051393 96.06244584051393 M 23.937554159486076 96.06244584051393 L 96.06244584051393 23.937554159486076",key:_.sectorSeparator}),v([C[2],C[1],C[0]],C[3],C[3]).map(((t,i)=>{var a;return(0,Ee.u)("path",{afterRemoved:g,class:this.classes(_.sector,null!==e&&void 0!==e&&null!==(a=e[i])&&void 0!==a&&a.length?_.sectorEnabled:_.sectorDisabled),d:t,"data-sector":"".concat(i),key:"".concat(_.sector,"-").concat(i),onclick:h})})),(0,Ee.u)("path",{class:this.classes(_.sector,_.sectorCross),d:"M 56.4 56.4 L 63.53 63.53 M 63.53 56.4 L 56.4 63.53",key:_.sectorCross}),m,i.attributes.cameraPitch>=5&&o?(0,Ee.u)("path",{class:_.selectedFeaturePath,d:o,fill:"url(#".concat(this.id,"-coverage-fill)"),key:_.selectedFeaturePath}):null))):null}_renderNavigationTool(){const{state:e}=this.viewModel;return(0,Ee.u)("calcite-action",{active:this.navigationToolActive,afterCreate:this._storeActionElement,bind:this,disabled:"image-loaded"!==e,icon:"explore",onclick:this._toggleNavigationTool,text:this.messages.navigationTool})}_renderImageEnhancementTool(){const{state:e,mode:t}=this.viewModel;return(0,Ee.u)("calcite-action",{active:this.imageEnhancementToolActive,afterCreate:this._storeActionElement,bind:this,disabled:"default"!==t||"image-loaded"!==e,icon:"sliders-horizontal",onclick:this._toggleImageEnhancementToolState,text:this.messages.imageEnhancement})}_renderMenuBarContainer(){const{currentCoverageVisible:e,isAdditionalCoverageVisible:t,isAdditionalPointSourcesVisible:i,imageGalleryEnabled:a}=this;return(0,Ee.u)("calcite-action-bar",{expandDisabled:!0,layout:"horizontal",slot:"action-bar"},(0,Ee.u)("calcite-action-group",{expanded:!0},(0,Ee.u)("calcite-action",{active:e,afterCreate:this._storeActionElement,bind:this,class:_.currentCoverage,icon:"trapezoid-area",onclick:this._toggleCurrentCoverage,text:this.messages.currentFootprint}),(0,Ee.u)("calcite-action",{active:t,afterCreate:this._storeActionElement,bind:this,class:_.addCoverage,icon:"trapezoid-area",onclick:this._toggleAdditionalCoverage,text:this.messages.additionalFootprints}),(0,Ee.u)("calcite-action",{active:i,afterCreate:this._storeActionElement,bind:this,class:_.addExpPoints,icon:"circle-area",onclick:this._toggleAdditionalCameraLocations,text:this.messages.additionalCameraLocations})),(0,Ee.u)("calcite-action-group",{layout:"horizontal"},this.visibleElements.mapImageConversionTool?this._renderMapImageConversionTool():null,this.visibleElements.navigationTool?this._renderNavigationTool():null,this.visibleElements.imageEnhancement?this._renderImageEnhancementTool():null),(0,Ee.u)("calcite-action-group",null,(0,Ee.u)("calcite-action",{active:this.galleryOpened,afterCreate:this._storeActionElement,bind:this,disabled:!a,icon:"images",onclick:this._toggleImageGallery,text:this.messages.imageGallery,textEnabled:!0}),this.visibleElements.showPopupsAction?this._renderPopupAction():null),this._renderActionTooltips())}_renderMessageBox(){const{messages:e,viewModel:{displayMessage:t}}=this;if(!t)return null;const{data:i,key:a,map:r}=t,o="".concat(r?(0,pt.n)(e[a],r):e[a]);return(0,Ee.u)("span",{class:_.messageBox},i?"".concat(o," ").concat(i):o)}_renderPopupAction(){return(0,Ee.u)("calcite-action",{afterCreate:this._storeActionElement,bind:this,disabled:!this.popupEnabled,icon:"popup",onclick:this._toogleImageAttributes,text:this.messages.showPopups,textEnabled:!0})}_renderThumbnails(e){const{currentBestFeature:t}=this.viewModel;return t?(0,Ee.u)("div",{class:_.carouselContent},e.items.map(((e,i)=>{let{url:a,objectId:r,rotation:o}=e;return(0,Ee.u)("div",{class:"".concat(_.carouselItemWrapper).concat(t.attributes.objectId===r?"--selected":""),key:"".concat(_.carouselItemWrapper,"-").concat(i)},(0,Ee.u)("canvas",{afterCreate:this._registerGalleryItem,afterRemoved:this._unregisterGalleryItem,alt:"thumbnail-".concat(r),class:_.carouselItem,"data-objectid":"".concat(r),"data-rotation":"".concat(o),"data-src":a,onclick:this._loadImageFromGallery,onmouseenter:this._highlight,onmouseleave:this._removeHighlight}))}))):null}_renderViewerContainer(){return(0,Ee.u)("div",{class:_.viewerContainer},this._renderImageViewer(),this._renderPanoramicViewer(),this._renderMessageBox())}_renderImageViewer(){const{displayMessage:e,loadImageViewer:t,mode:i}=this.viewModel,a="".concat(_.viewer).concat(e||"default"!==i?"--hide":"");return(0,Ee.u)("calcite-panel",{afterCreate:t,bind:this,class:a})}_renderPanoramicViewer(){const{displayMessage:e,loadPanoramicViewer:t,mode:i}=this.viewModel,a="".concat(_.viewer).concat(e||"panoramic"!==i?"--hide":"");return(0,Ee.u)("calcite-panel",{afterCreate:t,bind:this,class:a})}_resetImageTools(){this.viewModel.sharpness=this.viewModel.brightness=this.viewModel.contrast=0}_storeActionElement(e){this._actionItems.set(e.text,e)}_storeNavigationToolReference(e){this._navigationTool=e}_toggleAdditionalCameraLocations(){this.isAdditionalPointSourcesVisible=!this.isAdditionalPointSourcesVisible}_toggleAdditionalCoverage(){this.isAdditionalCoverageVisible=!this.isAdditionalCoverageVisible}_toggleCurrentCoverage(){this.currentCoverageVisible=!this.currentCoverageVisible}_toggleImageEnhancementToolState(e){e.stopPropagation(),this.imageEnhancementToolActive=!this.imageEnhancementToolActive,this.imageEnhancementToolActive&&(this.galleryOpened&&(this.galleryOpened=!1),this.navigationToolActive&&(this.navigationToolActive=!1))}_toggleImageGallery(e){e.stopPropagation(),this.galleryOpened=!!this.imageGalleryEnabled&&!this.galleryOpened,this.galleryOpened&&(this.imageEnhancementToolActive&&(this.imageEnhancementToolActive=!1),this.navigationToolActive&&(this.navigationToolActive=!1))}_toggleNavigationTool(){this.navigationToolActive=!this.navigationToolActive,this.navigationToolActive&&(this.galleryOpened&&(this.galleryOpened=!1),this.imageEnhancementToolActive&&(this.imageEnhancementToolActive=!1))}_toggleMapImageConversionToolState(){this.mapImageConversionToolState=!this.mapImageConversionToolState}_unregisterGalleryItem(e){this._galleryObserver.unobserve(e)}_updateNavigationTool(e){const{previousFeatureAngle:t,bestFeatureAngle:i}=this.viewModel,a=(i-t+540)%360-180;e.style.setProperty("--oi-navigation-tool-rotation-from","".concat(t,"deg")),e.style.setProperty("--oi-navigation-tool-rotation-to","".concat(t+a,"deg"))}loadBestImage(e){this.viewModel.loadBestImage(e)}loadImageFromSource(e,t){return this.viewModel.loadImageFromSource(e,t)}async plotMapPoint(e){return this.viewModel.plotMapPoint(e)}plotReferencePointOnGround(e){this.viewModel.plotReferencePointOnGround(e)}plotReferencePointOnImage(e){this.viewModel.plotReferencePointOnImage(e)}resetImage(){this.viewModel.resetImage()}render(){const{dockEnabled:e,viewModel:{state:t}}=this;return(0,Ee.u)("div",{class:this.classes(Ze.z.widget,y)},(0,Ee.u)("calcite-panel",{bind:this,class:e?_.dock:_.float,heading:this.visibleElements.title?this.messages.title:void 0,loading:"image-loading"===t},this.visibleElements.coverageMenu?this._renderMenuBarContainer():null,this._renderBody()))}updateSuitabilities(e){this.viewModel.updateSuitabilities(e)}};(0,a._)([(0,c.Cb)()],mt.prototype,"activeLayer",null),(0,a._)([(0,c.Cb)()],mt.prototype,"currentBestFeature",null),(0,a._)([(0,c.Cb)()],mt.prototype,"currentCoverageVisible",null),(0,a._)([(0,c.Cb)()],mt.prototype,"disabled",null),(0,a._)([(0,c.Cb)()],mt.prototype,"dockEnabled",void 0),(0,a._)([(0,c.Cb)()],mt.prototype,"drawFootprint",null),(0,a._)([(0,c.Cb)()],mt.prototype,"features",null),(0,a._)([(0,c.Cb)()],mt.prototype,"imagePointsInView",null),(0,a._)([(0,c.Cb)()],mt.prototype,"isDocked",null),(0,a._)([(0,c.Cb)()],mt.prototype,"galleryOpened",void 0),(0,a._)([(0,c.Cb)()],mt.prototype,"icon",null),(0,a._)([(0,c.Cb)()],mt.prototype,"imageEnhancementToolActive",void 0),(0,a._)([(0,c.Cb)({readOnly:!0})],mt.prototype,"imageGalleryEnabled",null),(0,a._)([(0,c.Cb)()],mt.prototype,"isAdditionalCoverageVisible",null),(0,a._)([(0,c.Cb)()],mt.prototype,"isAdditionalPointSourcesVisible",null),(0,a._)([(0,c.Cb)()],mt.prototype,"mapImageConversionToolState",null),(0,a._)([(0,c.Cb)()],mt.prototype,"layer",null),(0,a._)([(0,c.Cb)()],mt.prototype,"navigationToolActive",void 0),(0,a._)([(0,c.Cb)({type:st})],mt.prototype,"viewModel",void 0),(0,a._)([(0,c.Cb)(),(0,ut.H)("esri/widgets/OrientedImageryViewer/t9n/OrientedImageryViewer")],mt.prototype,"messages",void 0),(0,a._)([(0,c.Cb)(),(0,ut.H)("esri/t9n/common")],mt.prototype,"messagesCommon",void 0),(0,a._)([(0,c.Cb)({readOnly:!0})],mt.prototype,"popupEnabled",null),(0,a._)([(0,c.Cb)()],mt.prototype,"referencePoint",null),(0,a._)([(0,c.Cb)()],mt.prototype,"view",null),(0,a._)([(0,c.Cb)({type:ht,nonNullable:!0})],mt.prototype,"visibleElements",void 0),(0,a._)([(0,c.Cb)()],mt.prototype,"determineWorkflowForFeature",null),(0,a._)([(0,c.Cb)()],mt.prototype,"updateFootprint",null),(0,a._)([(0,c.Cb)()],mt.prototype,"_navigationToolExpanded",void 0),(0,a._)([(0,c.Cb)()],mt.prototype,"_navigationTool",void 0),mt=(0,a._)([(0,h.j)("esri.widgets.OrientedImageryViewer")],mt);const gt=mt},28429:(e,t,i)=>{i.d(t,{C$:()=>v,FH:()=>p,Gu:()=>m,Lr:()=>u,OH:()=>y,RS:()=>w,TU:()=>_,ao:()=>g,mH:()=>f,tA:()=>b});i(51508);var a=i(80987),r=i(75021),o=i(16072),n=i(61459),s=i(62554),l=i(36365),c=i(40345),h=i(16915),d=i(43977);const u=new o.default({size:15,style:"circle",color:[255,102,102,.5],outline:null}),p=new o.default({size:10,style:"circle",color:[0,128,192,.5],outline:null}),m=new n.default({style:"solid",color:[0,128,192,.5],outline:null}),g=new n.default({style:"solid",color:[255,102,102,.5],outline:null}),v=new o.default({size:10,style:"diamond",color:[255,102,102],outline:null}),y=new s.Z({symbolLayers:new a.Z([new l.Z({size:10,material:{color:"red"},resource:{primitive:"x"},outline:{color:"black",size:1}})])}),f=new s.Z({symbolLayers:new a.Z([new c.Z({width:9,height:9,depth:9,material:{color:[255,102,102]},resource:{primitive:"diamond"},castShadows:!1})])}),b=new r.Z({data:{type:"CIMSymbolReference",symbol:{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,size:10,frame:{xmin:-5,ymin:-5,xmax:5,ymax:5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{rings:[[[0,1.4142135623730951],[3.585786437626905,5],[5,3.585786437626905],[1.4142135623730951,0],[5,-3.585786437626905],[3.585786437626905,-5],[0,-1.4142135623730951],[-3.585786437626905,-5],[-5,-3.585786437626905],[-1.4142135623730951,0],[-5,3.585786437626905],[-3.585786437626905,5],[0,1.4142135623730951]]]},symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidStroke",enable:!0,width:1,color:[0,0,0,100]},{type:"CIMSolidFill",enable:!0,color:[255,0,0,255]}]}}]}]}}}),w=new h.Z({symbolLayers:new a.Z([new d.Z({material:{color:[255,102,102,.5]},edges:null})])}),_=new h.Z({symbolLayers:new a.Z([new d.Z({material:{color:[0,128,192,.25]},edges:null})])})},49885:(e,t,i)=>{i.d(t,{Ex:()=>c,K0:()=>s,SL:()=>n,e1:()=>l,wz:()=>o});i(59486);var a=i(848),r=i(78952);const o=new a.Z({x:0,y:0,z:0,spatialReference:r.Z.WebMercator}),n=1e3,s=114,l=120,c=50}}]);
//# sourceMappingURL=56589.41bf3217.chunk.js.map