"use strict";(self.webpackChunknorthwind=self.webpackChunknorthwind||[]).push([[98549],{30168:(e,t,o)=>{function n(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}o.d(t,{Z:()=>n})},46228:(e,t,o)=>{o.d(t,{I:()=>r,v:()=>l});var n=o(16889);function r(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r=(0,n.uZ)(e,0,s);for(let n=0;n<4;n++)t[o+n]=Math.floor(256*d(r*i[n]))}function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=0;for(let n=0;n<4;n++)o+=e[t+n]*a[n];return o}const i=[1,256,65536,16777216],a=[1/256,1/65536,1/16777216,1/4294967296],s=l(new Uint8ClampedArray([255,255,255,255]));function d(e){return e-Math.floor(e)}},68859:(e,t,o)=>{o.d(t,{K:()=>i,U:()=>a});var n=o(12400),r=o(79803),l=o(50628);function i(e,t,o,n){var i,a;if((0,r.canProjectWithoutEngine)(e.spatialReference,o)){var d;s[0]=e.x,s[1]=e.y;const r=e.z;return s[2]=null!==(d=null!==r&&void 0!==r?r:n)&&void 0!==d?d:0,(0,l.projectBuffer)(s,e.spatialReference,0,t,o,0,1)}const c=(0,r.tryProjectWithZConversion)(e,o);return!!c&&(t[0]=null===c||void 0===c?void 0:c.x,t[1]=null===c||void 0===c?void 0:c.y,t[2]=null!==(i=null!==(a=null===c||void 0===c?void 0:c.z)&&void 0!==a?a:n)&&void 0!==i?i:0,!0)}async function a(e,t,o,n,l){return await(0,r.initializeProjection)(e.spatialReference,o,null,l),i(e,t,o,n)}const s=(0,n.Ue)()},5986:(e,t,o)=>{o.d(t,{S:()=>l});o(79803);var n=o(78952),r=o(68859);function l(e,t,o,n,l){return!(null==t||null==n||e.length<2)&&(i.x=e[0],i.y=e[1],i.z=e[2],i.spatialReference=t,(0,r.K)(i,o,n,l))}const i=(0,o(55946).T)(0,0,0,n.Z.WGS84)},10743:(e,t,o)=>{o.r(t),o.d(t,{default:()=>z});var n=o(27366),r=o(80987),l=o(77178),i=o(10064),a=o(84652),s=o(93002),d=o(32718),c=o(97642),u=o(66978),p=o(35995),f=o(49861),v=(o(93169),o(38511)),y=o(69912),m=o(78952),h=o(30651),b=o(59147),g=o(15801),x=o(27961),C=o(11936),w=o(46671),S=o(6061),T=o(29598),O=o(56811),I=o(81118),E=o(84076),A=o(56232),F=o(76200),M=o(46784),R=o(54472),P=o(67426);o(84936);let N=class extends M.wq{constructor(){super(...arguments),this.fieldName=null,this.modelName=null,this.label=null,this.min=null,this.max=null,this.mostFrequentValues=null,this.subLayerIds=null}};(0,n._)([(0,f.Cb)({type:String})],N.prototype,"fieldName",void 0),(0,n._)([(0,f.Cb)({type:String})],N.prototype,"modelName",void 0),(0,n._)([(0,f.Cb)({type:String})],N.prototype,"label",void 0),(0,n._)([(0,f.Cb)({type:Number})],N.prototype,"min",void 0),(0,n._)([(0,f.Cb)({type:Number})],N.prototype,"max",void 0),(0,n._)([(0,f.Cb)({json:{read:e=>Array.isArray(e)&&(e.every((e=>"string"==typeof e))||e.every((e=>"number"==typeof e)))?e.slice():null}})],N.prototype,"mostFrequentValues",void 0),(0,n._)([(0,f.Cb)({type:[Number]})],N.prototype,"subLayerIds",void 0),N=(0,n._)([(0,y.j)("esri.layers.support.BuildingSummaryStatistics.BuildingFieldStatistics")],N);let L=class extends(R.Z.LoadableMixin((0,P.v)(M.wq))){constructor(){super(...arguments),this.url=null}get fields(){return this.loaded||"loading"===this.loadStatus?this._get("fields"):(d.Z.getLogger(this).error("building summary statistics are not loaded"),null)}load(e){const t=null!=e?e.signal:null;return this.addResolvingPromise(this._fetchService(t)),Promise.resolve(this)}async _fetchService(e){const t=(await(0,F.Z)(this.url,{query:{f:"json"},responseType:"json",signal:e})).data;this.read(t,{origin:"service"})}};(0,n._)([(0,f.Cb)({constructOnly:!0,type:String})],L.prototype,"url",void 0),(0,n._)([(0,f.Cb)({readOnly:!0,type:[N],json:{read:{source:"summary"}}})],L.prototype,"fields",null),L=(0,n._)([(0,y.j)("esri.layers.support.BuildingSummaryStatistics")],L);const _=L;var Z,j=o(70361),D=o(74509);const U=r.Z.ofType(A.Z),H=(0,a.d9)(g.Z.sublayersProperty),V=null===(Z=H.json)||void 0===Z?void 0:Z.origins;V&&(V["web-scene"]={type:[b.Z],write:{enabled:!0,overridePolicy:()=>({enabled:!1})}},V["portal-item"]={type:[b.Z],write:{enabled:!0,overridePolicy:()=>({enabled:!1})}});let B=class extends((0,I.Vt)((0,C.Y)((0,S.q)((0,T.I)((0,O.M)((0,c.R)((0,w.N)((0,x.V)(h.Z))))))))){constructor(e){super(e),this.operationalLayerType="BuildingSceneLayer",this.allSublayers=new l.Z({getCollections:()=>[this.sublayers],getChildrenFunction:e=>"building-group"===e.type?e.sublayers:null}),this.sublayers=null,this._sublayerOverrides=null,this.filters=new U,this.activeFilterId=null,this.summaryStatistics=null,this.outFields=null,this.legendEnabled=!0,this.type="building-scene"}normalizeCtorArgs(e){return"string"==typeof e?{url:e}:null!==e&&void 0!==e?e:{}}destroy(){this.allSublayers.destroy()}readSublayers(e,t,o){const n=g.Z.readSublayers(e,t,o);return g.Z.forEachSublayer(n,(e=>e.layer=this)),this._sublayerOverrides&&(this.applySublayerOverrides(n,this._sublayerOverrides),this._sublayerOverrides=null),n}applySublayerOverrides(e,t){let{overrides:o,context:n}=t;g.Z.forEachSublayer(e,(e=>e.read(o.get(e.id),n)))}readSublayerOverrides(e,t){const o=new Map;for(const r of e){var n;null!=r&&"object"==typeof r&&"number"==typeof r.id?o.set(r.id,r):null===(n=t.messages)||void 0===n||n.push(new i.Z("building-scene-layer:invalid-sublayer-override","Invalid value for sublayer override. Not an object or no id specified.",{value:r}))}return{overrides:o,context:t}}writeSublayerOverrides(e,t,o){const n=[];g.Z.forEachSublayer(this.sublayers,(e=>{const t=e.write({},o);Object.keys(t).length>1&&n.push(t)})),n.length>0&&(t.sublayers=n)}writeUnappliedOverrides(e,t){t.sublayers=[],e.overrides.forEach((e=>{t.sublayers.push((0,a.d9)(e))}))}write(e,t){return e=super.write(e,t),!t||"web-scene"!==t.origin&&"portal-item"!==t.origin||(this.sublayers?this.writeSublayerOverrides(this.sublayers,e,t):this._sublayerOverrides&&this.writeUnappliedOverrides(this._sublayerOverrides,e)),e}read(e,t){if(super.read(e,t),t&&("web-scene"===t.origin||"portal-item"===t.origin)&&null!=e&&Array.isArray(e.sublayers)){const o=this.readSublayerOverrides(e.sublayers,t);this.sublayers?this.applySublayerOverrides(this.sublayers,o):this._sublayerOverrides=o}}readSummaryStatistics(e,t){if("string"==typeof t.statisticsHRef){var o;const e=(0,p.v_)(null===(o=this.parsedUrl)||void 0===o?void 0:o.path,t.statisticsHRef);return new _({url:e})}return null}set elevationInfo(e){this._set("elevationInfo",e),this._validateElevationInfo()}load(e){const t=null!=e?e.signal:null,o=this.loadFromPortal({supportedTypes:["Scene Service"]},e).catch(u.r9).then((()=>this._fetchService(t))).then((()=>this._fetchAssociatedFeatureService(t)));return this.addResolvingPromise(o),Promise.resolve(this)}loadAll(){return(0,s.G)(this,(e=>{g.Z.forEachSublayer(this.sublayers,(t=>{"building-group"!==t.type&&e(t)})),this.summaryStatistics&&e(this.summaryStatistics)}))}async saveAs(e,t){return this._debouncedSaveOperations(I.xp.SAVE_AS,{...t,getTypeKeywords:()=>this._getTypeKeywords(),portalItemLayerType:"building-scene"},e)}async save(){const e={getTypeKeywords:()=>this._getTypeKeywords(),portalItemLayerType:"building-scene"};return this._debouncedSaveOperations(I.xp.SAVE,e)}validateLayer(e){if(!e.layerType||"Building"!==e.layerType)throw new i.Z("buildingscenelayer:layer-type-not-supported","BuildingSceneLayer does not support this layer type",{layerType:e.layerType})}_getTypeKeywords(){return["Building"]}async _fetchAssociatedFeatureService(e){try{const{portalItem:t}=await(0,E.w)("".concat(this.url,"/layers/").concat(this.layerId),{sceneLayerItem:this.portalItem,customParameters:this.customParameters,apiKey:this.apiKey,signal:e});this.associatedFeatureServiceItem=t}catch(t){d.Z.getLogger(this).warn("Associated feature service item could not be loaded",t)}}_validateElevationInfo(){const e=this.elevationInfo,t="Building scene layers";(0,D.LR)(d.Z.getLogger(this),(0,D.Uy)(t,"absolute-height",e)),(0,D.LR)(d.Z.getLogger(this),(0,D.kf)(t,e))}};(0,n._)([(0,f.Cb)({type:["BuildingSceneLayer"]})],B.prototype,"operationalLayerType",void 0),(0,n._)([(0,f.Cb)({readOnly:!0})],B.prototype,"allSublayers",void 0),(0,n._)([(0,f.Cb)(H)],B.prototype,"sublayers",void 0),(0,n._)([(0,v.r)("service","sublayers")],B.prototype,"readSublayers",null),(0,n._)([(0,f.Cb)({type:U,nonNullable:!0,json:{write:!0}})],B.prototype,"filters",void 0),(0,n._)([(0,f.Cb)({type:String,json:{write:!0}})],B.prototype,"activeFilterId",void 0),(0,n._)([(0,f.Cb)({readOnly:!0,type:_})],B.prototype,"summaryStatistics",void 0),(0,n._)([(0,v.r)("summaryStatistics",["statisticsHRef"])],B.prototype,"readSummaryStatistics",null),(0,n._)([(0,f.Cb)({type:[String],json:{read:!1}})],B.prototype,"outFields",void 0),(0,n._)([(0,f.Cb)(j.vg)],B.prototype,"fullExtent",void 0),(0,n._)([(0,f.Cb)(j.rn)],B.prototype,"legendEnabled",void 0),(0,n._)([(0,f.Cb)({type:["show","hide","hide-children"]})],B.prototype,"listMode",void 0),(0,n._)([(0,f.Cb)((0,j.Lx)(m.Z))],B.prototype,"spatialReference",void 0),(0,n._)([(0,f.Cb)(j.PV)],B.prototype,"elevationInfo",null),(0,n._)([(0,f.Cb)({json:{read:!1},readOnly:!0})],B.prototype,"type",void 0),(0,n._)([(0,f.Cb)()],B.prototype,"associatedFeatureServiceItem",void 0),B=(0,n._)([(0,y.j)("esri.layers.BuildingSceneLayer")],B);const z=B},15801:(e,t,o)=>{o.d(t,{Z:()=>y});var n,r=o(27366),l=o(80987),i=o(93002),a=o(51370),s=o(49861),d=(o(93169),o(32718),o(84936),o(69912)),c=o(59147),u=o(58550);const p={type:l.Z,readOnly:!0,json:{origins:{service:{read:{source:"sublayers",reader:f}}},read:!1}};function f(e,t,o){if(e&&Array.isArray(e))return new l.Z(e.map((e=>{const t=function(e){return"group"===e.layerType?v:c.Z}(e);if(t){const n=new t;return n.read(e,o),n}return null!==o&&void 0!==o&&o.messages&&e&&o.messages.push(new a.Z("building-scene-layer:unsupported-sublayer-type","Building scene sublayer of type '"+(e.type||"unknown")+"' are not supported",{definition:e,context:o})),null})))}let v=n=class extends u.Z{constructor(e){super(e),this.type="building-group",this.listMode="show",this.sublayers=null}loadAll(){return(0,i.w)(this,(e=>n.forEachSublayer(this.sublayers,(t=>{"building-group"!==t.type&&e(t)}))))}};(0,r._)([(0,s.Cb)({type:["hide","show","hide-children"],json:{write:!0}})],v.prototype,"listMode",void 0),(0,r._)([(0,s.Cb)(p)],v.prototype,"sublayers",void 0),v=n=(0,r._)([(0,d.j)("esri.layers.buildingSublayers.BuildingGroupSublayer")],v),function(e){e.sublayersProperty=p,e.readSublayers=f,e.forEachSublayer=function e(t,o){t.forEach((t=>{o(t),"building-group"===t.type&&e(t.sublayers,o)}))}}(v||(v={}));const y=v},55946:(e,t,o)=>{function n(e,t,o,n){return{x:e,y:t,z:o,hasZ:null!=o,hasM:!1,spatialReference:n,type:"point"}}function r(e,t,o,n,r){e.x=t,e.y=o,e.z=n,e.hasZ=null!=n,e.spatialReference=r}o.d(t,{T:()=>n,y:()=>r})},56232:(e,t,o)=>{o.d(t,{Z:()=>E});var n=o(27366),r=o(80987),l=o(46784),i=o(84652),a=o(71907),s=o(49861),d=(o(93169),o(32718),o(69912));o(84936);let c=class extends l.wq{constructor(){super(...arguments),this.type=null}};(0,n._)([(0,s.Cb)({type:String,readOnly:!0,json:{write:!0}})],c.prototype,"type",void 0),c=(0,n._)([(0,d.j)("esri.layers.support.BuildingFilterAuthoringInfo")],c);const u=c;var p;let f=p=class extends l.wq{constructor(){super(...arguments),this.filterType=null,this.filterValues=null}clone(){return new p({filterType:this.filterType,filterValues:(0,i.d9)(this.filterValues)})}};(0,n._)([(0,s.Cb)({type:String,json:{write:!0}})],f.prototype,"filterType",void 0),(0,n._)([(0,s.Cb)({type:[String],json:{write:!0}})],f.prototype,"filterValues",void 0),f=p=(0,n._)([(0,d.j)("esri.layers.support.BuildingFilterAuthoringInfoType")],f);const v=f;var y;const m=r.Z.ofType(v);let h=y=class extends l.wq{clone(){return new y({filterTypes:(0,i.d9)(this.filterTypes)})}};(0,n._)([(0,s.Cb)({type:m,json:{write:!0}})],h.prototype,"filterTypes",void 0),h=y=(0,n._)([(0,d.j)("esri.layers.support.BuildingFilterAuthoringInfoBlock")],h);const b=h;var g;const x=r.Z.ofType(b);let C=g=class extends u{constructor(){super(...arguments),this.type="checkbox"}clone(){return new g({filterBlocks:(0,i.d9)(this.filterBlocks)})}};(0,n._)([(0,s.Cb)({type:["checkbox"]})],C.prototype,"type",void 0),(0,n._)([(0,s.Cb)({type:x,json:{write:!0}})],C.prototype,"filterBlocks",void 0),C=g=(0,n._)([(0,d.j)("esri.layers.support.BuildingFilterAuthoringInfoCheckbox")],C);const w=C;var S,T=o(32506);const O=r.Z.ofType(T.Z);let I=S=class extends l.wq{constructor(){super(...arguments),this.description=null,this.filterBlocks=null,this.id=(0,a.DO)(),this.name=null}clone(){return new S({description:this.description,filterBlocks:(0,i.d9)(this.filterBlocks),id:this.id,name:this.name,filterAuthoringInfo:(0,i.d9)(this.filterAuthoringInfo)})}};(0,n._)([(0,s.Cb)({type:String,json:{write:!0}})],I.prototype,"description",void 0),(0,n._)([(0,s.Cb)({type:O,json:{write:{enabled:!0,isRequired:!0}}})],I.prototype,"filterBlocks",void 0),(0,n._)([(0,s.Cb)({types:{key:"type",base:u,typeMap:{checkbox:w}},json:{read:e=>"checkbox"===(null===e||void 0===e?void 0:e.type)?w.fromJSON(e):null,write:!0}})],I.prototype,"filterAuthoringInfo",void 0),(0,n._)([(0,s.Cb)({type:String,constructOnly:!0,json:{write:{enabled:!0,isRequired:!0}}})],I.prototype,"id",void 0),(0,n._)([(0,s.Cb)({type:String,json:{write:{enabled:!0,isRequired:!0}}})],I.prototype,"name",void 0),I=S=(0,n._)([(0,d.j)("esri.layers.support.BuildingFilter")],I);const E=I},32506:(e,t,o)=>{o.d(t,{Z:()=>g});var n,r=o(27366),l=o(46784),i=o(84652),a=o(49861),s=(o(93169),o(32718),o(69912)),d=o(70936),c=o(30857),u=o(27135),p=o(68901);let f=n=class extends d.Z{constructor(){super(...arguments),this.type="wire-frame",this.edges=null}clone(){return new n({edges:(0,i.d9)(this.edges)})}};(0,r._)([(0,u.J)({wireFrame:"wire-frame"})],f.prototype,"type",void 0),(0,r._)([(0,a.Cb)(p.Z)],f.prototype,"edges",void 0),f=n=(0,r._)([(0,s.j)("esri.layers.support.BuildingFilterModeWireFrame")],f);const v=f;var y,m=o(67682);const h={nonNullable:!0,types:{key:"type",base:d.Z,typeMap:{solid:c.Z,"wire-frame":v,"x-ray":m.Z}},json:{read:e=>{switch(null===e||void 0===e?void 0:e.type){case"solid":return c.Z.fromJSON(e);case"wireFrame":return v.fromJSON(e);case"x-ray":return m.Z.fromJSON(e);default:return}},write:{enabled:!0,isRequired:!0}}};let b=y=class extends l.wq{constructor(){super(...arguments),this.filterExpression=null,this.filterMode=new c.Z,this.title=""}clone(){return new y({filterExpression:this.filterExpression,filterMode:(0,i.d9)(this.filterMode),title:this.title})}};(0,r._)([(0,a.Cb)({type:String,json:{write:{enabled:!0,isRequired:!0}}})],b.prototype,"filterExpression",void 0),(0,r._)([(0,a.Cb)(h)],b.prototype,"filterMode",void 0),(0,r._)([(0,a.Cb)({type:String,json:{write:{enabled:!0,isRequired:!0}}})],b.prototype,"title",void 0),b=y=(0,r._)([(0,s.j)("esri.layers.support.BuildingFilterBlock")],b);const g=b},70936:(e,t,o)=>{o.d(t,{Z:()=>s});var n=o(27366),r=o(46784),l=o(49861),i=(o(93169),o(32718),o(84936),o(69912));let a=class extends r.wq{};(0,n._)([(0,l.Cb)({readOnly:!0,json:{read:!1}})],a.prototype,"type",void 0),a=(0,n._)([(0,i.j)("esri.layers.support.BuildingFilterMode")],a);const s=a},30857:(e,t,o)=>{o.d(t,{Z:()=>d});var n,r=o(27366),l=o(49861),i=(o(93169),o(32718),o(84936),o(69912)),a=o(70936);let s=n=class extends a.Z{constructor(){super(...arguments),this.type="solid"}clone(){return new n}};(0,r._)([(0,l.Cb)({type:["solid"],readOnly:!0,json:{write:!0}})],s.prototype,"type",void 0),s=n=(0,r._)([(0,i.j)("esri.layers.support.BuildingFilterModeSolid")],s);const d=s},67682:(e,t,o)=>{o.d(t,{Z:()=>d});var n,r=o(27366),l=o(49861),i=(o(93169),o(32718),o(84936),o(69912)),a=o(70936);let s=n=class extends a.Z{constructor(){super(...arguments),this.type="x-ray"}clone(){return new n}};(0,r._)([(0,l.Cb)({type:["x-ray"],readOnly:!0,json:{write:!0}})],s.prototype,"type",void 0),s=n=(0,r._)([(0,i.j)("esri.layers.support.BuildingFilterModeXRay")],s);const d=s},84076:(e,t,o)=>{o.d(t,{w:()=>c});var n=o(19545),r=o(76200),l=o(10064),i=o(66978),a=o(25899),s=o(7575),d=o(98995);async function c(e,t){var o,c;const f=(0,a.Qc)(e);if(!f)throw new l.Z("invalid-url","Invalid scene service url");const v={...t,sceneServerUrl:f.url.path,layerId:null!==(o=f.sublayer)&&void 0!==o?o:void 0};if(null!==(c=v.sceneLayerItem)&&void 0!==c||(v.sceneLayerItem=await async function(e){const t=(await u(e)).serviceItemId;if(!t)return null;const o=new d.default({id:t,apiKey:e.apiKey}),l=await async function(e){const t=null===n.id||void 0===n.id?void 0:n.id.findServerInfo(e.sceneServerUrl);if(null!==t&&void 0!==t&&t.owningSystemUrl)return t.owningSystemUrl;const o=e.sceneServerUrl.replace(/(.*\/rest)\/.*/i,"$1")+"/info";try{const t=(await(0,r.Z)(o,{query:{f:"json"},responseType:"json",signal:e.signal})).data.owningSystemUrl;if(t)return t}catch(y){(0,i.r9)(y)}return null}(e);null!=l&&(o.portal=new s.Z({url:l}));try{return o.load({signal:e.signal})}catch(m){return(0,i.r9)(m),null}}(v)),null==v.sceneLayerItem)return p(v.sceneServerUrl.replace("/SceneServer","/FeatureServer"),v);const y=await async function(e){let{sceneLayerItem:t,signal:o}=e;if(!t)return null;try{const e=(await t.fetchRelatedItems({relationshipType:"Service2Service",direction:"reverse"},{signal:o})).find((e=>"Feature Service"===e.type))||null;if(!e)return null;const n=new d.default({portal:e.portal,id:e.id});return await n.load(),n}catch(n){return(0,i.r9)(n),null}}(v);if(null===y||void 0===y||!y.url)throw new l.Z("related-service-not-found","Could not find feature service through portal item relationship");v.featureServiceItem=y;const m=await p(y.url,v);return m.portalItem=y,m}async function u(e){if(e.rootDocument)return e.rootDocument;const t={query:{f:"json",...e.customParameters,token:e.apiKey},responseType:"json",signal:e.signal};try{const o=await(0,r.Z)(e.sceneServerUrl,t);e.rootDocument=o.data}catch{e.rootDocument={}}return e.rootDocument}async function p(e,t){var o,n,i;const s=(0,a.Qc)(e);if(!s)throw new l.Z("invalid-feature-service-url","Invalid feature service url");const d=s.url.path,c=t.layerId;if(null==c)return{serverUrl:d};const p=u(t),f=t.featureServiceItem?await t.featureServiceItem.fetchData("json"):null,v=null===(o=(null===f||void 0===f||null===(n=f.layers)||void 0===n?void 0:n[0])||(null===f||void 0===f||null===(i=f.tables)||void 0===i?void 0:i[0]))||void 0===o?void 0:o.customParameters,y=e=>{const o={query:{f:"json",...v},responseType:"json",authMode:e,signal:t.signal};return(0,r.Z)(d,o)},m=y("anonymous").catch((()=>y("no-prompt"))),[h,b]=await Promise.all([m,p]),g=null===b||void 0===b?void 0:b.layers,x=h.data&&h.data.layers;if(!Array.isArray(x))throw new Error("expected layers array");if(Array.isArray(g)){for(let r=0;r<Math.min(g.length,x.length);r++)if(g[r].id===c)return{serverUrl:d,layerId:x[r].id}}else if(null!=c&&c<x.length)return{serverUrl:d,layerId:x[c].id};throw new Error("could not find matching associated sublayer")}},74509:(e,t,o)=>{o.d(t,{AA:()=>v,Jn:()=>d,LR:()=>E,Lt:()=>p,O3:()=>C,Ou:()=>b,RL:()=>u,Uy:()=>T,VW:()=>s,W_:()=>S,Wb:()=>O,XH:()=>y,Zz:()=>i,ap:()=>h,fl:()=>f,fm:()=>A,jG:()=>F,kf:()=>I,mF:()=>a,tR:()=>M,tq:()=>w,vQ:()=>g,vu:()=>c,zx:()=>x});var n=o(68860),r=o(88152);function l(e){return e?F:M}function i(e,t){return null!==t&&void 0!==t&&t.mode?t.mode:l(e).mode}function a(e,t){return null!=t?t:l(e)}function s(e,t){return i(null!=e&&e.hasZ,t)}function d(e,t){return a(null!=e&&!!e.hasZ,t)}function c(e){const t=m(e);return s(e.geometry,t)}function u(e){const t=m(e),o=s(e.geometry,t);return{mode:o,offset:null!=t&&"on-the-ground"!==o?A(t):0,featureExpressionInfo:null===t||void 0===t?void 0:t.featureExpressionInfo}}function p(e){return y(u(e))}function f(e){return y(e)||v(e)}function v(e){var t;return"0"===(null===e||void 0===e||null===(t=e.featureExpressionInfo)||void 0===t?void 0:t.expression)}function y(e){if(!e)return!1;if("on-the-ground"===e.mode)return!1;const t=null!==e&&void 0!==e&&e.featureExpressionInfo?e.featureExpressionInfo.expression:null;return!(!t||"0"===t)}function m(e){return e.layer&&"elevationInfo"in e.layer?e.layer.elevationInfo:null}function h(e,t){if(null===e||void 0===e||!e.offset)return 0;const{offset:o,unit:r}=e;if("decimal-degrees"===r)return 0;const l="unknown"!==r&&r?r:"meters",i=(0,n.y)(t);return i?(0,n.En)(o,l,i):0}function b(e,t,o){var n,r;if(null===o||void 0===o||!o.mode)return;const l=e.hasZ?e.z:0,i=h(o,e.spatialReference);switch(o.mode){case"absolute-height":return l-i;case"on-the-ground":return 0;case"relative-to-ground":return l-((null!==(n=t.elevationProvider.getElevation(e.x,e.y,l,e.spatialReference,"ground"))&&void 0!==n?n:0)+i);case"relative-to-scene":return l-((null!==(r=t.elevationProvider.getElevation(e.x,e.y,l,e.spatialReference,"scene"))&&void 0!==r?r:0)+i)}}function g(e,t,o){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return C(e,t.x,t.y,t.hasZ?t.z:0,t.spatialReference,o,n)}function x(e,t,o,n){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return C(e,t[0],t[1],t.length>2?t[2]:0,o,n,r)}function C(e,t,o,n,r,l){let i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;if(null==l)return;const a=null!=i?i.mode:"absolute-height";if("on-the-ground"===a)return 0;const{absoluteZ:s}=w(t,o,n,r,e,l);return function(e,t,o,n,r,l,i,a){var s,d;const c=h(i,r);switch(a){case"absolute-height":return e-c;case"relative-to-ground":return e-((null!==(s=l.elevationProvider.getElevation(t,o,n,r,"ground"))&&void 0!==s?s:0)+c);case"relative-to-scene":return e-((null!==(d=l.elevationProvider.getElevation(t,o,n,r,"scene"))&&void 0!==d?d:0)+c)}}(s,t,o,n,r,e,i,a)}function w(e,t,o,n,r,l){const i=h(l,n);switch(l.mode){case"absolute-height":return{absoluteZ:o+i,elevation:0};case"on-the-ground":{var a;const o=null!==(a=r.elevationProvider.getElevation(e,t,0,n,"ground"))&&void 0!==a?a:0;return{absoluteZ:o,elevation:o}}case"relative-to-ground":{var s;const l=null!==(s=r.elevationProvider.getElevation(e,t,o,n,"ground"))&&void 0!==s?s:0;return{absoluteZ:o+l+i,elevation:l}}case"relative-to-scene":{var d;const l=null!==(d=r.elevationProvider.getElevation(e,t,o,n,"scene"))&&void 0!==d?d:0;return{absoluteZ:o+l+i,elevation:l}}}}function S(e,t){if(null==t)return!1;const{mode:o}=t;return null!=o&&("scene"===e&&"relative-to-scene"===o||"ground"===e&&"absolute-height"!==o)}function T(e,t,o){return o&&o.mode!==t?"".concat(e," only support ").concat(t," elevation mode"):null}function O(e,t,o){return(null===o||void 0===o?void 0:o.mode)===t?"".concat(e," do not support ").concat(t," elevation mode"):null}function I(e,t){return null!=(null===t||void 0===t?void 0:t.featureExpressionInfo)&&"0"!==t.featureExpressionInfo.expression?"".concat(e," do not support featureExpressionInfo"):null}function E(e,t){t&&e.warn(".elevationInfo=",t)}function A(e){var t;return(null!==(t=null===e||void 0===e?void 0:e.offset)&&void 0!==t?t:0)*(0,r.Z7)(null===e||void 0===e?void 0:e.unit)}const F={mode:"absolute-height",offset:0},M={mode:"on-the-ground",offset:null}},97689:(e,t,o)=>{o.d(t,{hM:()=>d,C8:()=>c,$s:()=>u,eU:()=>s});var n=o(51995),r=(o(93169),o(17842)),l=o(86361);var i=o(77958),a=o(34016);function s(e){return e&&e.enabled&&(function(e){return"extrude"===e.type}(e)||function(e){return"fill"===e.type}(e))&&null!=e.edges}function d(e,t){return c(function(e){return e&&e.enabled&&e.edges||null}(e),t)}function c(e,t){if(null==e)return null;const o=null!=e.color?(0,l.nI)(n.Z.toUnitRGBA(e.color)):(0,l.al)(0,0,0,0),i=(0,r.F2)(e.size),s=(0,r.F2)(e.extensionLength);switch(e.type){case"solid":return u({color:o,size:i,extensionLength:s,...t});case"sketch":return d={color:o,size:i,extensionLength:s,...t},{...f,...d,type:a.Pb.Sketch};default:return}var d}function u(e){return{...p,...e,type:a.Pb.Solid}}const p={color:(0,l.al)(0,0,0,.2),size:1,extensionLength:0,opacity:1,objectTransparency:i.i.OPAQUE,hasSlicePlane:!1},f={color:(0,l.al)(0,0,0,.2),size:1,extensionLength:0,opacity:1,objectTransparency:i.i.OPAQUE,hasSlicePlane:!1}},49420:(e,t,o)=>{o.d(t,{F5:()=>i,HB:()=>a,a9:()=>n});var n,r,l=o(16889);function i(e){switch(e){case"multiply":default:return n.Multiply;case"ignore":return n.Ignore;case"replace":return n.Replace;case"tint":return n.Tint}}function a(e,t,o){if(null==e||t===n.Ignore)return o[0]=255,o[1]=255,o[2]=255,void(o[3]=255);const r=(0,l.uZ)(Math.round(e[3]*d),0,d),i=0===r||t===n.Tint?0:t===n.Replace?c:u;o[0]=(0,l.uZ)(Math.round(e[0]*s),0,s),o[1]=(0,l.uZ)(Math.round(e[1]*s),0,s),o[2]=(0,l.uZ)(Math.round(e[2]*s),0,s),o[3]=r+i}(r=n||(n={}))[r.Multiply=1]="Multiply",r[r.Ignore=2]="Ignore",r[r.Replace=3]="Replace",r[r.Tint=4]="Tint";const s=255,d=85,c=d,u=2*d},37107:(e,t,o)=>{o.d(t,{AD:()=>M,_N:()=>S,nO:()=>F,Hz:()=>A});var n=o(30168),r=o(41644),l=o(46228),i=o(93169),a=o(77343),s=o(37081),d=o(78980),c=o(20395),u=o(61809),p=o(99340);class f extends u.x{constructor(e,t){super(e,"int",p.P.Draw,((o,n,r)=>o.setUniform1i(e,t(n,r))))}}var v,y,m,h,b,g,x,C,w,S,T,O=o(98634),I=o(78050),E=o(4760);(T=S||(S={}))[T.Uniform=0]="Uniform",T[T.Varying=1]="Varying",T[T.COUNT=2]="COUNT";const A=429496.7296;function F(e,t){(0,l.I)(e/A*.5+.5,t)}function M(e,t){switch(t.componentData){case S.Varying:return function(e,t){const{vertex:o,fragment:r}=e;o.include(d.n),o.uniforms.add(new I.R("componentColorTex",(e=>e.componentParameters.texture.texture))),e.attributes.add(E.T.COMPONENTINDEX,"float"),e.varyings.add("vExternalColorMixMode","mediump float"),e.varyings.add("vExternalColor","vec4");const l=t.output===s.H_.ObjectAndLayerIdColor;l&&e.varyings.add("vObjectAndLayerIdColor","vec4"),e.include(a.A),o.constants.add("elevationScale","float",2*A),o.constants.add("stride","float",(0,i.Z)("enable-feature:objectAndLayerId-rendering")?3:2),o.code.add((0,O.H)(v||(v=(0,n.Z)(["vec2 getComponentTextureCoordinates(float componentIndex, float typeOffset) {\nfloat index = componentIndex * stride + typeOffset;\nfloat texSize = float(textureSize(componentColorTex, 0).x);\nfloat coordX = mod(index, texSize);\nfloat coordY = floor(index / texSize);\nreturn vec2(coordX, coordY) + 0.5;\n}"])))),o.code.add((0,O.H)(y||(y=(0,n.Z)(["\n  vec4 _readComponentColor() {\n    vec2 textureCoordinates = getComponentTextureCoordinates(componentIndex, 0.0);\n\n    return texelFetch(componentColorTex, ivec2(textureCoordinates), 0);\n   }\n\n   float readElevationOffset() {\n    vec2 textureCoordinates = getComponentTextureCoordinates(componentIndex, 1.0);\n\n    vec4 encodedElevation = texelFetch(componentColorTex, ivec2(textureCoordinates), 0);\n    return (rgba2float(encodedElevation) - 0.5) * elevationScale;\n  }\n\n  ","\n\n  vec4 forwardExternalColor(out bool castShadows) {\n    vec4 componentColor = _readComponentColor() * 255.0;\n\n    float shadowFlag = mod(componentColor.b * 255.0, 2.0);\n    componentColor.b -= shadowFlag;\n    castShadows = shadowFlag >= 1.0;\n\n    int decodedColorMixMode;\n    vExternalColor = decodeSymbolColor(componentColor, decodedColorMixMode) * 0.003921568627451; // = 1/255;\n    vExternalColorMixMode = float(decodedColorMixMode) + 0.5; // add 0.5 to avoid interpolation artifacts\n\n    return vExternalColor;\n  }\n"])),l?(0,O.H)(m||(m=(0,n.Z)(["\n          void forwardObjectAndLayerIdColor() {\n            vec2 textureCoordinates = getComponentTextureCoordinates(componentIndex, 2.0);\n\n            vObjectAndLayerIdColor = texelFetch(componentColorTex, ivec2(textureCoordinates), 0);\n          }"]))):(0,O.H)(h||(h=(0,n.Z)(["void forwardObjectAndLayerIdColor() {}"]))))),r.code.add((0,O.H)(b||(b=(0,n.Z)(["\n  void readExternalColor(out vec4 externalColor, out int externalColorMixMode) {\n    externalColor = vExternalColor;\n    externalColorMixMode = int(vExternalColorMixMode);\n  }\n\n  void outputObjectAndLayerIdColor() {\n     ","\n  }\n"])),l?(0,O.H)(g||(g=(0,n.Z)(["fragColor = vObjectAndLayerIdColor;"]))):""))}(e,t);case S.Uniform:return function(e,t){const{vertex:o,fragment:r}=e;o.uniforms.add(new c.$("externalColor",(e=>e.componentParameters.externalColor))),r.uniforms.add(new f("externalColorMixMode",(e=>e.componentParameters.externalColorMixMode))),e.varyings.add("vExternalColor","vec4"),o.code.add((0,O.H)(x||(x=(0,n.Z)(["float readElevationOffset() {\nreturn 0.0;\n}\nvoid forwardObjectAndLayerIdColor() {}\nvec4 forwardExternalColor(out bool castShadows) {\nvExternalColor = externalColor;\ncastShadows = true;\nreturn externalColor;\n}"]))));const l=t.output===s.H_.ObjectAndLayerIdColor;r.code.add((0,O.H)(C||(C=(0,n.Z)(["\n  void readExternalColor(out vec4 color, out int colorMixMode) {\n    color = vExternalColor;\n    colorMixMode = externalColorMixMode;\n  }\n\n  void outputObjectAndLayerIdColor() {\n    ","\n }\n"])),l?(0,O.H)(w||(w=(0,n.Z)(["fragColor = vec4(0,0,0,0);"]))):""))}(e,t);case S.COUNT:return;default:(0,r.Bg)(t.componentData)}}},77343:(e,t,o)=>{o.d(t,{A:()=>a});var n,r=o(30168),l=o(49420),i=o(98634);function a(e){e.vertex.code.add((0,i.H)(n||(n=(0,r.Z)(["\n    vec4 decodeSymbolColor(vec4 symbolColor, out int colorMixMode) {\n      float symbolAlpha = 0.0;\n\n      const float maxTint = 85.0;\n      const float maxReplace = 170.0;\n      const float scaleAlpha = 3.0;\n\n      if (symbolColor.a > maxReplace) {\n        colorMixMode = ",";\n        symbolAlpha = scaleAlpha * (symbolColor.a - maxReplace);\n      } else if (symbolColor.a > maxTint) {\n        colorMixMode = ",";\n        symbolAlpha = scaleAlpha * (symbolColor.a - maxTint);\n      } else if (symbolColor.a > 0.0) {\n        colorMixMode = ",";\n        symbolAlpha = scaleAlpha * symbolColor.a;\n      } else {\n        colorMixMode = ",";\n        symbolAlpha = 0.0;\n      }\n\n      return vec4(symbolColor.r, symbolColor.g, symbolColor.b, symbolAlpha);\n    }\n  "])),i.H.int(l.a9.Multiply),i.H.int(l.a9.Replace),i.H.int(l.a9.Tint),i.H.int(l.a9.Multiply)))}},37081:(e,t,o)=>{var n;function r(e){return l(e)||e===n.Depth||e===n.Normal||e===n.ObjectAndLayerIdColor}function l(e){return e===n.Shadow||e===n.ShadowHighlight||e===n.ShadowExcludeHighlight||e===n.ViewshedShadow}function i(e){return v(e)||e===n.Normal}function a(e){return e===n.Highlight||e===n.ObjectAndLayerIdColor}function s(e){return e===n.Color||a(e)}function d(e){return e===n.Color}function c(e){return d(e)||e===n.ObjectAndLayerIdColor}function u(e){return d(e)||e===n.Highlight}function p(e){return u(e)||y(e)}function f(e){return d(e)||a(e)}function v(e){return f(e)||y(e)}function y(e){return e===n.Depth}o.d(t,{BX:()=>y,CQ:()=>c,D5:()=>d,H_:()=>n,Jb:()=>i,Kr:()=>l,L_:()=>f,Xo:()=>p,_4:()=>v,_D:()=>r,ou:()=>a,xs:()=>s}),function(e){e[e.Color=0]="Color",e[e.Depth=1]="Depth",e[e.Normal=2]="Normal",e[e.Shadow=3]="Shadow",e[e.ShadowHighlight=4]="ShadowHighlight",e[e.ShadowExcludeHighlight=5]="ShadowExcludeHighlight",e[e.ViewshedShadow=6]="ViewshedShadow",e[e.Highlight=7]="Highlight",e[e.ObjectAndLayerIdColor=8]="ObjectAndLayerIdColor",e[e.COUNT=9]="COUNT"}(n||(n={}))},16010:(e,t,o)=>{o.d(t,{O:()=>p,r:()=>i});var n,r,l,i,a,s=o(30168),d=o(41644),c=o(98634),u=o(4760);function p(e,t){switch(t.normalType){case i.Compressed:e.attributes.add(u.T.NORMALCOMPRESSED,"vec2"),e.vertex.code.add((0,c.H)(n||(n=(0,s.Z)(["vec3 decompressNormal(vec2 normal) {\nfloat z = 1.0 - abs(normal.x) - abs(normal.y);\nreturn vec3(normal + sign(normal) * min(z, 0.0), z);\n}\nvec3 normalModel() {\nreturn decompressNormal(normalCompressed);\n}"]))));break;case i.Attribute:e.attributes.add(u.T.NORMAL,"vec3"),e.vertex.code.add((0,c.H)(r||(r=(0,s.Z)(["vec3 normalModel() {\nreturn normal;\n}"]))));break;case i.ScreenDerivative:e.fragment.code.add((0,c.H)(l||(l=(0,s.Z)(["vec3 screenDerivativeNormal(vec3 positionView) {\nreturn normalize(cross(dFdx(positionView), dFdy(positionView)));\n}"]))));break;default:(0,d.Bg)(t.normalType);case i.COUNT:case i.Ground:}}(a=i||(i={}))[a.Attribute=0]="Attribute",a[a.Compressed=1]="Compressed",a[a.Ground=2]="Ground",a[a.ScreenDerivative=3]="ScreenDerivative",a[a.COUNT=4]="COUNT"},27254:(e,t,o)=>{o.d(t,{$:()=>a});var n,r,l=o(30168),i=o(98634);function a(e,t){let{code:o}=e;t.doublePrecisionRequiresObfuscation?o.add((0,i.H)(n||(n=(0,l.Z)(["vec3 dpPlusFrc(vec3 a, vec3 b) {\nreturn mix(a, a + b, vec3(notEqual(b, vec3(0))));\n}\nvec3 dpMinusFrc(vec3 a, vec3 b) {\nreturn mix(vec3(0), a - b, vec3(notEqual(a, b)));\n}\nvec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {\nvec3 t1 = dpPlusFrc(hiA, hiB);\nvec3 e = dpMinusFrc(t1, hiA);\nvec3 t2 = dpMinusFrc(hiB, e) + dpMinusFrc(hiA, dpMinusFrc(t1, e)) + loA + loB;\nreturn t1 + t2;\n}"])))):o.add((0,i.H)(r||(r=(0,l.Z)(["vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {\nvec3 t1 = hiA + hiB;\nvec3 e = t1 - hiA;\nvec3 t2 = ((hiB - e) + (hiA - (t1 - e))) + loA + loB;\nreturn t1 + t2;\n}"]))))}},78980:(e,t,o)=>{o.d(t,{n:()=>i});var n,r=o(30168),l=o(98634);function i(e){e.code.add((0,l.H)(n||(n=(0,r.Z)(["const float MAX_RGBA_FLOAT =\n255.0 / 256.0 +\n255.0 / 256.0 / 256.0 +\n255.0 / 256.0 / 256.0 / 256.0 +\n255.0 / 256.0 / 256.0 / 256.0 / 256.0;\nconst vec4 FIXED_POINT_FACTORS = vec4(1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0);\nvec4 float2rgba(const float value) {\nfloat valueInValidDomain = clamp(value, 0.0, MAX_RGBA_FLOAT);\nvec4 fixedPointU8 = floor(fract(valueInValidDomain * FIXED_POINT_FACTORS) * 256.0);\nconst float toU8AsFloat = 1.0 / 255.0;\nreturn fixedPointU8 * toU8AsFloat;\n}\nconst vec4 RGBA_2_FLOAT_FACTORS = vec4(\n255.0 / (256.0),\n255.0 / (256.0 * 256.0),\n255.0 / (256.0 * 256.0 * 256.0),\n255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n);\nfloat rgba2float(vec4 rgba) {\nreturn dot(rgba, RGBA_2_FLOAT_FACTORS);\n}"]))))}},86471:(e,t,o)=>{o.d(t,{B:()=>l});var n=o(61809),r=o(99340);class l extends n.x{constructor(e,t){super(e,"vec3",r.P.Draw,((o,n,r,l)=>o.setUniform3fv(e,t(n,r,l))))}}},49450:(e,t,o)=>{o.d(t,{J:()=>l});var n=o(61809),r=o(99340);class l extends n.x{constructor(e,t){super(e,"vec3",r.P.Pass,((o,n,r)=>o.setUniform3fv(e,t(n,r))))}}},20395:(e,t,o)=>{o.d(t,{$:()=>l});var n=o(61809),r=o(99340);class l extends n.x{constructor(e,t){super(e,"vec4",r.P.Draw,((o,n,r)=>o.setUniform4fv(e,t(n,r))))}}},58406:(e,t,o)=>{o.d(t,{p:()=>l});var n=o(61809),r=o(99340);class l extends n.x{constructor(e,t){super(e,"float",r.P.Pass,((o,n,r)=>o.setUniform1f(e,t(n,r))))}}},82644:(e,t,o)=>{o.d(t,{j:()=>l});var n=o(61809),r=o(99340);class l extends n.x{constructor(e,t){super(e,"mat3",r.P.Draw,((o,n,r)=>o.setUniformMatrix3fv(e,t(n,r))))}}},35522:(e,t,o)=>{o.d(t,{c:()=>l});var n=o(61809),r=o(99340);class l extends n.x{constructor(e,t){super(e,"mat3",r.P.Pass,((o,n,r)=>o.setUniformMatrix3fv(e,t(n,r))))}}},8654:(e,t,o)=>{o.d(t,{g:()=>l});var n=o(61809),r=o(99340);class l extends n.x{constructor(e,t){super(e,"mat4",r.P.Pass,((o,n,r)=>o.setUniformMatrix4fv(e,t(n,r))))}}},78050:(e,t,o)=>{o.d(t,{R:()=>l});var n=o(61809),r=o(99340);class l extends n.x{constructor(e,t){super(e,"sampler2D",r.P.Draw,((o,n,r)=>o.bindTexture(e,t(n,r))))}}},61809:(e,t,o)=>{o.d(t,{x:()=>r});var n=o(99340);class r{constructor(e,t,o,r){let l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(this.name=e,this.type=t,this.arraySize=l,this.bind={[n.P.Pass]:null,[n.P.Draw]:null},r)switch(o){case n.P.Pass:this.bind[n.P.Pass]=r;break;case n.P.Draw:this.bind[n.P.Draw]=r}}equals(e){return this.type===e.type&&this.name===e.name&&this.arraySize===e.arraySize}}},98634:(e,t,o)=>{o.d(t,{H:()=>r,K:()=>n});const n=class{};function r(e){let t="";for(let o=0;o<(arguments.length<=1?0:arguments.length-1);o++)t+=e[o]+(o+1<1||arguments.length<=o+1?void 0:arguments[o+1]);return t+=e[e.length-1],t}!function(e){e.int=function(e){return Math.round(e).toString()},e.float=function(e){return e.toPrecision(8)}}(r||(r={}))},99340:(e,t,o)=>{var n;o.d(t,{P:()=>n}),function(e){e[e.Pass=0]="Pass",e[e.Draw=1]="Draw"}(n||(n={}))},4760:(e,t,o)=>{var n;function r(e){return e===n.POSITION}o.d(t,{T:()=>n,j:()=>r}),function(e){e.POSITION="position",e.NORMAL="normal",e.NORMALCOMPRESSED="normalCompressed",e.UV0="uv0",e.COLOR="color",e.SYMBOLCOLOR="symbolColor",e.SIZE="size",e.TANGENT="tangent",e.OFFSET="offset",e.PERSPECTIVEDIVIDE="perspectiveDivide",e.CENTEROFFSETANDDISTANCE="centerOffsetAndDistance",e.LENGTH="length",e.PREVPOSITION="prevPosition",e.NEXTPOSITION="nextPosition",e.SUBDIVISIONFACTOR="subdivisionFactor",e.COLORFEATUREATTRIBUTE="colorFeatureAttribute",e.SIZEFEATUREATTRIBUTE="sizeFeatureAttribute",e.OPACITYFEATUREATTRIBUTE="opacityFeatureAttribute",e.DISTANCETOSTART="distanceToStart",e.UVMAPSPACE="uvMapSpace",e.BOUNDINGRECT="boundingRect",e.UVREGION="uvRegion",e.PROFILERIGHT="profileRight",e.PROFILEUP="profileUp",e.PROFILEVERTEXANDNORMAL="profileVertexAndNormal",e.FEATUREVALUE="featureValue",e.INSTANCEMODELORIGINHI="instanceModelOriginHi",e.INSTANCEMODELORIGINLO="instanceModelOriginLo",e.INSTANCEMODEL="instanceModel",e.INSTANCEMODELNORMAL="instanceModelNormal",e.INSTANCECOLOR="instanceColor",e.INSTANCEFEATUREATTRIBUTE="instanceFeatureAttribute",e.LOCALTRANSFORM="localTransform",e.GLOBALTRANSFORM="globalTransform",e.BOUNDINGSPHERE="boundingSphere",e.MODELORIGIN="modelOrigin",e.MODELSCALEFACTORS="modelScaleFactors",e.FEATUREATTRIBUTE="featureAttribute",e.STATE="state",e.LODLEVEL="lodLevel",e.POSITION0="position0",e.POSITION1="position1",e.NORMAL2COMPRESSED="normal2Compressed",e.COMPONENTINDEX="componentIndex",e.VARIANTOFFSET="variantOffset",e.VARIANTSTROKE="variantStroke",e.VARIANTEXTENSION="variantExtension",e.SIDENESS="sideness",e.START="start",e.END="end",e.UP="up",e.EXTRUDE="extrude",e.OBJECTANDLAYERIDCOLOR="objectAndLayerIdColor",e.INSTANCEOBJECTANDLAYERIDCOLOR="instanceObjectAndLayerIdColor"}(n||(n={}))},77958:(e,t,o)=>{var n;o.d(t,{i:()=>n}),function(e){e[e.INVISIBLE=0]="INVISIBLE",e[e.TRANSPARENT=1]="TRANSPARENT",e[e.OPAQUE=2]="OPAQUE"}(n||(n={}))},34016:(e,t,o)=>{o.d(t,{G7:()=>b,Pb:()=>h,UR:()=>L,lV:()=>_});var n,r,l,i,a,s,d,c,u,p,f,v,y,m,h,b,g,x=o(30168),C=o(37107),w=o(16010),S=o(27254),T=o(78980),O=o(86471),I=o(49450),E=o(58406),A=o(98634),F=o(82644),M=o(35522),R=o(8654),P=o(78050),N=o(4760);function L(e,t){const o=e.vertex;o.include(T.n),e.include(w.O,t),o.uniforms.add(new E.p("distanceFalloffFactor",(e=>e.distanceFalloffFactor))),o.code.add((0,A.H)(n||(n=(0,x.Z)(["float distanceBasedPerspectiveFactor(float distance) {\nreturn clamp(sqrt(distanceFalloffFactor / distance), 0.0, 1.0);\n}"])))),o.uniforms.add(new P.R("componentDataTex",(e=>e.componentDataTexture))),e.attributes.add(N.T.COMPONENTINDEX,"float"),o.constants.add("componentColorFieldOffset","float",0),o.constants.add("componentOtherFieldOffset","float",1),o.constants.add("componentVerticalOffsetFieldOffset","float",2),o.constants.add("componentFieldCount","float",3),o.constants.add("lineWidthFractionFactor","float",8),o.constants.add("extensionLengthOffset","float",128),o.constants.add("verticalOffsetScale","float",2*C.Hz),o.code.add((0,A.H)(r||(r=(0,x.Z)(["\n    vec2 _componentTextureCoords(float componentIndex, float fieldOffset) {\n      float fieldIndex = componentFieldCount * componentIndex + fieldOffset;\n      float texSize = float(textureSize(componentDataTex, 0).x);\n      float colIndex = mod(fieldIndex, texSize);\n      float rowIndex = floor(fieldIndex / texSize);\n\n      return vec2(colIndex, rowIndex) + 0.5;\n    }\n\n    struct ComponentData {\n      vec4 color;\n      vec3 normal;\n      vec3 normal2;\n      float lineWidth;\n      float extensionLength;\n      float type;\n      float verticalOffset;\n    };\n\n    ComponentData readComponentData() {\n      vec2 colorIndex = _componentTextureCoords(componentIndex, componentColorFieldOffset);\n      vec2 otherIndex = _componentTextureCoords(componentIndex, componentOtherFieldOffset);\n      vec2 verticalOffsetIndex = _componentTextureCoords(componentIndex, componentVerticalOffsetFieldOffset);\n      vec3 normal = normalModel();\n      vec3 normal2 = ",";\n\n      vec4 colorValue = texelFetch(componentDataTex, ivec2(colorIndex), 0);\n      vec4 otherValue = texelFetch(componentDataTex, ivec2(otherIndex), 0);\n      float verticalOffset = (rgba2float(texelFetch(componentDataTex, ivec2(verticalOffsetIndex), 0)) - 0.5) * verticalOffsetScale;\n\n      return ComponentData(\n        vec4(colorValue.rgb, colorValue.a * otherValue.w), // otherValue.w stores separate opacity\n        normal, normal2,\n        otherValue.x * (255.0 / lineWidthFractionFactor),\n        otherValue.y * 255.0 - extensionLengthOffset,\n        -(otherValue.z * 255.0) + 0.5, // SOLID (=0/255) needs to be > 0.0, SKETCHY (=1/255) needs to be <= 0;\n        verticalOffset\n      );\n    }\n  "])),t.silhouette?(0,A.H)(l||(l=(0,x.Z)(["decompressNormal(normal2Compressed)"]))):(0,A.H)(i||(i=(0,x.Z)(["normal"]))))),t.legacy?o.code.add((0,A.H)(a||(a=(0,x.Z)(["vec3 _modelToWorldNormal(vec3 normal) {\nreturn (model * vec4(normal, 0.0)).xyz;\n}\nvec3 _modelToViewNormal(vec3 normal) {\nreturn (localView * model * vec4(normal, 0.0)).xyz;\n}"])))):(o.uniforms.add(new F.j("transformNormalGlobalFromModel",(e=>e.transformNormalGlobalFromModel))),o.code.add((0,A.H)(s||(s=(0,x.Z)(["vec3 _modelToWorldNormal(vec3 normal) {\nreturn transformNormalGlobalFromModel * normal;\n}"]))))),t.silhouette?(e.attributes.add(N.T.NORMAL2COMPRESSED,"vec2"),o.code.add((0,A.H)(d||(d=(0,x.Z)(["vec3 worldNormal(ComponentData data) {\nreturn _modelToWorldNormal(normalize(data.normal + data.normal2));\n}"]))))):o.code.add((0,A.H)(c||(c=(0,x.Z)(["vec3 worldNormal(ComponentData data) {\nreturn _modelToWorldNormal(data.normal);\n}"])))),t.legacy?o.code.add((0,A.H)(u||(u=(0,x.Z)(["void worldAndViewFromModelPosition(vec3 modelPos, float verticalOffset, out vec3 worldPos, out vec3 viewPos) {\nworldPos = (model * vec4(modelPos, 1.0)).xyz;\nviewPos = (localView * vec4(worldPos, 1.0)).xyz;\n}"])))):(o.include(S.$,t),o.uniforms.add(new M.c("transformViewFromCameraRelativeRS",(e=>e.transformViewFromCameraRelativeRS)),new F.j("transformWorldFromModelRS",(e=>e.transformWorldFromModelRS)),new O.B("transformWorldFromModelTL",(e=>e.transformWorldFromModelTL)),new O.B("transformWorldFromModelTH",(e=>e.transformWorldFromModelTH)),new I.J("transformWorldFromViewTL",(e=>e.transformWorldFromViewTL)),new I.J("transformWorldFromViewTH",(e=>e.transformWorldFromViewTH))),o.code.add((0,A.H)(p||(p=(0,x.Z)(["\n      void worldAndViewFromModelPosition(vec3 modelPos, float verticalOffset, out vec3 worldPos, out vec3 viewPos) {\n        vec3 rotatedModelPosition = transformWorldFromModelRS * modelPos;\n\n        vec3 transformCameraRelativeFromModel = dpAdd(\n          transformWorldFromModelTL,\n          transformWorldFromModelTH,\n          -transformWorldFromViewTL,\n          -transformWorldFromViewTH\n        );\n\n        worldPos = transformCameraRelativeFromModel + rotatedModelPosition;\n\n        if (verticalOffset != 0.0) {\n          vec3 vUp = ","\n          worldPos += verticalOffset * vUp;\n        }\n\n        viewPos = transformViewFromCameraRelativeRS * worldPos;\n      }\n    "])),t.spherical?(0,A.H)(f||(f=(0,x.Z)(["normalize(transformWorldFromModelTL + rotatedModelPosition);"]))):(0,A.H)(v||(v=(0,x.Z)(["vec3(0.0, 0.0, 1.0);"])))))),o.uniforms.add(new R.g("transformProjFromView",((e,t)=>t.camera.projectionMatrix))),o.code.add((0,A.H)(y||(y=(0,x.Z)(["vec4 projFromViewPosition(vec3 position) {\nreturn transformProjFromView * vec4(position, 1.0);\n}"])))),o.code.add((0,A.H)(m||(m=(0,x.Z)(["float calculateExtensionLength(float extensionLength, float lineLength) {\nreturn extensionLength / (log2(max(1.0, 256.0 / lineLength)) * 0.2 + 1.0);\n}"]))))}function _(e){return e===h.Sketch||e===h.Mixed}(g=h||(h={}))[g.Solid=0]="Solid",g[g.Sketch=1]="Sketch",g[g.Mixed=2]="Mixed",g[g.COUNT=3]="COUNT",function(e){e[e.REGULAR=0]="REGULAR",e[e.SILHOUETTE=1]="SILHOUETTE"}(b||(b={}))},24405:(e,t,o)=>{o.d(t,{V5:()=>l,e7:()=>r,zc:()=>i});var n=o(37270);async function r(e){var t,o;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.popupTemplate;if(null==r)return[];const l=await r.getRequiredFields(e.fieldsIndex),{lastEditInfoEnabled:i}=r,{objectIdField:a,typeIdField:s,globalIdField:d,relationships:c}=e;if(l.includes("*"))return["*"];const u=i?(0,n.CH)(e):[],p=(0,n.Q0)(e.fieldsIndex,[...l,...u]);return s&&p.push(s),p&&a&&null!==(t=e.fieldsIndex)&&void 0!==t&&t.has(a)&&!p.includes(a)&&p.push(a),p&&d&&null!==(o=e.fieldsIndex)&&void 0!==o&&o.has(d)&&!p.includes(d)&&p.push(d),c&&c.forEach((t=>{var o;const{keyField:n}=t;p&&n&&(null===(o=e.fieldsIndex)||void 0===o?void 0:o.has(n))&&!p.includes(n)&&p.push(n)})),p}function l(e,t){return e.popupTemplate?e.popupTemplate:null!=t&&t.defaultPopupTemplateEnabled&&null!=e.defaultPopupTemplate?e.defaultPopupTemplate:null}function i(e,t){return null!=l(e,{defaultPopupTemplateEnabled:t})}}}]);
//# sourceMappingURL=98549.51de0781.chunk.js.map