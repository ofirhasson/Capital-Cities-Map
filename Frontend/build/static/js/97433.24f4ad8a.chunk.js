"use strict";(self.webpackChunknorthwind=self.webpackChunknorthwind||[]).push([[97433,92463,2170],{92463:(e,t,i)=>{i.r(t),i.d(t,{hydratedAdapter:()=>l});var n=i(53866),r=i(77577),a=i(848),s=i(80885),o=i(29909);const l={convertToGEGeometry:function(e,t){if(null==t)return null;let i="cache"in t?t.cache._geVersion:void 0;return null==i&&(i=e.convertJSONToGeometry(t),"cache"in t&&(t.cache._geVersion=i)),i},exportPoint:function(e,t,i){const n=e.hasZ(t),r=e.hasM(t),s=new a.Z({x:e.getPointX(t),y:e.getPointY(t),spatialReference:i});return n&&(s.z=e.getPointZ(t)),r&&(s.m=e.getPointM(t)),s.cache._geVersion=t,s},exportPolygon:function(e,t,i){const n=new s.Z({rings:e.exportPaths(t),hasZ:e.hasZ(t),hasM:e.hasM(t),spatialReference:i});return n.cache._geVersion=t,n},exportPolyline:function(e,t,i){const n=new o.Z({paths:e.exportPaths(t),hasZ:e.hasZ(t),hasM:e.hasM(t),spatialReference:i});return n.cache._geVersion=t,n},exportMultipoint:function(e,t,i){const n=new r.Z({hasZ:e.hasZ(t),hasM:e.hasM(t),points:e.exportPoints(t),spatialReference:i});return n.cache._geVersion=t,n},exportExtent:function(e,t,i){const r=e.hasZ(t),a=e.hasM(t),s=new n.Z({xmin:e.getXMin(t),ymin:e.getYMin(t),xmax:e.getXMax(t),ymax:e.getYMax(t),spatialReference:i});if(r){const i=e.getZExtent(t);s.zmin=i.vmin,s.zmax=i.vmax}if(a){const i=e.getMExtent(t);s.mmin=i.vmin,s.mmax=i.vmax}return s.cache._geVersion=t,s}}},2170:(e,t,i)=>{i.r(t),i.d(t,{buffer:()=>D,changeDefaultSpatialReferenceTolerance:()=>j,clearDefaultSpatialReferenceTolerance:()=>W,clip:()=>o,contains:()=>c,convexHull:()=>y,crosses:()=>d,cut:()=>l,densify:()=>F,difference:()=>V,disjoint:()=>m,distance:()=>u,equals:()=>h,extendedSpatialReferenceInfo:()=>s,flipHorizontal:()=>P,flipVertical:()=>H,generalize:()=>z,geodesicArea:()=>k,geodesicBuffer:()=>O,geodesicDensify:()=>G,geodesicLength:()=>Z,intersect:()=>M,intersectLinesToPoints:()=>N,intersects:()=>p,isSimple:()=>g,nearestCoordinate:()=>A,nearestVertex:()=>T,nearestVertices:()=>R,offset:()=>S,overlaps:()=>_,planarArea:()=>I,planarLength:()=>L,relate:()=>w,rotate:()=>U,simplify:()=>b,symmetricDifference:()=>C,touches:()=>v,union:()=>E,within:()=>f});var n=i(99058),r=i(92463);function a(e){return Array.isArray(e)?e[0].spatialReference:e&&e.spatialReference}function s(e){return n.G.extendedSpatialReferenceInfo(e)}function o(e,t){return n.G.clip(r.hydratedAdapter,a(e),e,t)}function l(e,t){return n.G.cut(r.hydratedAdapter,a(e),e,t)}function c(e,t){return n.G.contains(r.hydratedAdapter,a(e),e,t)}function d(e,t){return n.G.crosses(r.hydratedAdapter,a(e),e,t)}function u(e,t,i){return n.G.distance(r.hydratedAdapter,a(e),e,t,i)}function h(e,t){return n.G.equals(r.hydratedAdapter,a(e),e,t)}function p(e,t){return n.G.intersects(r.hydratedAdapter,a(e),e,t)}function v(e,t){return n.G.touches(r.hydratedAdapter,a(e),e,t)}function f(e,t){return n.G.within(r.hydratedAdapter,a(e),e,t)}function m(e,t){return n.G.disjoint(r.hydratedAdapter,a(e),e,t)}function _(e,t){return n.G.overlaps(r.hydratedAdapter,a(e),e,t)}function w(e,t,i){return n.G.relate(r.hydratedAdapter,a(e),e,t,i)}function g(e){return n.G.isSimple(r.hydratedAdapter,a(e),e)}function b(e){return n.G.simplify(r.hydratedAdapter,a(e),e)}function y(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return n.G.convexHull(r.hydratedAdapter,a(e),e,t)}function V(e,t){return n.G.difference(r.hydratedAdapter,a(e),e,t)}function C(e,t){return n.G.symmetricDifference(r.hydratedAdapter,a(e),e,t)}function M(e,t){return n.G.intersect(r.hydratedAdapter,a(e),e,t)}function E(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return n.G.union(r.hydratedAdapter,a(e),e,t)}function S(e,t,i,s,o,l){return n.G.offset(r.hydratedAdapter,a(e),e,t,i,s,o,l)}function D(e,t,i){let s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return n.G.buffer(r.hydratedAdapter,a(e),e,t,i,s)}function O(e,t,i,s,o,l){return n.G.geodesicBuffer(r.hydratedAdapter,a(e),e,t,i,s,o,l)}function A(e,t){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return n.G.nearestCoordinate(r.hydratedAdapter,a(e),e,t,i)}function T(e,t){return n.G.nearestVertex(r.hydratedAdapter,a(e),e,t)}function R(e,t,i,s){return n.G.nearestVertices(r.hydratedAdapter,a(e),e,t,i,s)}function x(e){var t,i;return"xmin"in e?"center"in e?e.center:null:"x"in e?e:"extent"in e&&null!==(t=null===(i=e.extent)||void 0===i?void 0:i.center)&&void 0!==t?t:null}function U(e,t,i){var r;if(null==e)throw new B;const a=e.spatialReference;if(null==(i=null!==(r=i)&&void 0!==r?r:x(e)))throw new B;const s=e.constructor.fromJSON(n.G.rotate(e,t,i));return s.spatialReference=a,s}function P(e,t){var i;if(null==e)throw new B;const r=e.spatialReference;if(null==(t=null!==(i=t)&&void 0!==i?i:x(e)))throw new B;const a=e.constructor.fromJSON(n.G.flipHorizontal(e,t));return a.spatialReference=r,a}function H(e,t){var i;if(null==e)throw new B;const r=e.spatialReference;if(null==(t=null!==(i=t)&&void 0!==i?i:x(e)))throw new B;const a=e.constructor.fromJSON(n.G.flipVertical(e,t));return a.spatialReference=r,a}function z(e,t,i,s){return n.G.generalize(r.hydratedAdapter,a(e),e,t,i,s)}function F(e,t,i){return n.G.densify(r.hydratedAdapter,a(e),e,t,i)}function G(e,t,i){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return n.G.geodesicDensify(r.hydratedAdapter,a(e),e,t,i,s)}function I(e,t){return n.G.planarArea(r.hydratedAdapter,a(e),e,t)}function L(e,t){return n.G.planarLength(r.hydratedAdapter,a(e),e,t)}function k(e,t,i){return n.G.geodesicArea(r.hydratedAdapter,a(e),e,t,i)}function Z(e,t,i){return n.G.geodesicLength(r.hydratedAdapter,a(e),e,t,i)}function N(e,t){return n.G.intersectLinesToPoints(r.hydratedAdapter,a(e),e,t)}function j(e,t){n.G.changeDefaultSpatialReferenceTolerance(e,t)}function W(e){n.G.clearDefaultSpatialReferenceTolerance(e)}class B extends Error{constructor(){super("Illegal Argument Exception")}}},98074:(e,t,i)=>{i.d(t,{p:()=>l});var n=i(27366),r=i(42537),a=i(67426),s=i(49861),o=(i(93169),i(32718),i(84936),i(69912));const l=e=>{let t=class extends((0,a.v)(e)){constructor(){super(...arguments),this.parent=null,this._userInteractive=!1,this._interactiveViewModelCount=0}get interactive(){return this._interactiveViewModelCount>0||this._userInteractive}set interactive(e){this._userInteractive=e}get updating(){return!1}get visible(){return null==this.parent||this.parent.visible&&!this.parent.suspended}set visible(e){this._overrideIfSome("visible",e)}forceInteractiveForViewModel(){return this._interactiveViewModelCount++,(0,r.kB)((()=>this._interactiveViewModelCount--))}};return(0,n._)([(0,s.Cb)({constructOnly:!0})],t.prototype,"parent",void 0),(0,n._)([(0,s.Cb)({constructOnly:!0})],t.prototype,"view",void 0),(0,n._)([(0,s.Cb)({type:Boolean})],t.prototype,"interactive",null),(0,n._)([(0,s.Cb)()],t.prototype,"_userInteractive",void 0),(0,n._)([(0,s.Cb)({readOnly:!0})],t.prototype,"updating",null),(0,n._)([(0,s.Cb)()],t.prototype,"visible",null),(0,n._)([(0,s.Cb)()],t.prototype,"_interactiveViewModelCount",void 0),t=(0,n._)([(0,o.j)("esri.views.3d.analysis.AnalysisView3D")],t),t}},3319:(e,t,i)=>{i.d(t,{AN:()=>d,C7:()=>V,Ci:()=>A,Eu:()=>y,G0:()=>p,GI:()=>s,GW:()=>b,K_:()=>C,L0:()=>l,Lf:()=>m,Mr:()=>o,P3:()=>u,QG:()=>M,Qf:()=>D,Wp:()=>h,XC:()=>c,Yn:()=>S,ZE:()=>v,ae:()=>T,cf:()=>E,fg:()=>_,sz:()=>w,tW:()=>a,tv:()=>g,v9:()=>f,yy:()=>O});var n=i(93169),r=i(16889);const a=(0,n.Z)("mac")?"Meta":"Control",s="Shift",o=2,l=1.15,c=1.15,d=2500,u=.02,h=Math.cos((0,r.Vl)(45)),p=Math.cos((0,r.Vl)(5)),v=.95,f=.3,m=2,_=1,w=3,g=11,b=22.5,y=40,V=48,C=2.25,M=4,E=1,S=.3,D=6,O=4,A=1600,T=.4},44549:(e,t,i)=>{i.r(t),i.d(t,{default:()=>yt});var n=i(27366),r=i(7138),a=i(92026),s=i(94172),o=i(49861),l=(i(93169),i(32718),i(84936),i(69912)),c=i(98074),d=i(42537),u=i(51995),h=i(84652),p=i(16889),v=i(29134),f=i(7025),m=i(32035),_=i(12400),w=(i(13611),i(6644)),g=i(2170),b=(i(51378),i(83639)),y=i(51328);function V(e,t){let{tiltedUpVector:i,rightVector:n,observerRenderSpace:r}=e;const a=(0,b.Aq)(i,n,r,t);return a[12]=0,a[13]=0,a[14]=0,a}function C(e,t,i){const n=(0,_.Ue)(),r=(0,m.b)((0,_.Ue)(),i.basis1,i.basis2);return e.next((0,y._N)(t,i.plane)).next((e=>{"start"===e.action&&(0,m.c)(n,e.renderStart);const t=(0,p.BV)((0,b.Gd)(n,e.renderEnd,i.origin,r));return{...e,deltaAngle:t}}))}function M(e,t){if(null==e)return 0;const{observer:i,target:n}=e,r=t.camera.position,a=(0,g.distance)(r,i)>(0,g.distance)(r,n)?i:n;return t.pixelSizeAt(a)}(0,w.Ue)();var E=i(33837),S=i(56529),D=i(86700);const O=new u.Z([85,85,85,.5]);let A=class extends r.default{constructor(e){super(e),this.visible=!0,this._viewshedCorners={topLeft:(0,_.Ue)(),topRight:(0,_.Ue)(),bottomLeft:(0,_.Ue)(),bottomRight:(0,_.Ue)(),center:(0,_.Ue)()},this._arcCenterPoints={top:(0,_.Ue)(),bottom:(0,_.Ue)(),left:(0,_.Ue)(),right:(0,_.Ue)()},this._parallelCenters={top:(0,_.Ue)(),bottom:(0,_.Ue)()}}initialize(){const e={view:this.view,isDecoration:!0,color:this._color,renderOccluded:S.yD.OccludeAndTransparent},t={...e,width:2,stipplePattern:(0,D.z5)(2)};this._boundaryLinesVisualElement=new E.r(e),this._leftArcVisualElement=new E.r(e),this._rightArcVisualElement=new E.r(e),this._topArcVisualElement=new E.r(e),this._bottomArcVisualElement=new E.r(e),this._centralLongitude=new E.r(t),this._centralLatitude=new E.r(t),this.addHandles([(0,s.watch)((()=>{const e=this.viewshedComputedData;if(null===e||void 0===e||!e.isValid())return null;const t=this._offsetScale,i=this._viewshedCorners,n=this._arcCenterPoints,r=this._parallelCenters;return e.cornerPoints(t,i),e.arcCentersPoints(t,n),e.parallelCenterPoints(r),{viewshedComputedData:e,corners:i,arcCenters:n,parallelCenters:r}}),(e=>{null!=e?(this._forEachVisualElement((e=>e.attached=!0)),this._updateVisualElements(e)):this._forEachVisualElement((e=>e.attached=!1))}),{initial:!0,equals:h.fS}),(0,s.watch)((()=>{var e;return{visible:this.visible,horFOV:null===(e=this.viewshedComputedData)||void 0===e?void 0:e.horizontalFieldOfView}}),((e,t)=>{let{visible:i,horFOV:n}=e;i!==(null===t||void 0===t?void 0:t.visible)&&this._forEachVisualElement((e=>e.visible=i)),i&&n!==(null===t||void 0===t?void 0:t.horFOV)&&(this._boundaryLinesVisualElement.visible=360!==n)}),s.initial),(0,s.watch)((()=>this._color),(e=>this._forEachVisualElement((t=>t.color=e))),s.initial)])}get _color(){var e,t;const i=this.viewshedComputedData;if(null==i)return u.Z.toUnitRGBA(O);const n=this.analysisViewData,r=(null===(e=n.tool)||void 0===e?void 0:e.active)||n.interactive,a=i===n.selectedViewshedComputedData,s=i.viewshed===(null===(t=n.tool)||void 0===t?void 0:t.stagedViewshed),o=r&&(a||s)?this.view.effectiveTheme.accentColor:O;return u.Z.toUnitRGBA(o)}get _offsetScale(){return M(this.viewshedComputedData,this.view)}destroy(){this._boundaryLinesVisualElement=(0,a.SC)(this._boundaryLinesVisualElement),this._leftArcVisualElement=(0,a.SC)(this._leftArcVisualElement),this._rightArcVisualElement=(0,a.SC)(this._rightArcVisualElement),this._topArcVisualElement=(0,a.SC)(this._topArcVisualElement),this._bottomArcVisualElement=(0,a.SC)(this._bottomArcVisualElement),this._centralLongitude=(0,a.SC)(this._centralLongitude),this._centralLatitude=(0,a.SC)(this._centralLatitude)}_forEachVisualElement(e){[this._boundaryLinesVisualElement,this._leftArcVisualElement,this._rightArcVisualElement,this._topArcVisualElement,this._bottomArcVisualElement,this._centralLatitude,this._centralLongitude].forEach(e)}_updateVisualElements(e){const{viewshedComputedData:t,corners:i,arcCenters:n,parallelCenters:r}=e;this._updateBoundaryLines(i),this._updateBoundaryArcs(t,i,r),this._updateCentralHelperArcs(t,n)}_updateBoundaryLines(e){this._boundaryLinesVisualElement.geometry=[[e.center,e.topLeft],[e.center,e.topRight],[e.center,e.bottomLeft],[e.center,e.bottomRight]]}_updateBoundaryArcs(e,t,i){const{observerRenderSpace:n,rightVector:r,horizontalFieldOfView:a,tiltedUpVector:s}=e,o=(0,p.Vl)(a),l=(0,_.Ue)(),c=(0,f.Ue)();(0,v.Us)(c,o/2,s),(0,m.h)(l,r,c),T(this._leftArcVisualElement,n,t.bottomLeft,t.topLeft,"forward",l),(0,v.Us)(c,-o/2,s),(0,m.s)(l,0,0,0),(0,m.h)(l,r,c),T(this._rightArcVisualElement,n,t.bottomRight,t.topRight,"forward",l);const d=a>180?"backward":"forward";T(this._topArcVisualElement,i.top,t.topRight,t.topLeft,d,s),T(this._bottomArcVisualElement,i.bottom,t.bottomRight,t.bottomLeft,d,s)}_updateCentralHelperArcs(e,t){const i=e.observerRenderSpace,n=e.horizontalFieldOfView>=180?"backward":"forward";T(this._centralLatitude,i,t.right,t.left,n,e.tiltedUpVector),T(this._centralLongitude,i,t.top,t.bottom,"forward",e.leftVector)}};function T(e,t,i,n,r,a){let s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:5;const o=(0,_.Ue)();(0,m.z)(o,i,t);const l=(0,m.H)(o),c=(0,_.Ue)();(0,m.z)(c,n,t),(0,m.n)(c,c),(0,m.j)(c,c,l);let d=(0,m.d)(o,c);const u=(0,_.d9)(a);"backward"===r&&((0,m.k)(u,u),d=-(2*Math.PI-d));const h=[],w=Math.ceil(Math.abs(d)/(0,p.Vl)(s)),g=(0,f.Ue)();(0,v.Us)(g,d/w,u);const b=(0,_.Ue)();(0,m.c)(b,o);const y=(0,_.Ue)();(0,m.c)(y,i);for(let p=0;p<w;p++){const e=(0,_.Ue)();(0,m.c)(e,y),(0,m.h)(b,b,g),(0,m.g)(y,t,b);const i=(0,_.Ue)();(0,m.c)(i,y),h.push([e,i])}e.geometry=h}(0,n._)([(0,o.Cb)()],A.prototype,"view",void 0),(0,n._)([(0,o.Cb)()],A.prototype,"analysisViewData",void 0),(0,n._)([(0,o.Cb)()],A.prototype,"viewshedComputedData",void 0),(0,n._)([(0,o.Cb)()],A.prototype,"visible",void 0),(0,n._)([(0,o.Cb)()],A.prototype,"_color",null),(0,n._)([(0,o.Cb)()],A.prototype,"_offsetScale",null),A=(0,n._)([(0,l.j)("esri.views.3d.analysis.Viewshed.ViewshedVisualization")],A);const R=A;let x=class extends r.default{get visible(){return this.analysisViewData.visible}constructor(e){super(e)}initialize(){const e=this.analysisViewData,t=(0,s.mapCollection)((()=>this.analysisViewData.viewshedComputedDataHandles),(t=>{let{viewshedComputedData:i}=t;const n=new R({view:this.view,viewshedComputedData:i,analysisViewData:e});return{visualization:n,remove:()=>n.destroy()}}));this._viewshedVisualizations=t,this.addHandles([(0,d.ed)(t),(0,s.watch)((()=>this.visible),(e=>this._viewshedVisualizations.forEach((t=>{let{visualization:i}=t;return i.visible=e}))))])}};(0,n._)([(0,o.Cb)({constructOnly:!0})],x.prototype,"analysisViewData",void 0),(0,n._)([(0,o.Cb)({constructOnly:!0,nonNullable:!0})],x.prototype,"view",void 0),(0,n._)([(0,o.Cb)({constructOnly:!0})],x.prototype,"isDecoration",void 0),(0,n._)([(0,o.Cb)()],x.prototype,"visible",null),x=(0,n._)([(0,l.j)("esri.views.3d.analysis.Viewshed.ViewshedAnalysisVisualization")],x);i(59486);var U,P=i(848);let H=U=class extends r.default{constructor(e){super(e)}get observer(){var e;return null!==(e=this.viewshed.observer)&&void 0!==e?e:new P.Z}get farDistance(){return this.viewshed.farDistance}get farDistanceRenderSpace(){return this.farDistance/this.metersPerUnit}get heading(){return this.viewshed.heading}get tilt(){return this.viewshed.tilt}get tiltParallelToSurface(){return this.tilt-90}get horizontalFieldOfView(){return this.viewshed.horizontalFieldOfView}get verticalFieldOfView(){return this.viewshed.verticalFieldOfView}get observerRenderSpace(){return this._pointToRenderSpace(this.observer,(0,_.Ue)())}get target(){const e=this.targetRenderSpace;return this.renderSpaceToPoint(e,this.observer.spatialReference)}get targetRenderSpace(){const{leftVector:e,northVector:t,upVector:i}=this,n=this.observerRenderSpace,r=this.farDistanceRenderSpace,a=(0,_.Ue)();return(0,m.j)(a,t,r),F(a,-(0,p.Vl)(this.heading),i,a),F(a,-(0,p.Vl)(this.tiltParallelToSurface),e,a),(0,m.g)(a,n,a),a}get targetDirection(){const e=(0,m.z)((0,_.Ue)(),this.targetRenderSpace,this.observerRenderSpace);return(0,m.n)(e,e)}get tiltedUpVector(){const e=F(this.upVector,-(0,p.Vl)(this.tiltParallelToSurface),this.leftVector,(0,_.Ue)());return(0,m.n)(e,e)}get _basis(){return this.renderCoordsHelper.basisMatrixAtPosition(this.observerRenderSpace,(0,f.Ue)())}get upVector(){const e=this._basis;return(0,_.al)(e[8],e[9],e[10])}get northVector(){const e=this._basis;return(0,_.al)(e[4],e[5],e[6])}get leftVector(){const e=this.upVector,t=F(this.northVector,-(0,p.Vl)(this.heading),e,(0,_.Ue)());return(0,m.b)(t,e,t)}get rightVector(){return(0,m.k)((0,_.Ue)(),this.leftVector)}clone(){return new U({renderCoordsHelper:this.renderCoordsHelper,viewshed:this.viewshed.clone()})}isValid(){return this.viewshed.isValid()}get metersPerUnit(){return this.renderCoordsHelper.spatialReference.metersPerUnit}pointOnSphere(e,t,i){const{observerRenderSpace:n,targetRenderSpace:r}=this,a=(0,m.z)(L,r,n);return F(a,-(0,p.Vl)(t),this.leftVector,a),F(a,-(0,p.Vl)(e),this.tiltedUpVector,a),(0,m.g)(i,a,n)}cornerPoints(e,t){const i=this.observerRenderSpace,n=this.horizontalFieldOfView/2,r=this.verticalFieldOfView/2,a=this.pointOnSphere(-n,r,q),s=this.pointOnSphere(n,r,Y),o=this.pointOnSphere(-n,-r,Q),l=this.pointOnSphere(n,-r,J),c=(0,m.z)(j,a,i),d=(0,m.z)(W,s,i),u=(0,m.z)(B,o,i),h=(0,m.z)(X,l,i),{horizontalFieldOfView:p}=this,v=Z;z(c,d,a,o,i,e,p,t.topLeft,t.bottomLeft,v);const f=N;z(h,u,s,l,i,e,p,t.topRight,t.bottomRight,f),(0,m.j)(t.center,(0,m.g)(t.center,f,v),.5)}arcCentersPoints(e,t){const i=this.horizontalFieldOfView/2,n=this.verticalFieldOfView/2,r=this.pointOnSphere(0,n,t.top),a=this.pointOnSphere(0,-n,t.bottom),s=this.pointOnSphere(-i,0,t.left),o=this.pointOnSphere(i,0,t.right),{observerRenderSpace:l}=this;I(r,l,e),I(a,l,e),I(s,l,e),I(o,l,e)}parallelCenterPoints(e){const t=this.observerRenderSpace,i=this.farDistanceRenderSpace*Math.sin((0,p.Vl)(this.verticalFieldOfView/2)),n=(0,m.j)(L,this.tiltedUpVector,i);(0,m.g)(e.top,t,n),(0,m.z)(e.bottom,t,n)}renderSpaceToPoint(e,t){const i=L;return this.renderCoordsHelper.fromRenderCoords(e,i,t),new P.Z(i[0],i[1],i[2],t)}_pointToRenderSpace(e,t){const i=(0,_.nI)(e.toArray());return this.renderCoordsHelper.toRenderCoords(i,e.spatialReference,t),t}};function z(e,t,i,n,r,a,s,o,l,c){const d=function(e,t,i,n){const r=(0,m.b)(n,e,t);return(0,m.n)(r,r),(0,m.j)(r,r,i),r}(e,t,a,k);(0,m.g)(c,r,d),G(i,e,d,a,s,o),G(n,e,d,a,s,l)}function F(e,t,i,n){return(0,v.Us)($,t,i),(0,m.h)(n,e,$)}function G(e,t,i,n,r,a){const s=(0,m.n)(L,t);return(0,m.j)(s,s,n),(0,m.g)(a,e,s),0!==r&&360!==r&&(0,m.g)(a,a,i),a}function I(e,t,i){const n=(0,m.z)(L,e,t);(0,m.n)(n,n),(0,m.j)(n,n,i),(0,m.g)(e,e,n)}(0,n._)([(0,o.Cb)()],H.prototype,"renderCoordsHelper",void 0),(0,n._)([(0,o.Cb)()],H.prototype,"viewshed",void 0),(0,n._)([(0,o.Cb)()],H.prototype,"observer",null),(0,n._)([(0,o.Cb)()],H.prototype,"farDistance",null),(0,n._)([(0,o.Cb)()],H.prototype,"farDistanceRenderSpace",null),(0,n._)([(0,o.Cb)()],H.prototype,"heading",null),(0,n._)([(0,o.Cb)()],H.prototype,"tilt",null),(0,n._)([(0,o.Cb)()],H.prototype,"tiltParallelToSurface",null),(0,n._)([(0,o.Cb)()],H.prototype,"horizontalFieldOfView",null),(0,n._)([(0,o.Cb)()],H.prototype,"verticalFieldOfView",null),(0,n._)([(0,o.Cb)()],H.prototype,"observerRenderSpace",null),(0,n._)([(0,o.Cb)()],H.prototype,"target",null),(0,n._)([(0,o.Cb)()],H.prototype,"targetRenderSpace",null),(0,n._)([(0,o.Cb)()],H.prototype,"targetDirection",null),(0,n._)([(0,o.Cb)()],H.prototype,"tiltedUpVector",null),(0,n._)([(0,o.Cb)()],H.prototype,"_basis",null),(0,n._)([(0,o.Cb)()],H.prototype,"upVector",null),(0,n._)([(0,o.Cb)()],H.prototype,"northVector",null),(0,n._)([(0,o.Cb)()],H.prototype,"leftVector",null),(0,n._)([(0,o.Cb)()],H.prototype,"rightVector",null),(0,n._)([(0,o.Cb)()],H.prototype,"isValid",null),(0,n._)([(0,o.Cb)()],H.prototype,"metersPerUnit",null),H=U=(0,n._)([(0,l.j)("esri.views.3d.analysis.Viewshed.ViewshedComputedData")],H);const L=(0,_.Ue)(),k=(0,_.Ue)(),Z=(0,_.Ue)(),N=(0,_.Ue)(),j=(0,_.Ue)(),W=(0,_.Ue)(),B=(0,_.Ue)(),X=(0,_.Ue)(),q=(0,_.Ue)(),Y=(0,_.Ue)(),Q=(0,_.Ue)(),J=(0,_.Ue)(),$=(0,f.Ue)();var K=i(11582),ee=i(17768),te=i(89125),ie=i(25243);let ne=class extends((0,K.J)(r.default)){constructor(e){super(e),this.observer=null,this.farDistance=1e3,this.heading=0,this.tilt=90,this.horizontalFieldOfView=45,this.verticalFieldOfView=45}isValid(){return null!=this.observer&&this.farDistance>0}equals(e){return(0,a._W)(this.observer,e.observer)&&this.farDistance===e.farDistance&&this.heading===e.heading&&this.tilt===e.tilt&&this.horizontalFieldOfView===e.horizontalFieldOfView&&this.verticalFieldOfView===e.verticalFieldOfView}};(0,n._)([(0,o.Cb)({type:P.Z})],ne.prototype,"observer",void 0),(0,n._)([(0,o.Cb)({type:Number,nonNullable:!0,range:{min:0}})],ne.prototype,"farDistance",void 0),(0,n._)([(0,o.Cb)({type:Number,nonNullable:!0}),(0,te.p)((e=>ee.BV.normalize((0,ie.q9)(e))))],ne.prototype,"heading",void 0),(0,n._)([(0,o.Cb)({type:Number,nonNullable:!0,range:{min:0,max:180}})],ne.prototype,"tilt",void 0),(0,n._)([(0,o.Cb)({type:Number,nonNullable:!0,range:{min:0,max:360}})],ne.prototype,"horizontalFieldOfView",void 0),(0,n._)([(0,o.Cb)({type:Number,nonNullable:!0,range:{min:0,max:180}})],ne.prototype,"verticalFieldOfView",void 0),(0,n._)([(0,o.Cb)()],ne.prototype,"isValid",null),ne=(0,n._)([(0,l.j)("esri.analysis.Viewshed")],ne);const re=ne;var ae=i(55652),se=i(63780),oe=i(79803),le=i(50951),ce=i(100),de=i(82218),ue=i(3319);const he=ue.QG,pe=ue.Mr*he,ve=.0025,fe=Math.sin((0,p.Vl)(2)),me=ue.Mr/1.5;var _e=i(35284),we=i(40508),ge=i(41029),be=i(70818),ye=i(70619),Ve=i(97731),Ce=i(58901),Me=i(74229),Ee=i(99034);class Se extends be.b{constructor(e){super(),this._handles=new ce.Z,this._interactive=!0,this._tool=e.tool,this._view=e.view,this._focusedArcMaterial=this._createArcMaterial(!0),this._unfocusedArcMaterial=this._createArcMaterial(!1),this._createManipulators(),this.forEachManipulator((e=>this._tool.manipulators.add(e)))}destroy(){this._handles=(0,a.SC)(this._handles),this.forEachManipulator((e=>{this._tool.manipulators.remove(e),e.destroy()})),this._tool=null,this._view=null,this._manipulators=null}get interactive(){return this._interactive}set interactive(e){this._interactive!==e&&(this._interactive=e,this._updateManipulatorInteractivity())}createDragPipeline(e,t){const i=Object.values(this._manipulators);return(0,d.AL)(i.map((i=>{let{manipulator:n,side:r}=i;return(0,Me.Xd)(n,((i,n,a,s,o)=>{const l=function(e,t){let{observerRenderSpace:i,targetDirection:n,tiltedUpVector:r,rightVector:a}=t;const s=Oe(e)?a:r;return(0,de.f)(i,n,s)}(r,t);Oe(r)?t.horizontalFieldOfView:t.verticalFieldOfView;const c=n.next((e=>({...e,manipulatorType:ge.d.SCALE,side:r}))),d=C(c,this._view,l);e(i,d,a)}))})))}updateManipulatorsTransform(e){this._forEachManipulatorInfo((t=>this._updateArcManipulatorTransform(t,e)))}updateManipulatorVisuals(e){this._forEachManipulatorInfo((t=>this._updateArcManipulatorVisuals(t,e)))}_updateArcManipulatorVisuals(e,t){let{manipulator:i,side:n}=e;const r=[];if(null!=t){if("left"===n&&(t.horizontalFieldOfView<1||t.horizontalFieldOfView>359)||"bottom"===n&&t.verticalFieldOfView<1)return i.renderObjects=[],void(i.collisionType={type:"line",paths:[]});const[e,a]=function(e,t,i){const{horizontalFieldOfView:n,verticalFieldOfView:r}=t,a=Oe(e),s=(0,p.Vl)((0,p.uZ)((a?r:n)/2,0,15)),o=a?1:Math.max(Math.sin((0,p.Vl)(90-r/2)),.1),l=De(-s/2,s/2,o,[-o,0,0]);return[(0,ye.rh)(i,l),l]}(n,t,this._unfocusedArcMaterial);r.push(new we.r(e,Ee.Q9.Unfocused),new we.r(e.instantiate({material:this._focusedArcMaterial}),Ee.Q9.Focused)),i.collisionType={type:"line",paths:[a]}}i.renderObjects=r,i.radius=10}_updateArcManipulatorTransform(e,t){let{manipulator:i,side:n}=e;const r=t.horizontalFieldOfView,a=(0,p.Vl)(t.verticalFieldOfView/2),s=(0,p.Vl)(r/2),o=Oe(n);i.location=t.observer;const l=(0,f.Ue)(),c=e=>{(0,v.Jp)(l,e,l)};c((0,v.gT)(Te,(0,p.Vl)(-90))),o||c((0,v.aC)(Te,a));const d=t.farDistanceRenderSpace;c((0,v.xJ)(Te,(0,m.s)(Re,d,d,d))),c((0,v.QO)(Te,function(e){return function(e){switch(e){case"left":return 0;case"bottom":return 1;case"right":return 2;case"top":return 3}}(e)*Ae}(n))),c(V(t,Te));const u=(0,m.z)(Re,t.targetRenderSpace,t.observerRenderSpace);let h,_;if(c((0,v.vc)(Te,u)),o){if(h=s,_=t.tiltedUpVector,0!==r&&360!==r){const e=M(t,this._view);h+=2*Math.tan(e/(2*t.farDistance))}}else _=t.rightVector,h=a;h*="right"===n||"bottom"===n?-1:1;const w=(0,v.Us)(Te,h,_);null!=w&&c(w),i.modelTransform=l}_updateManipulatorInteractivity(){const e=this.grabbing;this.forEachManipulator((t=>{t.interactive=!e&&this.interactive||t.grabbing}))}_createManipulators(){const e=this._createArcManipulator("left"),t=this._createArcManipulator("right"),i=this._createArcManipulator("top"),n=this._createArcManipulator("bottom");this._manipulators={left:e,right:t,top:i,bottom:n};const r=[[n.manipulator,i.manipulator],[e.manipulator,t.manipulator]];r.push(...r.map((e=>{let[t,i]=e;return[i,t]}))),this._handles.add(r.map((e=>{let[t,i]=e;return t.events.on("focus-changed",(e=>{const t="focus"===e.action;i.hovering=t}))})))}_createArcManipulator(e){const t={manipulator:new _e.Z({view:this._view,autoScaleRenderObjects:!1,worldSized:!0}),side:e};return this._updateArcManipulatorVisuals(t),t}_createArcMaterial(e){const t=e?pe:he,i=new Ce.U({renderOccluded:S.yD.OccludeAndTransparent,isDecoration:!0,width:t});return this._handles.add((0,s.watch)((()=>u.Z.toUnitRGBA(this._view.effectiveTheme.accentColor)),(e=>i.setParameters({color:e})),s.initial)),i}forEachManipulator(e){Object.values(this._manipulators).forEach((t=>{let{manipulator:i}=t;return e(i,ge.d.SCALE)}))}_forEachManipulatorInfo(e){Object.values(this._manipulators).forEach((t=>e(t)))}}function De(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[0,0,0],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:10;(0,Ve.hu)(r>1,"createArcPolylineGeometry() needs at least 2 for numVertices");const a=t-e,[s,o,l]=n;if(a<=0||i<=0){const e=.001;return[(0,_.al)(s,o,l+e),(0,_.al)(s,o,o+-e)]}const c=[],d=a/r;for(let u=0;u<r;u++){let n=e+u*d;u===r-1&&(n=t);const a=Math.cos(n)*i,h=Math.sin(n)*i,p=(0,_.al)(a+s,o,h+l);c.push(p)}return c}function Oe(e){return"left"===e||"right"===e}const Ae=Math.PI/2,Te=(0,f.Ue)(),Re=(0,_.Ue)();var xe=i(40885),Ue=i(68401),Pe=i(66832);class He extends _e.Z{constructor(e,t,i,n){super({view:e,autoScaleRenderObjects:!1,worldSized:!0,radius:5}),this._handles=new ce.Z,this._setupManipulatorVisual(t,i,n)}destroy(){this._handles.remove(),super.destroy()}_setupManipulatorVisual(e,t,i){const n=this._createMaterial(),r=(0,p.Vl)(t),a=e?1:Math.sin(r),s=e?De(0,r,a,[-a,0,0]):[(0,_.al)(0,0,0),(0,_.al)(0,0,a)],o=(0,ye.PD)(n,s,i,16,!1),l=(0,ye.PD)(n,s,i*ue.Mr,16,!1),c=ze(!1,n,i),d=ze(!0,n,i),u=(0,f.Ue)();(0,v.vc)(u,s[s.length-1]),(0,v.dC)(u,u,(0,v.aC)(Ge,Math.PI/2)),(0,v.dC)(u,u,(0,v.gT)(Ge,Math.PI/2)),e&&(0,v.dC)(u,u,(0,v.aC)(Ge,-r)),c.transformation=u,d.transformation=u,this.renderObjects=[new we.r(o,Ee.Q9.Unfocused),new we.r(l,Ee.Q9.Focused),new we.r(c,Ee.Q9.Unfocused),new we.r(d,Ee.Q9.Focused)];const h=(0,_.al)(0,Fe(!0),0),w=(0,m.h)(h,h,u),g=[...s,w];this.collisionType={type:"line",paths:[g]}}_createMaterial(){const e=new Pe.E({cullFace:Ue.Vr.Back,renderOccluded:S.yD.OccludeAndTransparent,isDecoration:!0,writeLinearDepth:!0});return this._handles.add((0,s.watch)((()=>u.Z.toUnitRGBA(this.view.effectiveTheme.accentColor)),(t=>e.setParameters({color:t})),s.initial)),e}}function ze(e,t,i){const n=Fe(e);let r=2*i;e&&(r*=ue.Mr);const a=n/2;return(0,ye.DA)(t,n,a,a,r,0)}function Fe(e){let t=fe;return e&&(t*=me),t}const Ge=(0,f.Ue)();class Ie extends be.b{constructor(e){super(),this._handles=new ce.Z,this._interactive=!0,this._tool=e.tool,this._view=e.view,this._manipulatorHeading=new He(this._view,!0,5,ve),this._manipulatorTilt=new He(this._view,!0,5,ve),this._manipulatorDistance=new He(this._view,!1,5,ve),this.forEachManipulator((e=>{this._tool.manipulators.add(e),this._handles.add(e.events.on("grab-changed",(()=>this._updateManipulatorInteractivity())))}))}destroy(){this._handles.destroy(),this.forEachManipulator((e=>{this._tool.manipulators.remove(e),e.destroy()})),this._manipulatorHeading=null,this._manipulatorTilt=null,this._manipulatorDistance=null,this._tool=null,this._view=null}get interactive(){return this._interactive}set interactive(e){this._interactive!==e&&(this._interactive=e,this._updateManipulatorInteractivity())}createHeadingDragPipeline(e,t){return(0,Me.Xd)(this._manipulatorHeading,((i,n,r,a,s)=>{const{_view:o}=this,l=Math.sin((0,p.Vl)(t.tiltParallelToSurface))*t.farDistanceRenderSpace,c=(0,m.g)(Ne,t.observerRenderSpace,(0,m.j)(je,t.upVector,l)),d=(0,m.b)(je,t.northVector,t.upVector),u=C(n,o,(0,de.f)(c,t.northVector,d)).next((e=>({...e,manipulatorType:ge.d.ROTATE})));e(i,u,r)}))}createTiltDragPipeline(e,t){return(0,Me.Xd)(this._manipulatorTilt,((i,n,r,a,s)=>{const o=(0,de.f)(t.observerRenderSpace,t.targetDirection,t.tiltedUpVector),l=C(n,this._view,o).next((e=>({...e,manipulatorType:ge.d.ROTATE})));e(i,l,r)}))}createDistanceDragPipeline(e,t){return(0,Me.Xd)(this._manipulatorDistance,((i,n,r,a,s)=>{const o=(0,xe.al)(t.observerRenderSpace,t.targetDirection),l=n.next((0,Me.kY)(this._view,i.location)).next((0,y.B2)(this._view,o)).next((e=>({...e,manipulatorType:ge.d.SCALE})));e(i,l,r)}))}updateManipulators(e){const{target:t}=e;this._manipulatorHeading.location=t,this._manipulatorTilt.location=t,this._manipulatorDistance.location=t;const i=(0,f.Ue)(),n=e=>{(0,v.Jp)(i,e,i)},r=function(e){const t=1,{verticalFieldOfView:i,horizontalFieldOfView:n}=e,r=i>180,a=n>180,s=e.farDistanceRenderSpace;if(r&&a)return Math.max(t,s);e.arcCentersPoints(s,Le);const{left:o,right:l,top:c,bottom:d}=Le,u=1.9*(r?(0,m.p)(o,l):a?(0,m.p)(d,o):Math.sqrt(Math.min((0,m.a)(d,c),(0,m.a)(o,l))));return Math.max(t,Math.min(s,u))}(e);n((0,v.xJ)(ke,(0,m.s)(Ne,r,r,r))),n(V(e,ke));const a=ve*ue.Mr*r,s=(0,m.j)(Ne,e.targetDirection,a);n((0,v.vc)(ke,s));const o=(0,v.QO)(ke,-We);(0,v.dC)(o,o,(0,v.gT)(Ze,-We)),this._manipulatorHeading.modelTransform=(0,v.dC)((0,f.Ue)(),i,o);const l=(0,v.gT)(ke,We);(0,v.dC)(l,l,(0,v.QO)(Ze,Math.PI)),this._manipulatorTilt.modelTransform=(0,v.Jp)((0,f.Ue)(),i,l),this._manipulatorDistance.modelTransform=i}_updateManipulatorInteractivity(){const e=!this.grabbing;this.forEachManipulator((t=>{t.interactive=e&&this._interactive||t.grabbing}))}forEachManipulator(e){e(this._manipulatorHeading,ge.d.ROTATE),e(this._manipulatorTilt,ge.d.ROTATE),e(this._manipulatorDistance,ge.d.SCALE)}}const Le={top:(0,_.Ue)(),bottom:(0,_.Ue)(),left:(0,_.Ue)(),right:(0,_.Ue)()},ke=(0,f.Ue)(),Ze=(0,f.Ue)(),Ne=(0,_.Ue)(),je=(0,_.Ue)(),We=Math.PI/2;i(75505),i(86741),i(51370),i(10064);class Be extends _e.Z{constructor(e,t){super({view:e,autoScaleRenderObjects:!1,worldSized:!1,radius:5,interactive:!1}),this._handles=new ce.Z;const i=(0,b.EA)(this._color);this.renderObjects=[new we.r((0,ye.PI)(i,5,32,32))],t.manipulators.add(this),this._handles.add([(0,s.watch)((()=>this._color),(e=>{i.setParameters({color:e})}),s.initial)])}destroy(){this._handles.remove(),super.destroy()}get _color(){return u.Z.toUnitRGBA(this.view.effectiveTheme.accentColor)}}(0,n._)([(0,o.Cb)()],Be.prototype,"_color",null);var Xe=i(99047),qe=i(89107),Ye=i(6599),Qe=i(97411),Je=i(96026),$e=i(17877);const Ke=Symbol("dragHandles"),et=Symbol("hideManipulators");let tt=class extends r.default{constructor(e){super(e),this._moveManipulation=null,this._observerManipulator=null,this._fieldOfViewManipulation=null,this._scaleOrientManipulation=null,this._moveHelperVisualElement=null,this._settings=new Xe.Z({getTheme:()=>this.view.effectiveTheme}),this._grabbing=!1,this.viewshedComputedData=null}initialize(){this._moveManipulation=this._createMoveManipulation(),this._fieldOfViewManipulation=new Se({view:this.view,tool:this.parentTool}),this._scaleOrientManipulation=new Ie({view:this.view,tool:this.parentTool}),this._observerManipulator=new Be(this.view,this.parentTool),this._createMoveHelperVisuals(),this.addHandles([(0,s.watch)((()=>{const{observer:e}=this;return{observer:e,array:null===e||void 0===e?void 0:e.toArray()}}),(e=>{let{observer:t}=e;null!=t&&(this._moveManipulation.location=t,this._observerManipulator.location=t)}),s.syncAndInitial),(0,s.watch)((()=>{const{viewshedComputedData:e}=this;return{viewshedComputedData:e,observer:null===e||void 0===e?void 0:e.observer}}),((e,t)=>{let{viewshedComputedData:i,observer:n}=e;this._grabbing&&n!==(null===t||void 0===t?void 0:t.observer)||(this.removeHandles(Ke),(null===i||void 0===i?void 0:i.isValid())&&this.addHandles([this._buildObserverDragPipeline(i),this._buildFOVDragPipeline(i),this._buildScaleOrientDragPipeline(i)].filter(se.pC),Ke))}),s.initial),(0,s.watch)((()=>{const e=this.viewshedComputedData;return null!==e&&void 0!==e&&e.isValid()?{viewshedCompData:e,target:e.targetRenderSpace,hFOV:e.horizontalFieldOfView,vFOV:e.verticalFieldOfView}:null}),(e=>{null!=e&&this._fieldOfViewManipulation.updateManipulatorsTransform(e.viewshedCompData)}),s.initial),(0,s.watch)((()=>{const e=this.viewshedComputedData;return null!==e&&void 0!==e&&e.isValid()?{viewshedCompData:e,hFOV:e.horizontalFieldOfView,vFOV:e.verticalFieldOfView,tilt:e.tilt}:null}),(e=>{null!=e&&this._fieldOfViewManipulation.updateManipulatorVisuals(e.viewshedCompData)}),s.initial),(0,s.watch)((()=>{var e,t;return this.analysisViewData.visible&&null!==(e=null===(t=this.viewshedComputedData)||void 0===t?void 0:t.isValid())&&void 0!==e&&e&&!this.parentTool.placingTarget}),(e=>this._updateManipulationAvailability(e)),s.initial),(0,s.watch)((()=>{const e=this.viewshedComputedData;if(null===e||void 0===e||!e.isValid())return null;const{observer:t,target:i,verticalFieldOfView:n,horizontalFieldOfView:r}=e;return{viewshedCompData:e,observer:t,target:i,verticalFieldOfView:n,horizontalFieldOfView:r}}),(e=>{null!=e&&this._scaleOrientManipulation.updateManipulators(e.viewshedCompData)}),s.initial),(0,s.watch)((()=>{var e;return null===(e=this.viewshedComputedData)||void 0===e?void 0:e.observerRenderSpace}),(e=>{null!=e&&this._updateMoveHelperVisualsLocation(e)}),s.initial)]);this._forEachManipulator((e=>{this.addHandles([e.events.on("focus-changed",(()=>this._updateManipulatorVisibility())),e.events.on("grab-changed",(e=>{this._grabbing="start"===e.action}))])}))}destroy(){this._moveManipulation=(0,a.SC)(this._moveManipulation),this._fieldOfViewManipulation=(0,a.SC)(this._fieldOfViewManipulation),this._scaleOrientManipulation=(0,a.SC)(this._scaleOrientManipulation),this.parentTool.manipulators.remove(this._observerManipulator),this._observerManipulator=(0,a.SC)(this._observerManipulator),this._destroyMoveHelperVisuals()}get viewshed(){var e;return null===(e=this.viewshedComputedData)||void 0===e?void 0:e.viewshed}get grabbing(){return this._grabbing}get observer(){var e;return null===(e=this.viewshed)||void 0===e?void 0:e.observer}set observer(e){const t=this.viewshed;null!=t&&(t.observer=e)}get discManipulator(){return this._moveManipulation.xyManipulation.discManipulator}onManipulatorSelectionChanged(){this._updateManipulatorVisibility()}hasManipulator(e){let t=!1;return this._forEachManipulator((i=>{t=t||i===e})),t}_someManipulatorSelected(){return this._moveManipulation.selected||this._fieldOfViewManipulation.selected||this._scaleOrientManipulation.selected}_someManipulatorHovering(){return this._moveManipulation.hovering||this._fieldOfViewManipulation.hovering||this._scaleOrientManipulation.hovering}_createMoveManipulation(){return new Ye.b({view:this.view,tool:this.parentTool,snapToScene:!1,xyAvailable:!0,xyAxisAvailable:!0,zAvailable:!0,radius:qe.E5})}_buildObserverDragPipeline(e){const t=e.observer;return null==t?null:this._moveManipulation.createDragPipeline(((t,i,n,r,a)=>{r=r.next((0,Me.di)(this,["observer"]));const s=e.observer.clone();if(null==s)return{steps:n,cancel:r};const o=$e.c.fromGeometry(s,(0,le.wg)(this.view.viewingMode));return{steps:n.next((0,Me.$Q)({operations:o})).next((e=>(this.observer=(0,oe.project)(o.data.geometry,s.spatialReference),e))),cancel:r}}),{mode:"absolute-height",offset:0},t.spatialReference,void 0)}_buildFOVDragPipeline(e){let t=0,i=0;return this._fieldOfViewManipulation.createDragPipeline(((n,r,a)=>{if(null==e)return{steps:r,cancel:a};const s=e.viewshed;return a=a.next((0,Me.di)(e,["horizontalFieldOfView","verticalFieldOfView"])),{steps:r.next((n=>{"start"===n.action&&(t=e.horizontalFieldOfView,i=e.verticalFieldOfView);const r=n.deltaAngle;let a=0;switch(n.side){case"left":a=t/2-r;break;case"right":a=t/2+r;break;case"top":a=i+2*r;break;case"bottom":a=i-2*r}return Oe(n.side)?(a=ee.BV.normalize(a),a=a>270?0:a>180?180:a,s.horizontalFieldOfView=2*a):s.verticalFieldOfView=a,n})),cancel:a}}),e)}_buildScaleOrientDragPipeline(e){let t=0,i=0;const n=(t,i)=>(n,r,a)=>{if(null==e)return{steps:r,cancel:a};const s=e.viewshed;return a=a.next((0,Me.di)(s,[t])),{steps:r=r.next(i(s,e)),cancel:a}};return(0,d.AL)([this._scaleOrientManipulation.createHeadingDragPipeline(n("heading",((t,n)=>n=>("start"===n.action&&(i=e.heading),t.heading=ee.BV.normalize(i+n.deltaAngle),n))),e),this._scaleOrientManipulation.createTiltDragPipeline(n("tilt",((i,n)=>n=>{"start"===n.action&&(t=e.tilt);let r=t+n.deltaAngle;return r<-90?r=180:r>270&&(r=0),i.tilt=nt.clamp(r),n})),e),this._scaleOrientManipulation.createDistanceDragPipeline(n("farDistance",((e,t)=>i=>{const n=(0,m.z)(it,i.renderEnd,t.observerRenderSpace),r=(0,m.H)(n)*t.metersPerUnit,a=(0,m.m)(n,t.targetDirection)<0?1:r;return e.farDistance=a,i})),e)])}_updateManipulationAvailability(e){this._moveManipulation.available=e,this._fieldOfViewManipulation.available=e,this._scaleOrientManipulation.available=e,this._observerManipulator.available=e}_updateManipulatorVisibility(){const e=this._someManipulatorSelected()||this._someManipulatorHovering()&&null==this.view.activeTool;if(e)this.removeHandles(et);else{const e=[],t=t=>{e.push(t.disableDisplay())};this._forEachManipulator(t),this.addHandles(e,et)}this._updateMoveHelperVisualsVisibility(e)}_forEachManipulator(e){this._moveManipulation.forEachManipulator(e),this._fieldOfViewManipulation.forEachManipulator(e),this._scaleOrientManipulation.forEachManipulator(e),e(this._observerManipulator)}_createMoveHelperVisuals(){this._destroyMoveHelperVisuals();const e=new Je.W({view:this.view,attached:!0,style:{glowWidth:this._settings.visualElements.heightPlane.glowWidth,innerWidth:this._settings.visualElements.heightPlane.innerWidth},isDecoration:!0}),t=new Qe.V({view:this.view,extensionType:this._settings.visualElements.zVerticalLine.extensionType,attached:!0,innerWidth:1,writeDepthEnabled:!1,renderOccluded:S.yD.OccludeAndTransparent,isDecoration:!0});this._moveHelperVisualElement={laserline:e,verticalLine:t},this.addHandles([(0,s.watch)((()=>this._settings.visualElements.zVerticalLine),(e=>e.apply(t)),s.syncAndInitial),(0,s.watch)((()=>this._settings.visualElements.heightPlane),(t=>t.apply(e)),s.syncAndInitial)])}_updateMoveHelperVisualsVisibility(e){e=this.analysisViewData.visible&&e;const t=this._moveHelperVisualElement;null!=t&&(t.verticalLine.visible=e,t.laserline.visible=e)}_updateMoveHelperVisualsLocation(e){const t=this._moveHelperVisualElement;if(null==t)return;const{laserline:i,verticalLine:n}=t;i.heightManifoldTarget=e,i.intersectsWorldUpAtLocation=e,null!=e&&n.setStartEndFromWorldDownAtLocation(e)}_destroyMoveHelperVisuals(){const e=this._moveHelperVisualElement;null!=e&&(e.laserline.destroy(),e.verticalLine.destroy(),this._moveHelperVisualElement=null)}get test(){return{moveManipulation:this._moveManipulation,fieldOfViewManipulation:this._fieldOfViewManipulation,scaleOrientManipulation:this._scaleOrientManipulation,moveHelperVisualElements:this._moveHelperVisualElement,viewshedComputedData:this.viewshedComputedData}}};(0,n._)([(0,o.Cb)({constructOnly:!0})],tt.prototype,"analysis",void 0),(0,n._)([(0,o.Cb)({constructOnly:!0})],tt.prototype,"analysisViewData",void 0),(0,n._)([(0,o.Cb)({constructOnly:!0})],tt.prototype,"parentTool",void 0),(0,n._)([(0,o.Cb)({constructOnly:!0,nonNullable:!0})],tt.prototype,"view",void 0),(0,n._)([(0,o.Cb)()],tt.prototype,"viewshed",null),(0,n._)([(0,o.Cb)()],tt.prototype,"_grabbing",void 0),(0,n._)([(0,o.Cb)()],tt.prototype,"grabbing",null),(0,n._)([(0,o.Cb)()],tt.prototype,"viewshedComputedData",void 0),(0,n._)([(0,o.Cb)()],tt.prototype,"observer",null),tt=(0,n._)([(0,l.j)("esri.views.3d.analysis.Viewshed.ViewshedSubTool")],tt);const it=(0,_.Ue)(),nt=new ee.pE(0,180);var rt,at=i(86509),st=i(87888),ot=i(81298),lt=i(72612);let ct=rt=class extends at.f{constructor(e){super(e),this.removeIncompleteOnCancel=!1,this.automaticManipulatorSelection=!1,this._stagedViewshed=null,this._stagedViewshedComputedData=null,this._creating=!1,this._selectedManipulator=null,this._selectedManipulatorSubTool=null}initialize(){this._intersector=(0,ot.w)(this.view.state.viewingMode);const e=this.analysisViewData.viewshedComputedDataHandles;this.addHandles([(0,s.watch)((()=>e.some((e=>e.viewshedComputedData.isValid()))),(e=>{e&&this.finishToolCreation()}),s.syncAndInitial),(0,s.watch)((()=>this._stagedViewshed),(e=>{var t;this._stagedViewshedComputedData=null!=e?null===(t=this.analysisViewData.viewshedComputedDataHandles.find((t=>t.viewshedComputedData.viewshed===e)))||void 0===t?void 0:t.viewshedComputedData:null}),s.syncAndInitial),(0,s.watch)((()=>this.firstGrabbedManipulator),(e=>{null!=e&&this._selectManipulator(e)}),s.sync),(0,s.watch)((()=>this.analysisViewData.visible),(e=>{e||this._selectManipulator(null)})),(0,s.watch)((()=>this.view.activeTool),(e=>{e!==this&&null!=e&&this._selectManipulator(null)}))]),this.subToolHandles=(0,s.mapCollection)((()=>e),(e=>{let{viewshedComputedData:t}=e;const i=new tt({analysis:this.analysis,analysisViewData:this.analysisViewData,parentTool:this,view:this.view,viewshedComputedData:t});return{subTool:i,remove:()=>{this._selectedManipulatorSubTool===i&&this._selectManipulator(null),i.destroy()}}}))}destroy(){this.subToolHandles=(0,a.SC)(this.subToolHandles)}onDeactivate(){this.removeStaged()}get cursor(){return this.creating?"crosshair":null}_selectManipulator(e){var t,i,n;const r=this._selectedManipulator;null!=r&&(r.selected=!1,this._selectedManipulator=null,null!==(t=this._selectedManipulatorSubTool)&&void 0!==t&&t.onManipulatorSelectionChanged(),this._selectedManipulatorSubTool=null),null!=e&&(e.selected=!0,this._selectedManipulator=e,this._selectedManipulatorSubTool=null===(i=this.subToolHandles.find((t=>t.subTool.hasManipulator(e))))||void 0===i?void 0:i.subTool,null===(n=this._selectedManipulatorSubTool)||void 0===n||n.onManipulatorSelectionChanged())}get selectedViewshed(){var e;return null===(e=this._selectedManipulatorSubTool)||void 0===e?void 0:e.viewshed}set selectedViewshed(e){this.selectViewshed(e)}get selectedViewshedComputedData(){var e;return null===(e=this._selectedManipulatorSubTool)||void 0===e?void 0:e.viewshedComputedData}get stagedViewshed(){return this._stagedViewshed}get grabbing(){return this.subToolHandles.some((e=>{let{subTool:t}=e;return t.grabbing}))}get creating(){return this._creating&&this.active}get placingTarget(){return null!=this._stagedViewshed}createViewsheds(){this._creating=!0}onManipulatorSelectionChanged(){this.subToolHandles.forEach((e=>e.subTool.onManipulatorSelectionChanged()))}onInputEvent(e){switch(e.type){case"immediate-click":this._clickDeselectHandler();break;case"immediate-double-click":this._doubleClickHandler(e);break;case"pointer-move":this._pointerMoveHandler(e);break;case"key-down":st.Sn.cancel===e.key?this._cancelKeyHandler(e):st.Sn.delete.includes(e.key)&&this._deleteKeyHandler()}}onInputEventAfter(e){"immediate-click"===e.type&&this._clickPlacementHandler(e)}_clickDeselectHandler(){this.hasFocusedManipulators||this._selectManipulator(null)}_clickPlacementHandler(e){if(!this.creating||this.hasFocusedManipulators)return;const t=this._stagedViewshed,i=this._intersectScreen(e,mt);if(null!=i){if(null==t){var n;i.mapPoint.z=(null!==(n=i.mapPoint.z)&&void 0!==n?n:0)+2;const e=new re({observer:i.mapPoint.clone()});this.analysis.viewsheds.add(e),this._stagedViewshed=e,this._updateStagedViewshed(i.scenePoint)}else{this._updateStagedViewshed(i.scenePoint);const e=this._stagedViewshed;this._stagedViewshed=null,this.selectViewshed(e)}e.stopPropagation()}}_doubleClickHandler(e){this.creating&&(this.removeStaged(),this._selectManipulator(null),this._creating=!1,this.view.activeTool=null,e.stopPropagation())}_pointerMoveHandler(e){if(!this.creating||null==this._stagedViewshed)return;const t=this._intersectScreen(e,mt);null!=t&&this._updateStagedViewshed(t.scenePoint)}_cancelKeyHandler(e){if(this.creating){if(this.removeStaged())return this._selectManipulator(null),void e.stopPropagation();this._creating=!1}else if(!this.grabbing)return this.selectViewshed(null),void e.stopPropagation()}_deleteKeyHandler(){this.creating&&this.removeStaged(),null!=this.selectedViewshed&&this.analysis.viewsheds.remove(this.selectedViewshed)}_updateStagedViewshed(e){const t=this._stagedViewshed,i=this._stagedViewshedComputedData;if(null==t||null==i)return;const{heading:n,tilt:r,farDistance:a}=function(e,t,i){const n=t.observerRenderSpace,r=(0,m.z)(dt,i,n),a=(0,m.H)(r)*t.metersPerUnit,s=e.renderCoordsHelper.basisMatrixAtPosition(n,vt),o=(0,m.s)(ut,s[8],s[9],s[10]),l=(0,ae.Yq)(n,o,ft),c=(0,ae.nF)(l,i,ht),d=(0,m.z)(c,c,n),u=(0,p.BV)((0,m.d)(r,d))*((0,m.m)(o,r)<0?-1:1)+90,h=(0,m.s)(pt,s[4],s[5],s[6]),v=(0,p.BV)((0,m.d)(h,d)),f=(0,m.s)(pt,s[0],s[1],s[2]);return{heading:(0,m.m)(d,f)<0?360-v:v,tilt:u,farDistance:a}}(this.view,i,e);t.farDistance=a,t.tilt=r,t.heading=n}removeStaged(){return null!=this._stagedViewshed&&(this.analysis.viewsheds.remove(this._stagedViewshed),this._stagedViewshed=null,!0)}selectViewshed(e){var t;if(null!=e)for(const n of this.view.tools.items)n!==this&&n instanceof rt&&n.selectViewshed(null);const i=null===(t=this.subToolHandles.find((t=>t.subTool.viewshed===e)))||void 0===t?void 0:t.subTool;this._selectManipulator(null===i||void 0===i?void 0:i.discManipulator)}_intersectScreen(e,t){const i=(0,lt.Sj)(e);this.view.sceneIntersectionHelper.intersectToolIntersectorScreen(i,this._intersector);const n=this._intersector.results.min,r=t.scenePoint;if(!n.getIntersectionPoint(r))return null;const a=t.mapPoint;return a.spatialReference=this.view.spatialReference,this.view.renderCoordsHelper.fromRenderCoords(r,a),null==a?null:t}get test(){var e;return{subTools:this.subToolHandles.map((e=>e.subTool.test)),selectedSubTool:null===(e=this._selectedManipulatorSubTool)||void 0===e?void 0:e.test,stagedViewshed:this._stagedViewshed}}};(0,n._)([(0,o.Cb)({constructOnly:!0})],ct.prototype,"view",void 0),(0,n._)([(0,o.Cb)()],ct.prototype,"analysisViewData",void 0),(0,n._)([(0,o.Cb)()],ct.prototype,"removeIncompleteOnCancel",void 0),(0,n._)([(0,o.Cb)()],ct.prototype,"automaticManipulatorSelection",void 0),(0,n._)([(0,o.Cb)({constructOnly:!0})],ct.prototype,"analysis",void 0),(0,n._)([(0,o.Cb)()],ct.prototype,"subToolHandles",void 0),(0,n._)([(0,o.Cb)()],ct.prototype,"_stagedViewshed",void 0),(0,n._)([(0,o.Cb)()],ct.prototype,"_stagedViewshedComputedData",void 0),(0,n._)([(0,o.Cb)()],ct.prototype,"_creating",void 0),(0,n._)([(0,o.Cb)({readOnly:!0})],ct.prototype,"cursor",null),(0,n._)([(0,o.Cb)()],ct.prototype,"_selectedManipulator",void 0),(0,n._)([(0,o.Cb)()],ct.prototype,"_selectedManipulatorSubTool",void 0),(0,n._)([(0,o.Cb)()],ct.prototype,"selectedViewshed",null),(0,n._)([(0,o.Cb)()],ct.prototype,"selectedViewshedComputedData",null),(0,n._)([(0,o.Cb)()],ct.prototype,"grabbing",null),(0,n._)([(0,o.Cb)()],ct.prototype,"creating",null),(0,n._)([(0,o.Cb)()],ct.prototype,"placingTarget",null),ct=rt=(0,n._)([(0,l.j)("esri.views.3d.analysis.Viewshed.ViewshedTool")],ct);const dt=(0,_.Ue)(),ut=(0,_.Ue)(),ht=(0,_.Ue)(),pt=(0,_.Ue)(),vt=(0,f.Ue)(),ft=(0,ae.Ue)(),mt={mapPoint:new P.Z,scenePoint:(0,_.Ue)()},_t=ct;var wt=i(58206),gt=i(70209);let bt=class extends((0,c.p)(r.default)){constructor(e){super(e),this.type="viewshed-view-3d",this.analysis=null,this.tool=null,this.viewshedComputedDataHandles=null,this._placementTask=null}get selectedViewshed(){var e;return null===(e=this.tool)||void 0===e?void 0:e.selectedViewshed}set selectedViewshed(e){const{tool:t}=this;null!=t&&(t.selectedViewshed=e)}get selectedViewshedComputedData(){var e;return null===(e=this.tool)||void 0===e?void 0:e.selectedViewshedComputedData}initialize(){this._initializeUpdateHandle(),this.viewshedComputedDataHandles=(0,s.mapCollection)((()=>this.analysis.viewsheds),(e=>{const t=new H({renderCoordsHelper:this.view.renderCoordsHelper,viewshed:e}),i=Symbol();return this.addHandles((0,s.watch)((()=>t.isValid()),((e,i)=>{this.visible&&(e?this._addViewshedsToRenderer(t):i&&this._removeViewshedsFromRenderer(t))}),s.initial)),{viewshedComputedData:t,remove:()=>{this.removeHandles(i),this._removeViewshedsFromRenderer(t),t.destroy()}}})),this._analysisVisualization=new x({view:this.view,analysisViewData:this,isDecoration:!this.parent}),this.addHandles([(0,s.watch)((()=>this.visible),(e=>{const t=this.viewshedComputedDataHandles.map((e=>e.viewshedComputedData)).filter((e=>e.isValid()));e?this._addViewshedsToRenderer(t):this._removeViewshedsFromRenderer(t)})),(0,s.watch)((()=>this.view.renderCoordsHelper),(e=>{this.viewshedComputedDataHandles.forEach((t=>{let{viewshedComputedData:i}=t;return i.renderCoordsHelper=e}))})),(0,gt.Lp)(this,_t)])}destroy(){this._placementTask=(0,a.IM)(this._placementTask),(0,gt.Yq)(this),this._analysisVisualization=(0,a.SC)(this._analysisVisualization),this._removeViewshedsFromRenderer(this.viewshedComputedDataHandles.map((e=>e.viewshedComputedData)))}async createViewsheds(e){return this._placementTask=(0,a.IM)(this._placementTask),this._placementTask=(0,gt.Er)(this,e),null!=this.tool&&this.tool.createViewsheds(),await this._placementTask.promise}_initializeUpdateHandle(){const e=this.view._stage.renderer.plugins.plugins.find((e=>e instanceof wt.U));e&&(this._updateHandleInRenderer=e.updateViewsheds.bind(e))}_addViewshedsToRenderer(e){this._updateHandleInRenderer({adds:e})}_removeViewshedsFromRenderer(e){this._updateHandleInRenderer({removes:e})}};(0,n._)([(0,o.Cb)({readOnly:!0})],bt.prototype,"type",void 0),(0,n._)([(0,o.Cb)({constructOnly:!0,nonNullable:!0})],bt.prototype,"analysis",void 0),(0,n._)([(0,o.Cb)()],bt.prototype,"tool",void 0),(0,n._)([(0,o.Cb)()],bt.prototype,"selectedViewshed",null),(0,n._)([(0,o.Cb)()],bt.prototype,"selectedViewshedComputedData",null),(0,n._)([(0,o.Cb)()],bt.prototype,"viewshedComputedDataHandles",void 0),(0,n._)([(0,o.Cb)()],bt.prototype,"_analysisVisualization",void 0),(0,n._)([(0,o.Cb)()],bt.prototype,"_placementTask",void 0),bt=(0,n._)([(0,l.j)("esri.views.3d.analysis.ViewshedAnalysisView3D")],bt);const yt=bt},51328:(e,t,i)=>{i.d(t,{B2:()=>E,G:()=>V,J4:()=>D,JA:()=>C,Sp:()=>M,_N:()=>g,bB:()=>b,cx:()=>n,gv:()=>O,zP:()=>S});i(59486);var n,r=i(17842),a=i(32035),s=i(12400),o=i(79803),l=i(55652),c=i(40885),d=i(40927),u=i(51378),h=i(74509),p=i(81703),v=i(88153),f=i(54463),m=i(76783),_=i(74229),w=i(848);function g(e,t){return y(e,(()=>t))}function b(e){return y(e,(e=>e.plane))}function y(e,t){const i=(0,s.Ue)(),n=(0,s.Ue)();let a=!1;return s=>{const o=t(s);if("start"===s.action){const t=(0,r.md)(s.screenStart,(0,r.c$)(u.qW.get())),n=(0,p.u4)(e.state.camera,t,R);null!=n&&(a=(0,l.BR)(o,n,i))}if(!a)return null;const c=(0,r.md)(s.screenEnd,(0,r.c$)(u.qW.get())),d=(0,p.u4)(e.state.camera,c,R);return null==d?null:(0,l.BR)(o,d,n)?{...s,renderStart:i,renderEnd:n,plane:o,ray:d}:null}}function V(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=null;return l=>{if("start"===l.action&&(s=e.sceneIntersectionHelper.intersectElevationFromScreen((0,r.s1)(l.screenStart.x,l.screenStart.y),t,i,a),null!=s&&null!=n&&!(0,o.projectPoint)(s,s,n)))return null;if(null==s)return null;const c=e.sceneIntersectionHelper.intersectElevationFromScreen((0,r.s1)(l.screenEnd.x,l.screenEnd.y),t,i,a);return null==c||null!=n&&!(0,o.projectPoint)(c,c,n)?null:{...l,mapStart:s,mapEnd:c}}}(e,i,(0,h.Ou)(t,e,i),n,a)}function C(e,t,i,n){const r=i.toMap(e.screenStart);return null!=r?V(t,r,i.elevationInfo,n):null}function M(e,t,i){let n=null;const r=new _.hM;return r.next(g(e,function(e,t){const i=A,n=T,r=(0,l.Ue)();e.renderCoordsHelper.worldUpAtPosition(t,i);const s=(0,a.b)((0,l.st)(r),i,(0,a.f)(n,t,e.state.camera.eye));return(0,a.b)(s,s,i),(0,l.Yq)(t,s,r)}(e,t))).next(function(e,t){const i=(0,s.Ue)(),n=(0,a.l)(t);e.renderCoordsHelper.worldUpAtPosition(t,i);const r=(0,s.Ue)(),o=(0,s.Ue)(),l=r=>((0,a.f)(r,r,t),(0,d.nF)(i,r,r),"global"===e.viewingMode&&(0,a.l)(r)*Math.sign((0,a.m)(i,r))<.001-n&&(0,a.f)(r,(0,a.j)(r,i,.001),t),(0,a.g)(r,r,t),r);return e=>(e.renderStart=l((0,a.c)(r,e.renderStart)),e.renderEnd=l((0,a.c)(o,e.renderEnd)),e)}(e,t)).next(S(e,i)).next((e=>{e.mapEnd.x=e.mapStart.x,e.mapEnd.y=e.mapStart.y,n=e})),e=>(n=null,r.execute(e),n)}function E(e,t){const i=i=>{const n=(0,r.md)(i,(0,r.c$)(u.qW.get())),a=(0,p.u4)(e.state.camera,n,R);return null==a?null:(0,c._w)(t,a,A,T)[1]};return e=>{const t=i(e.screenStart);if(null==t)return null;const n=i(e.screenEnd);return null==n?null:{...e,renderStart:t,renderEnd:n}}}function S(e,t){const i=e.renderCoordsHelper;return e=>{const n=i.fromRenderCoords(e.renderStart,new w.Z({spatialReference:t})),r=i.fromRenderCoords(e.renderEnd,new w.Z({spatialReference:t}));return null!=n&&null!=r?{...e,mapStart:n,mapEnd:r}:null}}function D(e){let t=null;return i=>{switch(i.action){case"start":t=e.disableDisplay();break;case"end":case"cancel":null!=t&&(t.remove(),t=null)}return i}}function O(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const i=(0,v.Z8)(e.state.viewingMode);i.options.selectionMode=!0,i.options.store=f.eC.MIN,i.options.hud=!1;const a=(0,r.s1)(),o={requiresGroundFeedback:!0,enableDraped:!0,exclude:new Set},l=(0,s.Ue)(),c=null!==t&&void 0!==t?t:e.spatialReference,d=t=>{e.map.ground&&e.map.ground.opacity<1?o.exclude.add(m.xX):o.exclude.delete(m.xX),e.sceneIntersectionHelper.intersectIntersectorScreen((0,r.md)(t,a),i,o);const s=i.results.min;let d;if(s.getIntersectionPoint(l))d=s.intersector===f.q7.TERRAIN?n.GROUND:n.OTHER;else{if(!i.results.ground.getIntersectionPoint(l))return null;d=n.GROUND}return{location:e.renderCoordsHelper.fromRenderCoords(l,new w.Z({spatialReference:c})),surfaceType:d}};let u;return e=>{if("start"===e.action){const t=d(e.screenStart);u=null!=t?t.location:null}if(null==u)return null;const t=d(e.screenEnd);return null!=(null===t||void 0===t?void 0:t.location)?{...e,mapStart:u,mapEnd:t.location,surfaceType:t.surfaceType}:null}}!function(e){e[e.GROUND=0]="GROUND",e[e.OTHER=1]="OTHER"}(n||(n={}));const A=(0,s.Ue)(),T=(0,s.Ue)(),R=(0,c.Ue)()},33837:(e,t,i)=>{i.d(t,{r:()=>h});var n=i(29134),r=i(7025),a=i(32035),s=i(12400),o=i(86361),l=i(52168),c=i(79685),d=i(56529),u=i(58901);class h extends l._{constructor(e,t){super(e),this._hasExternalMaterial=!1,this._hasExternalMaterial=null!=t,this._material=null!=t?t:new u.U({width:1,color:(0,o.al)(1,0,1,1),stippleOffColor:null,stipplePattern:null,stipplePreferContinuous:!0,isClosed:!1,falloff:0,innerColor:null,innerWidth:1,hasPolygonOffset:!1,renderOccluded:d.yD.OccludeAndTransparent,isDecoration:!!e.isDecoration,writeDepth:!0}),this.applyProperties(e)}setGeometryFromRenderSpacePoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;this.geometry=[[[e[0]-t,e[1],e[2]],[e[0]+t,e[1],e[2]]],[[e[0],e[1]-t,e[2]],[e[0],e[1]+t,e[2]]],[[e[0],e[1],e[2]-t],[e[0],e[1],e[2]+t]]]}setGeometryFromExtent(e){const t=this.view.spatialReference,i=(0,s.Ue)(),n=(0,s.Ue)(),r=100,o=[];(0,a.s)(i,e[0],e[1],r),this.view.renderCoordsHelper.toRenderCoords(i,t,n),o.push([n[0],n[1],n[2]]),(0,a.s)(i,e[2],e[1],r),this.view.renderCoordsHelper.toRenderCoords(i,t,n),o.push([n[0],n[1],n[2]]),(0,a.s)(i,e[2],e[3],r),this.view.renderCoordsHelper.toRenderCoords(i,t,n),o.push([n[0],n[1],n[2]]),(0,a.s)(i,e[0],e[3],r),this.view.renderCoordsHelper.toRenderCoords(i,t,n),o.push([n[0],n[1],n[2]]),(0,a.s)(i,e[0],e[1],r),this.view.renderCoordsHelper.toRenderCoords(i,t,n),o.push([n[0],n[1],n[2]]),(0,a.s)(i,e[0],e[1],r),this.view.renderCoordsHelper.toRenderCoords(i,t,n),o.push([n[0],n[1],n[2]]),this.geometry=[o]}setGeometryFromFrustum(e){const t=[];e.lines.forEach((e=>{t.push([e.origin[0],e.origin[1],e.origin[2]]),t.push([e.endpoint[0],e.endpoint[1],e.endpoint[2]])})),this.geometry=[t]}setGeometryFromBoundedPlane(e){const t=[],i=e.origin,n=e.basis1,r=e.basis2,a=.5,o=(0,s.Ue)(),l=(0,s.Ue)(),c=(0,s.Ue)(),d=(0,s.Ue)();o[0]=i[0]-n[0]*a-r[0]*a,o[1]=i[1]-n[1]*a-r[1]*a,o[2]=i[2]-n[2]*a-r[2]*a,l[0]=i[0]-n[0]*a+r[0]*a,l[1]=i[1]-n[1]*a+r[1]*a,l[2]=i[2]-n[2]*a+r[2]*a,c[0]=i[0]+n[0]*a+r[0]*a,c[1]=i[1]+n[1]*a+r[1]*a,c[2]=i[2]+n[2]*a+r[2]*a,d[0]=i[0]+n[0]*a-r[0]*a,d[1]=i[1]+n[1]*a-r[1]*a,d[2]=i[2]+n[2]*a-r[2]*a,t.push([o[0],o[1],o[2]]),t.push([l[0],l[1],l[2]]),t.push([c[0],c[1],c[2]]),t.push([d[0],d[1],d[2]]),t.push([o[0],o[1],o[2]]),this.geometry=[t]}setGeometryFromSegment(e){const t=e.endRenderSpace;this.transform=(0,n.vc)(p,t);const{points:i}=e.createRenderGeometry(t,this.view.renderCoordsHelper);this.geometry=[i]}setGeometryFromSegments(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s.AG;this.transform=(0,n.vc)(p,t),this.geometry=e.map((e=>e.createRenderGeometry(t,this.view.renderCoordsHelper).points))}getTransformedGeometry(){return null==this._geometry?null:this._geometry.map((e=>e.map((e=>(0,a.h)((0,s.Ue)(),e,this.transform)))))}get renderOccluded(){return this._material.parameters.renderOccluded}set renderOccluded(e){this._material.setParameters({renderOccluded:e})}get geometry(){return this._geometry}set geometry(e){this._geometry=e,this.recreateGeometry()}get width(){return this._material.parameters.width}set width(e){this._material.setParameters({width:e})}get color(){return this._material.parameters.color}set color(e){const t=1===e[3];this._material.setParameters({color:(0,o.d9)(e),writeDepth:t})}get innerWidth(){return this._material.parameters.innerWidth}set innerWidth(e){this._material.setParameters({innerWidth:e})}get innerColor(){return this._material.parameters.innerColor}set innerColor(e){this._material.setParameters({innerColor:null!=e?(0,o.d9)(e):null})}get stipplePattern(){return this._material.parameters.stipplePattern}set stipplePattern(e){null!=this._material&&this._material.setParameters({stipplePattern:e})}get stippleOffColor(){return this._material.parameters.stippleOffColor}set stippleOffColor(e){this._material.setParameters({stippleOffColor:null!=e?(0,o.d9)(e):null})}get stipplePreferContinuous(){return this._material.parameters.stipplePreferContinuous}set stipplePreferContinuous(e){this._material.setParameters({stipplePreferContinuous:e})}get falloff(){return this._material.parameters.falloff}set falloff(e){this._material.setParameters({falloff:e})}get polygonOffset(){return this._material.parameters.hasPolygonOffset}set polygonOffset(e){this._material.setParameters({hasPolygonOffset:e})}createExternalResources(){}destroyExternalResources(){}createGeometries(e){for(const t of(0,c.c)(this.geometry)){const i=(0,c.Y)(this._material,t);e.addGeometry(i)}}forEachExternalMaterial(e){this._hasExternalMaterial||e(this._material)}}const p=(0,r.Ue)()},70209:(e,t,i)=>{i.d(t,{Er:()=>o,Lp:()=>l,Yq:()=>c});var n=i(14921),r=i(92026),a=i(66978),s=i(94172);function o(e,t){e.interactive=!0;const{tool:i,view:o}=e;o.activeTool=i;let l=(0,a.fu)(t,(()=>{o.activeTool===i&&(o.activeTool=null)}));return(0,n.vr)((async e=>{await(0,s.whenOnce)((()=>null==i||!i.active),e),l=(0,r.hw)(l)}),t)}function l(e,t){return(0,s.watch)((()=>e.interactive),(()=>function(e,t){e.interactive?function(e,t){c(e);const{view:i,analysis:n}=e,r=new t({view:i,analysis:n,analysisViewData:e});e.tool=r,i.tools.add(r)}(e,t):c(e)}(e,t)),s.syncAndInitial)}function c(e){const{view:t,tool:i}=e;null!=i&&(t.tools.remove(i),e.tool=null)}},86509:(e,t,i)=>{i.d(t,{f:()=>o});var n=i(27366),r=i(94172),a=(i(32718),i(93169),i(84936),i(10064),i(69912)),s=i(45900);let o=class extends s.m{constructor(e){super(e)}initialize(){this.addHandles((0,r.watch)((()=>this.analysisViewData.visible),(e=>this.visible=e),r.syncAndInitial))}deactivate(){this.onDeactivate(),this.created||this.analysis.clear()}resetCreated(){this._set("created",!1)}};o=(0,n._)([(0,a.j)("esri.views.interactive.AnalysisToolBase")],o)},45900:(e,t,i)=>{i.d(t,{m:()=>d});var n=i(27366),r=i(7138),a=(i(93169),i(32718),i(66978)),s=i(49861),o=(i(84936),i(69912)),l=i(99034),c=i(92853);let d=class extends r.default{constructor(e){super(e),this.manipulators=new c.D,this.automaticManipulatorSelection=!0,this.hasGrabbedManipulators=!1,this.hasHoveredManipulators=!1,this.firstGrabbedManipulator=null,this.created=!1,this.removeIncompleteOnCancel=!0,this._editableFlags=new Map([[l.bH.MANAGER,!0],[l.bH.USER,!0]]),this._creationFinishedResolver=(0,a.hh)()}get active(){return null!=this.view&&this.view.activeTool===this}set visible(e){this._get("visible")!==e&&(this._set("visible",e),this._syncVisible())}get editable(){return this.getEditableFlag(l.bH.USER)}set editable(e){this.setEditableFlag(l.bH.USER,e)}get updating(){return!1}get cursor(){return null}get hasFocusedManipulators(){return this.hasGrabbedManipulators||this.hasHoveredManipulators}destroy(){this.manipulators.destroy(),this._set("view",null)}onAdd(){this._syncVisible()}activate(){null!=this.view&&(this.view.focus(),this.onActivate())}deactivate(){this.onDeactivate()}handleInputEvent(e){this.onInputEvent(e)}handleInputEventAfter(e){this.onInputEventAfter(e)}setEditableFlag(e,t){this._editableFlags.set(e,t),this.manipulators.isToolEditable=this.internallyEditable,this._updateManipulatorAttachment(),e===l.bH.USER&&this.notifyChange("editable"),this.onEditableChange(),this.onManipulatorSelectionChanged()}getEditableFlag(e){var t;return null!==(t=this._editableFlags.get(e))&&void 0!==t&&t}whenCreated(){return this._creationFinishedResolver.promise}onManipulatorSelectionChanged(){}onActivate(){}onDeactivate(){}onShow(){}onHide(){}onEditableChange(){}onInputEvent(e){}onInputEventAfter(e){}get internallyEditable(){return this.getEditableFlag(l.bH.USER)&&this.getEditableFlag(l.bH.MANAGER)}finishToolCreation(){this.created||this._creationFinishedResolver.resolve(this),this._set("created",!0)}_syncVisible(){if(this.initialized)if(this.visible)this._show();else if(this._hide(),this.active)return void(this.view.activeTool=null)}_show(){this._updateManipulatorAttachment(),this.onShow()}_hide(){this._updateManipulatorAttachment(),this.onHide()}_updateManipulatorAttachment(){this.visible?this.manipulators.attach():this.manipulators.detach()}};(0,n._)([(0,s.Cb)({constructOnly:!0})],d.prototype,"view",void 0),(0,n._)([(0,s.Cb)({readOnly:!0})],d.prototype,"active",null),(0,n._)([(0,s.Cb)({value:!0})],d.prototype,"visible",null),(0,n._)([(0,s.Cb)({value:!0})],d.prototype,"editable",null),(0,n._)([(0,s.Cb)({readOnly:!0})],d.prototype,"manipulators",void 0),(0,n._)([(0,s.Cb)({readOnly:!0})],d.prototype,"updating",null),(0,n._)([(0,s.Cb)()],d.prototype,"cursor",null),(0,n._)([(0,s.Cb)({readOnly:!0})],d.prototype,"automaticManipulatorSelection",void 0),(0,n._)([(0,s.Cb)()],d.prototype,"hasFocusedManipulators",null),(0,n._)([(0,s.Cb)()],d.prototype,"hasGrabbedManipulators",void 0),(0,n._)([(0,s.Cb)()],d.prototype,"hasHoveredManipulators",void 0),(0,n._)([(0,s.Cb)()],d.prototype,"firstGrabbedManipulator",void 0),(0,n._)([(0,s.Cb)({readOnly:!0})],d.prototype,"created",void 0),(0,n._)([(0,s.Cb)({readOnly:!0})],d.prototype,"removeIncompleteOnCancel",void 0),d=(0,n._)([(0,o.j)("esri.views.interactive.InteractiveToolBase")],d)},92853:(e,t,i)=>{i.d(t,{D:()=>a});var n,r=i(80987);!function(e){e[e.WhenToolEditable=0]="WhenToolEditable",e[e.WhenToolNotEditable=1]="WhenToolNotEditable",e[e.Always=2]="Always"}(n||(n={}));class a{constructor(){this._isToolEditable=!0,this._manipulators=new r.Z,this._resourceContexts={manipulator3D:{}},this._attached=!1}set isToolEditable(e){this._isToolEditable=e}get length(){return this._manipulators.length}add(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.WhenToolEditable;this.addMany([e],t)}addMany(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.WhenToolEditable;for(const i of e){const e={manipulator:i,visibilityPredicate:t,attached:!1};this._manipulators.add(e),this._attached&&this._updateManipulatorAttachment(e)}}remove(e){for(let t=0;t<this._manipulators.length;t++)if(this._manipulators.at(t).manipulator===e){const e=this._manipulators.splice(t,1)[0];this._detachManipulator(e);break}}removeAll(){this._manipulators.forEach((e=>{this._detachManipulator(e)})),this._manipulators.removeAll()}attach(){this._manipulators.forEach((e=>{this._updateManipulatorAttachment(e)})),this._attached=!0}detach(){this._manipulators.forEach((e=>{this._detachManipulator(e)})),this._attached=!1}destroy(){this.detach(),this._manipulators.forEach((e=>{let{manipulator:t}=e;return t.destroy()})),this._manipulators.destroy(),this._resourceContexts=null}on(e,t){return this._manipulators.on(e,(e=>{t(e)}))}forEach(e){for(const t of this._manipulators.items)e(t)}some(e){return this._manipulators.items.some(e)}toArray(){const e=[];return this.forEach((t=>e.push(t.manipulator))),e}intersect(e,t){let i=null,n=Number.MAX_VALUE;return this._manipulators.forEach((r=>{let{manipulator:a,attached:s}=r;if(!s||!a.interactive)return;const o=a.intersectionDistance(e,t);null!=o&&o<n&&(n=o,i=a)})),i}_updateManipulatorAttachment(e){this._isManipulatorItemVisible(e)?this._attachManipulator(e):this._detachManipulator(e)}_attachManipulator(e){e.attached||(e.manipulator.attach&&e.manipulator.attach(this._resourceContexts),e.attached=!0)}_detachManipulator(e){if(!e.attached)return;const t=e.manipulator;t.grabbing=!1,t.dragging=!1,t.hovering=!1,t.selected=!1,t.detach&&t.detach(this._resourceContexts),e.attached=!1}_isManipulatorItemVisible(e){return e.visibilityPredicate===n.Always||(this._isToolEditable?e.visibilityPredicate===n.WhenToolEditable:e.visibilityPredicate===n.WhenToolNotEditable)}}},81298:(e,t,i)=>{i.d(t,{w:()=>a});var n=i(88153),r=i(54463);function a(e){const t=(0,n.Z8)(e);return t.options.store=r.eC.MIN,t.options.hud=!1,t}},74229:(e,t,i)=>{i.d(t,{$Q:()=>v,AN:()=>V,BS:()=>D,Cf:()=>_,M2:()=>p,Mz:()=>A,Xd:()=>h,dJ:()=>y,di:()=>g,fW:()=>w,hM:()=>S,kY:()=>M,uI:()=>b,zh:()=>C});var n=i(63780),r=(i(93169),i(84652)),a=i(16889),s=i(17842),o=i(79803),l=i(69048),c=i(37818),d=i(74509),u=i(17877);function h(e,t){return e.events.on("drag",function(e,t){let i=null,n=null;return r=>{if("cancel"===r.action)return void(null!=n&&(n.execute({action:"cancel"}),i=null,n=null));const a={action:r.action,screenStart:r.start,screenEnd:r.screenPoint};"start"===r.action&&null==i&&(i=new S,n=new S,t(e,i,n,r.pointerType,a)),null!=i&&i.execute(a),"end"===r.action&&null!=i&&(i=null,n=null)}}(e,t))}function p(e,t){var i;const n=[e.x,e.y,null!==(i=e.z)&&void 0!==i?i:0],r=t,a=[Math.cos(r),Math.sin(r)],s=Math.sqrt(a[0]*a[0]+a[1]*a[1]);if(0===s)return null;a[0]/=s,a[1]/=s;const o=e=>{const t=(e.x-n[0])*a[0]+(e.y-n[1])*a[1];e.x=n[0]+t*a[0],e.y=n[1]+t*a[1]};return e=>(o(e.mapStart),o(e.mapEnd),{...e,axis:a})}function v(e){let t=null;return i=>{var n,r;if("start"===i.action&&(t=function(e,t){const i=e.operations;if(!i)return null;const n=i.data.geometry,r=(0,c.D)(t);if(n.spatialReference.equals(r))return m(e,i,(()=>{}));if("mesh"!==n.type){const t=f(n,r);if(null==t)return null;const a=n.spatialReference;return m(e,u.c.fromGeometry(t,i.viewingMode),(()=>{const e=(0,o.project)(n,a);i.trySetGeometry(e)}))}if((0,l.QK)(n)){const t=f(n.origin,r);if(!t)return null;const a=n.spatialReference,s=u.c.fromGeometry(t,i.viewingMode);return m(e,i,(()=>{var e,t;const r=(0,o.project)(s.data.geometry,a),l=r.x-n.origin.x,c=r.y-n.origin.y,d=(null!==(e=r.z)&&void 0!==e?e:0)-(null!==(t=n.origin.z)&&void 0!==t?t:0);i.move(l,c,d)}))}return null}(e,i.mapStart.spatialReference)),null==t)return null;const a=i.mapEnd.x-i.mapStart.x,s=i.mapEnd.y-i.mapStart.y,d=(null!==(n=i.mapEnd.z)&&void 0!==n?n:0)-(null!==(r=i.mapStart.z)&&void 0!==r?r:0);return t.move(a,s,d,i.action),{...i,translationX:a,translationY:s,translationZ:d}}}function f(e,t){return null==e?null:e.spatialReference.equals(t)?e.clone():(0,o.project)(e,t)}function m(e,t,i){let n=0,r=0,a=0;return{move:(s,o,l,c)=>{var d;"start"===c&&(n=0,r=0,a=0);const u=s-n,h=o-r,p=l-a;t.move(u,h,p),n+=u,r+=h,a+=p,i(),"end"===c&&(null===(d=e.endInteraction)||void 0===d||d.call(e))}}}function _(e){var t;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0,r=null;const a=null==i||null!==(t=e.spatialReference)&&void 0!==t&&t.equals(i)?e=>e:e=>null!=e?(0,o.project)(e,i):e,s={exclude:[],...n};return t=>{if("start"===t.action&&(r=a(e.toMap(t.screenStart,s))),null==r)return null;const i=a(e.toMap(t.screenEnd,s));return null!=i?{...t,mapStart:r,mapEnd:i}:null}}function w(e){const t=e.map((e=>v(e))).filter(n.pC);return e=>{const i=e.mapEnd.x-e.mapStart.x,n=e.mapEnd.y-e.mapStart.y,r=e.mapEnd.z-e.mapStart.z;return t.forEach((t=>t(e))),{...e,translationX:i,translationY:n,translationZ:r}}}function g(e,t){const i=new Map;for(const n of t)i.set(n,(0,r.d9)(e[n]));return t=>(i.forEach(((t,i)=>{e[i]=t})),t)}function b(e){var t;const i=null===(t=e.operations)||void 0===t?void 0:t.createResetState();return e=>(null!==i&&void 0!==i&&i.remove(),e)}function y(e){const t=e.map((e=>b(e))).filter((e=>null!=e));return e=>(t.forEach((t=>t(e))),e)}function V(){let e=0,t=0,i=0;return n=>{"start"===n.action&&(e=n.mapStart.x,t=n.mapStart.y,i=n.mapStart.z);const r=n.mapEnd.x-e,a=n.mapEnd.y-t,s=n.mapEnd.z-i;return e=n.mapEnd.x,t=n.mapEnd.y,i=n.mapEnd.z,{...n,mapDeltaX:r,mapDeltaY:a,mapDeltaZ:s,mapDeltaSpatialReference:n.mapStart.spatialReference}}}function C(){let e=0,t=0;return i=>{"start"===i.action&&(e=i.screenStart.x,t=i.screenStart.y);const n=i.screenEnd.x-e,r=i.screenEnd.y-t;return e=i.screenEnd.x,t=i.screenEnd.y,{...i,screenDeltaX:n,screenDeltaY:r}}}function M(e,t){let i=null,n=0,r=0;return o=>{var l;if("start"===o.action&&(i=null===(l=e.toScreen)||void 0===l?void 0:l.call(e,t),null!=i&&(i.x<0||i.x>e.width||i.y<0||i.y>e.height?i=null:(n=o.screenStart.x-i.x,r=o.screenStart.y-i.y))),null==i)return null;const c=(0,a.uZ)(o.screenEnd.x-n,0,e.width),d=(0,a.uZ)(o.screenEnd.y-r,0,e.height),u=(0,s.vW)(c,d);return o.screenStart=i,o.screenEnd=u,o}}const E=()=>{};class S{constructor(){this.execute=E}next(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new S;return null!=e&&(this.execute=i=>{const n=e(i);null!=n&&t.execute(n)}),t}}function D(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if("2d"===e.type)return e=>e;let n=null;return r=>{"start"===r.action&&(n=e.toMap(r.screenStart,{exclude:i}),null!=n&&(n.z=(0,d.Ou)(n,e,t)));const a=e.toMap(r.screenEnd,{exclude:i});null!=a&&(a.z=(0,d.Ou)(a,e,t));const s=null!=n&&null!=a?{sceneStart:n,sceneEnd:a}:null;return{...r,scenePoints:s}}}function O(e,t,i){var n,r;const a=null!==(n=t.elevationProvider.getElevation(e.x,e.y,null!==(r=e.z)&&void 0!==r?r:0,e.spatialReference,"scene"))&&void 0!==n?n:0,s=(0,c.WG)(e);return s.z=a,s.hasZ=!0,s.z=(0,d.Ou)(s,t,i),s}function A(e,t){if("2d"===e.type)return e=>e;let i=null;return n=>{"start"===n.action&&(i=O(n.mapStart,e,t));const r=O(n.mapEnd,e,t),a=null!=i&&null!=r?{sceneStart:i,sceneEnd:r}:null;return{...n,scenePoints:a}}}},87888:(e,t,i)=>{i.d(t,{G7:()=>h,Kj:()=>c,Lk:()=>u,Sn:()=>l,T6:()=>d});var n=i(63780),r=i(42537),a=i(77427),s=i(1614),o=i(67750);const l={redo:"r",undo:"z",center:"Alt",constraint:"Shift",cancel:"Escape",delete:["Backspace","Delete"],complete:"Enter",vertexAdd:"f",pan:" "},c={toggle:"Control"},d={enterInputMode:"Tab",commit:"Enter",discard:"Escape",next:"Tab"},u={moveUp:{key:"ArrowUp",modifier:"Shift",repeats:!0},moveDown:{key:"ArrowDown",modifier:"Shift",repeats:!0},moveLeft:{key:"ArrowLeft",modifier:"Shift",repeats:!0},moveRight:{key:"ArrowRight",modifier:"Shift",repeats:!0},scaleUp:{key:"+",modifier:"Shift"},scaleDown:{key:"-",modifier:"Shift"},factorModifier:{key:o.C,continuePropagation:!0},toggleOpacity:"t",preserveAspectRatio:{key:"Shift",continuePropagation:!0},rotateIncrements:{key:"Shift",continuePropagation:!0},undo:"z",redo:"r"};class h{constructor(){this._bindings=new Map}add(e,t){return this.addToggle(e,(e=>{"key-down"===e.type&&t(e)}))}addToggle(e,t){const i=p.fromDefinition(e,t),s=(0,a.s1)(this._bindings,i.key,(()=>[]));return s.push(i),(0,r.kB)((()=>(0,n.Od)(s,i)))}register(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s.f.WIDGET;return(0,r.AL)([e.on("key-down",(t=>this.dispatch(e.inputManager,t)),t),e.on("key-up",(t=>this.dispatch(e.inputManager,t)),t)])}dispatch(e,t){const i=t.key,n=this._bindings.get(i);if(n)for(const r of n)r.process(e,t)}}class p{constructor(e,t,i,n,r){this.key=e,this.modifiers=t,this.repeats=i,this.continuePropagation=n,this.callback=r}process(e,t){if(!(t.key!==this.key||"repeat"in t&&t.repeat&&!this.repeats)){for(const t of this.modifiers)if(!e.isModifierKeyDown(t))return;this.continuePropagation||t.stopPropagation(),this.callback(t)}}static fromDefinition(e,t){if("string"==typeof e)return new p(e,[],!1,!1,t);const{key:i,modifier:n,repeats:r,continuePropagation:a}=e;return new p(i,n?Array.isArray(n)?n:[n]:[],!!r,!!a,t)}}},94163:(e,t,i)=>{i.d(t,{SP:()=>n,UG:()=>d,dU:()=>c,k0:()=>o,xO:()=>l});i(16889);var n,r=i(13611),a=i(6644);function s(e,t){return e[0]*t[1]-e[1]*t[0]}function o(e,t,i,n){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:i;return(0,r.$X)(h,n,i),(0,r.$X)(v,t,a),function(e,t,i){const n=(0,r.AK)(i,t)/(0,r.we)(i);(0,r.bA)(e,i,n)}(f,v,h),(0,r.IH)(e,a,f)}function l(e,t,i,n){(0,r.$X)(h,t,i);const a=n/(0,r.kE)(h);return(0,r.od)(e,i,h,a)}function c(e,t){const i=e.start,a=e.end,o=t.start,l=t.end,c=(0,r.$X)(h,a,i),d=(0,r.$X)(p,l,o),m=s(c,d);if(Math.abs(m)<=u)return[];const _=(0,r.$X)(v,i,o),w=s(d,_)/m,g=s(c,_)/m;if(w>=0){if(g>=0||t.type===n.LINE)return[(0,r.od)(f,i,c,w)]}else if(e.type===n.LINE&&(g>=0||t.type===n.LINE))return[(0,r.od)(f,i,c,w)];return[]}function d(e,t,i){const a=[],s=(0,r.$X)(h,e.end,e.start),o=(0,r.$X)(p,e.start,t),l=(0,r.we)(s),c=2*(0,r.AK)(s,o),d=c*c-4*l*((0,r.we)(o)-i*i);if(0===d){const t=-c/(2*l);(e.type===n.LINE||t>=0)&&a.push((0,r.od)(f,e.start,s,t))}else if(d>0){const t=Math.sqrt(d),i=(-c+t)/(2*l);(e.type===n.LINE||i>=0)&&a.push((0,r.od)(f,e.start,s,i));const o=(-c-t)/(2*l);(e.type===n.LINE||o>=0)&&a.push((0,r.od)(v,e.start,s,o))}return a}!function(e){e[e.RAY=0]="RAY",e[e.LINE=1]="LINE"}(n||(n={}));const u=1e-6,h=(0,a.Ue)(),p=(0,a.Ue)(),v=(0,a.Ue)(),f=(0,a.Ue)()}}]);
//# sourceMappingURL=97433.24f4ad8a.chunk.js.map