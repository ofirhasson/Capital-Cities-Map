"use strict";(self.webpackChunknorthwind=self.webpackChunknorthwind||[]).push([[45337],{29616:(t,e,i)=>{i.d(e,{Qc:()=>d,WU:()=>a,lt:()=>c,ti:()=>r});var n=i(643),o=i(36257);const s={ar:[".",","],bg:[",","\xa0"],bs:[",","."],ca:[",","."],cs:[",","\xa0"],da:[",","."],de:[",","."],"de-ch":[".","\u2019"],el:[",","."],en:[".",","],"en-au":[".",","],es:[",","."],"es-mx":[".",","],et:[",","\xa0"],fi:[",","\xa0"],fr:[",","\u202f"],"fr-ch":[",","\u202f"],he:[".",","],hi:[".",",","#,##,##0.###"],hr:[",","."],hu:[",","\xa0"],id:[",","."],it:[",","."],"it-ch":[".","\u2019"],ja:[".",","],ko:[".",","],lt:[",","\xa0"],lv:[",","\xa0"],mk:[",","."],nb:[",","\xa0"],nl:[",","."],pl:[",","\xa0"],pt:[",","."],"pt-pt":[",","\xa0"],ro:[",","."],ru:[",","\xa0"],sk:[",","\xa0"],sl:[",","."],sr:[",","."],sv:[",","\xa0"],th:[".",","],tr:[",","."],uk:[",","\xa0"],vi:[",","."],zh:[".",","]};function r(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,o.Kd)(),e=(t=t.toLowerCase())in s;if(!e){const i=t.split("-");i.length>1&&i[0]in s&&(t=i[0],e=!0),e||(t="en")}const[i,n,r="#,##0.###"]=s[t];return{decimal:i,group:n,pattern:r}}function a(t,e){const i=r((e={...e}).locale);e.customs=i;const n=e.pattern||i.pattern;return isNaN(t)||Math.abs(t)===1/0?null:function(t,e,i){const n=(i=i||{}).customs.group,o=i.customs.decimal,s=e.split(";"),r=s[0];if((e=s[t<0?1:0]||"-"+r).includes("%"))t*=100;else if(e.includes("\u2030"))t*=1e3;else{if(e.includes("\xa4"))throw new Error("currency notation not supported");if(e.includes("E"))throw new Error("exponential notation not supported")}const a=l,c=r.match(a);if(!c)throw new Error("unable to find a number expression in pattern: "+e);return!1===i.fractional&&(i.places=0),e.replace(a,function(t,e,i){!0===(i=i||{}).places&&(i.places=0),i.places===1/0&&(i.places=6);const n=e.split("."),o="string"==typeof i.places&&i.places.indexOf(",");let s=i.places;o?s=i.places.substring(o+1):+s>=0||(s=(n[1]||[]).length),i.round<0||(t=Number(t.toFixed(Number(s))));const r=String(Math.abs(t)).split("."),a=r[1]||"";if(n[1]||i.places){o&&(i.places=i.places.substring(0,o));const t=void 0!==i.places?i.places:n[1]&&n[1].lastIndexOf("0")+1;+t>a.length&&(r[1]=a.padEnd(Number(t),"0")),+s<a.length&&(r[1]=a.substr(0,Number(s)))}else r[1]&&r.pop();const l=n[0].replace(",","");let c=l.indexOf("0");-1!==c&&(c=l.length-c,c>r[0].length&&(r[0]=r[0].padStart(c,"0")),l.includes("#")||(r[0]=r[0].substr(r[0].length-c)));let d,u,p=n[0].lastIndexOf(",");if(-1!==p){d=n[0].length-p-1;const t=n[0].substr(0,p);p=t.lastIndexOf(","),-1!==p&&(u=t.length-p-1)}const h=[];for(let v=r[0];v;){const t=v.length-d;h.push(t>0?v.substr(t):v),v=t>0?v.slice(0,t):"",u&&(d=u,u=void 0)}return r[0]=h.reverse().join(i.group||","),r.join(i.decimal||".")}(t,c[0],{decimal:o,group:n,places:i.places,round:i.round}))}(t,n,e)}const l=/[#0,]*[#0](?:\.0*#*)?/;function c(t){const e=r((t=t||{}).locale),i=t.pattern||e.pattern,o=e.group,s=e.decimal;let a=1;if(i.includes("%"))a/=100;else if(i.includes("\u2030"))a/=1e3;else if(i.includes("\xa4"))throw new Error("currency notation not supported");const c=i.split(";");1===c.length&&c.push("-"+c[0]);const d=p(c,(e=>(e="(?:"+(0,n.Qs)(e,".")+")").replace(l,(e=>{const i={signed:!1,separator:t.strict?o:[o,""],fractional:t.fractional,decimal:s,exponent:!1},n=e.split(".");let r=t.places;1===n.length&&1!==a&&(n[1]="###"),1===n.length||0===r?i.fractional=!1:(void 0===r&&(r=t.pattern?n[1].lastIndexOf("0")+1:1/0),r&&null==t.fractional&&(i.fractional=!0),!t.places&&+r<n[1].length&&(r+=","+n[1].length),i.places=r);const l=n[0].split(",");return l.length>1&&(i.groupSize=l.pop().length,l.length>1&&(i.groupSize2=l.pop().length)),"("+function(t){"places"in(t=t||{})||(t.places=1/0),"string"!=typeof t.decimal&&(t.decimal="."),"fractional"in t&&!String(t.places).startsWith("0")||(t.fractional=[!0,!1]),"exponent"in t||(t.exponent=[!0,!1]),"eSigned"in t||(t.eSigned=[!0,!1]);const e=u(t),i=p(t.fractional,(e=>{let i="";return e&&0!==t.places&&(i="\\"+t.decimal,t.places===1/0?i="(?:"+i+"\\d+)?":i+="\\d{"+t.places+"}"),i}),!0);let n=e+i;return i&&(n="(?:(?:"+n+")|(?:"+i+"))"),n+p(t.exponent,(e=>e?"([eE]"+u({signed:t.eSigned})+")":""))}(i)+")"}))),!0);return{regexp:d.replaceAll(/[\xa0 ]/g,"[\\s\\xa0]"),group:o,decimal:s,factor:a}}function d(t,e){const i=c(e),n=new RegExp("^"+i.regexp+"$").exec(t);if(!n)return NaN;let o=n[1];if(!n[1]){if(!n[2])return NaN;o=n[2],i.factor*=-1}return o=o.replaceAll(new RegExp("["+i.group+"\\s\\xa0]","g"),"").replace(i.decimal,"."),Number(o)*i.factor}function u(t){return"signed"in(t=t||{})||(t.signed=[!0,!1]),"separator"in t?"groupSize"in t||(t.groupSize=3):t.separator="",p(t.signed,(t=>t?"[-+]":""),!0)+p(t.separator,(e=>{if(!e)return"(?:\\d+)";" "===(e=(0,n.Qs)(e))?e="\\s":"\xa0"===e&&(e="\\s\\xa0");const i=t.groupSize,o=t.groupSize2;if(o){const t="(?:0|[1-9]\\d{0,"+(o-1)+"}(?:["+e+"]\\d{"+o+"})*["+e+"]\\d{"+i+"})";return i-o>0?"(?:"+t+"|(?:0|[1-9]\\d{0,"+(i-1)+"}))":t}return"(?:0|[1-9]\\d{0,"+(i-1)+"}(?:["+e+"]\\d{"+i+"})*)"}),!0)}const p=(t,e,i)=>{if(!Array.isArray(t))return e(t);const n=[];for(let o=0;o<t.length;o++)n.push(e(t[o]));return h(n.join("|"),Boolean(i))},h=(t,e)=>"("+(e?"?:":"")+t+")"},87616:(t,e,i)=>{i.d(e,{$B:()=>m,$i:()=>f,BZ:()=>h,DR:()=>g,Ow:()=>_,QU:()=>d,cZ:()=>v,kR:()=>l,on:()=>b,ul:()=>p,wS:()=>u,zD:()=>c});var n=i(10064),o=i(15075),s=i(848),r=i(78952),a=i(6291);function l(){return(0,o.i)()}function c(){return(0,o.l)()}function d(t,e){const i=[];t=(t=(t=t.replaceAll(/[\u00B0\u00BA]/g,"^")).replaceAll("\u2032","'")).replaceAll("\u2033",'"');const n=w(e);return o.c.dmsToGeog(n,1,[t],i)?new s.Z(i[0][0],i[0][1],e||r.Z.WGS84):null}function u(t){var e,i,n;return t&&l()&&null!==(e=null!==(i=(0,a.p3)(t))&&void 0!==i?i:null===(n=d("0\xb0 0' 0\" N | ".concat(t)))||void 0===n?void 0:n.longitude)&&void 0!==e?e:null}function p(t){var e,i,n;return t&&l()&&null!==(e=null!==(i=(0,a.p3)(t))&&void 0!==i?i:null===(n=d("".concat(t," | 00\xb0 00' 00\" E")))||void 0===n?void 0:n.latitude)&&void 0!==e?e:null}function h(t,e,i){const n=[],a=C(i);if(-1===a)return console.warn("invalid conversionMode: ".concat(i)),null;const l=w(e);return o.d.mgrsToGeogExtended(l,1,[t],a,n)?new s.Z(n[0][0],n[0][1],e||r.Z.WGS84):null}function v(t,e){const i=[];!e&&/\(.+27/.test(t)&&(e=r.Z.GCS_NAD_1927);const n=w(e);return o.e.usngToGeog(n,1,[t],i)?new s.Z(i[0][0],i[0][1],e||r.Z.WGS84):null}function g(t,e,i){const n=[],a=y(i);if(-1===a)return console.warn("invalid conversionMode: ".concat(i)),null;const l=w(e);return o.f.utmToGeog(l,1,[t],a,n)?new s.Z(n[0][0],n[0][1],e||r.Z.WGS84):null}function _(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const n=[[t.x,t.y]],s=[],r=w(t.spatialReference);let a=0;switch(e){case"dd":a=o.c.geogToDd(r,1,n,i,s);break;case"ddm":a=o.c.geogToDdm(r,1,n,i,s);break;case"dms":a=o.c.geogToDms(r,1,n,i,s);break;default:return console.warn("invalid format: ".concat(e)),null}return a?s[0]:null}function m(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const s=[[t.x,t.y]],r=[],a=w(t.spatialReference);let l=C(e);return-1===l?(console.warn("invalid conversionMode: ".concat(e)),null):(n&&(l|=o.d.PE_MGRS_ADD_SPACES),o.d.geogToMgrsExtended(a,1,s,i,!1,l,r)?r[0]:null)}function b(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=[[t.x,t.y]],s=[],r=w(t.spatialReference);return o.e.geogToUsng(r,1,n,e,!1,i,s)?s[0]:null}function f(t,e){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=[[t.x,t.y]],s=[],r=w(t.spatialReference);let a=y(e);return-1===a?(console.warn("invalid conversionMode: ".concat(e)),null):(i&&(a|=o.f.PE_UTM_OPTS_ADD_SPACES),o.f.geogToUtm(r,1,n,a,s)?s[0]:null)}function w(t){let e=null;if(t||(t=r.Z.WGS84),t.wkid){if(e=o.P.geogcs(t.wkid),!e)throw new n.Z("coordinate-formatter:invalid-spatial-reference","wkid is not valid")}else{if(!t.wkt2&&!t.wkt)throw new n.Z("coordinate-formatter:invalid-spatial-reference","wkid and wkt are missing");if(e=o.P.fromString(o.a.PE_TYPE_GEOGCS,t.wkt2||t.wkt),!e)throw new n.Z("coordinate-formatter:invalid-spatial-reference","wkt is not valid")}return e}function C(t){let e=-1;switch(t){case"automatic":e=o.d.PE_MGRS_STYLE_AUTO;break;case"new-180-in-zone-01":e=o.d.PE_MGRS_STYLE_NEW|o.d.PE_MGRS_180_ZONE_1_PLUS;break;case"new-180-in-zone-60":e=o.d.PE_MGRS_STYLE_NEW;break;case"old-180-in-zone-01":e=o.d.PE_MGRS_STYLE_OLD|o.d.PE_MGRS_180_ZONE_1_PLUS;break;case"old-180-in-zone-60":e=o.d.PE_MGRS_STYLE_OLD}return e}function y(t){let e=-1;switch(t){case"latitude-band-indicators":e=o.f.PE_UTM_OPTS_NONE;break;case"north-south-indicators":e=o.f.PE_UTM_OPTS_NS}return e}},45337:(t,e,i)=>{i.r(e),i.d(e,{default:()=>_t});var n=i(27366),o=i(32718),s=i(92026),r=i(49861),a=i(89125),l=(i(84936),i(93169),i(69912)),c=i(33565),d=i(65905),u=i(52639),p=(i(59166),i(80987)),h=i(10064),v=i(91505),g=i(94172),_=i(848),m=i(79803),b=i(91946),f=i(7138);let w=class extends f.default{constructor(t){super(t),this.format=null,this.position={coordinate:null,location:null}}get displayCoordinate(){var t,e;return null===(t=this.format)||void 0===t?void 0:t.getDisplayCoordinate(null===(e=this.position)||void 0===e?void 0:e.coordinate)}};(0,n._)([(0,r.Cb)({readOnly:!0})],w.prototype,"displayCoordinate",null),(0,n._)([(0,r.Cb)()],w.prototype,"format",void 0),(0,n._)([(0,r.Cb)()],w.prototype,"position",void 0),w=(0,n._)([(0,l.j)("esri.widgets.CoordinateConversion.support.Conversion")],w);const C=w;i(59486);var y=i(78952);function P(t){return t>=500?6:t<500&&t>=50?7:t<50&&t>=5?8:9}function S(t,e){const i=t.includes(",")?",":" ",[n,o,s]=t.split(i).map((t=>{const e=t.trim();return e?Number(e):null}));if(!x(n)||!x(o))return null;const r=new _.Z({x:n,y:o,spatialReference:e||y.Z.WGS84});return s&&(r.z=s,r.hasZ=!0),r}function x(t){return"number"==typeof t&&isFinite(t)}function M(t){return!!t&&x(t.x)&&x(t.y)}function E(t,e){if(t.spatialReference.isGeographic&&e){const[i,n]=function(t,e){const i=P(e);return[t[0].toFixed(i),t[1].toFixed(i)]}([t.x,t.y],e);return"".concat(i,", ").concat(n)}return"".concat(t.x.toFixed(3),", ").concat(t.y.toFixed(3))}const T=["dd","dms","ddm","mgrs","usng","utm"];var I=i(29616),D=i(36257),R=i(87616),k=i(92975),F=i(81753);let L=class extends f.default{constructor(t){super(t),this.conversionInfo=null,this.coordinateSegments=null,this._currentPattern=void 0,this.defaultPattern=null,this.name=null,this.viewModel=null}get currentPattern(){var t;return null!==(t=this._currentPattern||this.defaultPattern)&&void 0!==t?t:""}set currentPattern(t){this._currentPattern=t}get label(){var t;return null!==(t=this.name)&&void 0!==t?t:""}set label(t){this._overrideIfSome("label",t)}get hasDisplayProperties(){return!(!this.defaultPattern||!this.coordinateSegments)}get spatialReference(){var t,e;return"basemap"===this.name?this._viewSpatialReference:null!==(t=null===(e=this.conversionInfo)||void 0===e?void 0:e.spatialReference)&&void 0!==t?t:y.Z.WGS84}set spatialReference(t){this._overrideIfSome("spatialReference",t)}get _viewSpatialReference(){var t,e;return null!==(t=null===(e=this.viewModel)||void 0===e||null===(e=e.view)||void 0===e?void 0:e.spatialReference)&&void 0!==t?t:y.Z.WGS84}get _additionalCharactersPattern(){const t=this.coordinateSegments;if(!t)return null;const e=t.map((t=>t.alias)),i=this.currentPattern.replaceAll(new RegExp('["nsew'.concat(e.join(),"]"),"gi"),"").replaceAll(" ","");return new RegExp("[".concat(i,"]"),"g")}get test(){}async convert(t){var e;if(!M(t))throw new h.Z("format:invalid-point","Could not convert invalid point.",{point:t});const i=null===(e=this.conversionInfo)||void 0===e?void 0:e.convert;if(i)return Promise.resolve().then((()=>i(t)));const n=await this._project(t,this.spatialReference);return{location:n,coordinate:await this._getCoordinate(n)}}getConversionStrategy(){var t,e;const i=this._viewSpatialReference;return null!==(t=this.conversionInfo)&&void 0!==t&&t.convert||null!==(e=this.viewModel)&&void 0!==e&&e.formatterAvailable||"xy"===this.name&&(i.isWebMercator||i.isWGS84)||"basemap"===this.name?"client":"server"}getDisplayCoordinate(t){if(!t)return null;if(!this.coordinateSegments||!this.currentPattern)return t;let e=this.currentPattern;const i=this._getSegmentMatches(t,!1);for(let n=this.coordinateSegments.length-1;n>=0;n--){const t=this.coordinateSegments[n];e=e.replace(t.alias,i[n])}return e}_parseUserInput(t){const{defaultPattern:e,_additionalCharactersPattern:i,coordinateSegments:n}=this;if(!e||!i)return"";let o=e.replace(i,"");t=t.replace(i,"");const s=this._getSegmentMatches(t,!0);if(n)for(let r=n.length-1;r>=0;r--){const t=n[r];o=o.replace(t.alias,s[r])}return o}_getSegmentMatches(t,e){const i=new Array,{coordinateSegments:n}=this;if(!n)return i;for(let o=0;o<n.length;o++){const s=n[o],r=t.match(s.searchPattern);if(!r){i.push("");continue}let a=r[0];if(t=t.replace(a,"").trim(),s.substitution){const t=e?s.substitution.input(a):s.substitution.output(a);t&&(a="".concat(t))}i.push(a)}return i}async reverseConvert(t){var e,i;const n=this._parseUserInput(t),o=null===(e=this.conversionInfo)||void 0===e?void 0:e.reverseConvert;let s;if(o)s=o(n);else if("xy"===this.name||"basemap"===this.name)s=S(n,this.spatialReference);else if(null!==(i=this.viewModel)&&void 0!==i&&i.formatterAvailable)switch(this.name){case"dd":case"ddm":case"dms":s=(0,R.QU)(n,this.spatialReference);break;case"mgrs":{const t="automatic";s=(0,R.BZ)(n,this.spatialReference,t);break}case"utm":{const t="latitude-band-indicators";s=(0,R.DR)(n,this.spatialReference,t);break}case"usng":s=(0,R.cZ)(n,this.spatialReference);break;default:s=null}if(!s)throw new h.Z("format:invalid-input","Could not parse input into point.",{userInput:t});return this._project(s,this._viewSpatialReference)}async _getCoordinate(t){var e,i,n;const o=null!==(e=null===(i=this.viewModel)||void 0===i||null===(i=i.view)||void 0===i?void 0:i.scale)&&void 0!==e?e:0;if(!M(t))throw new h.Z("format:invalid-point","Could not transform invalid point into coordinate.",{point:t});if(null!==(n=this.viewModel)&&void 0!==n&&n.formatterAvailable||"basemap"===this.name||"xy"===this.name)switch(this.name){case"dd":case"ddm":case"dms":{const e=P(o);return(0,R.Ow)(t,this.name,e)}case"mgrs":return(0,R.$B)(t,"automatic",5,!1);case"usng":return(0,R.on)(t,5,!1);case"utm":return(0,R.$i)(t,"latitude-band-indicators",!0);default:return E(t,o)}return E(t,o)}async _project(t,e){var i,n;if((0,k.fS)(t.spatialReference,e)||!e)return t;if(null!==(i=this.viewModel)&&void 0!==i&&i.formatterAvailable&&(0,m.isLoaded)())return(0,m.project)(t,e);if(null===(n=this.viewModel)||void 0===n||!n.formatterAvailable){const i=(0,F.iV)(t,e);if(null!=i)return i}return null}};(0,n._)([(0,r.Cb)()],L.prototype,"conversionInfo",void 0),(0,n._)([(0,r.Cb)()],L.prototype,"coordinateSegments",void 0),(0,n._)([(0,r.Cb)()],L.prototype,"currentPattern",null),(0,n._)([(0,r.Cb)()],L.prototype,"_currentPattern",void 0),(0,n._)([(0,r.Cb)()],L.prototype,"label",null),(0,n._)([(0,r.Cb)()],L.prototype,"defaultPattern",void 0),(0,n._)([(0,r.Cb)({readOnly:!0})],L.prototype,"hasDisplayProperties",null),(0,n._)([(0,r.Cb)()],L.prototype,"name",void 0),(0,n._)([(0,r.Cb)({type:y.Z})],L.prototype,"spatialReference",null),(0,n._)([(0,r.Cb)()],L.prototype,"viewModel",void 0),(0,n._)([(0,r.Cb)({readOnly:!0})],L.prototype,"_viewSpatialReference",null),(0,n._)([(0,r.Cb)({readOnly:!0})],L.prototype,"_additionalCharactersPattern",null),L=(0,n._)([(0,l.j)("esri.widgets.CoordinateConversion.support.Format")],L);const Z=L,O=(0,I.ti)().decimal,B={N:"north",S:"south",E:"east",W:"west"},A="\xb0".concat("\u200e"),G=new RegExp("-?\\d+[\\.|\\".concat(O,"]?\\d*")),V=/^[\\0]+(?=\d)/;function N(t,e){const i="ar"===(0,D.Kd)(),n=t.abbreviatedDirections.north,o=t.abbreviatedDirections.south,s=t.abbreviatedDirections.east,r=t.abbreviatedDirections.west,a=(0,I.ti)().decimal,l={[n]:"N",[o]:"S",[s]:"E",[r]:"W"},c=new RegExp("-?\\d+[\\.|\\".concat(a,"]?\\d*")),d=new RegExp("N|S|".concat(n,"|").concat(o),"i"),u=new RegExp("E|W|".concat(s,"|").concat(r),"i"),p={ddm:"Y".concat(A," A'").concat(t.abbreviatedDirections.north,", X").concat(A," B'").concat(t.abbreviatedDirections.east),dms:"Y".concat(A," A' B\"").concat(t.abbreviatedDirections.north,", X").concat(A," C' D\"").concat(t.abbreviatedDirections.east),dd:"Y".concat(A).concat(t.abbreviatedDirections.north,", X").concat(A).concat(t.abbreviatedDirections.east),xy:"X".concat(A,", Y").concat(A),basemap:"X, Y"},h={ddm:"".concat(t.abbreviatedDirections.north).concat(A,"Y 'A ,").concat(t.abbreviatedDirections.east).concat(A,"X 'B"),dms:"".concat(t.abbreviatedDirections.north).concat(A,"Y 'A \"B ,").concat(t.abbreviatedDirections.east).concat(A,"X 'C \"D"),dd:"".concat(t.abbreviatedDirections.north).concat(A,"Y ,").concat(t.abbreviatedDirections.east).concat(A,"X"),xy:"X".concat(A," ,Y").concat(A),basemap:"X ,Y"},v=new RegExp("\\d{1,2}[\\.|\\".concat(a,"]?\\d*"),"i"),g=new RegExp("\\d{1,3}[\\.|\\".concat(a,"]?\\d*"),"i");e.forEach((e=>{const{name:n}=e;if("dd"===n?e.coordinateSegments=[{alias:"Y",description:"degrees latitude",searchPattern:v,substitution:{input:t=>Y(t),output:t=>W(t)}},{alias:t.abbreviatedDirections.north,description:"north/south indicator",searchPattern:d,substitution:{input:t=>l[t],output:e=>t.abbreviatedDirections[B[e]]}},{alias:"X",description:"degrees longitude",searchPattern:g,substitution:{input:t=>Y(t),output:t=>W(t)}},{alias:t.abbreviatedDirections.east,description:"east/west indicator",searchPattern:u,substitution:{input:t=>l[t],output:e=>t.abbreviatedDirections[B[e]]}}]:"ddm"===n?e.coordinateSegments=[{alias:"Y",description:"degrees latitude",searchPattern:v,substitution:{input:t=>Y(t),output:t=>W(t)}},{alias:"A",description:"minutes latitude",searchPattern:v,substitution:{input:t=>Y(t),output:t=>W(t)}},{alias:t.abbreviatedDirections.north,description:"north/south indicator",searchPattern:d,substitution:{input:t=>l[t],output:e=>t.abbreviatedDirections[B[e]]}},{alias:"X",description:"degrees longitude",searchPattern:g,substitution:{input:t=>Y(t),output:t=>W(t)}},{alias:"B",description:"minutes longitude",searchPattern:v,substitution:{input:t=>Y(t),output:t=>W(t)}},{alias:t.abbreviatedDirections.east,description:"east/west indicator",searchPattern:u,substitution:{input:t=>l[t],output:e=>t.abbreviatedDirections[B[e]]}}]:"dms"===n?e.coordinateSegments=[{alias:"Y",description:"degrees latitude",searchPattern:v,substitution:{input:t=>Y(t),output:t=>W(t)}},{alias:"A",description:"minutes latitude",searchPattern:v,substitution:{input:t=>Y(t),output:t=>W(t)}},{alias:"B",description:"seconds latitude",searchPattern:v,substitution:{input:t=>Y(t),output:t=>W(t)}},{alias:t.abbreviatedDirections.north,description:"north/south indicator",searchPattern:d,substitution:{input:t=>l[t],output:e=>t.abbreviatedDirections[B[e]]}},{alias:"X",description:"degrees longitude",searchPattern:g,substitution:{input:t=>Y(t),output:t=>W(t)}},{alias:"C",description:"minutes longitude",searchPattern:v,substitution:{input:t=>Y(t),output:t=>W(t)}},{alias:"D",description:"seconds longitude",searchPattern:v,substitution:{input:t=>Y(t),output:t=>W(t)}},{alias:t.abbreviatedDirections.east,description:"east/west indicator",searchPattern:u,substitution:{input:t=>l[t],output:e=>t.abbreviatedDirections[B[e]]}}]:("xy"===e.name||"basemap"===e.name)&&(e.coordinateSegments=[{alias:"X",description:"easting",searchPattern:c,substitution:{input:t=>Y(t),output:t=>W(t)}},{alias:"Y",description:"northing",searchPattern:c,substitution:{input:t=>Y(t),output:t=>W(t)}}]),(t=>null!=t&&Object.keys(p).includes(t))(n)){const t=i?h[n]:p[n];e.defaultPattern=t,e.currentPattern=t}}))}function W(t){const e=t.match(V),i=e?e[0]:"",n=t.includes(".")?t.split(".")[1].length:0;return i+(0,I.WU)(Number(t),{pattern:"###0.###",places:n,round:-1})}function Y(t){return(0,I.Qc)(t)}var z=i(99505),X=i(41201);const U="default",H="crosshair",j=new _.Z([0,0,500]),$=["mgrs","utm","usng","dd","dms","ddm"],Q="esri__coordinateConversionWidgetState",J="conversions",q="formats",K="view",tt="view-change";let et=class extends((0,z._)(v.Z.EventedAccessor)){constructor(t){super(t),this._conversionPromise=null,this._locationGraphic=null,this._pointerCount=0,this.conversions=new p.Z,this.formats=new p.Z,this.formatterAvailable=!1,this.messages=null,this.filteredFormats=new p.Z,this.locationSymbol=new b.Z({url:(0,d.V)("esri/images/search/search-symbol-32.png"),width:24,height:24}),this.storageEnabled=!0,this.storageType="session",this.view=null,this._saveWidgetState=this._saveWidgetState.bind(this),this._handleFormatChange=this._handleFormatChange.bind(this),this._handleConversionChange=this._handleConversionChange.bind(this),this._handleViewChange=this._handleViewChange.bind(this),this._onClick=this._onClick.bind(this),this._onPointerMove=this._onPointerMove.bind(this),this._onPointerDown=this._onPointerDown.bind(this),this._onPointerUp=this._onPointerUp.bind(this)}initialize(){const t=async()=>this.messages=await(0,X.ME)("esri/widgets/CoordinateConversion/t9n/CoordinateConversion");this.formats.addMany(function(){const t=new RegExp("N|S","i"),e=new RegExp("E|W","i");return[new Z({name:"basemap",coordinateSegments:[{alias:"X",description:"easting",searchPattern:G,substitution:{input:t=>Y(t),output:t=>W(t)}},{alias:"Y",description:"northing",searchPattern:G,substitution:{input:t=>Y(t),output:t=>W(t)}}],defaultPattern:"X, Y",viewModel:null}),new Z({name:"dd",coordinateSegments:[{alias:"Y",description:"degrees latitude",searchPattern:new RegExp("\\d{1,2}[\\.|\\".concat(O,"]?\\d*(?=\\D*?[N|S])"),"i"),substitution:{input:t=>Y(t),output:t=>W(t)}},{alias:"N",description:"north/south indicator",searchPattern:t},{alias:"X",description:"degrees longitude",searchPattern:new RegExp("\\d{1,3}[\\.|\\".concat(O,"]?\\d*(?=\\D*?[E|W|])"),"i"),substitution:{input:t=>Y(t),output:t=>W(t)}},{alias:"E",description:"east/west indicator",searchPattern:e}],defaultPattern:"Y".concat(A,"N, X").concat(A,"E"),viewModel:null}),new Z({name:"ddm",coordinateSegments:[{alias:"Y",description:"degrees latitude",searchPattern:new RegExp("\\d{1,2}(?=.*?\\s+.*?[N|S])","i"),substitution:{input:t=>Y(t),output:t=>W(t)}},{alias:"A",description:"minutes latitude",searchPattern:new RegExp("\\d{1,2}[\\.\\".concat(O,"]?\\d*(?=.*?[N|S])"),"i"),substitution:{input:t=>Y(t),output:t=>W(t)}},{alias:"N",description:"north/south indicator",searchPattern:t},{alias:"X",description:"degrees longitude",searchPattern:new RegExp("\\d{1,3}(?=\\D*?\\s+.*?[E|W])","i"),substitution:{input:t=>Y(t),output:t=>W(t)}},{alias:"B",description:"minutes longitude",searchPattern:new RegExp("\\d{1,2}[\\.|\\|".concat(O,"]?\\d*(?=.*?[E|W])"),"i"),substitution:{input:t=>Y(t),output:t=>W(t)}},{alias:"E",description:"east/west indicator",searchPattern:e}],defaultPattern:"Y".concat(A," A'N, X").concat(A," B'E"),viewModel:null}),new Z({name:"dms",coordinateSegments:[{alias:"Y",description:"degrees latitude",searchPattern:new RegExp("\\d{1,2}(?=.*?\\s+.*?[N|S])","i"),substitution:{input:t=>Y(t),output:t=>W(t)}},{alias:"A",description:"minutes latitude",searchPattern:new RegExp("\\d{1,2}(?=.*?[N|S])","i"),substitution:{input:t=>Y(t),output:t=>W(t)}},{alias:"B",description:"seconds latitude",searchPattern:new RegExp("\\d{1,2}[\\.|\\".concat(O,"]?\\d*(?=.*?[N|S])"),"i"),substitution:{input:t=>Y(t),output:t=>W(t)}},{alias:"N",description:"north/south indicator",searchPattern:t},{alias:"X",description:"degrees longitude",searchPattern:new RegExp("\\d{1,3}(?=.*?\\s+.*?[E|W])","i"),substitution:{input:t=>Y(t),output:t=>W(t)}},{alias:"C",description:"minutes longitude",searchPattern:new RegExp("\\d{1,2}(?=.*?[E|W])","i"),substitution:{input:t=>Y(t),output:t=>W(t)}},{alias:"D",description:"seconds longitude",searchPattern:new RegExp("\\d{1,2}[\\.|\\".concat(O,"]?\\d*(?=.*?[E|W])"),"i"),substitution:{input:t=>Y(t),output:t=>W(t)}},{alias:"E",description:"east/west indicator",searchPattern:e}],defaultPattern:"Y".concat(A," A' B\"N, X").concat(A," C' D\"E"),viewModel:null}),new Z({name:"xy",coordinateSegments:[{alias:"X",description:"longitude",searchPattern:G,substitution:{input:t=>Y(t),output:t=>W(t)}},{alias:"Y",description:"latitude",searchPattern:G,substitution:{input:t=>Y(t),output:t=>W(t)}}],defaultPattern:"X".concat(A,", Y").concat(A),viewModel:null}),new Z({name:"mgrs",coordinateSegments:[{alias:"Z",description:"grid zone",searchPattern:/\d{1,2}\w|[abyz]/i},{alias:"S",description:"grid square",searchPattern:/\w{2}/},{alias:"X",description:"easting",searchPattern:/^\d{5}(?=.?\d{5}$)|^\d{4}(?=.?\d{4}$)|^\d{3}(?=.?\d{3}$)|^\d{2}(?=.?\d{2}$)|^\d(?=.?\d$)/},{alias:"Y",description:"northing",searchPattern:/^\d{1,5}/}],defaultPattern:"Z S X Y",viewModel:null}),new Z({name:"usng",coordinateSegments:[{alias:"Z",description:"grid zone",searchPattern:/\d{1,2}\w|[abyz]/i},{alias:"S",description:"grid square",searchPattern:/\w{2}/},{alias:"X",description:"easting",searchPattern:/^\d{5}(?=.?\d{5}$)|^\d{4}(?=.?\d{4}$)|^\d{3}(?=.?\d{3}$)|^\d{2}(?=.?\d{2}$)|^\d(?=.?\d$)/},{alias:"Y",description:"northing",searchPattern:/^\d{1,5}/}],defaultPattern:"Z S X Y",viewModel:null}),new Z({name:"utm",coordinateSegments:[{alias:"Z",description:"zone number",searchPattern:/\d{1,2}|[abyz]/i},{alias:"B",description:"latitude band",searchPattern:/^\D/},{alias:"X",description:"easting",searchPattern:/\d{1,7}(?=\s*\d{7}$)/},{alias:"Y",description:"northing",searchPattern:/\d{1,7}/}],defaultPattern:"ZB X Y",viewModel:null})]}()),t().then((()=>{if(!this.destroyed&&(N(this.messages,this.formats),this.storageEnabled&&this._loadWidgetState(),this.formats.forEach((t=>{var e;t.viewModel=this,this.addHandles((0,g.watch)((()=>t.currentPattern),this._saveWidgetState),null!==(e=t.name)&&void 0!==e?e:"unnamed-format")})),this.addHandles(this.conversions.on("change",this._handleConversionChange),J),this.addHandles(this.formats.on("change",this._handleFormatChange),q),this.addHandles((0,D.qe)((()=>{t().then((()=>{N(this.messages,this.formats)}))}))),(0,m.load)().then((()=>{this.formatterAvailable=!0})).catch((t=>{o.Z.getLogger(this).error(new h.Z("coordinate-conversion:projection-load-failed","Failed to load the projection module.",{error:t})),this.formatterAvailable=!1,this._filterFormatsAndConversions()})).then((()=>this.addHandles((0,g.watch)((()=>this.view),this._handleViewChange,g.initial),tt))),0===this.conversions.length)){const t=this.formats.find((t=>"xy"===t.name))||this.formats.at(0);this.conversions.add(new C({format:t}))}}))}destroy(){this.removeHandles(),this._cleanUpView(this.view),this.view=null}castConversions(t){return this._castToConversions(t)}set currentLocation(t){this._set("currentLocation",t),this._updateConversions()}get currentLocation(){return this._get("currentLocation")||null}set mode(t){switch(t){case"capture":this.currentLocation=null,this._startCaptureMode(),this._set("mode",t);break;case"live":this._startLiveMode(),this._set("mode",t)}}get mode(){return this._get("mode")||"live"}get state(){const{messages:t,view:e}=this,i=null===e||void 0===e?void 0:e.ready;return t?i?"ready":e?"loading":"disabled":"disabled"}get storage(){const{storageType:t}=this;return"session"===t?sessionStorage:localStorage}get waitingForConversions(){return null!=this._conversionPromise}setLocation(t){var e,i;if(this._locationGraphic&&null!==(e=this.view)&&void 0!==e&&e.graphics.remove(this._locationGraphic),!t)return;const n=t.clone();n.hasZ&&(n.z=void 0),this._locationGraphic=new u.Z({geometry:n,symbol:this.locationSymbol}),null===(i=this.view)||void 0===i||i.graphics.add(this._locationGraphic)}async convert(t,e){if(!M(e))throw new h.Z("coordinate-conversion:invalid-point","Invalid point cannot be converted.",{point:e});return Promise.resolve().then((()=>t.convert(e)))}async goToLocation(t){var e;const{view:i}=this;if(!i)throw new h.Z("coordinate-conversion:go-to-failed","no view");const n="3d"===i.type?i.clippingArea:null,o=null===(e=i.map)||void 0===e||null===(e=e.basemap)||void 0===e?void 0:e.baseLayers;if(n||(null===o||void 0===o?void 0:o.length)>0){var s;const e=null!==n&&void 0!==n?n:null===(s=o.at(0))||void 0===s?void 0:s.fullExtent;if(null!=e&&!e.contains(t))throw new h.Z("coordinate-conversion:go-to-failed","Point outside basemap extent.",{point:t})}return this.callGoTo({target:t})}pause(){this.currentLocation=null,this.removeHandles(K),this.view&&(this.view.cursor=U,this._locationGraphic&&this.view.graphics.remove(this._locationGraphic))}async previewConversion(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.currentLocation||j;return(await it(t,e)).displayCoordinate}resume(){"capture"===this.mode?this._startCaptureMode():this._startLiveMode()}reverseConvert(t,e){return e.reverseConvert(t)}async updateConversions(t,e){if("point"!==(null===e||void 0===e?void 0:e.type))throw this._clearConversions(this.conversions),new h.Z("coordinate-conversion:invalid-input-point","Point is invalid, conversions cannot be updated.",{point:e});return this._convertMany(t,e)}_castToConversions(t){const e=new p.Z;return t.forEach((t=>{let i=null;if(t instanceof C)i=t;else if("string"==typeof t){const e=this.formats.find((e=>e.name===t));e&&(i=new C({format:e}))}i&&e.add(i)})),e}_cleanUpView(t){t&&(this._locationGraphic&&t.graphics.remove(this._locationGraphic),this.removeHandles(K),t.cursor=U)}_clearConversions(t){t.forEach((t=>{t.position={location:null,coordinate:null}}))}async _convertMany(t,e){return Promise.all(t.map((t=>it(t,e))))}_handleConversionChange(t){for(const e of t.added){const{format:t}=e;t&&(t.viewModel=this,this.currentLocation&&(this._set("waitingForConversions",!0),this.convert(t,this.currentLocation).then((t=>{e.position=t,this._set("waitingForConversions",!1)}))))}this._saveWidgetState()}_handleFormatChange(t){t.added.forEach((t=>{var e;this.addHandles((0,g.watch)((()=>t.currentPattern),this._saveWidgetState),null!==(e=t.name)&&void 0!==e?e:"unnamed-format"),t.viewModel=this})),t.removed.forEach((t=>{t.viewModel=null;const e=this.conversions.filter((e=>e.format===t));this.conversions.removeMany(e),t.name&&this.removeHandles(t.name)}))}_loadWidgetState(){try{const t=JSON.parse(this.storage.getItem(Q));t&&this._setWidgetState(t)}catch(t){o.Z.getLogger(this).error(new h.Z("coordinate-conversion:invalid-session-storage-json","Could not read from storage.",{error:t}))}}_startCaptureMode(){this.removeHandles(K),this.view&&(this.view.cursor=H,this.currentLocation&&this.setLocation(this.currentLocation),this.addHandles(this.view.on("click",this._onClick),K))}_startLiveMode(){this._pointerCount=0,this.removeHandles(K),this.view&&(this.view.cursor=U,this._locationGraphic&&this.view.graphics.remove(this._locationGraphic),this.addHandles([this.view.on("pointer-down",this._onPointerDown),this.view.on("pointer-up",this._onPointerUp),this.view.on("pointer-move",this._onPointerMove)],K))}_handleViewChange(t,e){e&&e!==t&&this._cleanUpView(e),t&&("capture"===this.mode?this._startCaptureMode():this._startLiveMode(),e&&this._filterFormatsAndConversions())}_onClick(t){if(0===t.button){var e;const i=null===(e=this.view)||void 0===e?void 0:e.toMap(t),n=null===i||void 0===i?void 0:i.normalize();this.setLocation(n),this.currentLocation=n}}_onPointerDown(t){const{pointerType:e}=t;if(this._pointerCount++,("touch"===e||"pen"===e)&&1===this._pointerCount){var i;const e=null===(i=this.view)||void 0===i?void 0:i.toMap(t);this.currentLocation=null===e||void 0===e?void 0:e.normalize()}}_onPointerMove(t){const{pointerType:e}=t;if("mouse"===e||1===this._pointerCount){var i;const e=null===(i=this.view)||void 0===i?void 0:i.toMap(t);this.currentLocation=null===e||void 0===e?void 0:e.normalize()}}_onPointerUp(){this._pointerCount--}_setWidgetState(t){try{t.formats.forEach((e=>{const i=this.formats.find((t=>t.name===e.name));i&&t.locale===(0,D.Kd)()&&e.currentPattern&&(i.currentPattern=e.currentPattern),i&&e.index>=0&&this.conversions.add(new C({format:i}))}))}catch(w){o.Z.getLogger(this).warn(new h.Z("coordinate-conversion:session-storage-read-error","Could not get widget state from stored JSON.",{error:w}))}}_saveWidgetState(){if(!this.storageEnabled)return;const t=this._toJSON();try{this.storage.setItem(Q,JSON.stringify({formats:t,locale:(0,D.Kd)()}))}catch(w){o.Z.getLogger(this).error(new h.Z("coordinate-conversion:local-storage-write-error","Could not write to localStorage.",{error:w}))}}async _updateConversions(){try{await this.updateConversions(this.conversions.toArray(),this.currentLocation)}catch{}}_toJSON(){return this.formats.filter((t=>{const e=t.name;return"xy"===e||"basemap"===e||function(t){return T.includes(t)}(e)})).map((t=>({name:t.name,currentPattern:t.currentPattern,defaultPattern:t.defaultPattern,index:this.conversions.findIndex((e=>e.format===t))}))).sort(((t,e)=>t.index-e.index)).toArray()}_filterFormatsAndConversions(){const{formatterAvailable:t,conversions:e,formats:i}=this;t||this.addHandles((0,g.when)((()=>{var t;return null===(t=this.view)||void 0===t?void 0:t.spatialReference}),(t=>{const n=t.isWebMercator||t.isWGS84,o=i.filter((t=>{const{name:e}=t;return!!function(t){return $.includes(t)}(e)||"xy"===e&&!n})),s=this.filteredFormats.filter((t=>"xy"===t.name&&n&&!this.formats.includes(t))),r=e.filter((t=>o.includes(t.format)));i.removeMany(o),e.removeMany(r),this.filteredFormats.addMany(o.filter((t=>!this.filteredFormats.includes(t)))),i.addMany(s)}),{once:!0,initial:!0}),K)}};async function it(t,e){try{var i;t.position=await(null===(i=t.format)||void 0===i?void 0:i.convert(e))}catch(x){t.position=null}return t}(0,n._)([(0,r.Cb)()],et.prototype,"conversions",void 0),(0,n._)([(0,a.p)("conversions")],et.prototype,"castConversions",null),(0,n._)([(0,r.Cb)({type:_.Z})],et.prototype,"currentLocation",null),(0,n._)([(0,r.Cb)()],et.prototype,"formats",void 0),(0,n._)([(0,r.Cb)()],et.prototype,"messages",void 0),(0,n._)([(0,r.Cb)()],et.prototype,"mode",null),(0,n._)([(0,r.Cb)()],et.prototype,"filteredFormats",void 0),(0,n._)([(0,r.Cb)({readOnly:!0})],et.prototype,"state",null),(0,n._)([(0,r.Cb)()],et.prototype,"locationSymbol",void 0),(0,n._)([(0,r.Cb)({readOnly:!0,dependsOn:["storageType"]})],et.prototype,"storage",null),(0,n._)([(0,r.Cb)()],et.prototype,"storageEnabled",void 0),(0,n._)([(0,r.Cb)()],et.prototype,"storageType",void 0),(0,n._)([(0,r.Cb)({readOnly:!0})],et.prototype,"waitingForConversions",null),(0,n._)([(0,r.Cb)()],et.prototype,"view",void 0),et=(0,n._)([(0,l.j)("esri.widgets.CoordinateConversion.CoordinateConversionViewModel")],et);const nt=et;var ot=i(8905),st=i(7021),rt=i(96919),at=i(33095),lt=i(78088),ct=i(80532),dt=i(67005),ut=i(80975);const pt="esri-coordinate-conversion",ht={base:pt,captureMode:"".concat(pt,"--capture-mode"),noBasemap:"".concat(pt,"--no-basemap"),popup:"".concat(pt,"__popup"),clipboardPopup:"".concat(pt,"__clipboard-popup"),conversionList:"".concat(pt,"__conversion-list"),conversionRow:"".concat(pt,"__row"),coordDisplay:"".concat(pt,"__display"),expandButton:"".concat(pt,"__expand-button"),expanded:"".concat(pt,"__conversions-view--expanded"),expandDown:"".concat(pt,"__conversions-view--expand-down"),expandUp:"".concat(pt,"__conversions-view--expand-up"),conversionsView:"".concat(pt,"__conversions-view"),rowSelect:"".concat(pt,"__select-row"),toolDisplay:"".concat(pt,"__tools"),modeToggle:"".concat(pt,"__mode-toggle"),rowButton:"".concat(pt,"__row-button"),coordinateInput:"".concat(pt,"__input-coordinate"),inputForm:"".concat(pt,"__input-form"),inputFormGroup:"".concat(pt,"__input-group"),inputSelect:"".concat(pt,"__input-select"),sectionHeading:"".concat(pt,"__heading"),patternInput:"".concat(pt,"__pattern-input"),settings:"".concat(pt,"__settings"),settingsFormGroup:"".concat(pt,"__settings-group"),settingsFormGroupHorizontal:"".concat(pt,"__settings-group-horizontal"),previewCoordinate:"".concat(pt,"__preview-coordinate")},vt={settingsButton:!0,inputButton:!0,captureButton:!0,expandButton:!0};let gt=class extends c.Z{constructor(t,e){super(t,e),this._popupMessage=null,this._popupTimeoutId=void 0,this._clipboardPopupTimeoutId=void 0,this._coordinateInput=null,this._badInput=!1,this._goToEnabled=!1,this._conversionFormat=null,this._settingsFormat=null,this._previewConversion=null,this._expanded=!1,this._clipboardPopupVisible=!1,this._popupVisible=!1,this._settingsVisible=!1,this._inputVisible=!1,this.headingLevel=4,this.messages=null,this.messagesCommon=null,this.orientation="auto",this.viewModel=new nt,this.visibleElements={...vt}}loadDependencies(){return(0,ot.h)({button:()=>Promise.all([i.e(92358),i.e(46895),i.e(54438),i.e(14105),i.e(32275)]).then(i.bind(i,32275)),checkbox:()=>Promise.all([i.e(92358),i.e(54438),i.e(12424)]).then(i.bind(i,12424)),input:()=>Promise.all([i.e(92358),i.e(46895),i.e(54438),i.e(8715),i.e(16746)]).then(i.bind(i,75655)),label:()=>Promise.all([i.e(92358),i.e(35738)]).then(i.bind(i,35738)),option:()=>i.e(19790).then(i.bind(i,19790)),select:()=>Promise.all([i.e(92358),i.e(54438),i.e(26369)]).then(i.bind(i,26369))})}get conversions(){return this.viewModel.conversions}set conversions(t){this.viewModel.conversions=t}get currentLocation(){return this.viewModel.currentLocation}set currentLocation(t){this.viewModel.currentLocation=t}get formats(){return this.viewModel.formats}set formats(t){this.viewModel.formats=t}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(t){this.viewModel.goToOverride=t}get icon(){return"coordinate-system"}set icon(t){this._overrideIfSome("icon",t)}get label(){var t,e;return null!==(t=null===(e=this.messages)||void 0===e?void 0:e.widgetLabel)&&void 0!==t?t:""}set label(t){this._overrideIfSome("label",t)}get mode(){return this.viewModel.mode}set mode(t){this.viewModel.mode=t}set multipleConversions(t){!1===t&&(this._expanded=!1,this.conversions.splice(1,this.conversions.length-1)),this._set("multipleConversions",t)}get multipleConversions(){const t=this._get("multipleConversions");return"boolean"!=typeof t||t}get locationSymbol(){return this.viewModel.locationSymbol}set locationSymbol(t){this.viewModel.locationSymbol=t}get storageEnabled(){return this.viewModel.storageEnabled}set storageEnabled(t){this.viewModel.storageEnabled=t}get storageType(){return this.viewModel.storageType}set storageType(t){this.viewModel.storageType=t}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}castVisibleElements(t){return{...vt,...t}}reverseConvert(t,e){return this.viewModel.reverseConvert(t,e)}render(){var t,e;const i=null===(t=this.viewModel)||void 0===t?void 0:t.state,n="disabled"===i?(0,dt.u)("div",{key:"esri-coordinate__no-basemap"},null===(e=this.messages)||void 0===e?void 0:e.noBasemap):null,o=!n&&this._inputVisible?this._renderInputForm():null,s=!n&&this._settingsVisible?this._renderSettings():null,r=n||o||s?null:this._renderConversionsView(),a=this._popupVisible?this._renderPopup():null,l={[ht.captureMode]:"capture"===this.mode,[st.z.disabled]:"loading"===i,[ht.noBasemap]:"disabled"===i};return(0,dt.u)("div",{class:this.classes(ht.base,st.z.widget,l)},a,n,r,s,o)}_addConversion(t){const e=t.target,i=e.selectedOption.value,n=mt(e);if(null==i||null==n)return;const o=new C({format:i});e.value="default",n>=0?(this.conversions.removeAt(n),this.conversions.add(o,n)):this.conversions.add(o)}_findSettingsFormat(){return this._settingsFormat||this.conversions.reduceRight(((t,e)=>{const i=e.format;return null!==i&&void 0!==i&&i.hasDisplayProperties?i:t}),null)||this.formats.find((t=>t.hasDisplayProperties))}_hidePopup(){this._popupTimeoutId&&(clearTimeout(this._popupTimeoutId),this._popupTimeoutId=void 0),this._popupVisible=!1,this._popupMessage=null,this.scheduleRender()}_hideClipboardPopup(){this._clipboardPopupTimeoutId&&(clearTimeout(this._clipboardPopupTimeoutId),this._clipboardPopupTimeoutId=void 0),this._clipboardPopupVisible=!1,this.scheduleRender()}_onConvertComplete(){this._inputVisible=!1,this._coordinateInput.value=""}_onCopy(t){var e,i;const n=null===(e=function(t){return t["data-conversion"]}(t.currentTarget))||void 0===e?void 0:e.displayCoordinate;null!=n&&(null!==(i=t.clipboardData)&&void 0!==i&&i.setData("text/plain",n),this._showClipboardPopup(),t.preventDefault())}_processUserInput(t){const e=(0,s.aF)(t,"key"),i=this.viewModel;if("Enter"!==e&&e)this._badInput&&(this._badInput=!1);else{const t=this._conversionFormat||this.conversions.at(0).format;if(!t)return;const e=this._coordinateInput.value;this._reverseConvert(e,t).then((t=>{"capture"===this.mode?i.resume():this.mode="capture",this.currentLocation=t,i.setLocation(t),this._onConvertComplete()})).catch((t=>{var e;o.Z.getLogger(this).error(t),this._showPopup(null===(e=this.messages)||void 0===e?void 0:e.invalidCoordinate),this._badInput=!0}))}}async _reverseConvert(t,e){const i=this.viewModel,n=await e.reverseConvert(t);return this._goToEnabled&&n&&i.goToLocation(n).catch((t=>{var e;o.Z.getLogger(this).warn(t),this._showPopup(null===(e=this.messages)||void 0===e?void 0:e.locationOffBasemap)})),n}_setInputFormat(t){const e=t.target.selectedOption.value;null!=e&&(this._conversionFormat=e)}_setPreviewConversion(){const t=this._findSettingsFormat(),e=this.viewModel;if(t){var i,n;const o=this.conversions.find((e=>e.format===t));this._previewConversion=new C({format:t,position:{location:this.currentLocation,coordinate:null===o||void 0===o||null===(i=o.position)||void 0===i?void 0:i.coordinate}}),(null===(n=this._previewConversion.position)||void 0===n?void 0:n.coordinate)||e.previewConversion(this._previewConversion)}}_setSettingsFormat(t){const e=t.target.selectedOption.value;null!=e&&(this._settingsFormat=e,this._setPreviewConversion())}_showClipboardPopup(){this._clipboardPopupVisible?clearTimeout(this._clipboardPopupTimeoutId):this._clipboardPopupVisible=!0,this.scheduleRender(),this._popupTimeoutId=setTimeout((()=>{this._popupTimeoutId=void 0,this._hideClipboardPopup()}),750)}_showPopup(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2500;this._popupMessage=t,this._popupVisible?clearTimeout(this._popupTimeoutId):this._popupVisible=!0,this.scheduleRender(),this._popupTimeoutId=setTimeout((()=>{this._popupTimeoutId=void 0,this._hidePopup()}),e)}_toggleGoTo(){this._goToEnabled=!this._goToEnabled}_updateCurrentPattern(t){t.stopPropagation();const e=t.target,i=this._findSettingsFormat();i&&(i.currentPattern=e.value)}_renderConversion(t,e){var i;const{messages:n}=this;if(!n)return(0,dt.u)("li",null);const{format:o}=t,s=null!==(i=null===o||void 0===o?void 0:o.label)&&void 0!==i?i:"",r="".concat(this.id,"__list-item-").concat(e),a="".concat(s," ").concat(n.conversionOutputSuffix),l=0===e,c=l||this._expanded,d=l?this._renderFirstConversion(t):this._renderTools(e,t,r),u=l&&!t.displayCoordinate?n.noLocation:t.displayCoordinate,p=(0,dt.u)("div",{"aria-label":u,class:ht.coordDisplay,"data-conversion":t,role:"listitem",tabIndex:0,title:null!==u&&void 0!==u?u:""},u),h=this._renderOptions(this.formats.filter((t=>t!==o)));return c?(0,dt.u)("li",{"aria-label":a,class:ht.conversionRow,id:r,key:t,role:"group",tabIndex:0,title:a},(0,dt.u)("calcite-select",{"aria-controls":r,bind:this,class:ht.rowSelect,"data-index":e,label:n.selectFormat,scale:"s",onCalciteSelectChange:this._addConversion},(0,dt.u)("calcite-option",{label:s.toUpperCase(),selected:!0},s.toUpperCase()),h),p,d):null}_renderCopyButton(t){const e=this._clipboardPopupVisible&&this._renderClipboardPopup(),{messagesCommon:i}=this;return i?(0,dt.u)("li",{"aria-label":i.copy,bind:this,class:this.classes(st.z.widgetButton,ht.rowButton),"data-conversion":t,onclick:this._copyCoordinateOutput,oncopy:this._onCopy,onkeydown:this._copyCoordinateOutput,role:"button",tabIndex:0,title:i.copy},e,(0,dt.u)("span",{"aria-hidden":"true",class:at.W.duplicate})):(0,dt.u)("li",null)}_renderFirstConversion(t){const e=this.id,{messages:i,messagesCommon:n,multipleConversions:o,visibleElements:s}=this;if(!n||!i)return(0,dt.u)("ul",null);const r="live"===this.mode?i.captureMode:i.liveMode,a=this._expanded?n.collapse:n.expand,l=t.displayCoordinate&&"capture"===this.mode?this._renderCopyButton(t):null,c=o&&s.expandButton&&this._renderIconButton({iconType:this._expanded?"chevron-down":"chevron-up",clickFunction:this._toggleExpand,classes:[ht.expandButton],attributes:{"aria-controls":"".concat(e,"__").concat(ht.conversionList),label:a}}),d=!o&&s.captureButton&&this._renderIconButton({iconType:"live"===this.mode?"pin-tear":"pin-tear-f",clickFunction:this._toggleMode,classes:[ht.modeToggle],attributes:{label:r}});return(0,dt.u)("ul",{class:ht.toolDisplay},l,c,d)}_renderInputForm(){const t=this._conversionFormat||this.conversions.at(0).format,e=this.formats.findIndex((e=>e.name===(null===t||void 0===t?void 0:t.name))),i=this.id,n="".concat(i,"__").concat(ht.coordinateInput),o="".concat(i,"__").concat(ht.coordinateInput,"__header"),s=this._renderOptions(this.formats,!0,e),{messages:r,messagesCommon:a,headingLevel:l}=this;if(!a||!r)return(0,dt.u)("div",null);const c=this._renderIconButton({iconType:(0,ut.dZ)(this.container)?"arrow-right":"arrow-left",clickFunction:this._toggleInputVisibility,attributes:{label:a.back}});return(0,dt.u)("div",{"aria-labelledby":o,class:ht.inputForm,key:"esri-coordinate-conversion__input-form",role:"search"},(0,dt.u)("div",{class:ht.sectionHeading},c,(0,dt.u)(rt.X,{class:st.z.heading,id:o,level:l},r.inputCoordTitle)),(0,dt.u)("div",{class:ht.inputFormGroup},(0,dt.u)("calcite-select",{"aria-controls":n,bind:this,class:ht.inputSelect,label:r.selectFormat,scale:"s",onCalciteSelectChange:this._setInputFormat},s),(0,dt.u)("calcite-input",{afterCreate:ut.Yo,"aria-labelledby":o,bind:this,class:ht.coordinateInput,"data-format":t,"data-node-ref":"_coordinateInput",id:n,onkeydown:this._processUserInput,placeholder:r.inputCoordTitle,required:!0,scale:"s",spellcheck:!1,status:this._badInput?"invalid":"idle"})),(0,dt.u)("div",{class:ht.inputFormGroup},(0,dt.u)("calcite-label",{layout:"inline",scale:"s"},(0,dt.u)("calcite-checkbox",{bind:this,checked:this._goToEnabled,onCalciteCheckboxChange:this._toggleGoTo}),r.goTo),(0,dt.u)("calcite-button",{appearance:"outline",bind:this,kind:"neutral",onclick:this._processUserInput,type:"button",width:"auto"},r.convert)))}_renderConversionsView(){const{messages:t}=this;if(!t)return(0,dt.u)("div",null);const e="".concat(this.id,"__").concat(ht.conversionList),i=this._renderPrimaryTools(),n=this._renderOptions(this.formats),o=this.conversions.map(((t,e)=>this._renderConversion(t,e))).toArray(),s=this._expanded?(0,dt.u)("div",{class:ht.conversionRow},(0,dt.u)("calcite-select",{"aria-controls":e,bind:this,"data-index":-1,label:t.addConversion,scale:"s",onCalciteSelectChange:this._addConversion},(0,dt.u)("calcite-option",{disabled:!0,selected:!0,value:"default"},t.addConversion),n),i):null,r={[ht.expanded]:this._expanded,[ht.expandUp]:"expand-up"===this.orientation,[ht.expandDown]:"expand-down"===this.orientation};return(0,dt.u)("div",{class:this.classes(ht.conversionsView,r),key:"esri-coordinate-conversion__main-view"},(0,dt.u)("ul",{"aria-expanded":this._expanded?"true":"false",class:ht.conversionList,id:e},o),s)}_renderOptions(t,e,i){var n;const o=this.conversions.at(0),s=null===(n=o.format)||void 0===n?void 0:n.name;return t.map(((t,n)=>{var r;const a=!(e||!o)&&(s===t.name||this.conversions.map((t=>{var e;return null===(e=t.format)||void 0===e?void 0:e.name})).includes(t.name));return(0,dt.u)("calcite-option",{disabled:a,key:null!==(r=t.name)&&void 0!==r?r:"unnamed-format",label:t.label.toUpperCase(),selected:n===i,value:t},t.label)})).toArray()}_renderPopup(){return(0,dt.u)("div",{class:ht.popup,role:"alert"},this._popupMessage)}_renderClipboardPopup(){const{messages:t}=this;return t?(0,dt.u)("div",{class:this.classes(ht.popup,ht.clipboardPopup),role:"alert"},t.copySuccessMessage):(0,dt.u)("div",null)}_renderPrimaryTools(){const{messages:t,visibleElements:e}=this;if(!t)return(0,dt.u)("ul",null);const i="live"===this.mode?t.captureMode:t.liveMode,n=e.inputButton&&this._renderIconButton({iconType:"pencil",clickFunction:this._toggleInputVisibility,attributes:{label:t.inputCoordTitle}}),o=e.captureButton&&this._renderIconButton({iconType:"live"===this.mode?"pin-tear":"pin-tear-f",clickFunction:this._toggleMode,classes:[ht.modeToggle],attributes:{label:i}}),s=e.settingsButton&&this._renderIconButton({iconType:"gear",clickFunction:this._toggleSettingsVisibility,attributes:{label:t.settingsTitle}});return(0,dt.u)("ul",{class:ht.toolDisplay},n,o,s)}_renderSettings(){var t;const e=this.id,i="".concat(e,"__").concat(ht.patternInput),n="".concat(e,"__").concat(ht.patternInput,"__header"),o="".concat(e,"__").concat(ht.previewCoordinate),s=this.formats.filter((t=>t.hasDisplayProperties)),r=this._findSettingsFormat(),a=r?s.indexOf(r):-1,l=this._renderOptions(s,!0,a),c=null===r||void 0===r?void 0:r.currentPattern,{messages:d,messagesCommon:u,headingLevel:p}=this;if(!u||!d)return(0,dt.u)("div",null);const h=this._renderIconButton({iconType:(0,ut.dZ)(this.container)?"arrow-right":"arrow-left",clickFunction:this._toggleSettingsVisibility,attributes:{label:u.back}}),v=this._renderIconButton({iconType:"refresh",clickFunction:this._setDefaultPattern,attributes:{label:d.defaultPattern}});return(0,dt.u)("div",{"aria-labelledby":n,class:ht.settings,key:ht.settings},(0,dt.u)("div",{class:ht.sectionHeading},h,(0,dt.u)(rt.X,{class:st.z.heading,id:n,level:p},d.settingsTitle)),(0,dt.u)("div",{class:ht.settingsFormGroup},(0,dt.u)("label",{for:i},d.changeCoordinateDisplay),(0,dt.u)("calcite-select",{bind:this,label:d.selectFormat,width:"full",onCalciteSelectChange:this._setSettingsFormat},l),(0,dt.u)("div",{class:ht.settingsFormGroupHorizontal},(0,dt.u)("calcite-input",{"aria-controls":o,bind:this,class:ht.patternInput,id:i,spellcheck:!1,type:"text",value:c,onCalciteInputInput:this._updateCurrentPattern}),v)),(0,dt.u)("div",{class:ht.settingsFormGroup},(0,dt.u)("label",null,u.preview,(0,dt.u)("div",{class:ht.previewCoordinate,id:o,tabIndex:0},null===(t=this._previewConversion)||void 0===t?void 0:t.displayCoordinate))))}_renderIconButton(t){const{iconType:e,clickFunction:i,classes:n,attributes:o}=t;return(0,dt.u)("calcite-button",{appearance:"transparent",bind:this,class:this.classes(n),iconStart:e,kind:"neutral",onclick:i,onkeydown:i,...o})}_renderTools(t,e,i){const n=e.displayCoordinate&&"capture"===this.mode?this._renderCopyButton(e):null,{messages:o}=this;if(!o)return(0,dt.u)("ul",null);const s=this._renderIconButton({iconType:"x",clickFunction:this._removeConversion,attributes:{"aria-controls":i,label:o.removeConversion,"data-index":t}});return(0,dt.u)("ul",{class:ht.toolDisplay,role:"listitem"},n,(0,dt.u)("li",{class:this.classes(ht.rowButton)},s))}_copyCoordinateOutput(t){const e=t.target;if(!("createTextRange"in document.body)){const t=window.getSelection(),i=document.createRange();i.selectNodeContents(e),null!==t&&void 0!==t&&t.removeAllRanges(),null===t||void 0===t||t.addRange(i)}document.execCommand("copy")}_removeConversion(t){const e=mt(t.currentTarget);null!=e&&this.conversions.removeAt(e)}_setDefaultPattern(t){t.stopPropagation();const e=this._findSettingsFormat();e&&(e.currentPattern=e.defaultPattern)}_toggleExpand(){this._expanded=!this._expanded}_toggleInputVisibility(){this._inputVisible=!this._inputVisible,this._popupVisible&&this._hidePopup(),this._inputVisible?this.viewModel.pause():this.viewModel.resume()}_toggleMode(){this.mode="live"===this.mode?"capture":"live"}_toggleSettingsVisibility(){this._settingsVisible=!this._settingsVisible,this._popupVisible&&this._hidePopup(),this._settingsVisible?(this._setPreviewConversion(),this.viewModel.pause()):this.viewModel.resume()}};(0,n._)([(0,r.Cb)()],gt.prototype,"conversions",null),(0,n._)([(0,r.Cb)()],gt.prototype,"currentLocation",null),(0,n._)([(0,r.Cb)()],gt.prototype,"formats",null),(0,n._)([(0,r.Cb)()],gt.prototype,"goToOverride",null),(0,n._)([(0,r.Cb)()],gt.prototype,"headingLevel",void 0),(0,n._)([(0,r.Cb)()],gt.prototype,"icon",null),(0,n._)([(0,r.Cb)()],gt.prototype,"label",null),(0,n._)([(0,r.Cb)(),(0,ct.H)("esri/widgets/CoordinateConversion/t9n/CoordinateConversion")],gt.prototype,"messages",void 0),(0,n._)([(0,r.Cb)(),(0,ct.H)("esri/t9n/common")],gt.prototype,"messagesCommon",void 0),(0,n._)([(0,r.Cb)()],gt.prototype,"mode",null),(0,n._)([(0,r.Cb)()],gt.prototype,"orientation",void 0),(0,n._)([(0,r.Cb)()],gt.prototype,"multipleConversions",null),(0,n._)([(0,r.Cb)()],gt.prototype,"locationSymbol",null),(0,n._)([(0,r.Cb)()],gt.prototype,"storageEnabled",null),(0,n._)([(0,r.Cb)()],gt.prototype,"storageType",null),(0,n._)([(0,r.Cb)()],gt.prototype,"view",null),(0,n._)([(0,r.Cb)({type:nt})],gt.prototype,"viewModel",void 0),(0,n._)([(0,r.Cb)()],gt.prototype,"visibleElements",void 0),(0,n._)([(0,a.p)("visibleElements")],gt.prototype,"castVisibleElements",null),(0,n._)([(0,lt.h)()],gt.prototype,"_copyCoordinateOutput",null),(0,n._)([(0,lt.h)()],gt.prototype,"_removeConversion",null),(0,n._)([(0,lt.h)()],gt.prototype,"_setDefaultPattern",null),(0,n._)([(0,lt.h)()],gt.prototype,"_toggleExpand",null),(0,n._)([(0,lt.h)()],gt.prototype,"_toggleInputVisibility",null),(0,n._)([(0,lt.h)()],gt.prototype,"_toggleMode",null),(0,n._)([(0,lt.h)()],gt.prototype,"_toggleSettingsVisibility",null),gt=(0,n._)([(0,l.j)("esri.widgets.CoordinateConversion")],gt);const _t=gt;function mt(t){return t["data-index"]}}}]);
//# sourceMappingURL=45337.0c339e07.chunk.js.map