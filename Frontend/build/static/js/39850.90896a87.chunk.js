"use strict";(self.webpackChunknorthwind=self.webpackChunknorthwind||[]).push([[39850,77671,55785],{97942:(e,t,i)=>{function n(e){let t,i,n=[],s=!1;return function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return s&&t===this&&function(e,t){if(e.length!==t.length)return!1;for(let i=0;i<e.length;++i)if(e[i]!==t[i])return!1;return!0}(o,n)||(i=e.apply(this,o),t=this,n=o,s=!0),i}}i.d(t,{H:()=>n})},14916:(e,t,i)=>{function n(e,t,i,n){let s=null,r=1e3;"number"==typeof t?(r=t,n=i):(s=null!==t&&void 0!==t?t:null,r=i);let o,a=0;const l=()=>{a=0,e.apply(n,o)},c=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];s&&s.apply(n,t),o=t,r?a||(a=setTimeout(l,r)):l()};return c.remove=()=>{a&&(clearTimeout(a),a=0)},c.forceUpdate=()=>{a&&(clearTimeout(a),l())},c.hasPendingUpdates=()=>!!a,c}i.d(t,{P:()=>n})},5163:(e,t,i)=>{i.d(t,{L4:()=>T,LO:()=>d,Qv:()=>u,Rd:()=>p,Ud:()=>m,VG:()=>h,Wv:()=>v,Zv:()=>E,_o:()=>I,aC:()=>b,h9:()=>g,ld:()=>C,mg:()=>_,q6:()=>f,sS:()=>P,yc:()=>y});var n=i(70116),s=i(17768),r=i(16889),o=i(47898),a=i(643),l=i(68860),c=i(6291);function u(e,t,i){return e.units[t][i]}function h(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";return"".concat((0,c.uf)(t,{minimumFractionDigits:n,maximumFractionDigits:n,signDisplay:t>0?"never":"exceptZero"})," ").concat(u(e,i,s))}function d(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";return"".concat((0,c.uf)(t,{minimumFractionDigits:n,maximumFractionDigits:n,signDisplay:"exceptZero"})," ").concat(u(e,i,s))}function p(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const r=(0,l.Y8)(t,i);return h(e,(0,l.En)(t,i,r),r,n,s)}function _(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const r=(0,l.Y8)(t,i);return d(e,(0,l.En)(t,i,r),r,n,s)}function v(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const r=(0,l.Dw)(t,i);return h(e,(0,l.En)(t,i,r),r,n,s)}function g(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const r=(0,l.Dw)(t,i);return d(e,(0,l.En)(t,i,r),r,n,s)}function m(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const r=(0,l.Q7)(t,i);return h(e,(0,l.En)(t,i,r),r,n,s)}function f(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const r=(0,l.Q7)(t,i);return d(e,(0,l.En)(t,i,r),r,n,s)}function E(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const r=(0,l.jl)(t,i);return h(e,(0,l.En)(t,i,r),r,n,s)}function b(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const r=(0,l.jl)(t,i);return d(e,(0,l.En)(t,i,r),r,n,s)}function C(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const r=(0,l.ZI)(t,i);return h(e,(0,l.En)(t,i,r),r,n,s)}function y(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const r=(0,l.LV)(t,i);return h(e,(0,l.En)(t,i,r),r,n,s)}const S=(e,t)=>({style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:t,minimumFractionDigits:t,signDisplay:e>0?"never":"exceptZero"});function T(e,t,i,n,r){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:s.BV,u=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],h=a.normalize((0,o.hw)((0,l.En)(e,t,"degrees"),i,n),0,u);const d=S(h,null!==r&&void 0!==r?r:2);return h=R(h,d),(0,c.uf)(h,d)}function I(e,t,i,n,s){var r;i!==n&&(e=-e);const o={style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:s=null!==(r=s)&&void 0!==r?r:2,minimumFractionDigits:s,signDisplay:"exceptZero"};let a=(0,l.En)(e,t,"degrees")%360;return a=R(a,o),(0,c.uf)(a,o)}const O=new Map;function R(e,t){const i=JSON.stringify(t);let n=O.get(i);return n||(n=new Intl.NumberFormat("en-US",t),O.set(i,n)),/^[-+]?360\.?0*\xb0?$/.test(n.format(e))?0:e}const w=["B","kB","MB","GB","TB"];function P(e,t){let i=0===(t=Math.round(t))?0:Math.floor(Math.log(t)/Math.log(n.Y.KILOBYTES));i=(0,r.uZ)(i,0,w.length-1);const s=(0,c.uf)(t/n.Y.KILOBYTES**i,{maximumFractionDigits:2});return(0,a.gx)(e.units.bytes[w[i]],{fileSize:s})}},41388:(e,t,i)=>{i.d(t,{b:()=>o});var n=i(66978),s=i(76432),r=i(73553);class o{constructor(){this._tasks=new Array,this._runningTasks=(0,s.t)(0)}get length(){return this._tasks.length}get running(){return this._runningTasks.value>0}destroy(){this.cancelAll()}runTask(e){if(0===this.length)return r.J;for(;!e.done&&this._process(e);)e.madeProgress()}push(e,t,i){return++this._runningTasks.value,new Promise(((n,s)=>this._tasks.push(new a(n,s,e,t,i)))).finally((()=>--this._runningTasks.value))}unshift(e,t,i){return++this._runningTasks.value,new Promise(((n,s)=>this._tasks.unshift(new a(n,s,e,t,i)))).finally((()=>--this._runningTasks.value))}_process(e){if(0===this._tasks.length)return!1;const t=this._tasks.shift();try{const s=(0,n.Hc)(t.signal);if(s&&!t.abortCallback)t.reject((0,n.zE)());else{var i;const r=s?null===(i=t.abortCallback)||void 0===i?void 0:i.call(t,(0,n.zE)()):t.callback(e);(0,n.y8)(r)?r.then(t.resolve,t.reject):t.resolve(r)}}catch(o){t.reject(o)}return!0}cancelAll(){const e=(0,n.zE)();for(const t of this._tasks)if(t.abortCallback){const i=t.abortCallback(e);t.resolve(i)}else t.reject(e);this._tasks.length=0}}class a{constructor(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0;this.resolve=e,this.reject=t,this.callback=i,this.signal=n,this.abortCallback=s}}},77671:(e,t,i)=>{i.d(t,{Y:()=>s});var n=i(74177);const s={readOnly:!0,get(){return(0,n.R)(this.view)}}},74177:(e,t,i)=>{i.d(t,{R:()=>r});var n=i(68860),s=i(7575);function r(e){var t,i,r,o,a;const l="metric";if(null==e)return l;const c=e.map,u=null!==(t=c&&"portalItem"in c?null===(i=c.portalItem)||void 0===i?void 0:i.portal:null)&&void 0!==t?t:s.Z.getDefault();switch(null!==(r=null===(o=u.user)||void 0===o?void 0:o.units)&&void 0!==r?r:u.units){case l:return l;case"english":return"imperial"}return null!==(a=(0,n.yT)(e.spatialReference))&&void 0!==a?a:l}},94463:(e,t,i)=>{i.d(t,{h:()=>l});var n=i(27366),s=i(7138),r=i(49861),o=(i(93169),i(32718),i(84936),i(69912));let a=class extends s.default{constructor(){super(...arguments),this.SCENEVIEW_HITTEST_RETURN_INTERSECTOR=!1,this.DECONFLICTOR_SHOW_VISIBLE=!1,this.DECONFLICTOR_SHOW_INVISIBLE=!1,this.DECONFLICTOR_SHOW_GRID=!1,this.LABELS_SHOW_BORDER=!1,this.TEXT_SHOW_BASELINE=!1,this.TEXT_SHOW_BORDER=!1,this.OVERLAY_DRAW_DEBUG_TEXTURE=!1,this.OVERLAY_SHOW_CENTER=!1,this.SHOW_POI=!1,this.TESTS_DISABLE_OPTIMIZATIONS=!1,this.TESTS_DISABLE_FAST_UPDATES=!1,this.DRAW_MESH_GEOMETRY_NORMALS=!1,this.FEATURE_TILE_FETCH_SHOW_TILES=!1,this.FEATURE_TILE_TREE_SHOW_TILES=!1,this.TERRAIN_TILE_TREE_SHOW_TILES=!1,this.I3S_TREE_SHOW_TILES=!1,this.I3S_SHOW_MODIFICATIONS=!1,this.LOD_INSTANCE_RENDERER_DISABLE_UPDATES=!1,this.LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL=!1,this.EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES=!1,this.LINE_WIREFRAMES=!1}};(0,n._)([(0,r.Cb)()],a.prototype,"SCENEVIEW_HITTEST_RETURN_INTERSECTOR",void 0),(0,n._)([(0,r.Cb)()],a.prototype,"DECONFLICTOR_SHOW_VISIBLE",void 0),(0,n._)([(0,r.Cb)()],a.prototype,"DECONFLICTOR_SHOW_INVISIBLE",void 0),(0,n._)([(0,r.Cb)()],a.prototype,"DECONFLICTOR_SHOW_GRID",void 0),(0,n._)([(0,r.Cb)()],a.prototype,"LABELS_SHOW_BORDER",void 0),(0,n._)([(0,r.Cb)()],a.prototype,"TEXT_SHOW_BASELINE",void 0),(0,n._)([(0,r.Cb)()],a.prototype,"TEXT_SHOW_BORDER",void 0),(0,n._)([(0,r.Cb)()],a.prototype,"OVERLAY_DRAW_DEBUG_TEXTURE",void 0),(0,n._)([(0,r.Cb)()],a.prototype,"OVERLAY_SHOW_CENTER",void 0),(0,n._)([(0,r.Cb)()],a.prototype,"SHOW_POI",void 0),(0,n._)([(0,r.Cb)()],a.prototype,"TESTS_DISABLE_OPTIMIZATIONS",void 0),(0,n._)([(0,r.Cb)()],a.prototype,"TESTS_DISABLE_FAST_UPDATES",void 0),(0,n._)([(0,r.Cb)()],a.prototype,"DRAW_MESH_GEOMETRY_NORMALS",void 0),(0,n._)([(0,r.Cb)()],a.prototype,"FEATURE_TILE_FETCH_SHOW_TILES",void 0),(0,n._)([(0,r.Cb)()],a.prototype,"FEATURE_TILE_TREE_SHOW_TILES",void 0),(0,n._)([(0,r.Cb)()],a.prototype,"TERRAIN_TILE_TREE_SHOW_TILES",void 0),(0,n._)([(0,r.Cb)()],a.prototype,"I3S_TREE_SHOW_TILES",void 0),(0,n._)([(0,r.Cb)()],a.prototype,"I3S_SHOW_MODIFICATIONS",void 0),(0,n._)([(0,r.Cb)()],a.prototype,"LOD_INSTANCE_RENDERER_DISABLE_UPDATES",void 0),(0,n._)([(0,r.Cb)()],a.prototype,"LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL",void 0),(0,n._)([(0,r.Cb)()],a.prototype,"EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES",void 0),(0,n._)([(0,r.Cb)()],a.prototype,"LINE_WIREFRAMES",void 0),a=(0,n._)([(0,o.j)("esri.views.3d.support.debugFlags")],a);const l=new a},43449:(e,t,i)=>{i.d(t,{T6:()=>a,TX:()=>o,j9:()=>l});var n=i(54463),s=i(55848),r=i(22178);function o(e){return(0,r.nn)(e)&&e.intersector===n.q7.TERRAIN&&!!e.target}class a extends s.Dx{constructor(e,t,i){super(e,t),this.triangleNr=i}}function l(e){return(0,r.nn)(e)&&e.intersector===n.q7.OVERLAY&&!!e.target}},98634:(e,t,i)=>{i.d(t,{H:()=>s,K:()=>n});const n=class{};function s(e){let t="";for(let i=0;i<(arguments.length<=1?0:arguments.length-1);i++)t+=e[i]+(i+1<1||arguments.length<=i+1?void 0:arguments[i+1]);return t+=e[e.length-1],t}!function(e){e.int=function(e){return Math.round(e).toString()},e.float=function(e){return e.toPrecision(8)}}(s||(s={}))},96856:(e,t,i)=>{i.d(t,{a:()=>r,d:()=>s});var n=i(38499);class s{constructor(){this.enabled=!0,this._time=(0,n.HA)(0)}get time(){return this._time}advance(e){let{deltaTime:t,fixedTime:i}=e;return null!=i?this._time!==i&&(this._time=i,!0):(this._time=(0,n.HA)(this._time+t),0!==t)}}class r{constructor(e,t){this.deltaTime=e,this.fixedTime=t}}},1395:(e,t,i)=>{i.d(t,{c:()=>s});var n=i(95439);class s{constructor(){this.id=(0,n.D)()}}},79100:(e,t,i)=>{var n;i.d(t,{U:()=>n}),function(e){e[e.Layer=0]="Layer",e[e.Object=1]="Object",e[e.Mesh=2]="Mesh",e[e.Line=3]="Line",e[e.Point=4]="Point",e[e.Material=5]="Material",e[e.Texture=6]="Texture",e[e.COUNT=7]="COUNT"}(n||(n={}))},7566:(e,t,i)=>{i.d(t,{i:()=>s});var n=i(4760);const s=new Map([[n.T.POSITION,0],[n.T.NORMAL,1],[n.T.NORMALCOMPRESSED,1],[n.T.UV0,2],[n.T.COLOR,3],[n.T.COLORFEATUREATTRIBUTE,3],[n.T.SIZE,4],[n.T.TANGENT,4],[n.T.CENTEROFFSETANDDISTANCE,5],[n.T.SYMBOLCOLOR,5],[n.T.FEATUREATTRIBUTE,6],[n.T.INSTANCEFEATUREATTRIBUTE,6],[n.T.INSTANCECOLOR,7],[n.T.OBJECTANDLAYERIDCOLOR,7],[n.T.INSTANCEOBJECTANDLAYERIDCOLOR,7],[n.T.INSTANCEMODEL,8],[n.T.INSTANCEMODELNORMAL,12],[n.T.INSTANCEMODELORIGINHI,11],[n.T.INSTANCEMODELORIGINLO,15]])},56529:(e,t,i)=>{i.d(t,{F5:()=>p,Mt:()=>v,_o:()=>_,yD:()=>n});var n,s,r=i(12400),o=i(98634),a=i(96856),l=i(68401),c=i(1395),u=i(79100),h=i(7566),d=i(22909);class p extends c.c{constructor(e,t){super(),this.type=u.U.Material,this.supportsEdges=!1,this._visible=!0,this._renderPriority=0,this._vertexAttributeLocations=h.i,this._pp0=(0,r.al)(0,0,1),this._pp1=(0,r.al)(0,0,0),this._parameters=(0,d.Uf)(e,t),this.validateParameters(this._parameters)}get parameters(){return this._parameters}update(e){return!1}setParameters(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];(0,d.LO)(this._parameters,e)&&(this.validateParameters(this._parameters),t&&this.parametersChanged())}validateParameters(e){}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this.parametersChanged())}shouldRender(e){return this.isVisible()&&this.isVisibleForOutput(e.output)&&(!this.parameters.isDecoration||e.bindParameters.decorations===l.Iq.ON)&&!!(this.parameters.renderOccluded&e.renderOccludedMask)}isVisibleForOutput(e){return!0}get renderPriority(){return this._renderPriority}set renderPriority(e){e!==this._renderPriority&&(this._renderPriority=e,this.parametersChanged())}get vertexAttributeLocations(){return this._vertexAttributeLocations}isVisible(){return this._visible}parametersChanged(){var e;null===(e=this.repository)||void 0===e||e.materialChanged(this)}queryRenderOccludedState(e){return this.isVisible()&&this.parameters.renderOccluded===e}intersectDraped(e,t,i,n,s,r){return this._pp0[0]=this._pp1[0]=n[0],this._pp0[1]=this._pp1[1]=n[1],this.intersect(e,t,i,this._pp0,this._pp1,s)}}class _ extends a.a{constructor(e,t,i){super(t,i),this.camera=e}}(s=n||(n={}))[s.None=0]="None",s[s.Occlude=1]="Occlude",s[s.Transparent=2]="Transparent",s[s.OccludeAndTransparent=4]="OccludeAndTransparent",s[s.OccludeAndTransparentStencil=8]="OccludeAndTransparentStencil",s[s.Opaque=16]="Opaque";class v extends o.K{constructor(){super(...arguments),this.renderOccluded=n.Occlude,this.isDecoration=!1}}},4760:(e,t,i)=>{var n;function s(e){return e===n.POSITION}i.d(t,{T:()=>n,j:()=>s}),function(e){e.POSITION="position",e.NORMAL="normal",e.NORMALCOMPRESSED="normalCompressed",e.UV0="uv0",e.COLOR="color",e.SYMBOLCOLOR="symbolColor",e.SIZE="size",e.TANGENT="tangent",e.OFFSET="offset",e.PERSPECTIVEDIVIDE="perspectiveDivide",e.CENTEROFFSETANDDISTANCE="centerOffsetAndDistance",e.LENGTH="length",e.PREVPOSITION="prevPosition",e.NEXTPOSITION="nextPosition",e.SUBDIVISIONFACTOR="subdivisionFactor",e.COLORFEATUREATTRIBUTE="colorFeatureAttribute",e.SIZEFEATUREATTRIBUTE="sizeFeatureAttribute",e.OPACITYFEATUREATTRIBUTE="opacityFeatureAttribute",e.DISTANCETOSTART="distanceToStart",e.UVMAPSPACE="uvMapSpace",e.BOUNDINGRECT="boundingRect",e.UVREGION="uvRegion",e.PROFILERIGHT="profileRight",e.PROFILEUP="profileUp",e.PROFILEVERTEXANDNORMAL="profileVertexAndNormal",e.FEATUREVALUE="featureValue",e.INSTANCEMODELORIGINHI="instanceModelOriginHi",e.INSTANCEMODELORIGINLO="instanceModelOriginLo",e.INSTANCEMODEL="instanceModel",e.INSTANCEMODELNORMAL="instanceModelNormal",e.INSTANCECOLOR="instanceColor",e.INSTANCEFEATUREATTRIBUTE="instanceFeatureAttribute",e.LOCALTRANSFORM="localTransform",e.GLOBALTRANSFORM="globalTransform",e.BOUNDINGSPHERE="boundingSphere",e.MODELORIGIN="modelOrigin",e.MODELSCALEFACTORS="modelScaleFactors",e.FEATUREATTRIBUTE="featureAttribute",e.STATE="state",e.LODLEVEL="lodLevel",e.POSITION0="position0",e.POSITION1="position1",e.NORMAL2COMPRESSED="normal2Compressed",e.COMPONENTINDEX="componentIndex",e.VARIANTOFFSET="variantOffset",e.VARIANTSTROKE="variantStroke",e.VARIANTEXTENSION="variantExtension",e.SIDENESS="sideness",e.START="start",e.END="end",e.UP="up",e.EXTRUDE="extrude",e.OBJECTANDLAYERIDCOLOR="objectAndLayerIdColor",e.INSTANCEOBJECTANDLAYERIDCOLOR="instanceObjectAndLayerIdColor"}(n||(n={}))},68401:(e,t,i)=>{var n,s,r,o,a,l,c,u,h;i.d(t,{Gv:()=>s,Iq:()=>u,JJ:()=>c,Rw:()=>o,Ti:()=>h,V_:()=>l,Vr:()=>n,Xx:()=>r,hU:()=>a}),function(e){e[e.None=0]="None",e[e.Front=1]="Front",e[e.Back=2]="Back",e[e.COUNT=3]="COUNT"}(n||(n={})),function(e){e[e.Less=0]="Less",e[e.Lequal=1]="Lequal",e[e.COUNT=2]="COUNT"}(s||(s={})),function(e){e[e.BACKGROUND=0]="BACKGROUND",e[e.UPDATE=1]="UPDATE"}(r||(r={})),function(e){e[e.NOT_LOADED=0]="NOT_LOADED",e[e.LOADING=1]="LOADING",e[e.LOADED=2]="LOADED"}(o||(o={})),function(e){e[e.IntegratedMeshMaskExcluded=1]="IntegratedMeshMaskExcluded",e[e.OutlineVisualElementMask=2]="OutlineVisualElementMask"}(a||(a={})),function(e){e[e.Highlight=0]="Highlight",e[e.MaskOccludee=1]="MaskOccludee",e[e.COUNT=2]="COUNT"}(l||(l={})),function(e){e[e.Blend=0]="Blend",e[e.Opaque=1]="Opaque",e[e.Mask=2]="Mask",e[e.MaskBlend=3]="MaskBlend",e[e.COUNT=4]="COUNT"}(c||(c={})),function(e){e[e.OFF=0]="OFF",e[e.ON=1]="ON"}(u||(u={})),function(e){e.DDS_ENCODING="image/vnd-ms.dds",e.KTX2_ENCODING="image/ktx2",e.BASIS_ENCODING="image/x.basis"}(h||(h={}))},22255:(e,t,i)=>{i.d(t,{w:()=>a,x:()=>o});var n=i(54463),s=i(55848),r=i(22178);class o extends s.Dx{constructor(e,t,i,n,s,r){super(e,t),this.layerUid=e,this.graphicUid=t,this.geometryId=i,this.triangleNr=n,this.baseBoundingSphere=s,this.numLodLevels=r}}function a(e){return(0,r.nn)(e)&&e.intersector===n.q7.LOD&&!!e.target}},65216:(e,t,i)=>{i.d(t,{Gw:()=>r,PV:()=>c,TU:()=>u,bA:()=>h,n9:()=>o,sX:()=>l});var n=i(16889),s=i(50951);function r(e,t){return new d(e,p,t)}function o(e,t){const{curvatureDependent:i,scaleStart:n,scaleFallOffRange:s}=p;return new d(e,{curvatureDependent:{min:{curvature:i.min.curvature,tiltAngle:i.min.tiltAngle,scaleFallOffFactor:_.curvatureDependent.min.scaleFallOffFactor},max:{curvature:i.max.curvature,tiltAngle:i.max.tiltAngle,scaleFallOffFactor:_.curvatureDependent.max.scaleFallOffFactor}},scaleStart:n,scaleFallOffRange:s,minPixelSize:_.minPixelSize},t)}function a(e,t,i){const n=i.parameters;return v.scale=Math.min(n.divisor/(t-n.offset),1),v.factor=function(e){return Math.abs(e*e*e)}(e),v}function l(e,t){return(0,n.t7)(e*Math.max(t.scale,t.minScaleFactor),e,t.factor)}function c(e,t,i,n){n.scale=function(e,t,i){const n=a(e,t,i);return n.minScaleFactor=0,l(1,n)}(e,t,i),n.factor=0,n.minScaleFactor=i.minScaleFactor}function u(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0];const n=Math.min(Math.max(t.scale,t.minScaleFactor),1);return i[0]=e[0]*n,i[1]=e[1]*n,i}function h(e,t,i,n){return l(e,a(t,i,n))}class d{get minScaleFactor(){return null!=this._fontHeight?Math.min(this._description.minPixelSize/this._fontHeight,1):0}constructor(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{camera:{distance:0,fovY:0},divisor:0,offset:0},r=arguments.length>4?arguments[4]:void 0;this._viewingMode=e,this._description=t,this._ellipsoidRadius=i,this.parameters=n,this._fontHeight=r,this._viewingMode===s.JY.Local?(this._coverageCompensation=this._surfaceCoverageCompensationLocal,this._calculateCurvatureDependentParameters=this._calculateCurvatureDependentParametersLocal):(this._coverageCompensation=this._surfaceCoverageCompensationGlobal,this._calculateCurvatureDependentParameters=this._calculateCurvatureDependentParametersGlobal)}update(e){return(!this.parameters||this.parameters.camera.fovY!==e.fovY||this.parameters.camera.distance!==e.distance)&&(this._calculateParameters(e,this._ellipsoidRadius,this.parameters),!0)}overrideFontHeight(e){return e!==this._fontHeight?new d(this._viewingMode,this._description,this._ellipsoidRadius,this.parameters,e):this}_calculateParameters(e,t,i){const{scaleStart:n,scaleFallOffRange:s}=this._description,{fovY:r,distance:o}=e,a=this._calculateCurvatureDependentParameters(e,t),l=this._coverageCompensation(e,t,a),{tiltAngle:c,scaleFallOffFactor:u}=a,h=Math.sin(c)*o,d=.5*Math.PI-c-r*(.5-n*l),p=h/Math.cos(d),_=d+r*s*l,v=(p-u*(h/Math.cos(_)))/(1-u);return i.camera.fovY=e.fovY,i.camera.distance=e.distance,i.offset=v,i.divisor=p-v,i}_calculateCurvatureDependentParametersLocal(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:g;return i.tiltAngle=this._description.curvatureDependent.min.tiltAngle,i.scaleFallOffFactor=this._description.curvatureDependent.min.scaleFallOffFactor,i}_calculateCurvatureDependentParametersGlobal(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:g;const s=this._description.curvatureDependent,r=1+e.distance/t,o=Math.sqrt(r*r-1),[a,l]=[s.min.curvature,s.max.curvature],c=(0,n.uZ)((o-a)/(l-a),0,1),[u,h]=[s.min,s.max];return i.tiltAngle=(0,n.t7)(u.tiltAngle,h.tiltAngle,c),i.scaleFallOffFactor=(0,n.t7)(u.scaleFallOffFactor,h.scaleFallOffFactor,c),i}_surfaceCoverageCompensationLocal(e,t,i){return(e.fovY-i.tiltAngle)/e.fovY}_surfaceCoverageCompensationGlobal(e,t,i){const n=t*t,s=i.tiltAngle+.5*Math.PI,{fovY:r,distance:o}=e,a=o*o+n-2*Math.cos(s)*o*t,l=Math.sqrt(a),c=Math.sqrt(a-n);return(Math.acos(c/l)-Math.asin(t/(l/Math.sin(s)))+.5*r)/r}}const p={curvatureDependent:{min:{curvature:(0,n.Vl)(10),tiltAngle:(0,n.Vl)(12),scaleFallOffFactor:.5},max:{curvature:(0,n.Vl)(70),tiltAngle:(0,n.Vl)(40),scaleFallOffFactor:.8}},scaleStart:.3,scaleFallOffRange:.65,minPixelSize:0},_={curvatureDependent:{min:{scaleFallOffFactor:.7},max:{scaleFallOffFactor:.95}},minPixelSize:14};const v={scale:0,factor:0,minScaleFactor:0},g={tiltAngle:0,scaleFallOffFactor:0}},22909:(e,t,i)=>{i.d(t,{FZ:()=>u,Hx:()=>o,LO:()=>l,Uf:()=>a});var n=i(63780),s=i(16889),r=i(65216);function o(e,t,i,n,o){let a=(i.screenLength||0)*e.pixelRatio;null!=o&&(a=(0,r.bA)(a,n,t,o));const l=a*Math.tan(.5*e.fovY)/(.5*e.fullHeight);return(0,s.uZ)(l*t,i.minWorldLength||0,null!=i.maxWorldLength?i.maxWorldLength:1/0)}function a(e,t){const i=t?a(t):{};for(const s in e){var n;let t=e[s];null!==(n=t)&&void 0!==n&&n.forEach&&(t=c(t)),null==t&&s in i||(i[s]=t)}return i}function l(e,t){let i=!1;for(const s in t){const r=t[s];void 0!==r&&(Array.isArray(r)?null===e[s]?(e[s]=r.slice(),i=!0):(0,n.Vx)(e[s],r)&&(i=!0):e[s]!==r&&(i=!0,e[s]=r))}return i}function c(e){const t=[];return e.forEach((e=>t.push(e))),t}const u={multiply:1,ignore:2,replace:3,tint:4}},75248:(e,t,i)=>{var n;i.d(t,{n:()=>n}),function(e){e[e.ANIMATING=0]="ANIMATING",e[e.INTERACTING=1]="INTERACTING",e[e.IDLE=2]="IDLE"}(n||(n={}))},93463:(e,t,i)=>{i.d(t,{G5:()=>w,T8:()=>n,sq:()=>P,z4:()=>f});var n,s,r=i(100),o=(i(93169),i(32718)),a=i(92026),l=i(90941),c=i(27546),u=i(66978),h=i(94172),d=i(76432),p=i(38499),_=i(41388),v=i(32609),g=i(75248),m=i(73553);function f(){return new O.Scheduler}(s=n||(n={})).RESOURCE_CONTROLLER_IMMEDIATE="immediate",s.RESOURCE_CONTROLLER="schedule",s.SLIDE="slide",s.STREAM_DATA_LOADER="stream loader",s.ELEVATION_QUERY="elevation query",s.TERRAIN_SURFACE="terrain",s.SURFACE_GEOMETRY_UPDATES="surface geometry updates",s.LOD_RENDERER="LoD renderer",s.GRAPHICS_CORE="Graphics3D",s.I3S_CONTROLLER="I3S",s.POINT_CLOUD_LAYER="point cloud",s.FEATURE_TILE_FETCHER="feature fetcher",s.OVERLAY="overlay",s.STAGE="stage",s.GRAPHICS_DECONFLICTOR="graphics deconflictor",s.FILTER_VISIBILITY="Graphics3D filter visibility",s.SCALE_VISIBILITY="Graphics3D scale visibility",s.FRUSTUM_VISIBILITY="Graphics3D frustum visibility",s.POINT_OF_INTEREST_FREQUENT="POI frequent",s.POINT_OF_INTEREST_INFREQUENT="POI infrequent",s.LABELER="labeler",s.FEATURE_QUERY_ENGINE="feature query",s.FEATURE_TILE_TREE="feature tile tree",s.FEATURE_TILE_TREE_ACTIVE="fast feature tile tree",s.ELEVATION_ALIGNMENT="elevation alignment",s.ELEVATION_ALIGNMENT_SCENE="elevation alignment scene",s.TEXT_TEXTURE_ATLAS="text texture atlas",s.TEXTURE_UNLOAD="texture unload",s.LINE_OF_SIGHT_TOOL="line of sight tool",s.LINE_OF_SIGHT_TOOL_INTERACTIVE="interactive line of sight tool",s.ELEVATION_PROFILE="elevation profile",s.SNAPPING="snapping",s.SHADOW_ACCUMULATOR="shadow accumulator",s.CLOUDS_GENERATOR="clouds generator",s[s.NONE=0]="NONE",s[s.TEST_PRIO=1]="TEST_PRIO";const E=new Map([[n.RESOURCE_CONTROLLER_IMMEDIATE,0],[n.RESOURCE_CONTROLLER,4],[n.SLIDE,0],[n.STREAM_DATA_LOADER,0],[n.ELEVATION_QUERY,0],[n.TERRAIN_SURFACE,1],[n.SURFACE_GEOMETRY_UPDATES,1],[n.LOD_RENDERER,2],[n.GRAPHICS_CORE,2],[n.I3S_CONTROLLER,2],[n.POINT_CLOUD_LAYER,2],[n.FEATURE_TILE_FETCHER,2],[n.OVERLAY,4],[n.STAGE,4],[n.GRAPHICS_DECONFLICTOR,4],[n.FILTER_VISIBILITY,4],[n.SCALE_VISIBILITY,4],[n.FRUSTUM_VISIBILITY,4],[n.CLOUDS_GENERATOR,4],[n.POINT_OF_INTEREST_FREQUENT,6],[n.POINT_OF_INTEREST_INFREQUENT,30],[n.LABELER,8],[n.FEATURE_QUERY_ENGINE,8],[n.FEATURE_TILE_TREE,16],[n.FEATURE_TILE_TREE_ACTIVE,0],[n.ELEVATION_ALIGNMENT,12],[n.ELEVATION_ALIGNMENT_SCENE,14],[n.TEXT_TEXTURE_ATLAS,12],[n.TEXTURE_UNLOAD,12],[n.LINE_OF_SIGHT_TOOL,16],[n.LINE_OF_SIGHT_TOOL_INTERACTIVE,0],[n.SNAPPING,0],[n.SHADOW_ACCUMULATOR,30]]);function b(e){return E.has(e)?E.get(e):"number"==typeof e?e:1}const C=(0,p.HA)(6.5),y=(0,p.HA)(1),S=(0,p.HA)(30),T=(0,p.HA)(1e3/30),I=(0,p.HA)(100);var O,R;!function(e){e.Scheduler=class{get updating(){return this._updating.value}_updatingChanged(){this._updating.value=this._tasks.some((e=>e.needsUpdate))}constructor(){this._updating=(0,d.t)(!0),this._microTaskQueued=!1,this._frameNumber=0,this.performanceInfo={total:new l.Z("total"),tasks:new Map},this._frameTaskTimes=new Map,this._budget=new i,this._state=g.n.INTERACTING,this._tasks=new c.Z,this._runQueue=new c.Z,this._load=0,this._idleStateCallbacks=new c.Z,this._idleUpdatesStartFired=!1,this._forceTask=!1,this._debug=!1,this._debugHandle=(0,h.watch)((()=>v.Z.SCHEDULER_LOG_SLOW_TASKS),(e=>this._debug=e),h.initial);for(const e of Object.keys(n))this.performanceInfo.tasks.set(n[e],new l.Z(n[e]))}destroy(){this._tasks.toArray().forEach((e=>e.remove())),this._tasks.clear(),(0,a.hw)(this._debugHandle),this._microTaskQueued=!1,this._updatingChanged()}taskRunningChanged(e){this._updatingChanged(),e&&this._budget.remaining>0&&!this._microTaskQueued&&(this._microTaskQueued=!0,queueMicrotask((()=>{this._microTaskQueued&&(this._microTaskQueued=!1,this._budget.remaining>0&&this._schedule()&&this.frame())})))}registerTask(e,i){const n=new t(this,e,i);return this._tasks.push(n),this._updatingChanged(),this.performanceInfo.tasks.has(e)||this.performanceInfo.tasks.set(e,new l.Z(e)),n}registerIdleStateCallbacks(e,t){const i={idleBegin:e,idleEnd:t};this._idleStateCallbacks.push(i),this.state===g.n.IDLE&&this._idleUpdatesStartFired&&i.idleBegin();const n=this;return{remove:()=>this._removeIdleStateCallbacks(i),set idleBegin(e){n._idleUpdatesStartFired&&(i.idleEnd(),n._state===g.n.IDLE&&e()),i.idleBegin=e},set idleEnd(e){i.idleEnd=e}}}get load(){return this._load}set state(e){this._state!==e&&(this._state=e,this.state!==g.n.IDLE&&this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=!1,this._idleStateCallbacks.forAll((e=>e.idleEnd()))))}get state(){return this._state}updateBudget(e){++this._frameNumber;let t=C,i=e.frameDuration,n=y;switch(this.state){case g.n.IDLE:t=(0,p.HA)(0),i=(0,p.HA)(Math.max(I,e.frameDuration)),n=S;break;case g.n.INTERACTING:i=(0,p.HA)(Math.max(T,e.frameDuration));case g.n.ANIMATING:}return i=(0,p.HA)(i-e.elapsedFrameTime-t),this.state!==g.n.IDLE&&i<y&&!this._forceTask?(this._forceTask=!0,!1):(i=(0,p.HA)(Math.max(i,n)),this._budget.reset(i,this.state),this._updateLoad(),this._schedule())}frame(){switch(this._forceTask=!1,this._microTaskQueued=!1,this.state){case g.n.IDLE:this._idleUpdatesStartFired||(this._idleUpdatesStartFired=!0,this._idleStateCallbacks.forAll((e=>e.idleBegin()))),this._runIdle();break;case g.n.INTERACTING:this._runInteracting();break;default:this._runAnimating()}}stopFrame(){this._budget.reset((0,p.HA)(0),this._state),this._budget.madeProgress()}_removeIdleStateCallbacks(e){this._idleUpdatesStartFired&&e.idleEnd(),this._idleStateCallbacks.removeUnordered(e)}removeTask(e){this._tasks.removeUnordered(e),this._runQueue.removeUnordered(e),this._updatingChanged()}_updateTask(e){this._tasks.forAll((t=>{t.name===e&&t.setPriority(e)}))}_getState(e){if(this._runQueue.some((t=>t.name===e)))return R.SCHEDULED;let t=R.IDLE;return this._tasks.forAll((i=>{i.name===e&&i.needsUpdate&&(i.schedulePriority<=1?t=R.READY:t!==R.READY&&(t=R.WAITING))})),t}_getRuntime(e){let t=0;return this._tasks.forAll((i=>{i.name===e&&(t+=i.runtime)})),t}_resetRuntimes(){this._tasks.forAll((e=>e.runtime=0))}_getRunning(){const e=new Map;if(this._tasks.forAll((t=>{t.needsUpdate&&e.set(t.name,(e.get(t.name)||0)+1)})),0===e.size)return null;let t="";return e.forEach(((e,i)=>{t+=e>1?" ".concat(e,"x ").concat(i):" ".concat(i)})),t}_runIdle(){this._run()}_runInteracting(){this._run()}_runAnimating(){this._run()}_updateLoad(){const e=this._tasks.reduce(((e,t)=>t.needsUpdate?++e:e),0);this._load=.9*this._load+e*(1-.9)}_schedule(){for(this._runQueue.filterInPlace((e=>!!e.needsUpdate||(e.schedulePriority=e.basePriority,!1))),this._tasks.forAll((e=>{0===e.basePriority&&e.needsUpdate&&!this._runQueue.includes(e)&&e.blockFrame!==this._frameNumber&&this._runQueue.unshift(e)}));0===this._runQueue.length;){let e=!1,t=0;if(this._tasks.forAll((i=>{i.needsUpdate&&0!==i.schedulePriority&&0!==i.basePriority&&i.blockFrame!==this._frameNumber&&(e=!0,t=Math.max(t,i.basePriority),1===i.schedulePriority?(i.schedulePriority=0,this._runQueue.push(i)):--i.schedulePriority)})),!e)return this._updatingChanged(),!1}return this._updatingChanged(),!0}_run(){const e=this._budget.now();this._startFrameTaskTimes();do{for(;this._runQueue.length>0;){const i=this._budget.now(),s=this._runQueue.pop();this._budget.resetProgress();try{s.task.runTask(this._budget)===m.J&&(s.blockFrame=this._frameNumber)}catch(t){o.Z.getLogger("esri.views.support.Scheduler").error('Exception in task "'.concat(s.name,'"'),t),s.blockFrame=this._frameNumber}!this._budget.hasProgressed&&s.blockFrame!==this._frameNumber&&s.needsUpdate&&(s.name,n.I3S_CONTROLLER,s.blockFrame=this._frameNumber),s.schedulePriority=s.basePriority;const r=this._budget.now()-i;if(s.runtime+=r,this._frameTaskTimes.set(s.priority,this._frameTaskTimes.get(s.priority)+r),this._budget.remaining<=0)return this._updatingChanged(),void this._recordFrameTaskTimes(this._budget.now()-e)}}while(this._schedule());this._updatingChanged(),this._recordFrameTaskTimes(this._budget.now()-e)}_startFrameTaskTimes(){for(const e of Object.keys(n))this._frameTaskTimes.set(n[e],0)}_recordFrameTaskTimes(e){this._frameTaskTimes.forEach(((e,t)=>this.performanceInfo.tasks.get(t).record(e))),this.performanceInfo.total.record(e)}get test(){}};class t{get task(){return this._task.value}get updating(){return this._queue.running}constructor(e,t,i){this._scheduler=e,this.name=t,this.blockFrame=0,this.runtime=0,this._queue=new _.b,this._handles=new r.Z,this._basePriority=b(t),this.schedulePriority=this._basePriority,this._task=(0,d.t)(null!=i?i:this._queue),this._handles.add((0,h.when)((()=>this.task.running),(t=>e.taskRunningChanged(t))))}remove(){this.processQueue(w),this._scheduler.removeTask(this),this.schedule=P.schedule,this.reschedule=P.reschedule,this._handles.destroy()}get basePriority(){return this._basePriority}setPriority(e){if(this.name===e)return;this.name=e;const t=b(e);0!==this._basePriority&&0===this.schedulePriority||(this.schedulePriority=t),this._basePriority=t}get priority(){return this.name}set priority(e){this.setPriority(e)}get needsUpdate(){return this.updating||this.task.running}schedule(e,t,i){return this._queue.push(e,t,i)}reschedule(e,t,i){return this._queue.unshift(e,t,i)}processQueue(e){return this._queue.runTask(e)}}class i{constructor(){this._begin="undefined"!=typeof performance?performance.now():0,this._budget=0,this._state=g.n.IDLE,this._done=!1,this._progressed=!1,this._enabled=!0}run(e){return!this.done&&(!0===e()&&this.madeProgress(),!0)}get done(){return this._done}get budget(){return this._budget}madeProgress(){return this._progressed=!0,this._done=this.elapsed>=this._budget&&this._enabled,this._done}get state(){return this._state}get enabled(){return this._enabled}set enabled(e){this._enabled=e}reset(e,t){this._begin=this.now(),this._budget=e,this._state=t,this.resetProgress()}get remaining(){return Math.max(this._budget-this.elapsed,0)}now(){return performance.now()}get elapsed(){return this.now()-this._begin}resetProgress(){this._progressed=!1,this._done=!1}get hasProgressed(){return this._progressed}}e.Budget=i}(O||(O={})),function(e){e.SCHEDULED="s",e.READY="r",e.WAITING="w",e.IDLE="i"}(R||(R={}));const w=(()=>{const e=new O.Budget;return e.enabled=!1,e})();const P=new class{remove(){}processQueue(){}schedule(e,t,i){try{if((0,u.Hc)(t)){const e=(0,u.zE)();return i?Promise.resolve(i(e)):Promise.reject(e)}return(0,u.gx)(e(w))}catch(n){return Promise.reject(n)}}reschedule(e,t,i){return this.schedule(e,t,i)}}},73553:(e,t,i)=>{i.d(t,{J:()=>n});const n=Symbol("Yield")},32609:(e,t,i)=>{i.d(t,{Z:()=>l});var n=i(27366),s=i(7138),r=i(49861),o=(i(93169),i(32718),i(84936),i(69912));let a=class extends s.default{constructor(){super(...arguments),this.SCHEDULER_LOG_SLOW_TASKS=!1,this.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=!1}};(0,n._)([(0,r.Cb)()],a.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0),(0,n._)([(0,r.Cb)()],a.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0),a=(0,n._)([(0,o.j)("esri.views.support.debugFlags")],a);const l=new a},7930:(e,t,i)=>{i.r(t),i.d(t,{default:()=>Zt});var n=i(27366),s=i(14921),r=i(92026),o=i(97942),a=i(66978),l=i(94172),c=i(49861),u=(i(93169),i(32718)),h=(i(84936),i(69912)),d=i(33565);const p="esri-elevation-profile",_={base:"".concat(p),portrait:"".concat(p,"--portrait"),refined:"".concat(p,"--refined"),mainContainer:"".concat(p,"__main-container"),promptContainer:"".concat(p,"__prompt-container"),header:"".concat(p,"__header"),zoomOutButton:"".concat(p,"__zoom-out-button"),clearButton:"".concat(p,"__clear-button"),actionButton:"".concat(p,"__action-button"),sketchButton:"".concat(p,"__sketch-button"),sketchCancelButton:"".concat(p,"__sketch-cancel-button"),sketchDoneButton:"".concat(p,"__sketch-done-button"),selectButton:"".concat(p,"__select-button"),selectCancelButton:"".concat(p,"__select-cancel-button"),chartContainer:"".concat(p,"__chart-container"),chartSpinner:"".concat(p,"__chart-spinner"),chartSpinnerVisible:"".concat(p,"__chart-spinner--visible"),chartSpinnerSmall:"".concat(p,"__chart-spinner--small"),footer:"".concat(p,"__footer")},v="esri-elevation-profile-legend",g="esri-elevation-profile-legend-item",m={base:g,disabled:"".concat(g,"--disabled"),expanded:"".concat(g,"--expanded"),colorIndicator:"".concat(g,"__color-indicator"),header:"".concat(g,"__header"),content:"".concat(g,"__content"),collapseToggle:"".concat(g,"__collapse-toggle"),label:"".concat(g,"__label"),checkbox:"".concat(g,"__checkbox")},f="esri-elevation-profile-statistics",E={base:f,statistic:"".concat(f,"__statistic"),statisticLabel:"".concat(f,"__statistic__label"),statisticValue:"".concat(f,"__statistic__value"),slopeValue:"".concat(f,"__slope-value")},b="esri-elevation-profile-settings",C={base:"".concat(b),popoverContent:"".concat(b,"__popover-content"),uniformChartScalingLabel:"".concat(b,"__uniform-scaling-label"),uniformChartScalingCheckbox:"".concat(b,"__uniform-scaling-checkbox")};var y=i(52639),S=i(7138),T=i(63780),I=i(70116),O=i(80987),R=i(60354),w=i(44927),P=i(16054),A=i(68860),L=i(22689),k=i(77671),D=i(42537),N=i(14916),M=i(74509),U=i(91079),x=i(16889),F=i(13611),V=i(32035),B=i(29909),H=i(79803),G=i(78952),Z=i(15559);const z="ProfileGenerationError";var W;!function(e){e.TooComplex="too-complex",e.InvalidGeometry="invalid-geometry",e.InvalidElevationInfo="invalid-elevation-info",e.ElevationQueryError="elevation-query-error"}(W||(W={}));class q extends Error{constructor(e){super("profile could not be generated",{cause:e}),this.type=z}}async function Y(e,t,n,s,r,o,l){var c;let u,h,d;const p=e.spatialReference,_=p.isGeographic||p.isWebMercator;let v=0;if(!_){const{planarLength:t}=await i.e(84178).then(i.bind(i,84178));(0,a.k_)(l),v=await t(e,"meters"),(0,a.k_)(l)}const g=1/(0,A.c9)(s),m=null!==(c=r.geodesicDistanceThreshold)&&void 0!==c?c:1/0;if(_||v>=m){await(0,H.initializeProjection)([{source:p,dest:s},{source:p,dest:G.Z.WGS84}],l);const i=function(e){return(0,Z.Gb)(e.spatialReference)?e:(0,H.project)(e,G.Z.WGS84)}(e);u=(0,Z.Jf)([i],"meters")[0];const a=j(u,r);if(le(e,u,a)>o)throw new q(W.TooComplex);const c=Q(i,t,n);({densifiedPath:h,distances:d}=function(e,t,i){const{hasZ:n}=e;return ee(e,t,i,te,n?se:ne)}(c,a,g)),h=(0,H.project)(h,s)}else{await(0,H.initializeProjection)([{source:p,dest:s}],l),u=v;const i=j(u,r);if(le(e,u,i)>o)throw new q(W.TooComplex);const c=Q(e,t,n);({densifiedPath:h,distances:d}=function(e,t,i){const{hasZ:n}=e;return ee(e,t,i,ie,n?oe:re)}(c,i,g)),(0,a.k_)(l),h=(0,H.project)(h,s)}return{densifiedPath:h,pathLength:u*g,distances:d}}function j(e,t){const i=e/t.densificationMaxSamples;return Math.max(t.samplingDistance,i)}function Q(e,t,i){if(null==t)return J(e);const n=e.spatialReference,s=t.mode,r=(0,M.ap)(t,n);let o=null;switch(i.type){case"2d":o=function(e,t,i){let{hasZ:n}=e;return"absolute-height"===t?n?e=>{let[t,n,s]=e;return[t,n,s+i]}:e=>{let[t,n]=e;return[t,n,i]}:null}(e,s,r);break;case"3d":o=function(e,t,i,n){let{spatialReference:s,hasZ:r}=e,{elevationProvider:o}=n;const a=(e,t,i,n)=>{var r;return null!==(r=null===o||void 0===o?void 0:o.getElevation(e,t,i,s,n))&&void 0!==r?r:0};switch(t){case"on-the-ground":return e=>{let[t,i]=e;return[t,i,a(t,i,0,"ground")]};case"absolute-height":return r?e=>{let[t,n,s]=e;return[t,n,s+i]}:e=>{let[t,n]=e;return[t,n,i]};case"relative-to-ground":return r?e=>{let[t,n,s]=e;return[t,n,s+a(t,n,s,"ground")+i]}:e=>{let[t,n]=e;return[t,n,a(t,n,0,"ground")+i]};case"relative-to-scene":return r?e=>{let[t,n,s]=e;return[t,n,s+a(t,n,s,"scene")+i]}:e=>{let[t,n]=e;return[t,n,a(t,n,0,"scene")+i]};default:return null}}(e,s,r,i)}return null==o?J(e):new B.Z({hasZ:!0,hasM:!1,spatialReference:n,paths:X(e.paths,o)})}function J(e){return e.hasZ?new B.Z({hasZ:!1,hasM:!1,spatialReference:e.spatialReference,paths:X(e.paths,(e=>{let[t,i]=e;return[t,i]}))}):e}function X(e,t){const i=e.length,n=new Array(i);for(let s=0;s<i;++s){const i=e[s],r=i.length,o=new Array(i.length);n[s]=o;for(let e=0;e<r;++e)o[e]=t(i[e])}return n}function K(e){return $(e)&&e.paths.length>0&&e.paths.every((e=>e.length>=2))}function $(e){return null!=e&&"polyline"===e.type}function ee(e,t,i,n,s){const{spatialReference:r,hasZ:o}=e,a={from:null,to:null,distance:0,azimuth:0,reverseAzimuth:0,spatialReference:r,metersPerSR:(0,A.c9)(r)},l=[],c=[];let u=0;for(let h=0;h<e.paths.length;++h){const r=e.paths[h],o=new Array,d=new Array;let p=0;for(let e=1;e<r.length;++e){const l=r[e-1],c=r[e],h=n(a,l,c);let _;for(_=p;_<h.distance&&!(0,x.Po)(_,h.distance);_+=t)o.push(s(h,_)),d.push((u+_)*i);p=_-h.distance,u+=h.distance,o.push(c),d.push(u*i)}l[h]=o,c[h]=d}return{densifiedPath:new B.Z({spatialReference:r,hasZ:o,paths:l}),distances:c}}function te(e,t,i){return e.distance=0,(0,Z.cA)(e,t,i,e.spatialReference),e.from=t,e.to=i,e}function ie(e,t,i){return e.from=t,e.to=i,e.distance=(0,F.TE)(i,t)*e.metersPerSR,e}function ne(e,t){let{from:i,azimuth:n,spatialReference:s}=e;return(0,Z.TB)([0,0],i,n,t,s)}function se(e,t){let{from:i,to:n,azimuth:s,distance:r,spatialReference:o}=e;const a=t/r,l=[0,0,(0,x.t7)(i[2],n[2],a)];return(0,Z.TB)(l,i,s,t,o),l}function re(e,t){let{from:i,to:n,distance:s}=e;return(0,F.t7)([0,0],i,n,t/s)}function oe(e,t){let{from:i,to:n,distance:s}=e;return(0,V.o)([0,0,0],i,n,t/s)}function ae(e){return e.paths.reduce(((e,t)=>e+t.length),0)}function le(e,t,i){return ae(e)+Math.floor(t/i)+Math.max(0,e.paths.reduce((e=>1+e),0)-1)}var ce=i(77577),ue=i(69662),he=i(92975),de=i(38164),pe=i(93463);function _e(e,t){const i=e.length;if(0===i)return null;const n=e[0],s=n.sampledZ;let r=s,o=s,a=0,l=0,c=null,u=null,h=null!=s?s:0,d=0,p=0,_=null!=s?1:0,v=0,g=0;const m=(0,A.c9)(t),f=(0,A._R)(t),E=(0,U.iE)().minSlopeSampleDistance/m,b=2*E,C=new fe,y=new fe,S=()=>{I(),C.copy(y),y.reset()},T=(e,t)=>{S(),e>0&&e-C.start<=b&&(e=C.start+E),y.restart(e,t)},I=()=>{if(C.isHole||y.isHole)return;const e=y.avgElevation-C.avgElevation,t=y.start-C.start,i=e*f,n=t*m,s=(0,A.En)(Math.atan2(i,n),"radians","degrees");s>0?(d+=s,c=ge(c,s),v++):s<0&&(p-=s,u=ge(u,-s),g++)};null!=n.sampledZ&&T(n.distance,n.sampledZ);for(let O=1;O<i;++O){const t=e[O-1],i=e[O],n=i.sampledZ;if(null==n){y.isHole||S();continue}_++,h+=n,r=ve(r,n),o=ge(o,n),y.isHole||i.distance-y.start>=E?T(i.distance,n):y.insert(n);const s=t.sampledZ;if(null!=s){const e=n-s;e>0?a+=e:e<0&&(l-=e)}}return S(),0===_?null:{maxDistance:e[i-1].distance,minElevation:r,maxElevation:o,avgElevation:0===_?null:h/_,elevationGain:a,elevationLoss:l,maxPositiveSlope:c,maxNegativeSlope:u,avgPositiveSlope:0===v?null:d/v,avgNegativeSlope:0===g?null:p/g}}function ve(e,t){return null==t?e:null!=e?Math.min(e,t):t}function ge(e,t){return null==t?e:null!=e?Math.max(e,t):t}function me(e,t){return null!=e&&null!=t?e*t:null}class fe{constructor(){this._start=0,this._totalElevation=0,this._sampleCount=0}get avgElevation(){return this._totalElevation/this._sampleCount}get isHole(){return 0===this._sampleCount}get start(){return this._start}copy(e){this._start=e._start,this._sampleCount=e._sampleCount,this._totalElevation=e._totalElevation}reset(){this._start=0,this._sampleCount=0,this._totalElevation=0}restart(e,t){this._start=e,this._sampleCount=1,this._totalElevation=t}insert(e){++this._sampleCount,this._totalElevation+=e}}var Ee=i(39114);function*be(e,t){const{densificationResult:i}=e,n={...e,abortOptions:t,densificationResult:i},s=(0,Ee.k)(0,n.result.samples.length),r=s.slice(0,n.provider.numSamplesForPreview);yield Ce(n,r,!0);const o=(0,T.vr)(s,n.provider.numSamplesPerChunk);for(const a of o)yield Ce(n,a,!1)}async function Ce(e,t,i){let{densificationResult:n,result:s,provider:r,queue:o,abortOptions:l,cache:c}=e;const{densifiedPath:u,pathLength:h}=n,d=s.spatialReference,{samples:p}=s,_=[];for(let a=0;a<t.length;a++){const e=p[t[a]];_[a]=e.coordinate}try{return await o.push({geometry:new ce.Z({spatialReference:d,points:_,hasZ:u.hasZ}),provider:r,indices:t,preview:i,result:s,queryOptions:{...(0,U.iE)().defaultQueryOptions(),minDemResolution:i?Math.round(h/r.numSamplesForPreview):Math.round(h/p.length),cache:c}},l),{...s}}catch(mt){return(0,a.D_)(mt)?null:U.TH}}function ye(e){return new de.e({priority:pe.T8.ELEVATION_PROFILE,concurrency:1,scheduler:e,process:async e=>{(0,a.k_)(e.queryOptions);try{await async function(e){let{geometry:t,provider:i,indices:n,preview:s,result:r,queryOptions:o}=e;if(0===n.length)return;const a=(await async function(e,t,i){try{return await e.queryElevation(t,i)}catch(s){throw new q(W.ElevationQueryError)}}(i,t,o)).geometry,{hasZ:l,points:c}=a,u=o.noDataValue,{samples:h}=r;for(let d=0;d<n.length;d++){const e=h[n[d]];if(e.isHole)continue;const t=l?c[d][2]:null;null===t||t===u?e.sampledZ=null:(r.hasZ=!0,e.sampledZ=t),e.sampled=!0}(function(e){const t=e.length-1;let i=0;for(let n=1;n<=t;n++)(e[n].sampled||n===t)&&(Se(e,i,n),i=n)})(h),r.progress=s?0:r.progress+n.length/h.length,r.statistics=_e(r.samples,r.spatialReference)}(e)}catch(ut){(0,a.H9)(ut)}}})}function Se(e,t,i){if(i-t==1)return;const n=e[t],s=n.sampledZ,r=e[i],o=r.sampledZ;if(null==s||null==o){for(let n=t+1;n<i;n++)e[n].sampledZ=null;return}const a=n.distance,l=r.distance-a;for(let c=t+1;c<i;c++){const t=e[c],i=(t.distance-a)/l;t.sampledZ=(0,x.t7)(s,o,i)}}function Te(e){let{densifiedPath:t,distances:i}=e;const n=t.spatialReference,s=(0,he.C5)(n),r=t.paths,o=r.length,a=[];let l=null,c=0;for(let u=0;u<o;u++){const e=r[u],t=e.length,n=i[u];for(let i=0;i<t;i++){const t=e[i],r=n[i];s&&(t[0]=(0,ue.gQ)(t[0],s.valid[0],s.valid[1])),l&&0===i&&Ie(a,l,t,c,r),a.push(Oe(t,r)),l=t,c=r}}return{progress:0,samples:a,hasZ:!1,statistics:null,spatialReference:n}}function Ie(e,t,i,n,s){e.push(Re(t,n)),e.push(Re(i,s))}function Oe(e,t){return{coordinate:e,distance:t,sampledZ:null,sampled:!1,isHole:!1}}function Re(e,t){return{coordinate:e,distance:t,sampledZ:null,sampled:!0,isHole:!0}}const we="line-change";let Pe=class extends S.default{constructor(e){super(e),this._updateTask=null,this._paramsPerProfile=new Map,this._getUpdateParametersMemoized=(0,o.H)(((e,t,i)=>({stationary:e,visibleProfiles:t,generationParameters:i}))),this._getGenerationParametersMemoized=(0,o.H)(((e,t,i,n,s,r,o)=>$(t)&&K(t)&&null!=n?{view:e,geometry:t,elevationInfo:i,options:r,queue:n,cache:s,slicePlane:o}:null)),this._getElevationInfoMemoized=(0,o.H)(((e,t)=>({mode:e,offset:t}))),this._getOptionsMemoized=(0,o.H)(((e,t,i)=>{const{densificationMaxSamples:n,maxTotalSamples:s}=(0,U.iE)();return{geodesicDistanceThreshold:e,samplingDistance:t,densificationMaxSamples:Math.round(n/i),maxTotalSamples:s}})),this._updateThrottled=(0,N.P)((e=>(0,a.R8)(this._update(e))),(0,U.iE)().updateThrottleMillis)}initialize(){const e=this.viewModel;this.addHandles([(0,l.watch)((()=>e.profiles.toArray()),(e=>{this._abortUpdate(),this._paramsPerProfile.clear(),this.removeHandles(we),this.addHandles(e.map((e=>(0,D.AL)([e.attach(this.viewModel),e.on("change",(()=>{this._invalidateProfile(e)}))]))),we)}),l.syncAndInitial),this._updateThrottled,(0,l.watch)((()=>this._updateParameters),this._updateThrottled,l.syncAndInitial)])}destroy(){this._paramsPerProfile.clear()}get _updateParameters(){const{viewModel:e}=this,t=e.view;return this._getUpdateParametersMemoized(null==t||t.stationary,this.viewModel.visibleProfiles,this._generationParameters)}get _generationParameters(){const{view:e,input:t,queue:i,tileCache:n}=this.viewModel;return null!=e&&e.ready?this._getGenerationParametersMemoized(e,null===t||void 0===t?void 0:t.geometry,this._elevationInfo,i,n,this._options,"3d"===e.type?e.slicePlane:null):null}get _elevationInfo(){const e=this.viewModel.input,t=e?(0,M.Lt)(e)?null:(0,M.RL)(e):null;return null!=t?this._getElevationInfoMemoized(t.mode,t.offset):null}get _options(){var e;const t=this.viewModel,i=t.visibleProfiles.length;let n=null!==(e=t.minDemResolution)&&void 0!==e?e:(0,U.iE)().defaultDemResolution;return n=parseFloat(n.toFixed(2)),this._getOptionsMemoized(t.geodesicDistanceThreshold,n,i)}async _update(e){let{stationary:t,visibleProfiles:i,generationParameters:n}=e;this._abortUpdate(),t&&(null!=n?this._updateTask=(0,s.vr)((async e=>{this.viewModel.error=null;const t=i.filter((e=>!this._isProfileValid(e,n))),s=async function*(e,t){var i;const{view:n,geometry:s,elevationInfo:r,providers:o,options:l}=e,c=n.spatialReference;if(!c||null==s||!K(s))throw new q(W.InvalidGeometry);const u=o.length;if(0===u)return null;const h=Math.round(l.maxTotalSamples/u);if(ae(s)>h)throw new q(W.TooComplex);const d=await Y(s,r,n,c,l,h,t);let p=0;const _=new Array(u),v=new Array(u);for(let a=0;a<u;a++){const i=Te(d);_[a]=i,p+=i.samples.length;const n={...e,provider:o[a],result:i,densificationResult:d};v[a]=be(n,t)[Symbol.iterator]()}if(p>l.maxTotalSamples)throw new q(W.TooComplex);const g=await Promise.all(v.map((e=>{const t=e.next();return!0===t.done?Promise.resolve(null):t.value})));(0,a.k_)(t);for(let a=0;a<u;a++)_[a]=g[a];yield _,await(0,a.e4)(null!==(i=e.delayAfterPreview)&&void 0!==i?i:(0,U.iE)().delayAfterPreviewMillis,null,t.signal);const m=[];try{let e;do{e=!1;for(let t=0;t<u;t++){const i=v[t].next();!1===i.done&&(m.push({resultPromise:i.value,index:t}),e=!0)}}while(e)}finally{v.forEach((e=>{var t;return null===(t=e.return)||void 0===t?void 0:t.call(e)}))}for(const{resultPromise:f,index:E}of m)_[E]=await f,(0,a.k_)(t),yield _;for(const a of _)null!=a&&(a.progress=1);yield _}({...n,providers:t},{signal:e});try{for await(const i of s){(0,a.k_)(e),this._clearInvalidResults(n);for(let e=0;e<t.length;e++)t[e].result=i[e]}for(const e of t)this._paramsPerProfile.set(e,n)}catch(f){(0,a.r9)(f),this._abortUpdate(),this.viewModel.error=f,t.forEach((e=>{e.result=null}))}})):this._clearResults())}_abortUpdate(){this._updateTask=(0,r.IM)(this._updateTask)}_isProfileValid(e,t){return this._paramsPerProfile.has(e)&&this._paramsPerProfile.get(e)===t}_invalidateProfile(e){this._paramsPerProfile.delete(e),this._updateThrottled(this._updateParameters)}_clearInvalidResults(e){for(const t of this.viewModel.profiles.items)this._isProfileValid(t,e)||(t.result=null,this._paramsPerProfile.delete(t))}_clearResults(){for(const e of this.viewModel.profiles.items)e.result=null,this._paramsPerProfile.delete(e)}};(0,n._)([(0,c.Cb)({nonNullable:!0})],Pe.prototype,"viewModel",void 0),(0,n._)([(0,c.Cb)()],Pe.prototype,"_updateParameters",null),(0,n._)([(0,c.Cb)()],Pe.prototype,"_generationParameters",null),(0,n._)([(0,c.Cb)()],Pe.prototype,"_elevationInfo",null),(0,n._)([(0,c.Cb)()],Pe.prototype,"_options",null),Pe=(0,n._)([(0,h.j)("esri.widgets.ElevationProfile.ElevationProfileController")],Pe);var Ae=i(51995),Le=i(91505),ke=i(71907),De=i(848);function Ne(e,t,i){return null==e?null:(0,A.En)(e*t,"meters",i)}function Me(e,t,i){return null==e?null:(0,A.En)(e*t,"meters",i)}let Ue=class extends Le.Z.EventedAccessor{constructor(e){super(e),this.type=null,this.id=(0,ke.DO)(),this.title=null,this.color=new Ae.Z("#000000"),this.visible=!0,this._getSamplesMemoized=(0,o.H)(((e,t)=>function(e,t){if(null==e||null==t)return null;const{samples:i,spatialReference:n}=e,{distance:s,elevation:r}=t,o=(0,A.c9)(n),a=(0,A._R)(n),l=i.length,c=new Array(l);for(let u=0;u<l;++u){const e=i[u],t=e.sampledZ,n=e.coordinate;c[u]={x:n[0],y:n[1],z:t,distance:Ne(e.distance,o,s),elevation:Me(t,a,r)}}return c}(e,t))),this._getStatisticsMemoized=(0,o.H)(((e,t)=>function(e,t){if(null==e||null==t||null==e.statistics||null==e.spatialReference)return null;const{distance:i,elevation:n}=t,{statistics:s,spatialReference:r}=e,o=(0,A.c9)(r),a=(0,A._R)(r);return{maxDistance:Ne(s.maxDistance,o,i),minElevation:Me(s.minElevation,a,n),maxElevation:Me(s.maxElevation,a,n),avgElevation:Me(s.avgElevation,a,n),elevationGain:Me(s.elevationGain,a,n),elevationLoss:Me(s.elevationLoss,a,n),maxPositiveSlope:s.maxPositiveSlope,maxNegativeSlope:s.maxNegativeSlope,avgPositiveSlope:s.avgPositiveSlope,avgNegativeSlope:s.avgNegativeSlope}}(e,t))),this.viewVisualizationEnabled=!0,this.result=null,this.effectiveUnits=null,this.numSamplesForPreview=30,this.numSamplesPerChunk=200,this.chartFillEnabled=!0,this.chartStrokeWidth=1.5,this.chartStrokeOffsetY=0,this._viewModel=null}get progress(){return null!=this.result&&this.visible?this.result.progress:0}get samples(){return this._getSamplesMemoized(this.result,this.effectiveUnits)}get statistics(){return this._getStatisticsMemoized(this.result,this.effectiveUnits)}get hoveredPoint(){var e;const t=null===(e=this._viewModel)||void 0===e?void 0:e.hoveredChartPosition;return null!=t?this._getPoint(t):null}get available(){return!0}get hasZ(){const e=this.result;return null!=e&&e.hasZ}get minDemResolution(){return(0,U.iE)().defaultDemResolution}queryElevation(){throw new Error("not implemented")}attach(e){return this._viewModel=e,(0,D.AL)([(0,l.watch)((()=>e.effectiveUnits),(e=>{this.effectiveUnits=e}),l.syncAndInitial),(0,l.watch)((()=>[e.input]),(()=>this._onChange()),l.sync)])}toggleVisibility(e){this.visible=void 0===e?!this.visible:e}_onChange(){this.emit("change")}_getPoint(e){const{samples:t,result:i}=this;if(null==t||null==i)return null;const n=t.length;if(0===n)return null;const s=t[n-1].distance,r=(0,T.hG)(t,e*s,(e=>e.distance));if(null==r)return null;const{x:o,y:a,z:l}=r;return null==l?null:new De.Z({x:o,y:a,z:l,spatialReference:i.spatialReference})}};(0,n._)([(0,c.Cb)({nonNullable:!0})],Ue.prototype,"id",void 0),(0,n._)([(0,c.Cb)({nonNullable:!0})],Ue.prototype,"title",void 0),(0,n._)([(0,c.Cb)({type:Ae.Z,nonNullable:!0})],Ue.prototype,"color",void 0),(0,n._)([(0,c.Cb)({nonNullable:!0})],Ue.prototype,"visible",void 0),(0,n._)([(0,c.Cb)({readOnly:!0})],Ue.prototype,"progress",null),(0,n._)([(0,c.Cb)({readOnly:!0})],Ue.prototype,"samples",null),(0,n._)([(0,c.Cb)({readOnly:!0})],Ue.prototype,"statistics",null),(0,n._)([(0,c.Cb)()],Ue.prototype,"hoveredPoint",null),(0,n._)([(0,c.Cb)()],Ue.prototype,"viewVisualizationEnabled",void 0),(0,n._)([(0,c.Cb)()],Ue.prototype,"available",null),(0,n._)([(0,c.Cb)()],Ue.prototype,"result",void 0),(0,n._)([(0,c.Cb)()],Ue.prototype,"effectiveUnits",void 0),(0,n._)([(0,c.Cb)()],Ue.prototype,"numSamplesForPreview",void 0),(0,n._)([(0,c.Cb)()],Ue.prototype,"numSamplesPerChunk",void 0),(0,n._)([(0,c.Cb)()],Ue.prototype,"chartFillEnabled",void 0),(0,n._)([(0,c.Cb)()],Ue.prototype,"chartStrokeWidth",void 0),(0,n._)([(0,c.Cb)()],Ue.prototype,"chartStrokeOffsetY",void 0),(0,n._)([(0,c.Cb)({readOnly:!0})],Ue.prototype,"hasZ",null),(0,n._)([(0,c.Cb)({readOnly:!0})],Ue.prototype,"minDemResolution",null),(0,n._)([(0,c.Cb)()],Ue.prototype,"_viewModel",void 0),Ue=(0,n._)([(0,h.j)("esri.widgets.ElevationProfile.ElevationProfileLine")],Ue);const xe=Ue;var Fe=i(62565);function Ve(e){if(null==e)return null;if(e instanceof Fe.Z)return Be(e);const t=e.tileInfo;if(null==t)return null;const i=(0,T.Z$)(t.lods);return null==i?null:i.resolution*(0,A.c9)(t.spatialReference)}function Be(e){var t;if(null==e)return null;const i=e.layers.items.map(He).filter(T.pC);return null!==(t=(0,T.VV)(i))&&void 0!==t?t:null}function He(e){return e&&"tileInfo"in e?Ve(e):null}let Ge=class extends xe{constructor(e){super(e),this.type="ground",this.color=new Ae.Z("#ff7f00"),this.viewVisualizationEnabled=!0,this.numSamplesForPreview=50,this.numSamplesPerChunk=1e3,this._getQueryElevationDependencies=(0,o.H)(((e,t)=>({ground:e,groundLayers:t})))}get available(){const e=this._ground;return null!=e&&e.layers.some((e=>e.visible))}get minDemResolution(){return Be(this._ground)}get _queryElevationDependencies(){return this._getQueryElevationDependencies(this._ground,this._groundLayers)}get _ground(){var e;return null===(e=this._viewModel)||void 0===e||null===(e=e.view)||void 0===e||null===(e=e.map)||void 0===e?void 0:e.ground}get _groundLayers(){var e,t;return null!==(e=null===(t=this._ground)||void 0===t||null===(t=t.layers)||void 0===t?void 0:t.toArray())&&void 0!==e?e:[]}async queryElevation(e,t){const i=this._queryElevationDependencies;if(null==i)throw new Error("ElevationProfileLineGround: no dependencies");const{ground:n}=i;if(null==n)throw new Error("No ground configured in the view");const s=await n.queryElevation(e,t),r=(0,A._R)(e.spatialReference),o=(0,A._R)(n.layers.at(0).spatialReference);if(r!==o){const e=s.geometry;e.points=e.points.map((e=>{let[i,n,s]=e;return[i,n,s===t.noDataValue?s:s*o/r]}))}return s}attach(e){return(0,D.AL)([super.attach(e),(0,l.watch)((()=>this._queryElevationDependencies),(()=>this._onChange()))])}};(0,n._)([(0,c.Cb)({type:Ae.Z,nonNullable:!0})],Ge.prototype,"color",void 0),(0,n._)([(0,c.Cb)()],Ge.prototype,"viewVisualizationEnabled",void 0),(0,n._)([(0,c.Cb)()],Ge.prototype,"available",null),(0,n._)([(0,c.Cb)({readOnly:!0})],Ge.prototype,"minDemResolution",null),(0,n._)([(0,c.Cb)()],Ge.prototype,"_queryElevationDependencies",null),(0,n._)([(0,c.Cb)()],Ge.prototype,"_ground",null),(0,n._)([(0,c.Cb)()],Ge.prototype,"_groundLayers",null),Ge=(0,n._)([(0,h.j)("esri.widgets.ElevationProfile.ElevationProfileLineGround")],Ge);const Ze=Ge;var ze=i(77043);let We=class extends xe{constructor(e){super(e),this.type="input",this.color=new Ae.Z("#00c8c8"),this.viewVisualizationEnabled=!1,this.numSamplesForPreview=50,this.numSamplesPerChunk=500,this.chartFillEnabled=!1,this.chartStrokeOffsetY=-1,this._getQueryElevationDependencies=(0,o.H)(((e,t,i,n,s)=>e?{elevationInfo:e,visibleLayers:t,view:i,stationary:n,spatialReference:s}:null))}get queryElevationDependencies(){var e;const t=null===(e=this._viewModel)||void 0===e?void 0:e.view;return null==t?null:this._getQueryElevationDependencies(this._elevationInfo,this._visibleLayers,t,t.stationary,t.spatialReference)}get available(){var e;return!(null!==(e=this._viewModel)&&void 0!==e&&e.inputIsSketched)}get _elevationInfo(){var e;const t=null===(e=this._viewModel)||void 0===e?void 0:e.input;return t?(0,M.RL)(t):null}get _visibleLayers(){var e,t;return null!==(e=null===(t=this._viewModel)||void 0===t||null===(t=t.view)||void 0===t||null===(t=t.map)||void 0===t||null===(t=t.allLayers)||void 0===t?void 0:t.filter((e=>e.visible)).toArray())&&void 0!==e?e:[]}async queryElevation(e,t){let{noDataValue:i,signal:n}=t;const s=this.queryElevationDependencies;if(null==s)throw new Error("ElevationProfileLineInput: no dependencies");const{view:r,elevationInfo:o,spatialReference:a}=s;if("on-the-ground"===o.mode&&"3d"===r.type&&a){const t=await ze.e.fromGeometry(e).project(a,n);if(!t)return{geometry:e,noDataValue:i};const s=r.elevationProvider;return t.coordinates.forEach((e=>{var t;e.z=null!==(t=s.getElevation(e.x,e.y,0,a,"ground"))&&void 0!==t?t:0})),{geometry:t.export(),noDataValue:i}}return{geometry:e,noDataValue:i}}attach(e){const t=()=>this._onChange();return(0,D.AL)([super.attach(e),(0,l.watch)((()=>this.queryElevationDependencies),t),(0,l.on)((()=>e.elevationProvider),"elevation-change",t,{onListenerAdd:t,onListenerRemove:t})])}};(0,n._)([(0,c.Cb)({type:Ae.Z,nonNullable:!0})],We.prototype,"color",void 0),(0,n._)([(0,c.Cb)()],We.prototype,"viewVisualizationEnabled",void 0),(0,n._)([(0,c.Cb)()],We.prototype,"queryElevationDependencies",null),(0,n._)([(0,c.Cb)()],We.prototype,"available",null),(0,n._)([(0,c.Cb)()],We.prototype,"_elevationInfo",null),(0,n._)([(0,c.Cb)()],We.prototype,"_visibleLayers",null),We=(0,n._)([(0,h.j)("esri.widgets.ElevationProfile.ElevationProfileLineInput")],We);const qe=We;let Ye=class extends xe{constructor(e){super(e),this.type="query",this.color=new Ae.Z("#db334a"),this.viewVisualizationEnabled=!0,this.source=null,this.numSamplesForPreview=50,this.numSamplesPerChunk=500}get minDemResolution(){return Ve(this.source)}get available(){const e=this.source;return!!e&&(null==e.visible||e.visible)&&(null==e.layers||e.layers.some((e=>e.visible)))}queryElevation(e,t){if(!this.source)throw new Error("No source configured for the elevation profile line");return this.source.queryElevation(e,t)}attach(e){return(0,D.AL)([super.attach(e),(0,l.watch)((()=>this.source),(()=>this._onChange()),l.sync)])}};(0,n._)([(0,c.Cb)({type:Ae.Z,nonNullable:!0})],Ye.prototype,"color",void 0),(0,n._)([(0,c.Cb)()],Ye.prototype,"viewVisualizationEnabled",void 0),(0,n._)([(0,c.Cb)()],Ye.prototype,"source",void 0),(0,n._)([(0,c.Cb)({readOnly:!0})],Ye.prototype,"minDemResolution",null),(0,n._)([(0,c.Cb)()],Ye.prototype,"available",null),Ye=(0,n._)([(0,h.j)("esri.widgets.ElevationProfile.ElevationProfileLineQuery")],Ye);const je=Ye;var Qe=i(92377),Je=i(12400),Xe=i(83448),Ke=i(40885),$e=i(9985),et=i(88153),tt=i(54463),it=i(41781);let nt=class extends xe{constructor(e){super(e),this.type="view",this.color=new Ae.Z("#cf4ccf"),this.viewVisualizationEnabled=!0,this.include=null,this.exclude=null,this.numSamplesForPreview=50,this.numSamplesPerChunk=25,this._getQueryElevationDependencies=(0,o.H)(((e,t,i,n,s,r,o)=>({inputGraphicUid:null!=e?rt(e):null,visibleLayers:t,maxIntersectionDistance:i,intersectOptions:n,view:s,stationary:r,spatialReference:o}))),this._vecA=(0,Je.Ue)(),this._vecB=(0,Je.Ue)(),this._ray=(0,Ke.Ue)()}get minDemResolution(){var e,t;const i=null===(e=this._viewModel)||void 0===e?void 0:e.view;if(null==i||"3d"!==i.type)return null;const n=null===(t=i.pointsOfInterest)||void 0===t||null===(t=t.focus)||void 0===t?void 0:t.worldUnitsPerContentPixel;return null==n?null:n*(0,A._R)(i.spatialReference)}get queryElevationDependencies(){var e;const t=this._view;return t?this._getQueryElevationDependencies(null===(e=this._viewModel)||void 0===e?void 0:e.input,this._visibleLayers,this._maxIntersectionDistance,this._intersectOptions,t,t.stationary,t.spatialReference):null}get _visibleLayers(){var e,t;return null!==(e=null===(t=this._view)||void 0===t||null===(t=t.map)||void 0===t||null===(t=t.allLayers)||void 0===t?void 0:t.filter((e=>e.visible)).toArray())&&void 0!==e?e:[]}get _intersectOptions(){const e=this._view;if(null==e||e.destroyed)return{};const t=(0,$e.us)(e,{include:this.include,exclude:this.exclude}),i=(0,$e.us)(e,{exclude:this._pointCloudLayers});return t.exclude=(0,Qe.G0)(t.exclude,i.exclude),t}get _pointCloudLayers(){const e=this._view;return null==e?[]:e.allLayerViews.toArray().filter((e=>{var t;return"point-cloud"===(null===(t=e.layer)||void 0===t?void 0:t.type)})).map((e=>e.layer))}get _view(){var e;const t=null===(e=this._viewModel)||void 0===e?void 0:e.view;return null!=t&&"3d"===t.type?t:null}get _maxIntersectionDistance(){const e=this._view;return null!==e&&void 0!==e&&e.renderCoordsHelper?(0,Xe.Iu)(e.spatialReference).radius/e.renderCoordsHelper.unitInMeters:Number.POSITIVE_INFINITY}get _intersector(){const e=this._view;if(null==e)return null;const t=(0,et.Z8)(e.state.viewingMode),i=t.options;return i.hud=!1,i.invisibleTerrain=!1,i.backfacesTerrain=!1,i.selectionMode=!1,i.store=tt.eC.ALL,t}async queryElevation(e,t){let{noDataValue:i,signal:n}=t;const s=this.queryElevationDependencies;if(null==s)throw new Error("ElevationProfileLineInput: no dependencies");const r=this._intersector;if(null==r)throw new Error("ElevationProfileLineInput: no view");const{intersectOptions:o,view:a,spatialReference:l}=s,c=a.renderCoordsHelper,u=a.sceneIntersectionHelper,h=this._vecA,d=this._vecA,p=this._vecB,_=this._ray;if(!l)return{geometry:e,noDataValue:i};const v=await ze.e.fromGeometry(e).project(l,n);if(!v)return{geometry:e,noDataValue:i};const g=v.coordinates,m=g.length;for(let E=0;E<m;++E){var f;const e=g[E];(0,V.s)(p,e.x,e.y,null!==(f=e.z)&&void 0!==f?f:0),c.toRenderCoords(p,l,p),c.setAltitude(h,2e5,p);const t=(0,Ke.zk)(h,p,_);u.computeIntersection(t,r,o,!0);const n=st(s,r.results.all);n?(n.getIntersectionPoint(d),c.fromRenderCoords(d,d,l),e.z=d[2]):e.z=i}return{geometry:v.export(),noDataValue:i}}attach(e){const t=()=>this._onChange();return(0,D.AL)([super.attach(e),(0,l.watch)((()=>this.queryElevationDependencies),t),(0,l.on)((()=>e.elevationProvider),"elevation-change",t,{onListenerAdd:t,onListenerRemove:t})])}};function st(e,t){let{view:i,inputGraphicUid:n,maxIntersectionDistance:s}=e;for(const r of t){if(null!=r.distanceInRenderSpace&&r.distanceInRenderSpace>s)continue;const e=(0,it.tB)(r,i);if(null==e||rt(e)!==n)return r}return null}function rt(e){if(e.layer&&"objectIdField"in e.layer){const t=e.attributes[e.layer.objectIdField];if(t)return"o-".concat(e.layer.id,"-").concat(t)}return"u-".concat(e.uid)}(0,n._)([(0,c.Cb)({type:Ae.Z,nonNullable:!0})],nt.prototype,"color",void 0),(0,n._)([(0,c.Cb)()],nt.prototype,"viewVisualizationEnabled",void 0),(0,n._)([(0,c.Cb)()],nt.prototype,"include",void 0),(0,n._)([(0,c.Cb)()],nt.prototype,"exclude",void 0),(0,n._)([(0,c.Cb)({readOnly:!0})],nt.prototype,"minDemResolution",null),(0,n._)([(0,c.Cb)()],nt.prototype,"queryElevationDependencies",null),(0,n._)([(0,c.Cb)()],nt.prototype,"_visibleLayers",null),(0,n._)([(0,c.Cb)()],nt.prototype,"_intersectOptions",null),(0,n._)([(0,c.Cb)()],nt.prototype,"_pointCloudLayers",null),(0,n._)([(0,c.Cb)()],nt.prototype,"_view",null),(0,n._)([(0,c.Cb)()],nt.prototype,"_maxIntersectionDistance",null),(0,n._)([(0,c.Cb)()],nt.prototype,"_intersector",null),nt=(0,n._)([(0,h.j)("esri.widgets.ElevationProfile.ElevationProfileLineView")],nt);const ot={base:xe,key:"type",typeMap:{ground:Ze,input:qe,query:je,view:nt},errorContext:"elevation-profile-line"},at=O.Z.ofType(ot);var lt,ct,ut,ht=i(93655),dt=i(75021),pt=i(14404),_t=i(1614),vt=i(40763);(ut=lt||(lt={})).Ready="ready",ut.Creating="creating",ut.Reshaping="reshaping",ut.ReshapingDisabled="reshaping-disabled",ut.Selecting="selecting",ut.Selected="selected",function(e){e.View="view",e.Main="main",e.Interaction="interaction"}(ct||(ct={}));let gt=class extends S.default{constructor(e){super(e),this.state=lt.Ready,this._pendingStartOptions=null,this._previousInputInfo=null,this._shouldRemoveLastPoint=!1,this._sketchedGraphics=new WeakSet,this._creationToolPromise=null,this._updateToolPromise=null,this._updateDisabled=!1}initialize(){this.addHandles((0,l.watch)((()=>({view:this.tool.viewModel.view,visible:this.tool.visible})),(e=>{let{view:t,visible:i}=e;null!=t&&i?this._attach(t):this._detach()}),l.syncAndInitial),ct.View)}destroy(){this._detach()}get canStopCreating(){const e=this._geometry,t=this._shouldRemoveLastPoint?3:2;return $(e)&&e.paths.length>0&&e.paths[0].length>=t}get _input(){return this.tool.viewModel.input}set _input(e){this.tool.viewModel.input=e}get _geometry(){var e;return null===(e=this._input)||void 0===e?void 0:e.geometry}get _visibleAndEditable(){return this.tool.visible&&this.tool.editable}get _view(){return this.tool.viewModel.view}get test(){}start(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{mode:"sketch"};if(!this.tool.editable)return;const t=this._view;if(null!=t&&t.ready)switch(this._pendingStartOptions=null,this._stopInteraction(),null==this._previousInputInfo&&this._storePreviousInput(this._input),this._setSketchedGraphic(null),e.mode){case"sketch":this._set("state",lt.Creating),this._startCreationInteraction();break;case"select":this._set("state",lt.Selecting),this._startSelectionInteraction()}else this._pendingStartOptions=e}stop(){this._pendingStartOptions=null,this._stopInteractionAndUpdate(),this._clearPreviousInput()}cancel(){this._pendingStartOptions=null,this._stopInteractionAndUpdate(),this._restorePreviousInput()}clear(){this._stopInteractionAndUpdate(),this._set("state",lt.Ready),this._clearPreviousInput(),this._input=null,this._pendingStartOptions=null}isSketchedGraphic(e){return null!=e&&this._sketchedGraphics.has(e)}_attach(e){this._detach();const t={mode:"3d"===e.type?"relative-to-ground":"on-the-ground",offset:null};this._graphicsLayer=new ht.default({listMode:"hide",internal:!0,elevationInfo:t});const i=function(e){return"2d"===e?new dt.Z({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",effects:[{type:"CIMGeometricEffectDashes",dashTemplate:[5,4],lineDashEnding:"FullGap",controlPointEnding:"NoConstraint"}],enable:!0,capStyle:"Butt",joinStyle:"Round",width:1.5,color:[0,0,0,255]},{type:"CIMSolidStroke",enable:!0,capStyle:"Butt",joinStyle:"Round",width:1.5,color:[255,255,255,255]}]}}}):new pt.default({color:[0,0,0,0]})}(e.type);this._sketchVM=new vt.Z({layer:this._graphicsLayer,view:e,defaultCreateOptions:{mode:"click",hasZ:!1},updateOnGraphicClick:!1,defaultUpdateOptions:{reshapeOptions:{shapeOperation:"none"},enableRotation:!1,enableScaling:!1,enableMoveAllGraphics:!1,enableZ:!1,multipleSelectionEnabled:!1,toggleToolOnClick:!1,tool:"reshape"},polylineSymbol:i,activeLineSymbol:i}),this.addHandles([(0,l.when)((()=>e.ready),(()=>{const e=this._pendingStartOptions;e&&this.start(e)}),l.syncAndInitial),(0,l.watch)((()=>[this._input,this._visibleAndEditable]),(()=>this._update()),l.syncAndInitial),(0,l.watch)((()=>({map:e.map,graphicsLayer:this._graphicsLayer})),(e=>{let{map:t,graphicsLayer:i}=e;null!=t&&null!=i&&t.add(i),this._update()}),l.syncAndInitial)],ct.Main)}_detach(){var e;this.removeHandles(ct.Main),this._sketchVM=(0,r.SC)(this._sketchVM),this._creationToolPromise=null,this._updateToolPromise=null;const t=null===(e=this._view)||void 0===e?void 0:e.map,i=this._graphicsLayer;null!=t&&null!=i&&t.remove(i),this._graphicsLayer=(0,r.SC)(this._graphicsLayer),this._shouldRemoveLastPoint=!1,this._set("state",lt.Ready)}_startCreationInteraction(){this._stopInteractionAndUpdate();const e=this._view,t=this._sketchVM;if(null==e||null==t)return;this._shouldRemoveLastPoint=!1;const i=t.on("create",(e=>{var t;const i=e.graphic;switch(e.state){case"complete":this._shouldRemoveLastPoint=!1,this._setSketchedGraphic(i),this._stopInteractionAndUpdate(),this._clearPreviousInput();break;case"cancel":this.cancel();break;case"active":this._setSketchedGraphic(i),"cursor-update"===(null===(t=e.toolEventInfo)||void 0===t?void 0:t.type)&&(this._shouldRemoveLastPoint=!0);break;case"start":this._setSketchedGraphic(i)}}));this.removeHandles(ct.Interaction),this.addHandles((0,D.kB)((()=>{var e;i.remove();const n=this.canStopCreating,s=null===(e=this._geometry)||void 0===e?void 0:e.clone();t.cancel(),this._creationToolPromise=null,null!=s&&n?this._shouldRemoveLastPoint&&this._setSketchedGraphic(new y.Z({geometry:mt(s)})):this._input=null})),ct.Interaction),this._creationToolPromise=(0,a.R8)(t.create("polyline"))}_startReshapeInteraction(){this._stopInteraction();const e=this._view,t=this._sketchVM;if(null==e||null==t)return;const i=t.on("update",(e=>{const t=e.graphics[0];switch(e.state){case"complete":this._setSketchedGraphic(t),this._stopInteractionAndUpdate(),this._clearPreviousInput();break;case"active":case"start":this._setSketchedGraphic(t)}}));this.removeHandles(ct.Interaction),this.addHandles((0,D.kB)((()=>{i.remove(),t.cancel(),this._updateToolPromise=null})),ct.Interaction);const n=this._input;n&&(n.visible=!0,this._updateToolPromise=(0,a.R8)(t.update(n,{tool:"reshape"})))}_startSelectionInteraction(){this._stopInteraction();const e=this._view;if(null==e)return;const t=e.cursor,i=(0,D.kB)((()=>e.cursor=t));e.cursor="crosshair",e.closePopup();let n=null;const o=(0,D.kB)((()=>(0,r.IM)(n))),l=e.on("immediate-click",(t=>{t.async((async()=>{(0,r.IM)(n),n=(0,s.vr)((async i=>{const{results:n}=await e.hitTest(t);(0,a.k_)(i);const s=n.filter((e=>"graphic"===e.type&&null!=e.graphic)).map((e=>e.graphic)).find((e=>null!=e.geometry&&"polyline"===e.geometry.type));s&&(t.preventDefault(),t.stopPropagation(),this._input=s,this._clearPreviousInput(),this._stopInteractionAndUpdate())})),await n.promise}))}),_t.f.TOOL),c=e.on("key-down",(e=>{"Escape"===e.key&&this.cancel()}));this.removeHandles(ct.Interaction),this.addHandles([l,c,o,i],ct.Interaction),e.ready&&e.focus()}_stopInteraction(){this.removeHandles(ct.Interaction)}_stopInteractionAndUpdate(){this.hasHandles(ct.Interaction)&&(this._updateDisabled=!0,this._stopInteraction(),this._updateDisabled=!1,this._triggerUpdate())}_triggerUpdate(){this._set("state",lt.Ready),this._update()}_update(){if(this._updateDisabled)return;const e=this.state;if(e!==lt.Selecting){if(this._visibleAndEditable){if(e===lt.Creating||e===lt.Reshaping&&this.isSketchedGraphic(this._input))return}else this.cancel();this._set("state",this._getNextState()),this._updateVisuals()}else this.stop()}_getNextState(){return null==this._input?lt.Ready:this.isSketchedGraphic(this._input)?this.state===lt.Creating?lt.Creating:this._visibleAndEditable?lt.Reshaping:lt.ReshapingDisabled:lt.Selected}_updateVisuals(){switch(this.state){case lt.Creating:break;case lt.Reshaping:this._startReshapeInteraction();break;case lt.ReshapingDisabled:{this._stopInteractionAndUpdate();const e=this._input;null!=e&&this.isSketchedGraphic(e)&&(e.visible=!1);break}case lt.Ready:case lt.Selected:this._stopInteractionAndUpdate();case lt.Selecting:}this._updateSketchedGraphic()}_storePreviousInput(e){this._previousInputInfo={graphic:e}}_restorePreviousInput(){const e=this._previousInputInfo;null!=e&&(this._clearPreviousInput(),this._input=e.graphic,this._triggerUpdate())}_clearPreviousInput(){this._previousInputInfo=null}_updateSketchedGraphic(){const e=this._graphicsLayer;if(null==e)return;const t=e.graphics,i=this._input;if(null!=i&&this.isSketchedGraphic(i)){if(-1===t.indexOf(i))t.removeAll(),t.add(i);else if(1!==t.length){const e=t.filter((e=>e!==i));t.removeMany(e)}}else t.removeAll()}_setSketchedGraphic(e){null!=e&&this._sketchedGraphics.add(e),this._input=e,this._updateSketchedGraphic()}};function mt(e){if($(e)){const t=e.clone();return t.paths=[t.paths[0].slice(0,-1)],t}return e}(0,n._)([(0,c.Cb)({nonNullable:!0})],gt.prototype,"state",void 0),(0,n._)([(0,c.Cb)({nonNullable:!0})],gt.prototype,"tool",void 0),(0,n._)([(0,c.Cb)()],gt.prototype,"canStopCreating",null),(0,n._)([(0,c.Cb)()],gt.prototype,"_graphicsLayer",void 0),(0,n._)([(0,c.Cb)()],gt.prototype,"_sketchVM",void 0),(0,n._)([(0,c.Cb)()],gt.prototype,"_input",null),(0,n._)([(0,c.Cb)()],gt.prototype,"_geometry",null),(0,n._)([(0,c.Cb)()],gt.prototype,"_visibleAndEditable",null),(0,n._)([(0,c.Cb)()],gt.prototype,"_view",null),(0,n._)([(0,c.Cb)()],gt.prototype,"_shouldRemoveLastPoint",void 0),gt=(0,n._)([(0,h.j)("esri.widgets.ElevationProfile.ElevationProfileInteraction")],gt);let ft=class extends S.default{constructor(e){super(e),this._implementation=null,this._loadingTask=null}initialize(){this.addHandles((0,l.watch)((()=>{var e;return{tool:this.tool,view:this.tool.viewModel.view,visible:this.tool.visible&&!(null===(e=this.tool.viewModel.view)||void 0===e||!e.ready)}}),(e=>{let{tool:t,view:i,visible:n}=e;null!=i&&n?this._show(i,t):this._hide()}),l.syncAndInitial))}destroy(){this._hide()}_show(e,t){this._loadingTask=(0,r.IM)(this._loadingTask),this._loadingTask=(0,s.vr)((async n=>{if("2d"===e.type){const s=i.e(69570).then(i.bind(i,69570)),r=(await(0,a.Hl)(s,n)).ElevationProfileView2D;this._implementation=new r(e,t)}else if("3d"===e.type){const s=Promise.all([i.e(57808),i.e(25158),i.e(69656),i.e(25269),i.e(11219),i.e(96026),i.e(97411),i.e(22412)]).then(i.bind(i,90188)),r=(await(0,a.Hl)(s,n)).ElevationProfileView3D;this._implementation=new r(e,t)}}))}_hide(){this._loadingTask=(0,r.IM)(this._loadingTask),this._implementation=(0,r.SC)(this._implementation)}};(0,n._)([(0,c.Cb)()],ft.prototype,"tool",void 0),ft=(0,n._)([(0,h.j)("esri.widgets.ElevationProfile.support.ElevationProfileView")],ft);let Et=class extends S.default{constructor(e){super(e),this.editable=!0,this.visible=!0,this.highlightEnabled=!0}initialize(){this.view=new ft({tool:this}),this.interaction=new gt({tool:this})}destroy(){this.interaction.destroy(),this.view.destroy()}get state(){var e;switch(null===(e=this.interaction)||void 0===e?void 0:e.state){case lt.Ready:return U.dd.Ready;case lt.Creating:return U.dd.Creating;case lt.Selecting:return U.dd.Selecting;case lt.Selected:return U.dd.Selected;case lt.Reshaping:case lt.ReshapingDisabled:return U.dd.Created}}};(0,n._)([(0,c.Cb)({nonNullable:!0})],Et.prototype,"viewModel",void 0),(0,n._)([(0,c.Cb)()],Et.prototype,"view",void 0),(0,n._)([(0,c.Cb)()],Et.prototype,"interaction",void 0),(0,n._)([(0,c.Cb)()],Et.prototype,"editable",void 0),(0,n._)([(0,c.Cb)()],Et.prototype,"visible",void 0),(0,n._)([(0,c.Cb)()],Et.prototype,"highlightEnabled",void 0),Et=(0,n._)([(0,h.j)("esri.widgets.ElevationProfile.ElevationProfileTool")],Et);let bt=class extends S.default{constructor(e){super(e),this.view=null,this.input=null,this._getEffectiveUnitsMemoized=(0,o.H)(((e,t)=>({distance:e,elevation:t}))),this.hoveredChartPosition=null,this.uniformChartScaling=!1,this.defaultUnit=null,this.queue=null,this._currentTileCache=null,this.error=null,this._defaultProfileLineGround=new Ze,this._userUnitOptions=null,this._userUnit=null,(null===e||void 0===e?void 0:e.profiles)||(this.profiles=new O.Z([this._defaultProfileLineGround]))}initialize(){this.addHandles((0,l.watch)((()=>this.view),(e=>{var t;if(null==e)return void u.Z.getLogger(this).warnOnce("no view. Widget will be disabled until a view is provided.");this.removeHandles(Ct);const i="3d"===e.type?e.resourceController:void 0;null!==(t=this.queue)&&void 0!==t&&t.destroy(),this.queue=ye(null===i||void 0===i?void 0:i.scheduler);const n=null===i||void 0===i?void 0:i.addUpdatingObject(this);n&&this.addHandles(n,Ct)}),l.syncAndInitial)),this.tool=new Et({viewModel:this}),this._controller=new Pe({viewModel:this})}destroy(){this._defaultProfileLineGround=(0,r.SC)(this._defaultProfileLineGround),this._controller=(0,r.SC)(this._controller),this._currentTileCache=(0,r.SC)(this._currentTileCache),this.tool=(0,r.SC)(this.tool),this.queue=(0,r.SC)(this.queue)}get profiles(){return this._get("profiles")}set profiles(e){const t=this._get("profiles"),i=null!==e&&void 0!==e?e:new O.Z;this._set("profiles",(0,R.Z)(i,t))}get state(){const e=this.view;return null!=e&&e.ready?this.tool.state:U.dd.Disabled}get progress(){let e=0,t=0;for(const i of this.visibleProfiles)e++,t+=i.progress;return e>0?t/e:0}set unitOptions(e){this._userUnitOptions=e,this._set("unitOptions",this._filteredOrAllUnits(this._userUnitOptions))}get unitOptions(){return this._filteredOrAllUnits(this._userUnitOptions)}set unit(e){this._userUnit=e?this._findSelectableUnit(e,this._userUnit):null,this.notifyChange("unit")}get unit(){return this._userUnit?(this._userUnit=this._findSelectableUnit(this._userUnit,this.defaultUnit),this._userUnit):this._findSelectableUnit(this.defaultUnit)}get effectiveUnits(){const e=function(e){var t,i,n;let s=null,r=null,o=null;for(const a of e){if(null==a)continue;const{statistics:e,spatialReference:t}=a;if(null==e)continue;const i=(0,A.c9)(t);s=ge(s,me(e.maxDistance,i));const n=(0,A._R)(t);o=ve(o,me(e.minElevation,n)),r=ge(r,me(e.maxElevation,n))}return{minDistance:0,maxDistance:null!==(t=s)&&void 0!==t?t:0,minElevation:null!==(i=o)&&void 0!==i?i:0,maxElevation:null!==(n=r)&&void 0!==n?n:0}}(this.visibleProfiles.map((e=>e.result))),t=(0,A.wd)(e.maxDistance,"meters",this.unit),i=(0,A.yv)(e.maxElevation,"meters",this.unit);return this._getEffectiveUnitsMemoized(t,i)}get geodesicDistanceThreshold(){return this._get("geodesicDistanceThreshold")}set geodesicDistanceThreshold(e){(0,w.Mr)(u.Z.getLogger(this),"geodesicDistanceThreshold",{version:"4.29",warnOnce:!0}),this._set("geodesicDistanceThreshold",e)}get highlightEnabled(){return this.tool.highlightEnabled}set highlightEnabled(e){this.tool.highlightEnabled=e}get hasVertices(){var e;const t=null===(e=this.input)||void 0===e?void 0:e.geometry;return $(t)&&t.paths.reduce(((e,t)=>e+t.length),0)>0}get hoveredPoints(){return null!=this.input&&this.visible&&this.tool.editable?this.visibleProfiles.map((e=>{const t=e.hoveredPoint;return null!=t?{hoveredPoint:t,color:e.color}:null})).filter(T.pC):[]}get statistics(){return function(e){const t=e.filter(T.pC),i=t.length;if(0===i)return null;const n=t[0];if(1===i)return n;let s=n.maxDistance,r=n.minElevation,o=n.maxElevation,a=n.maxPositiveSlope,l=n.maxNegativeSlope;for(let c=1;c<t.length;++c){const e=t[c];s=ge(s,e.maxDistance),r=ve(r,e.minElevation),o=ge(o,e.maxElevation),a=ge(a,e.maxPositiveSlope),l=ge(l,e.maxNegativeSlope)}return{maxDistance:s,minElevation:r,maxElevation:o,avgElevation:null,elevationGain:null,elevationLoss:null,maxPositiveSlope:a,maxNegativeSlope:l,avgPositiveSlope:null,avgNegativeSlope:null}}(this.visibleProfiles.map((e=>e.statistics)))}get chartData(){if(null==this.input)return null;const{effectiveUnits:e,progress:t,statistics:i,visibleProfiles:n,uniformChartScaling:s}=this,r=n.filter((e=>e.hasZ)).map((e=>({id:e.id,type:e.type,title:e.title,color:e.color,samples:e.samples,progress:e.progress,chartFillEnabled:e.chartFillEnabled,chartStrokeWidth:e.chartStrokeWidth,chartStrokeOffsetY:e.chartStrokeOffsetY,viewVisualizationEnabled:e.viewVisualizationEnabled})));return 0===r.length?null:{lines:r,effectiveUnits:e,statistics:i,refined:1===t,dynamicElevationRange:n.some((e=>"view"===e.type)),uniformScaling:s}}get visibleProfiles(){return this.profiles.toArray().filter((e=>e.available&&e.visible))}get minDemResolutions(){const e=[];for(const{minDemResolution:t}of this.visibleProfiles)null!=t&&e.push(t);return e}get minDemResolution(){return(0,T.VV)(this.minDemResolutions)}get errorState(){var e;if(!K(null===(e=this.input)||void 0===e?void 0:e.geometry))return U.J8.NoValidInput;if(null!=this.error){if(function(e){return e.type===z}(this.error))switch(this.error.cause){case W.TooComplex:return U.J8.TooComplex;case W.InvalidGeometry:return U.J8.InvalidGeometry;case W.InvalidElevationInfo:return U.J8.InvalidElevationInfo;case W.ElevationQueryError:return U.J8.NoValidInput}return U.J8.UnknownError}return 0===this.visibleProfiles.length?U.J8.NoVisibleProfiles:null==this.chartData&&1===this.progress?U.J8.RefinedButNoChartData:U.J8.None}get tileCache(){this._currentTileCache=(0,r.SC)(this._currentTileCache);const e=this.view;if(null!=e&&"3d"===(null===e||void 0===e?void 0:e.type)){var t;const i=null===(t=e.basemapTerrain)||void 0===t?void 0:t.elevationQueryCache;if(null!=i)return i}return null==this._currentTileCache&&(this._currentTileCache=new L.b(new P.z(20*I.Y.MEGABYTES))),this._currentTileCache}get visible(){return this.tool.visible}set visible(e){this.tool.visible=e}get inputIsSketched(){return this.tool.interaction.isSketchedGraphic(this.input)}get elevationProvider(){const e=this.view;return null!=e&&"3d"===e.type?e.elevationProvider:null}get updating(){var e;const{progress:t}=this,i=!(null===(e=this.queue)||void 0===e||!e.updating);return t>0&&t<1||i}start(e){this.tool.interaction.start(e)}stop(){this.tool.interaction.stop()}cancel(){this.tool.interaction.cancel()}clear(){this.tool.interaction.clear()}_findSelectableUnit(e,t){const i=this.unitOptions;return null!=e&&i.includes(e)?e:t?this._findSelectableUnit(t):i[0]}_filteredOrAllUnits(e){const t=(null!=e?e:[]).filter((e=>A.oD.includes(e)));return 0===t.length?A.oD.slice():t}};(0,n._)([(0,c.Cb)()],bt.prototype,"view",void 0),(0,n._)([(0,c.Cb)({type:y.Z})],bt.prototype,"input",void 0),(0,n._)([(0,c.Cb)({type:at,nonNullable:!0})],bt.prototype,"profiles",null),(0,n._)([(0,c.Cb)({readOnly:!0})],bt.prototype,"state",null),(0,n._)([(0,c.Cb)({readOnly:!0})],bt.prototype,"progress",null),(0,n._)([(0,c.Cb)()],bt.prototype,"unitOptions",null),(0,n._)([(0,c.Cb)()],bt.prototype,"unit",null),(0,n._)([(0,c.Cb)({readOnly:!0})],bt.prototype,"effectiveUnits",null),(0,n._)([(0,c.Cb)()],bt.prototype,"geodesicDistanceThreshold",null),(0,n._)([(0,c.Cb)()],bt.prototype,"hoveredChartPosition",void 0),(0,n._)([(0,c.Cb)()],bt.prototype,"uniformChartScaling",void 0),(0,n._)([(0,c.Cb)()],bt.prototype,"highlightEnabled",null),(0,n._)([(0,c.Cb)({readOnly:!0})],bt.prototype,"hoveredPoints",null),(0,n._)([(0,c.Cb)({readOnly:!0})],bt.prototype,"statistics",null),(0,n._)([(0,c.Cb)()],bt.prototype,"chartData",null),(0,n._)([(0,c.Cb)()],bt.prototype,"visibleProfiles",null),(0,n._)([(0,c.Cb)()],bt.prototype,"minDemResolutions",null),(0,n._)([(0,c.Cb)({readOnly:!0})],bt.prototype,"minDemResolution",null),(0,n._)([(0,c.Cb)({readOnly:!0})],bt.prototype,"errorState",null),(0,n._)([(0,c.Cb)(k.Y)],bt.prototype,"defaultUnit",void 0),(0,n._)([(0,c.Cb)()],bt.prototype,"queue",void 0),(0,n._)([(0,c.Cb)()],bt.prototype,"tileCache",null),(0,n._)([(0,c.Cb)()],bt.prototype,"tool",void 0),(0,n._)([(0,c.Cb)()],bt.prototype,"visible",null),(0,n._)([(0,c.Cb)()],bt.prototype,"error",void 0),(0,n._)([(0,c.Cb)()],bt.prototype,"inputIsSketched",null),(0,n._)([(0,c.Cb)()],bt.prototype,"elevationProvider",null),(0,n._)([(0,c.Cb)()],bt.prototype,"updating",null),(0,n._)([(0,c.Cb)()],bt.prototype,"_defaultProfileLineGround",void 0),(0,n._)([(0,c.Cb)()],bt.prototype,"_userUnitOptions",void 0),(0,n._)([(0,c.Cb)()],bt.prototype,"_controller",void 0),(0,n._)([(0,c.Cb)()],bt.prototype,"_userUnit",void 0),bt=(0,n._)([(0,h.j)("esri.widgets.ElevationProfile.ElevationProfileViewModel")],bt);const Ct=Symbol("updating-object"),yt=bt;let St=class extends S.default{constructor(){super(...arguments),this.legend=!0,this.chart=!0,this.clearButton=!0,this.settingsButton=!0,this.sketchButton=!0,this.selectButton=!0,this.unitSelector=!0,this.uniformChartScalingToggle=!0}};(0,n._)([(0,c.Cb)()],St.prototype,"legend",void 0),(0,n._)([(0,c.Cb)()],St.prototype,"chart",void 0),(0,n._)([(0,c.Cb)()],St.prototype,"clearButton",void 0),(0,n._)([(0,c.Cb)()],St.prototype,"settingsButton",void 0),(0,n._)([(0,c.Cb)()],St.prototype,"sketchButton",void 0),(0,n._)([(0,c.Cb)()],St.prototype,"selectButton",void 0),(0,n._)([(0,c.Cb)()],St.prototype,"unitSelector",void 0),(0,n._)([(0,c.Cb)()],St.prototype,"uniformChartScalingToggle",void 0),St=(0,n._)([(0,h.j)("esri.widgets.ElevationProfile.ElevationProfileVisibleElements")],St);const Tt=St;i(59166);var It=i(5163),Ot=i(8905),Rt=i(80975),wt=i(80532),Pt=i(67005);let At=class extends d.Z{constructor(e,t){super(e,t),this._updateLayout=e=>{const t=e.parentElement,i=e.style.display;null!==t&&void 0!==t&&t.removeChild(e),document.body.appendChild(e),e.style.display="block";let n=80;for(const s of e.childNodes)s instanceof HTMLElement&&(n=Math.max(n,s.offsetWidth));document.body.removeChild(e),null!==t&&void 0!==t&&t.appendChild(e),e.style.display=i,e.style.setProperty("--max-width","".concat(n,"px"))},this._updateLayoutThrottled=(0,N.P)(this._updateLayout,100)}loadDependencies(){return(0,Ot.h)({icon:()=>Promise.all([i.e(92358),i.e(87474)]).then(i.bind(i,87474))})}initialize(){this.addHandles(this._updateLayoutThrottled)}render(){return(0,Pt.u)("div",{afterCreate:this._updateLayout,afterUpdate:this._updateLayoutThrottled,bind:this,class:E.base},this._renderStatistics())}_renderStatistics(){var e;const t=null===(e=this._messages)||void 0===e?void 0:e.statistics;return t?[this._renderDistanceStatistic("maxDistance",t.maxDistance),this._renderElevationStatistic("elevationGain",t.gain),this._renderElevationStatistic("elevationLoss",t.loss),this._renderElevationStatistic("minElevation",t.minElevation),this._renderElevationStatistic("maxElevation",t.maxElevation),this._renderElevationStatistic("avgElevation",t.avgElevation),this._renderSlopeStatistic("maxPositiveSlope","maxNegativeSlope",t.maxSlope),this._renderSlopeStatistic("avgPositiveSlope","avgNegativeSlope",t.avgSlope)]:[]}_renderDistanceStatistic(e,t){const i=(0,U.iE)().formatPrecision,n=this._renderValue(e,(e=>{const t=this.effectiveUnits.distance;return(0,It.VG)(this._messagesUnits,e,t,i)}));return this._renderStatistic(t,n)}_renderElevationStatistic(e,t){const i=(0,U.iE)().formatPrecision,n=this._renderValue(e,(e=>{const t=this.effectiveUnits.elevation;return(0,It.VG)(this._messagesUnits,e,t,i)}));return this._renderStatistic(t,n)}_renderSlopeStatistic(e,t,i){const n=(0,U.iE)().formatPrecision,s=(0,Pt.u)("div",{class:E.slopeValue,key:"slope-up"},(0,Pt.u)("calcite-icon",{icon:"arrow-up",scale:"s"}),this._renderValue(e,(e=>(0,It.L4)(e,"degrees","geographic","geographic",n))),(0,Pt.u)("calcite-icon",{icon:"arrow-down",scale:"s"}),this._renderValue(t,(e=>(0,It.L4)(e,"degrees","geographic","geographic",n))));return this._renderStatistic(i,s)}_renderStatistic(e,t){return(0,Pt.u)("div",{class:E.statistic},(0,Pt.u)("label",{class:E.statisticLabel},e),(0,Pt.u)("div",{class:E.statisticValue},t))}_renderValue(e,t){const i=this.line,n=1===i.progress?i.statistics:null,s=null===n||void 0===n?void 0:n[e];return null!=s?t(s):U.h8}};(0,n._)([(0,c.Cb)()],At.prototype,"effectiveUnits",void 0),(0,n._)([(0,c.Cb)()],At.prototype,"line",void 0),(0,n._)([(0,c.Cb)(),(0,wt.H)("esri/widgets/ElevationProfile/t9n/ElevationProfile")],At.prototype,"_messages",void 0),(0,n._)([(0,c.Cb)(),(0,wt.H)("esri/core/t9n/Units")],At.prototype,"_messagesUnits",void 0),At=(0,n._)([(0,h.j)("esri.widgets.ElevationProfile.components.Statistics")],At);var Lt=i(47732),kt=i(8704);let Dt=class extends d.Z{constructor(e,t){super(e,t),this.checkboxVisible=!0,this.expanded=!1}loadDependencies(){return(0,Ot.h)({action:()=>Promise.all([i.e(92358),i.e(46895),i.e(65138),i.e(91741)]).then(i.bind(i,6814)),checkbox:()=>Promise.all([i.e(92358),i.e(54438),i.e(12424)]).then(i.bind(i,12424)),label:()=>Promise.all([i.e(92358),i.e(35738)]).then(i.bind(i,35738)),tooltip:()=>Promise.all([i.e(92358),i.e(89219),i.e(94730)]).then(i.bind(i,94730))})}initialize(){this._statistics=new At(this._statisticsProps),this.addHandles((0,l.watch)((()=>this._statisticsProps),(e=>this._statistics.set(e))))}destroy(){this._statistics=(0,r.SC)(this._statistics)}render(){const e=this.expanded;return(0,Pt.u)("div",{class:this.classes(m.base,{[m.disabled]:this.disabled,[m.expanded]:e}),key:this},this._renderColorIndicator(),(0,Pt.u)("div",{class:m.header,key:"header"},this._renderLabelWithCheckbox(),this._renderCollapseToggleButton()),e?(0,Pt.u)("div",{class:m.content,key:"content"},this._statistics.render()):null)}get disabled(){return!this.line.available}get _statisticsProps(){return{line:this.line,effectiveUnits:this.effectiveUnits}}_renderColorIndicator(){return(0,Pt.u)("div",{class:m.colorIndicator,key:"color-indicator",styles:{backgroundColor:this.line.color.toCss()}})}_renderCollapseToggleButton(){const{expanded:e,messages:t}=this,i=e?t.hideDetails:t.showDetails;return(0,Pt.u)("calcite-action",{appearance:"transparent",bind:this,class:m.collapseToggle,"data-testid":"legend-toggle",icon:e?"chevron-up":"chevron-down",key:"collapse-toggle",onclick:this._onCollapseToggleClick,scale:"s",text:i,title:i})}_onCollapseToggleClick(){this.onExpandedToggle()}_renderLabelWithCheckbox(){const{line:e,checkboxVisible:t,disabled:i,messages:n}=this,s="label-".concat(e.id);return(0,Pt.u)("calcite-label",{class:m.label,disabled:i,key:s,layout:"inline"},t?this._renderCheckbox(e.id):null,(0,Lt.f)(e,n))}_renderCheckbox(e){const{disabled:t,line:i,messages:n}=this,s=i.visible,r="".concat(e,"-checkbox"),o=s?n.hideProfile:n.showProfile,a=(0,kt.n)(o,{name:(0,Lt.f)(i,n)});return(0,Pt.u)(Pt.D,null,(0,Pt.u)("calcite-checkbox",{checked:s,class:m.checkbox,disabled:t,id:r,key:"checkbox",onCalciteCheckboxChange:()=>i.toggleVisibility()}),(0,Pt.u)("calcite-tooltip",{overlayPositioning:"fixed",placement:"top",referenceElement:r},a))}};(0,n._)([(0,c.Cb)()],Dt.prototype,"checkboxVisible",void 0),(0,n._)([(0,c.Cb)()],Dt.prototype,"disabled",null),(0,n._)([(0,c.Cb)({nonNullable:!0})],Dt.prototype,"effectiveUnits",void 0),(0,n._)([(0,c.Cb)()],Dt.prototype,"expanded",void 0),(0,n._)([(0,c.Cb)({nonNullable:!0})],Dt.prototype,"line",void 0),(0,n._)([(0,c.Cb)()],Dt.prototype,"messages",void 0),(0,n._)([(0,c.Cb)()],Dt.prototype,"onExpandedToggle",void 0),(0,n._)([(0,c.Cb)()],Dt.prototype,"_statistics",void 0),Dt=(0,n._)([(0,h.j)("esri.widgets.ElevationProfile.components.LegendItem")],Dt);let Nt=class extends d.Z{constructor(){super(...arguments),this._expandedLine=null}render(){const{profiles:e,messages:t,effectiveUnits:i,_expandedLine:n}=this;return(0,Pt.u)("div",{class:v},e.map((s=>(0,Pt.u)(Dt,{checkboxVisible:e.length>1,effectiveUnits:i,expanded:s===n,line:s,messages:t,onExpandedToggle:()=>this._onExpandedToggle(s)}))))}_onExpandedToggle(e){this._expandedLine=e===this._expandedLine?null:e}};(0,n._)([(0,c.Cb)()],Nt.prototype,"effectiveUnits",void 0),(0,n._)([(0,c.Cb)()],Nt.prototype,"messages",void 0),(0,n._)([(0,c.Cb)()],Nt.prototype,"profiles",void 0),(0,n._)([(0,c.Cb)()],Nt.prototype,"_expandedLine",void 0),Nt=(0,n._)([(0,h.j)("esri.widgets.ElevationProfile.components.Legend")],Nt);var Mt=i(10498);let Ut=class extends d.Z{constructor(){super(...arguments),this.messages=null,this._popover=null,this._popoverIsOpen=!1,this._onPopoverAfterCreate=e=>{this._popover=e},this._onUniformChartScalingChange=e=>{this.onUniformChartScalingChange(e.target.checked)}}loadDependencies(){return(0,Ot.h)({action:()=>Promise.all([i.e(92358),i.e(46895),i.e(65138),i.e(91741)]).then(i.bind(i,6814)),checkbox:()=>Promise.all([i.e(92358),i.e(54438),i.e(12424)]).then(i.bind(i,12424)),label:()=>Promise.all([i.e(92358),i.e(35738)]).then(i.bind(i,35738)),popover:()=>Promise.all([i.e(92358),i.e(46895),i.e(89219),i.e(63839),i.e(65138),i.e(2654),i.e(447)]).then(i.bind(i,61580)),tooltip:()=>Promise.all([i.e(92358),i.e(89219),i.e(94730)]).then(i.bind(i,94730))})}initialize(){const e=()=>this._popover;this.addHandles([(0,l.on)(e,"calcitePopoverOpen",(()=>this._popoverIsOpen=!0)),(0,l.on)(e,"calcitePopoverClose",(()=>this._popoverIsOpen=!1))])}render(){const{id:e,messages:t,visibleElements:i}=this,{unitSelector:n,uniformChartScalingToggle:s}=i;if(!t||!n&&!s)return(0,Pt.u)("div",{key:"".concat(e,"-empty")});const r="".concat(e,"__action"),o=this._popoverIsOpen?t.hideSettings:t.showSettings;return(0,Pt.u)("div",{class:C.base,key:this},(0,Pt.u)("calcite-popover",{afterCreate:this._onPopoverAfterCreate,autoClose:!0,label:o,overlayPositioning:"fixed",placement:"bottom-end",referenceElement:r},this._renderPopoverContent()),(0,Pt.u)("calcite-action",{appearance:"transparent","data-testid":"settings-button",icon:"gear",id:r,scale:"s",text:o,title:o}))}_renderPopoverContent(){const{unitSelector:e,uniformChartScalingToggle:t}=this.visibleElements;return(0,Pt.u)("div",{class:C.popoverContent},e?this._renderUnitSelector():null,t?this._renderUniformChartScalingToggle():null)}_renderUnitSelector(){var e;const{messages:t}=this;return(0,Pt.u)(Mt.m,{key:"unit-selector-label",options:this.unitOptions,selectLabel:null!==(e=null===t||void 0===t?void 0:t.unitSelectLabel)&&void 0!==e?e:"",value:this.unit,onChange:this.onUnitChange})}_renderUniformChartScalingToggle(){var e;const{messages:t}=this,i=this.uniformChartScaling,n="".concat(this.id,"__uniform-chart-scaling-toggle"),s=null!==(e=null===t||void 0===t?void 0:t[i?"uniformChartScalingDisable":"uniformChartScalingEnable"])&&void 0!==e?e:"";return(0,Pt.u)("calcite-label",{class:C.uniformChartScalingLabel,key:"uniform-chart-scaling-label",layout:"inline"},(0,Pt.u)("calcite-checkbox",{checked:i,class:C.uniformChartScalingCheckbox,id:n,onCalciteCheckboxChange:this._onUniformChartScalingChange}),(0,Pt.u)("calcite-tooltip",{overlayPositioning:"fixed",referenceElement:n},s),null===t||void 0===t?void 0:t.uniformChartScalingLabel)}};(0,n._)([(0,c.Cb)()],Ut.prototype,"messages",void 0),(0,n._)([(0,c.Cb)()],Ut.prototype,"onUniformChartScalingChange",void 0),(0,n._)([(0,c.Cb)()],Ut.prototype,"onUnitChange",void 0),(0,n._)([(0,c.Cb)()],Ut.prototype,"uniformChartScaling",void 0),(0,n._)([(0,c.Cb)()],Ut.prototype,"unit",void 0),(0,n._)([(0,c.Cb)()],Ut.prototype,"unitOptions",void 0),(0,n._)([(0,c.Cb)()],Ut.prototype,"visibleElements",void 0),(0,n._)([(0,c.Cb)()],Ut.prototype,"_popover",void 0),(0,n._)([(0,c.Cb)()],Ut.prototype,"_popoverIsOpen",void 0),Ut=(0,n._)([(0,h.j)("esri.widgets.ElevationProfile.components.SettingsButton")],Ut);var xt,Ft=i(7021);!function(e){e.Sketch="sketch",e.SketchCancel="sketch-cancel",e.SketchDone="sketch-done",e.Select="select",e.SelectCancel="select-cancel"}(xt||(xt={}));const Vt=[{type:xt.Select},{type:xt.Sketch}],Bt={[U.J8.None]:null,[U.J8.NoValidInput]:"noProfile",[U.J8.NoVisibleProfiles]:"noProfile",[U.J8.RefinedButNoChartData]:"noProfile",[U.J8.TooComplex]:"tooComplex",[U.J8.UnknownError]:"unknown",[U.J8.InvalidGeometry]:"invalidGeometry",[U.J8.InvalidElevationInfo]:"invalidElevationInfo"},Ht=Symbol("resize-observer-handle");let Gt=class extends d.Z{constructor(e,t){super(e,t),this.viewModel=null,this.visibleElements=new Tt,this.messages=null,this.messagesCommon=null,this.messagesUnits=null,this._contentWrapper=null,this._chartContainer=null,this._chart=null,this._chartInitTask=null,this._chartIsRefined=!1,this._width=0,this._zoomOutButtonVisible=!1,this._getChartUpdateParamsMemoized=(0,o.H)(((e,t,i,n)=>({chart:e,data:t,stationary:i,messages:n}))),this._onZoomOutButtonClick=()=>{var e;null===(e=this._chart)||void 0===e||e.zoomOut()},this._onClearButtonClick=()=>{this.viewModel.clear()},(null===e||void 0===e?void 0:e.viewModel)||(this._defaultViewModel=new yt({view:null===e||void 0===e?void 0:e.view}),this.viewModel=this._defaultViewModel)}loadDependencies(){return(0,Ot.h)({action:()=>Promise.all([i.e(92358),i.e(46895),i.e(65138),i.e(91741)]).then(i.bind(i,6814)),button:()=>Promise.all([i.e(92358),i.e(46895),i.e(54438),i.e(14105),i.e(32275)]).then(i.bind(i,32275)),loader:()=>i.e(92382).then(i.bind(i,92382))})}postInitialize(){this.addHandles([(0,l.watch)((()=>({container:this._chartContainer,width:this._width})),(e=>{let{container:t,width:i}=e;this._destroyChart(),null!=t&&i>0&&this._initializeChart(t)}),l.initial),(0,l.watch)((()=>this._chartUpdateParams),(()=>this._updateChart(this._chartUpdateParams)),l.initial)])}destroy(){this._destroyChart(),null!=this._defaultViewModel&&this.viewModel!==this._defaultViewModel&&this._defaultViewModel.destroy()}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}get input(){return this.viewModel.input}set input(e){this.viewModel.input=e}get profiles(){return this.viewModel.profiles}set profiles(e){this.viewModel.profiles=e}get unitOptions(){return this.viewModel.unitOptions}set unitOptions(e){this.viewModel.unitOptions=e}get unit(){return this.viewModel.unit}set unit(e){this.viewModel.unit=e}get geodesicDistanceThreshold(){return this.viewModel.geodesicDistanceThreshold}set geodesicDistanceThreshold(e){this.viewModel.geodesicDistanceThreshold=e}get icon(){return"altitude"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e,t;return null!==(e=null===(t=this.messages)||void 0===t?void 0:t.widgetLabel)&&void 0!==e?e:""}set label(e){this._overrideIfSome("label",e)}get visible(){return this.viewModel.visible}set visible(e){this.viewModel.visible=e}get _portrait(){return this._width<(0,U.iE)().portraitModePixelBreakpoint}get _chartUpdateParams(){const e=this.view;return this._getChartUpdateParamsMemoized(this._chart,this.viewModel.chartData,null==e||e.stationary,this._chartMessages)}get _chartMessages(){return{...this.messagesUnits,...this.messages}}get _profilesArray(){return this.profiles.toArray()}render(){const{viewModel:e,visible:t}=this;return(0,Pt.u)("div",{"aria-label":this.messages.widgetLabel,class:this.classes({[_.base]:t,[Ft.z.widget]:t,[Ft.z.panel]:t,[Ft.z.widgetDisabled]:t&&"disabled"===e.state,[_.portrait]:this._portrait,[_.refined]:1===e.progress}),key:this},(0,Pt.u)("div",{afterCreate:this._onContentWrapperUpdate,afterRemoved:this._onContentWrapperRemoved,afterUpdate:this._onContentWrapperUpdate,bind:this,key:"content-wrapper"},t?this._renderContentForState():null))}_renderContentForState(){switch(this.viewModel.state){case U.dd.Ready:return this._renderContentForReadyState();case U.dd.Selecting:return this._renderContentForSelectingState();case U.dd.Creating:return this._renderContentForCreatingState();case U.dd.Selected:return this._renderContentForSelectedState();case U.dd.Created:return this._renderContentForCreatedState();case U.dd.Disabled:return this._renderContentForReadyState()}}_renderContentForReadyState(){var e;const{sketchButton:t,selectButton:i}=this.visibleElements,n=this.messages;let s;return s=t&&i?n.readyPrompt:t?n.readyPromptCreateOnly:i?n.readyPromptSelectOnly:null===(e=n.errors)||void 0===e?void 0:e.noProfile,this._renderContent({prompt:s,chart:!1,actions:Vt})}_renderContentForSelectingState(){const e=this.view;if(null==e)return null;const t=this.messages["selectingPrompt-".concat(e.type)];return this._renderContent({prompt:t,chart:!1,actions:[{type:xt.SelectCancel}]})}_renderContentForCreatingState(){const{view:e,viewModel:t}=this;if(null==e)return null;const i=t.hasVertices?[{type:xt.SketchCancel},{type:xt.SketchDone,disabled:!t.tool.interaction.canStopCreating}]:[{type:xt.Select},{type:xt.Sketch,disabled:!0}];if(t.errorState===U.J8.NoValidInput){const t=this.messages["creatingPrompt-".concat(e.type)];return this._renderContent({chart:!1,actions:i,prompt:t})}const n=this._getErrorMessage();return n?this._renderContent({chart:!1,actions:i,prompt:n}):this._renderContent({chart:!0,actions:i})}_renderContentForSelectedState(){const e=this._getErrorMessage();return e?this._renderContent({chart:!1,actions:Vt,prompt:e}):this._renderContent({chart:!0,actions:Vt})}_renderContentForCreatedState(){const e=this._getErrorMessage();return e?this._renderContent({chart:!1,actions:Vt,prompt:e}):this._renderContent({chart:!0,actions:Vt})}_getErrorMessage(){var e;const t=Bt[this.viewModel.errorState];return t?null===(e=this.messages)||void 0===e||null===(e=e.errors)||void 0===e?void 0:e[t]:null}_renderContent(e){const t=null!=e.prompt?this._renderPrompt(e.prompt):e.chart&&this._renderChart(),{viewModel:i}=this,n=null!=i.input;return(0,Pt.u)(Pt.D,null,(0,Pt.u)("header",{class:_.header,key:"header"},this._zoomOutButtonVisible?this._renderZoomOutButton():null,this.visibleElements.clearButton&&n?this._renderClearButton():null,this.visibleElements.settingsButton?(0,Pt.u)(Ut,{messages:this.messages,uniformChartScaling:i.uniformChartScaling,unit:i.unit,unitOptions:i.unitOptions,visibleElements:this.visibleElements,onUniformChartScalingChange:e=>i.uniformChartScaling=e,onUnitChange:e=>i.unit=e}):null),(0,Pt.u)("div",{class:_.mainContainer,key:"main-container"},t),this.visibleElements.legend?(0,Pt.u)(Nt,{effectiveUnits:i.effectiveUnits,messages:this.messages,profiles:this._profilesArray}):null,this._renderActions(e))}_renderZoomOutButton(){const e=this.messages.zoomOut;return(0,Pt.u)("calcite-action",{appearance:"transparent",class:_.zoomOutButton,"data-testid":"zoom-out-button",icon:"magnifying-glass-minus",key:"zoom-out",onclick:this._onZoomOutButtonClick,scale:"s",text:e,title:e})}_renderClearButton(){const e=this.messages.clearProfile;return(0,Pt.u)("calcite-action",{appearance:"transparent",class:_.clearButton,"data-testid":"clear-button",icon:"trash",key:"clear-profile",onclick:this._onClearButtonClick,scale:"s",text:e,title:e})}_renderPrompt(e){return[(0,Pt.u)("div",{bind:this,class:_.promptContainer,key:"prompt-container"},(0,Pt.u)("p",null,e))]}_renderChart(){if(!this.visibleElements.chart)return(0,Pt.u)("div",{class:_.chartContainer,key:"empty-chart-container"});const{chartData:e,progress:t}=this.viewModel,i=this._chartIsRefined||this._canRenderChart(),n=null!=e&&t<1;return i?(0,Pt.u)(Pt.D,null,this._renderSpinner({size:i?"small":"large",visible:n}),(0,Pt.u)("div",{afterCreate:this._onChartContainerUpdate,afterRemoved:this._onChartContainerRemoved,afterUpdate:this._onChartContainerUpdate,bind:this,class:_.chartContainer,key:"chart-container"})):(0,Pt.u)(Pt.D,null,this._renderSpinner({size:"large",visible:n}),(0,Pt.u)("div",{class:_.chartContainer,key:"chart-container-empty"}))}_renderSpinner(e){var t;const i="small"===e.size,n=null===(t=e.visible)||void 0===t||t;return(0,Pt.u)("calcite-loader",{class:this.classes(_.chartSpinner,i&&_.chartSpinnerSmall,n&&_.chartSpinnerVisible),inline:i,key:"spinner",label:"",scale:"s"})}_canRenderChart(){const e=this.viewModel.chartData;if(null==e)return!1;if(!this.viewModel.inputIsSketched)return e.refined;let t=0;for(const{samples:i}of e.lines)t+=null!=i?i.length:0;return e.refined||t<=(0,U.iE)().largeChartSamples}_renderActions(e){let{actions:t}=e;const i=t.map((e=>{switch(e.type){case xt.Sketch:return this.visibleElements.sketchButton&&this._renderAction({action:e,className:_.sketchButton,label:this.messages.sketchButtonLabel,onClick:this._onSketchButtonClick,primary:!0});case xt.SketchCancel:return this.visibleElements.sketchButton&&this._renderAction({action:e,onClick:this._onCancelButtonClick,className:_.sketchCancelButton,label:this.messagesCommon.cancel,primary:!1});case xt.SketchDone:return this.visibleElements.sketchButton&&this._renderAction({action:e,onClick:this._onDoneButtonClick,className:_.sketchDoneButton,label:this.messagesCommon.done,primary:!0});case xt.Select:return this.visibleElements.selectButton&&this._renderAction({action:e,onClick:this._onSelectButtonClick,className:_.selectButton,label:this.messages.selectButtonLabel,primary:!1});case xt.SelectCancel:return this.visibleElements.selectButton&&this._renderAction({action:e,onClick:this._onCancelButtonClick,className:_.selectCancelButton,label:this.messagesCommon.cancel,primary:!1})}})).filter(Boolean);return i.length?(0,Pt.u)("footer",{class:_.footer,key:"footer"},i):null}_renderAction(e){let{action:t,className:i,label:n,onClick:s,primary:r}=e;return(0,Pt.u)("calcite-button",{appearance:r?"solid":"outline-fill",bind:this,class:this.classes(_.actionButton,i),disabled:t.disabled,key:"action-".concat(t.type),onclick:s},n)}_onSketchButtonClick(){this.viewModel.start({mode:"sketch"})}_onSelectButtonClick(){this.viewModel.start({mode:"select"})}_onCancelButtonClick(){this.viewModel.cancel()}_onDoneButtonClick(){this.viewModel.stop()}_onContentWrapperUpdate(e){e!==this._contentWrapper&&(this._contentWrapper=e,this.removeHandles(Ht),this.addHandles((0,Rt.ib)(e,(e=>{this._width=e.contentRect.width})),Ht))}_onContentWrapperRemoved(){this.removeHandles(Ht),this._contentWrapper=null}_updateChart(e){const{data:t,chart:i,messages:n,stationary:s}=e;null!=i&&null!=n&&s&&this._canRenderChart()&&(i.update(e),this._chartIsRefined=null!=t&&t.refined)}_onChartContainerUpdate(e){this._chartContainer=e}_onChartContainerRemoved(){this._chartContainer=null}_initializeChart(e){(0,r.IM)(this._chartInitTask),this._chartInitTask=(0,s.vr)((async t=>{const{createChart:n}=await Promise.all([i.e(24390),i.e(15245),i.e(24489),i.e(49596),i.e(25059)]).then(i.bind(i,25059));(0,a.k_)(t);const s=await n({container:e,abortOptions:{signal:t},onRangeChange:(e,t)=>{this._zoomOutButtonVisible=1!==e||1!==t},onCursorPositionChange:e=>{this.viewModel.hoveredChartPosition=e}});if(t.aborted)throw(0,r.SC)(s),(0,a.zE)();this._chart=s,this._updateChart(this._chartUpdateParams)}))}_destroyChart(){this._chartInitTask=(0,r.IM)(this._chartInitTask),this._chart=(0,r.SC)(this._chart),this._chartIsRefined=!1}};(0,n._)([(0,c.Cb)({type:yt})],Gt.prototype,"viewModel",void 0),(0,n._)([(0,c.Cb)()],Gt.prototype,"view",null),(0,n._)([(0,c.Cb)()],Gt.prototype,"input",null),(0,n._)([(0,c.Cb)()],Gt.prototype,"profiles",null),(0,n._)([(0,c.Cb)()],Gt.prototype,"unitOptions",null),(0,n._)([(0,c.Cb)()],Gt.prototype,"unit",null),(0,n._)([(0,c.Cb)()],Gt.prototype,"geodesicDistanceThreshold",null),(0,n._)([(0,c.Cb)({type:Tt,nonNullable:!0})],Gt.prototype,"visibleElements",void 0),(0,n._)([(0,c.Cb)()],Gt.prototype,"icon",null),(0,n._)([(0,c.Cb)()],Gt.prototype,"label",null),(0,n._)([(0,c.Cb)()],Gt.prototype,"visible",null),(0,n._)([(0,c.Cb)(),(0,wt.H)("esri/widgets/ElevationProfile/t9n/ElevationProfile")],Gt.prototype,"messages",void 0),(0,n._)([(0,c.Cb)(),(0,wt.H)("esri/t9n/common")],Gt.prototype,"messagesCommon",void 0),(0,n._)([(0,c.Cb)(),(0,wt.H)("esri/core/t9n/Units")],Gt.prototype,"messagesUnits",void 0),(0,n._)([(0,c.Cb)()],Gt.prototype,"_contentWrapper",void 0),(0,n._)([(0,c.Cb)()],Gt.prototype,"_chartContainer",void 0),(0,n._)([(0,c.Cb)()],Gt.prototype,"_chart",void 0),(0,n._)([(0,c.Cb)()],Gt.prototype,"_chartInitTask",void 0),(0,n._)([(0,c.Cb)()],Gt.prototype,"_chartIsRefined",void 0),(0,n._)([(0,c.Cb)()],Gt.prototype,"_width",void 0),(0,n._)([(0,c.Cb)()],Gt.prototype,"_portrait",null),(0,n._)([(0,c.Cb)()],Gt.prototype,"_zoomOutButtonVisible",void 0),(0,n._)([(0,c.Cb)()],Gt.prototype,"_chartUpdateParams",null),(0,n._)([(0,c.Cb)()],Gt.prototype,"_chartMessages",null),(0,n._)([(0,c.Cb)()],Gt.prototype,"_profilesArray",null),Gt=(0,n._)([(0,h.j)("esri.widgets.ElevationProfile")],Gt);const Zt=Gt},91079:(e,t,i)=>{i.d(t,{J8:()=>s,TH:()=>d,dd:()=>n,h8:()=>h,iE:()=>u});var n,s,r,o=i(68860),a=i(86361),l=i(56529);(r=n||(n={})).Disabled="disabled",r.Ready="ready",r.Creating="creating",r.Created="created",r.Selecting="selecting",r.Selected="selected",function(e){e.NoValidInput="no-valid-input",e.NoVisibleProfiles="no-visible-profiles",e.InvalidGeometry="invalid-geometry",e.TooComplex="too-complex",e.InvalidElevationInfo="invalid-elevation-info",e.UnknownError="unknown-error",e.RefinedButNoChartData="refined-but-no-chart-data",e.None="none"}(s||(s={}));let c={noDataValue:-5e5,defaultQueryOptions:()=>({noDataValue:c.noDataValue,demResolution:"auto",maximumAutoTileRequests:150,ignoreInvisibleLayers:!0}),updateThrottleMillis:100,delayAfterPreviewMillis:500,defaultDemResolution:(0,o.En)(10,"centimeters","meters"),densificationMaxSamples:3e3,largeChartSamples:1e4,maxTotalSamples:1e5,maxChartRatio:300,minSlopeSampleDistance:10,formatPrecision:1,portraitModePixelBreakpoint:400,profileLinesStyle3D:{width:3,outlineSize:0,falloff:0,outlineColor:(0,a.nI)([1,1,1,0]),renderOccluded:l.yD.Opaque},hoveredPointsStyle:{size:14,borderStyle:"solid",borderWidth:3,borderColor:"#ffffff",boxShadow:"0px 0px 0px 5px rgba(255,255,255,0.2)"}};function u(){return c}const h=" \u2015 ",d={progress:1,hasZ:!1,samples:[],statistics:null,spatialReference:null}},47732:(e,t,i)=>{function n(e,t){let{profiles:i}=t;const n=e.title;if(null!=n)return n;switch(e.type){case"ground":return i.ground;case"input":return i.input;case"query":return i.query;case"view":return i.view;default:return""}}i.d(t,{f:()=>n})},10498:(e,t,i)=>{i.d(t,{m:()=>p});var n=i(27366),s=i(68860),r=i(49861),o=(i(93169),i(32718),i(84936),i(69912)),a=i(33565),l=i(8905),c=(i(80975),i(80532)),u=i(67005);const h="esri-unit-select",d={base:h,label:"".concat(h,"__label"),select:"".concat(h,"__select")};let p=class extends a.Z{constructor(e,t){super(e,t),this._onSelectChange=e=>{this.onChange(e.target.value)}}loadDependencies(){return(0,l.h)({label:()=>Promise.all([i.e(92358),i.e(35738)]).then(i.bind(i,35738)),option:()=>i.e(19790).then(i.bind(i,19790)),select:()=>Promise.all([i.e(92358),i.e(54438),i.e(26369)]).then(i.bind(i,26369))})}render(){const{messages:e,options:t,selectLabel:i,value:n,_onSelectChange:r}=this;return(0,u.u)("div",{class:d.base,key:"units"},(0,u.u)("calcite-label",{class:d.label},i,(0,u.u)("calcite-select",{class:d.select,label:i,onCalciteSelectChange:r},t.map((t=>{var i;return(0,u.u)("calcite-option",{key:t,selected:t===n,value:t},(0,s.ZO)(t)?e.systems[t]:null===(i=e.units[t])||void 0===i?void 0:i.pluralCapitalized)})))))}};(0,n._)([(0,r.Cb)()],p.prototype,"options",void 0),(0,n._)([(0,r.Cb)()],p.prototype,"onChange",void 0),(0,n._)([(0,r.Cb)()],p.prototype,"selectLabel",void 0),(0,n._)([(0,r.Cb)()],p.prototype,"value",void 0),(0,n._)([(0,r.Cb)(),(0,c.H)("esri/core/t9n/Units")],p.prototype,"messages",void 0),p=(0,n._)([(0,o.j)("esri.widgets.support.UnitSelect")],p)},39114:(e,t,i)=>{function n(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(e>=t)return i;if(i.push(e),t-e<2)return i;const n=t-1;i.push(n);const r=s(e+1,n);for(;;){const e=r.next();if(e.done)break;i.push(e.value)}return i}function*s(e,t){if(e>=t)return;const i=e+Math.floor((t-e)/2);yield i;const n=s(e,i),r=s(i+1,t);for(;;){const e=n.next(),t=r.next();if(e.done&&t.done)break;e.done||(yield e.value),t.done||(yield t.value)}}i.d(t,{k:()=>n})}}]);
//# sourceMappingURL=39850.90896a87.chunk.js.map