"use strict";(self.webpackChunknorthwind=self.webpackChunknorthwind||[]).push([[46639,54537],{14916:(e,t,i)=>{function n(e,t,i,n){let r=null,o=1e3;"number"==typeof t?(o=t,n=i):(r=null!==t&&void 0!==t?t:null,o=i);let s,l=0;const a=()=>{l=0,e.apply(n,s)},d=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];r&&r.apply(n,t),s=t,o?l||(l=setTimeout(a,o)):a()};return d.remove=()=>{l&&(clearTimeout(l),l=0)},d.forceUpdate=()=>{l&&(clearTimeout(l),a())},d.hasPendingUpdates=()=>!!l,d}i.d(t,{P:()=>n})},3182:(e,t,i)=>{i.d(t,{S6:()=>o,u_:()=>r});var n=i(80457);class r{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;this.geometry=e,this.attributes=t,this.centroid=i,this.objectId=n,this.displayId=0,this.geohashX=0,this.geohashY=0}static fromJSON(e,t){const i=e.geometry?n.Z.fromJSON(e.geometry):null,o=e.centroid?n.Z.fromJSON(e.centroid):null,s=e.attributes[t];return new r(i,e.attributes,o,s)}weakClone(){const e=new r(this.geometry,this.attributes,this.centroid,this.objectId);return e.displayId=this.displayId,e.geohashX=this.geohashX,e.geohashY=this.geohashY,e}clone(){var e,t;const i=null===(e=this.geometry)||void 0===e?void 0:e.clone(),n=new r(i,{...this.attributes},null===(t=this.centroid)||void 0===t?void 0:t.clone(),this.objectId);return n.displayId=this.displayId,n.geohashX=this.geohashX,n.geohashY=this.geohashY,n}}function o(e){var t;return!(null===(t=e.geometry)||void 0===t||null===(t=t.coords)||void 0===t||!t.length)}},6908:(e,t,i)=>{i.d(t,{Z:()=>n});class n{constructor(){this.objectIdFieldName=null,this.globalIdFieldName=null,this.geohashFieldName=null,this.geometryProperties=null,this.geometryType=null,this.spatialReference=null,this.hasZ=!1,this.hasM=!1,this.features=[],this.fields=[],this.transform=null,this.exceededTransferLimit=!1,this.uniqueIdField=null,this.queryGeometryType=null,this.queryGeometry=null}weakClone(){const e=new n;return e.objectIdFieldName=this.objectIdFieldName,e.globalIdFieldName=this.globalIdFieldName,e.geohashFieldName=this.geohashFieldName,e.geometryProperties=this.geometryProperties,e.geometryType=this.geometryType,e.spatialReference=this.spatialReference,e.hasZ=this.hasZ,e.hasM=this.hasM,e.features=this.features,e.fields=this.fields,e.transform=this.transform,e.exceededTransferLimit=this.exceededTransferLimit,e.uniqueIdField=this.uniqueIdField,e.queryGeometry=this.queryGeometry,e.queryGeometryType=this.queryGeometryType,e}}},80457:(e,t,i)=>{i.d(t,{Z:()=>n});class n{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.lengths=null!==e&&void 0!==e?e:[],this.coords=null!==t&&void 0!==t?t:[],this.hasIndeterminateRingOrder=i}static fromJSON(e){return new n(e.lengths,e.coords,e.hasIndeterminateRingOrder)}static fromRect(e){const[t,i,r,o]=e,s=r-t,l=o-i;return new n([5],[t,i,s,0,0,l,-s,0,0,-l])}get isPoint(){return 0===this.lengths.length}get maxLength(){return Math.max(...this.lengths)}get size(){return this.lengths.reduce(((e,t)=>e+t))}forEachVertex(e){let t=0;this.lengths.length||e(this.coords[0],this.coords[1]);for(let i=0;i<this.lengths.length;i++){const n=this.lengths[i];for(let i=0;i<n;i++)e(this.coords[2*(i+t)],this.coords[2*(i+t)+1]);t+=n}}deltaDecode(){const e=this.clone(),{coords:t,lengths:i}=e;let n=0;for(const r of i){for(let e=1;e<r;e++)t[2*(n+e)]+=t[2*(n+e)-2],t[2*(n+e)+1]+=t[2*(n+e)-1];n+=r}return e}clone(e){if(0===this.lengths.length)return new n([],[this.coords[0],this.coords[1]]);const t=2*(0===this.lengths.length?1:this.lengths.reduce(((e,t)=>e+t))),i=this.coords.slice(0,t);return e?(e.set(i),new n(this.lengths,e,this.hasIndeterminateRingOrder)):new n(Array.from(this.lengths),Array.from(i),this.hasIndeterminateRingOrder)}}},22585:(e,t,i)=>{function n(e){const t={};for(const i in e){if("declaredClass"===i)continue;const r=e[i];if(null!=r&&"function"!=typeof r)if(Array.isArray(r)){t[i]=[];for(let e=0;e<r.length;e++)t[i][e]=n(r[e])}else"object"==typeof r?r.toJSON&&(t[i]=JSON.stringify(r)):t[i]=r}return t}i.d(t,{A:()=>n})},77946:(e,t,i)=>{i.d(t,{F:()=>a,e:()=>l});var n=i(23084),r=i(5192),o=i(49818),s=i(21149);async function l(e,t,i){const n=await a(e,t,i);return o.Z.fromJSON(n)}async function a(e,t,i){const o=(0,n.en)(e),l={...i},a=s.Z.from(t),{data:d}=await(0,r.JT)(o,a,a.sourceSpatialReference,l);return d}},5192:(e,t,i)=>{i.d(t,{Ev:()=>m,JT:()=>h,Vn:()=>g,Vr:()=>y,hH:()=>_,n7:()=>f,qp:()=>v});var n=i(76200),r=i(35995),o=i(77981),s=i(91340),l=i(92975),a=i(22585),d=i(27607),c=i(68620);const u="Layer does not support extent calculation.";function p(e,t){var i;const n=e.geometry,r=e.toJSON();delete r.compactGeometryEnabled,delete r.defaultSpatialReferenceEnabled;const s=r;let a,d,c;if(null!=n&&(d=n.spatialReference,c=(0,l.B9)(d),s.geometryType=(0,o.Ji)(n),s.geometry=function(e,t){if(t&&"extent"===e.type)return"".concat(e.xmin,",").concat(e.ymin,",").concat(e.xmax,",").concat(e.ymax);if(t&&"point"===e.type)return"".concat(e.x,",").concat(e.y);const i=e.toJSON();return delete i.spatialReference,JSON.stringify(i)}(n,e.compactGeometryEnabled),s.inSR=c),r.groupByFieldsForStatistics&&(s.groupByFieldsForStatistics=r.groupByFieldsForStatistics.join(",")),r.objectIds&&(s.objectIds=r.objectIds.join(",")),r.orderByFields&&(s.orderByFields=r.orderByFields.join(",")),!r.outFields||!r.returnDistinctValues&&(null!==t&&void 0!==t&&t.returnCountOnly||null!==t&&void 0!==t&&t.returnExtentOnly||null!==t&&void 0!==t&&t.returnIdsOnly)?delete s.outFields:r.outFields.includes("*")?s.outFields="*":s.outFields=r.outFields.join(","),r.outSR?(s.outSR=(0,l.B9)(r.outSR),a=e.outSpatialReference):n&&(r.returnGeometry||r.returnCentroid)&&(s.outSR=s.inSR,a=d),r.returnGeometry&&delete r.returnGeometry,r.outStatistics&&(s.outStatistics=JSON.stringify(r.outStatistics)),r.fullText&&(s.fullText=JSON.stringify(r.fullText)),r.pixelSize&&(s.pixelSize=JSON.stringify(r.pixelSize)),r.quantizationParameters&&(e.defaultSpatialReferenceEnabled&&null!=d&&null!=(null===(i=e.quantizationParameters)||void 0===i?void 0:i.extent)&&d.equals(e.quantizationParameters.extent.spatialReference)&&delete r.quantizationParameters.extent.spatialReference,s.quantizationParameters=JSON.stringify(r.quantizationParameters)),r.parameterValues&&(s.parameterValues=JSON.stringify(r.parameterValues)),r.rangeValues&&(s.rangeValues=JSON.stringify(r.rangeValues)),r.dynamicDataSource&&(s.layer=JSON.stringify({source:r.dynamicDataSource}),delete r.dynamicDataSource),r.timeExtent){const e=r.timeExtent,{start:t,end:i}=e;null==t&&null==i||(s.time=t===i?t:"".concat(null!==t&&void 0!==t?t:"null",",").concat(null!==i&&void 0!==i?i:"null")),delete r.timeExtent}return e.defaultSpatialReferenceEnabled&&null!=d&&null!=a&&d.equals(a)&&(s.defaultSR=s.inSR,delete s.inSR,delete s.outSR),s}async function h(e,t,i,n){const r=null!=t.timeExtent&&t.timeExtent.isEmpty?{data:{features:[]}}:await g(e,t,"json",n);return(0,c.p)(t,i,r.data),r}async function v(e,t,i,n){if(null!=t.timeExtent&&t.timeExtent.isEmpty)return{data:i.createFeatureResult()};const r=await f(e,t,n),o=r;return o.data=(0,d.C)(r.data,i),o}function f(e,t,i){return g(e,t,"pbf",i)}function m(e,t,i){return null!=t.timeExtent&&t.timeExtent.isEmpty?Promise.resolve({data:{objectIds:[]}}):g(e,t,"json",i,{returnIdsOnly:!0})}function _(e,t,i){return null!=t.timeExtent&&t.timeExtent.isEmpty?Promise.resolve({data:{count:0}}):g(e,t,"json",i,{returnIdsOnly:!0,returnCountOnly:!0})}async function y(e,t,i){if(null!=t.timeExtent&&t.timeExtent.isEmpty)return{data:{count:0,extent:null}};const n=await g(e,t,"json",i,{returnExtentOnly:!0,returnCountOnly:!0}),r=n.data;if(r.hasOwnProperty("extent"))return n;if(r.features)throw new Error(u);if(r.hasOwnProperty("count"))throw new Error(u);return n}async function g(e,t,i){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const d="string"==typeof e?(0,r.mN)(e):e,c=t.geometry?[t.geometry]:[],u=await(0,s.aX)(c,null,{signal:o.signal}),h=null===u||void 0===u?void 0:u[0];null!=h&&((t=t.clone()).geometry=h);const v=(0,a.A)({...d.query,f:i,...l,...p(t,l)});return(0,n.Z)((0,r.v_)(d.path,(f=l,null==t.formatOf3DObjects||f.returnCountOnly||f.returnExtentOnly||f.returnIdsOnly?"query":"query3d")),{...o,responseType:"pbf"===i?"array-buffer":"json",query:{...v,...o.query}});var f}},10194:(e,t,i)=>{i.r(t),i.d(t,{default:()=>fe});var n=i(27366),r=(i(59166),i(94172)),o=i(49861),s=i(89125),l=(i(84936),i(93169),i(69912)),a=i(33565),d=(i(32718),i(21993)),c=i(83244),u=i(96919),p=i(80975),h=i(67005);const v="esri-feature-element-info",f={base:v,title:"".concat(v,"__title"),description:"".concat(v,"__description")};let m=class extends a.Z{constructor(e,t){super(e,t),this.description=null,this.headingLevel=2,this.title=null}render(){return(0,h.u)("div",{class:f.base},this._renderTitle(),this._renderDescription())}_renderTitle(){const{title:e}=this;return e?(0,h.u)(u.X,{class:f.title,innerHTML:e,level:this.headingLevel}):null}_renderDescription(){const{description:e}=this;return e?(0,h.u)("div",{class:f.description,innerHTML:e,key:"description"}):null}};(0,n._)([(0,o.Cb)()],m.prototype,"description",void 0),(0,n._)([(0,o.Cb)()],m.prototype,"headingLevel",void 0),(0,n._)([(0,o.Cb)()],m.prototype,"title",void 0),m=(0,n._)([(0,l.j)("esri.widgets.Feature.support.FeatureElementInfo")],m);const _=m,y="esri-feature-attachments";let g=class extends a.Z{constructor(e,t){super(e,t),this._featureElementInfo=null,this.attachmentsWidget=new d.default,this.headingLevel=2,this.viewModel=new c.Z}initialize(){this._featureElementInfo=new _,this.addHandles([(0,r.watch)((()=>{var e,t;return[null===(e=this.viewModel)||void 0===e?void 0:e.description,null===(t=this.viewModel)||void 0===t?void 0:t.title,this.headingLevel]}),(()=>this._setupFeatureElementInfo()),r.initial),(0,r.watch)((()=>this.viewModel),(e=>this.attachmentsWidget.viewModel=e),r.initial)])}destroy(){var e;this.attachmentsWidget.viewModel=null,this.attachmentsWidget.destroy(),null===(e=this._featureElementInfo)||void 0===e||e.destroy()}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get displayType(){return this.attachmentsWidget.displayType}set displayType(e){this.attachmentsWidget.displayType=e}get graphic(){return this.viewModel.graphic}set graphic(e){this.viewModel.graphic=e}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}render(){var e;const{attachmentsWidget:t}=this;return(0,h.u)("div",{class:y},null===(e=this._featureElementInfo)||void 0===e?void 0:e.render(),null===t||void 0===t?void 0:t.render())}_setupFeatureElementInfo(){var e;const{description:t,title:i,headingLevel:n}=this;null===(e=this._featureElementInfo)||void 0===e||e.set({description:t,title:i,headingLevel:n})}};(0,n._)([(0,o.Cb)({readOnly:!0})],g.prototype,"attachmentsWidget",void 0),(0,n._)([(0,o.Cb)()],g.prototype,"description",null),(0,n._)([(0,o.Cb)()],g.prototype,"displayType",null),(0,n._)([(0,o.Cb)()],g.prototype,"graphic",null),(0,n._)([(0,o.Cb)()],g.prototype,"headingLevel",void 0),(0,n._)([(0,o.Cb)()],g.prototype,"title",null),(0,n._)([(0,o.Cb)({type:c.Z})],g.prototype,"viewModel",void 0),g=(0,n._)([(0,l.j)("esri.widgets.Feature.FeatureAttachments")],g);const b=g;var w=i(50267),I=i(45276),M=i(53963);const C="esri-feature-content",A={base:C,loaderContainer:"".concat(C,"__loader-container"),loader:"".concat(C,"__loader")};let x=class extends a.Z{constructor(e,t){super(e,t),this.viewModel=null,this._addTargetToAnchors=e=>{Array.from(e.querySelectorAll("a")).forEach((e=>{(0,I.or)(e.href)&&!e.hasAttribute("target")&&e.setAttribute("target","_blank")}))}}get creator(){var e;return null===(e=this.viewModel)||void 0===e?void 0:e.creator}set creator(e){this.viewModel&&(this.viewModel.creator=e)}get graphic(){var e;return null===(e=this.viewModel)||void 0===e?void 0:e.graphic}set graphic(e){this.viewModel&&(this.viewModel.graphic=e)}render(){var e;const t=null===(e=this.viewModel)||void 0===e?void 0:e.state;return(0,h.u)("div",{class:A.base},"loading"===t?this._renderLoading():this._renderCreated())}_renderLoading(){return(0,h.u)("div",{class:A.loaderContainer,key:"loader"},(0,h.u)("div",{class:A.loader}))}_renderCreated(){var e;const t=null===(e=this.viewModel)||void 0===e?void 0:e.created;return t?t instanceof HTMLElement?(0,h.u)("div",{afterCreate:this._attachToNode,bind:t,key:t}):(0,M.Qd)(t)?(0,h.u)("div",{key:t},!t.destroyed&&t.render()):(0,h.u)("div",{afterCreate:this._addTargetToAnchors,innerHTML:t,key:t}):null}_attachToNode(e){e.appendChild(this)}};(0,n._)([(0,o.Cb)()],x.prototype,"creator",null),(0,n._)([(0,o.Cb)()],x.prototype,"graphic",null),(0,n._)([(0,o.Cb)({type:w.Z})],x.prototype,"viewModel",void 0),x=(0,n._)([(0,l.j)("esri.widgets.Feature.FeatureContent")],x);const F=x;var E=i(86836),T=i(7021),R=i(30333),S=i(80532);const L="esri-feature-fields",N={base:L,fieldHeader:"".concat(L,"__field-header"),fieldData:"".concat(L,"__field-data"),fieldDataDate:"".concat(L,"__field-data--date")};let P=class extends a.Z{constructor(e,t){super(e,t),this._featureElementInfo=null,this.viewModel=new E.Z,this.messages=null,this.messagesURIUtils=null}initialize(){this._featureElementInfo=new _,this.addHandles((0,r.watch)((()=>{var e,t;return[null===(e=this.viewModel)||void 0===e?void 0:e.description,null===(t=this.viewModel)||void 0===t?void 0:t.title]}),(()=>this._setupFeatureElementInfo()),r.initial))}destroy(){var e;null===(e=this._featureElementInfo)||void 0===e||e.destroy()}get attributes(){return this.viewModel.attributes}set attributes(e){this.viewModel.attributes=e}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get expressionInfos(){return this.viewModel.expressionInfos}set expressionInfos(e){this.viewModel.expressionInfos=e}get fieldInfos(){return this.viewModel.fieldInfos}set fieldInfos(e){this.viewModel.fieldInfos=e}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}render(){var e;return(0,h.u)("div",{class:N.base},null===(e=this._featureElementInfo)||void 0===e?void 0:e.render(),this._renderFields())}_renderFieldInfo(e,t){var i;const{attributes:n}=this.viewModel,r=e.fieldName||"",o=e.label||r,s=n?null==n[r]?"":n[r]:"",l=!(null===(i=e.format)||void 0===i||!i.dateFormat),a="number"!=typeof s||l?(0,R.q)(this.messagesURIUtils,s):this._forceLTR(s),d={[N.fieldDataDate]:l};return(0,h.u)("tr",{key:"fields-element-info-row-".concat(r,"-").concat(t)},(0,h.u)("th",{class:N.fieldHeader,innerHTML:o,key:"fields-element-info-row-header-".concat(r,"-").concat(t)}),(0,h.u)("td",{class:this.classes(N.fieldData,d),innerHTML:a,key:"fields-element-info-row-data-".concat(r,"-").concat(t)}))}_renderFields(){const{formattedFieldInfos:e}=this.viewModel;return null!==e&&void 0!==e&&e.length?(0,h.u)("table",{class:T.z.table,summary:this.messages.fieldsSummary},(0,h.u)("tbody",null,e.map(((e,t)=>this._renderFieldInfo(e,t))))):null}_setupFeatureElementInfo(){var e;const{description:t,title:i}=this;null===(e=this._featureElementInfo)||void 0===e||e.set({description:t,title:i})}_forceLTR(e){return"&lrm;".concat(e)}};(0,n._)([(0,o.Cb)()],P.prototype,"attributes",null),(0,n._)([(0,o.Cb)()],P.prototype,"description",null),(0,n._)([(0,o.Cb)()],P.prototype,"expressionInfos",null),(0,n._)([(0,o.Cb)()],P.prototype,"fieldInfos",null),(0,n._)([(0,o.Cb)()],P.prototype,"title",null),(0,n._)([(0,o.Cb)({type:E.Z,nonNullable:!0})],P.prototype,"viewModel",void 0),(0,n._)([(0,o.Cb)(),(0,S.H)("esri/widgets/Feature/t9n/Feature")],P.prototype,"messages",void 0),(0,n._)([(0,o.Cb)(),(0,S.H)("esri/widgets/support/t9n/uriUtils")],P.prototype,"messagesURIUtils",void 0),P=(0,n._)([(0,l.j)("esri.widgets.Feature.FeatureFields")],P);const k=P;var O=i(90193),Z=i(99388),V=i(21516),j=i(8905),H=i(37384),D=i(8704);const q="esri-feature-media",W={base:q,mediaContainer:"".concat(q,"__container"),mediaItemContainer:"".concat(q,"__item-container"),mediaItem:"".concat(q,"__item"),mediaItemText:"".concat(q,"__item-text"),mediaItemTitle:"".concat(q,"__item-title"),mediaItemCaption:"".concat(q,"__item-caption"),mediaNavigation:"".concat(q,"__item-navigation"),mediaPagination:"".concat(q,"__pagination"),mediaPaginationText:"".concat(q,"__pagination-text"),mediaPrevious:"".concat(q,"__previous"),mediaPreviousIconLTR:"".concat(q,"__previous-icon"),mediaPreviousIconRTL:"".concat(q,"__previous-icon--rtl"),mediaNext:"".concat(q,"__next"),mediaNextIconLTR:"".concat(q,"__next-icon"),mediaNextIconRTL:"".concat(q,"__next-icon--rtl"),mediaChart:"".concat(q,"__chart"),mediaPaginationButton:"".concat(q,"__pagination-button"),mediaPaginationIcon:"".concat(q,"__pagination-icon"),mediaChartRendered:"".concat(q,"__chart--rendered")},z="category",B="value";let J=class extends a.Z{constructor(e,t){super(e,t),this._refreshTimer=null,this._refreshIntervalInfo=null,this._featureElementInfo=null,this._chartRootMap=new WeakMap,this.viewModel=new V.Z,this.messages=null,this._disposeChart=e=>{var t;null!==(t=this._chartRootMap.get(e))&&void 0!==t&&t.dispose(),this._chartRootMap.delete(e)},this._createChart=async e=>{const{destroyed:t,viewModel:n}=this;if(t||!n||!e)return;const{createRoot:r}=await Promise.all([i.e(24390),i.e(24489),i.e(10470)]).then(i.bind(i,86798)),o=await r(e);this._chartRootMap.set(e,o),this._renderChart({mediaInfo:n.activeMediaInfo,root:o})}}initialize(){this._featureElementInfo=new _,this.addHandles([(0,r.watch)((()=>{var e,t;return[null===(e=this.viewModel)||void 0===e?void 0:e.activeMediaInfo,null===(t=this.viewModel)||void 0===t?void 0:t.activeMediaInfoIndex]}),(()=>this._setupMediaRefreshTimer()),r.initial),(0,r.watch)((()=>{var e,t;return[null===(e=this.viewModel)||void 0===e?void 0:e.description,null===(t=this.viewModel)||void 0===t?void 0:t.title]}),(()=>this._setupFeatureElementInfo()),r.initial)])}loadDependencies(){return(0,j.h)({icon:()=>Promise.all([i.e(92358),i.e(87474)]).then(i.bind(i,87474))})}destroy(){var e;this._clearMediaRefreshTimer(),null===(e=this._featureElementInfo)||void 0===e||e.destroy()}get attributes(){return this.viewModel.attributes}set attributes(e){this.viewModel.attributes=e}get activeMediaInfoIndex(){return this.viewModel.activeMediaInfoIndex}set activeMediaInfoIndex(e){this.viewModel.activeMediaInfoIndex=e}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get fieldInfoMap(){return this.viewModel.fieldInfoMap}set fieldInfoMap(e){this.viewModel.fieldInfoMap=e}get layer(){return this.viewModel.layer}set layer(e){this.viewModel.layer=e}get mediaInfos(){return this.viewModel.mediaInfos}set mediaInfos(e){this.viewModel.mediaInfos=e}get popupTemplate(){return this.viewModel.popupTemplate}set popupTemplate(e){this.viewModel.popupTemplate=e}get relatedInfos(){return this.viewModel.relatedInfos}set relatedInfos(e){this.viewModel.relatedInfos=e}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}render(){var e;return(0,h.u)("div",{bind:this,class:W.base,onkeyup:this._handleMediaKeyup},null===(e=this._featureElementInfo)||void 0===e?void 0:e.render(),this._renderMedia())}_renderMedia(){const{formattedMediaInfoCount:e,activeMediaInfoIndex:t}=this.viewModel,i=this._renderMediaText();return e?(0,h.u)("div",{class:W.mediaContainer,key:"media-element-container"},this._renderMediaInfo(),(0,h.u)("div",{class:W.mediaNavigation},i,e>1?(0,h.u)("div",{class:W.mediaPagination},this._renderMediaPageButton("previous"),(0,h.u)("span",{class:W.mediaPaginationText},(0,D.n)(this.messages.pageText,{index:t+1,total:e})),this._renderMediaPageButton("next")):null)):null}_renderMediaText(){const{activeMediaInfo:e}=this.viewModel;if(!e)return null;const t=e&&e.title?(0,h.u)("div",{class:W.mediaItemTitle,innerHTML:e.title,key:"media-title"}):null,i=e&&e.caption?(0,h.u)("div",{class:W.mediaItemCaption,innerHTML:e.caption,key:"media-caption"}):null;return t||i?(0,h.u)("div",{class:W.mediaItemText,key:"media-text"},t,i):null}_renderImageMediaInfo(e){var t;if(!e.value)return null;const{_refreshIntervalInfo:i}=this,{activeMediaInfoIndex:n,formattedMediaInfoCount:r}=this.viewModel,{value:o,refreshInterval:s,altText:l,title:a,type:d}=e,{sourceURL:c,linkURL:u}=o,p=(0,I.or)(null!==u&&void 0!==u?u:void 0)?"_blank":"_self",v="_blank"===p?"noreferrer":"",f=s?i:null,m=f?f.timestamp:0,_=f?f.sourceURL:c,y=(0,h.u)("img",{alt:l||a,key:"media-".concat(d,"-").concat(n,"-").concat(r,"-").concat(m),src:null!==_&&void 0!==_?_:void 0});return null!==(t=u?(0,h.u)("a",{href:u,rel:v,target:p,title:a},y):null)&&void 0!==t?t:y}_renderChartMediaInfo(e){const{activeMediaInfoIndex:t,formattedMediaInfoCount:i}=this.viewModel;return(0,h.u)("div",{afterCreate:this._createChart,afterRemoved:this._disposeChart,bind:this,class:W.mediaChart,key:"media-".concat(e.type,"-").concat(t,"-").concat(i)})}_renderMediaInfoType(){const{activeMediaInfo:e}=this.viewModel;return e?"image"===e.type?this._renderImageMediaInfo(e):e.type.includes("chart")?this._renderChartMediaInfo(e):null:null}_renderMediaInfo(){const{activeMediaInfo:e}=this.viewModel;return e?(0,h.u)("div",{class:W.mediaItemContainer,key:"media-container"},(0,h.u)("div",{class:W.mediaItem,key:"media-item-container"},this._renderMediaInfoType())):null}_renderMediaPageButton(e){if(this.viewModel.formattedMediaInfoCount<2)return null;const t="previous"===e,i=t?this.messages.previous:this.messages.next,n=t?"chevron-left":"chevron-right",r=t?"media-previous":"media-next",o=t?this._previous:this._next;return(0,h.u)("button",{"aria-label":i,bind:this,class:W.mediaPaginationButton,key:r,onclick:o,tabIndex:0,title:i,type:"button"},(0,h.u)("calcite-icon",{class:W.mediaPaginationIcon,icon:n,scale:"s"}))}_setupFeatureElementInfo(){var e;const{description:t,title:i}=this;null===(e=this._featureElementInfo)||void 0===e||e.set({description:t,title:i})}_next(){this.viewModel.next()}_previous(){this.viewModel.previous()}_getRenderer(){if(!this.viewModel)return;const{isAggregate:e,layer:t}=this.viewModel;return e&&null!==t&&void 0!==t&&t.featureReduction&&"renderer"in t.featureReduction?t.featureReduction.renderer:null===t||void 0===t?void 0:t.renderer}async _getSeriesColors(e){const{colorAm5:t}=await Promise.all([i.e(24390),i.e(96715)]).then(i.bind(i,96715)),n=new Map;return e.forEach((e=>{e.color&&n.set(e,t(e.color.toCss(!0)))})),n}async _getRendererColors(){const{colorAm5:e}=await Promise.all([i.e(24390),i.e(96715)]).then(i.bind(i,96715)),t=new Map,n=this._getRenderer();if(!n)return t;const r=await(0,Z.zB)(n);return r.delete("default"),Array.from(r.values()).every((e=>1===(null===e||void 0===e?void 0:e.length)))?(Array.from(r.keys()).forEach((i=>{var n;const o=null===(n=r.get(i))||void 0===n||null===(n=n[0])||void 0===n?void 0:n.toCss(!0);o&&t.set(i,e(o))})),t):t}_handleMediaKeyup(e){const{key:t}=e;"ArrowLeft"===t&&(e.stopPropagation(),this.viewModel.previous()),"ArrowRight"===t&&(e.stopPropagation(),this.viewModel.next())}_canAnimateChart(){return!!this.viewModel&&!!this.viewModel.abilities.chartAnimation&&!(0,O.n)()}_getChartAnimationMS(){return this._canAnimateChart()?250:0}_getChartSeriesAnimationMS(){return this._canAnimateChart()?500:0}async _renderChart(e){const{root:t,mediaInfo:n}=e,{value:r,type:o}=n,{ResponsiveThemeAm5:s,DarkThemeAm5:l,AnimatedThemeAm5:a,ColorSetAm5:d,ThemeAm5:c,esriChartColorSet:u}=await Promise.all([i.e(24390),i.e(96715)]).then(i.bind(i,96715)),p=c.new(t);p.rule("ColorSet").set("colors",u),p.rule("ColorSet").set("reuse",!0);const h=[s.new(t),p];(0,H.$o)()&&h.push(l.new(t)),this._canAnimateChart()&&h.push(a.new(t)),t.setThemes(h);const v=await this._getRendererColors(),f=await this._getSeriesColors(r.series),m=d.new(t,{}),_=f.get(r.series[0]),y=_?{lineSettings:{stroke:_}}:void 0,g=r.series.map(((e,t)=>{const i=f.get(e)||v.get(e.fieldName)||m.getIndex(t);return{[z]:e.tooltip,[B]:e.value,columnSettings:{fill:i,stroke:i},...y}})).filter((e=>"pie-chart"!==o||null!=e.value&&e.value>0));"pie-chart"===o?this._createPieChart(e,g):this._createXYChart(e,g)}_getDirection(){return(0,p.dZ)(this.container)?"rtl":"ltr"}_isInversed(){return!!(0,p.dZ)(this.container)}async _customizeChartTooltip(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"horizontal";const{colorAm5:r}=await Promise.all([i.e(24390),i.e(96715)]).then(i.bind(i,96715));e.setAll({pointerOrientation:n}),null!==(t=e.get("background"))&&void 0!==t&&t.setAll({stroke:r("rgba(50, 50, 50, 1)")}),e.label.setAll({direction:this._getDirection(),oversizedBehavior:"wrap",maxWidth:200})}async _createPieChart(e,t){const{TooltipAm5:n}=await Promise.all([i.e(24390),i.e(96715)]).then(i.bind(i,96715)),{PieChartAm5:r,PieSeriesAm5:o}=await Promise.all([i.e(24390),i.e(15245),i.e(77011)]).then(i.bind(i,77011)),{mediaInfo:s,root:l}=e,{title:a}=s,d=(null===s||void 0===s?void 0:s.altText)||(null===s||void 0===s?void 0:s.title)||"",c=l.container.children.push(r.new(l,{ariaLabel:d,focusable:!0,paddingBottom:5,paddingTop:5,paddingLeft:5,paddingRight:5})),u="{category}: {valuePercentTotal.formatNumber('0.00')}%\n ({value})",p=n.new(l,{labelText:u}),h=c.series.push(o.new(l,{name:a,valueField:B,categoryField:z,tooltip:p}));h.ticks.template.set("forceHidden",!0),h.labels.template.set("forceHidden",!0),h.slices.template.states.create("active",{shiftRadius:5}),this._customizeChartTooltip(p),h.slices.template.setAll({ariaLabel:u,focusable:!0,templateField:"columnSettings"}),h.data.setAll(t),h.appear(this._getChartSeriesAnimationMS()),c.appear(this._getChartAnimationMS()),c.root.dom.classList.toggle(W.mediaChartRendered,!0)}_getMinSeriesValue(e){let t=0;return e.forEach((e=>t=Math.min(e.value,t))),t}async _createColumnChart(e,t,n){const{TooltipAm5:r,ScrollbarAm5:o}=await Promise.all([i.e(24390),i.e(96715)]).then(i.bind(i,96715)),{CategoryAxisAm5:s,AxisRendererXAm5:l,ValueAxisAm5:a,AxisRendererYAm5:d,ColumnSeriesAm5:c}=await Promise.all([i.e(24390),i.e(15245),i.e(49596),i.e(96436)]).then(i.bind(i,96436)),{mediaInfo:u,root:p}=t,{value:h,title:v}=u;e.setAll({wheelX:"panX",wheelY:"zoomX"});const f=e.xAxes.push(s.new(p,{renderer:l.new(p,{inversed:this._isInversed()}),categoryField:z}));f.get("renderer").labels.template.setAll({forceHidden:!0});const m=e.yAxes.push(a.new(p,{renderer:d.new(p,{inside:!1}),min:this._getMinSeriesValue(h.series)}));m.get("renderer").labels.template.setAll({direction:this._getDirection()});const _="{categoryX}",y=r.new(p,{labelText:_}),g=e.series.push(c.new(p,{name:v,xAxis:f,yAxis:m,valueYField:B,categoryXField:z,tooltip:y}));this._customizeChartTooltip(y),g.columns.template.setAll({ariaLabel:_,focusable:!0,templateField:"columnSettings"}),h.series.length>15&&e.set("scrollbarX",o.new(p,{orientation:"horizontal"})),f.data.setAll(n),g.data.setAll(n),g.appear(this._getChartSeriesAnimationMS()),e.appear(this._getChartAnimationMS())}async _createBarChart(e,t,n){const{TooltipAm5:r,ScrollbarAm5:o}=await Promise.all([i.e(24390),i.e(96715)]).then(i.bind(i,96715)),{CategoryAxisAm5:s,AxisRendererXAm5:l,ValueAxisAm5:a,AxisRendererYAm5:d,ColumnSeriesAm5:c}=await Promise.all([i.e(24390),i.e(15245),i.e(49596),i.e(96436)]).then(i.bind(i,96436)),{mediaInfo:u,root:p}=t,{value:h,title:v}=u;e.setAll({wheelX:"panY",wheelY:"zoomY"});const f=e.yAxes.push(s.new(p,{renderer:d.new(p,{inversed:!0}),categoryField:z}));f.get("renderer").labels.template.setAll({forceHidden:!0});const m=e.xAxes.push(a.new(p,{renderer:l.new(p,{inside:!1,inversed:this._isInversed()}),min:this._getMinSeriesValue(h.series)}));m.get("renderer").labels.template.setAll({direction:this._getDirection()});const _="{categoryY}",y=r.new(p,{labelText:_}),g=e.series.push(c.new(p,{name:v,xAxis:m,yAxis:f,valueXField:B,categoryYField:z,tooltip:y}));this._customizeChartTooltip(y,"vertical"),g.columns.template.setAll({ariaLabel:_,focusable:!0,templateField:"columnSettings"}),h.series.length>15&&e.set("scrollbarY",o.new(p,{orientation:"vertical"})),f.data.setAll(n),g.data.setAll(n),g.appear(this._getChartSeriesAnimationMS()),e.appear(this._getChartAnimationMS())}async _createLineChart(e,t,n){var r,o;const{TooltipAm5:s,ScrollbarAm5:l}=await Promise.all([i.e(24390),i.e(96715)]).then(i.bind(i,96715)),{CategoryAxisAm5:a,AxisRendererXAm5:d,ValueAxisAm5:c,AxisRendererYAm5:u,LineSeriesAm5:p}=await Promise.all([i.e(24390),i.e(15245),i.e(49596),i.e(96436)]).then(i.bind(i,96436)),{root:h,mediaInfo:v}=t,{value:f,title:m}=v;e.setAll({wheelX:"panX",wheelY:"zoomX"});const _=e.xAxes.push(a.new(h,{renderer:d.new(h,{inversed:this._isInversed()}),categoryField:z}));_.get("renderer").labels.template.setAll({forceHidden:!0});const y=e.yAxes.push(c.new(h,{renderer:u.new(h,{inside:!1}),min:this._getMinSeriesValue(f.series)}));y.get("renderer").labels.template.setAll({direction:this._getDirection()});const g=null===(r=n[0])||void 0===r||null===(r=r.lineSettings)||void 0===r?void 0:r.stroke,b=s.new(h,{getFillFromSprite:!g,labelText:"{categoryX}"});g&&(null===(o=b.get("background"))||void 0===o||o.setAll({fill:g}));const w=e.series.push(p.new(h,{name:m,xAxis:_,yAxis:y,valueYField:B,categoryXField:z,tooltip:b}));w.strokes.template.setAll({templateField:"lineSettings"}),this._customizeChartTooltip(b,"vertical"),f.series.length>15&&e.set("scrollbarX",l.new(h,{orientation:"horizontal"})),_.data.setAll(n),w.data.setAll(n),w.appear(this._getChartSeriesAnimationMS()),e.appear(this._getChartAnimationMS())}async _createXYChart(e,t){const{XYChartAm5:n,XYCursorAm5:r}=await Promise.all([i.e(24390),i.e(15245),i.e(49596),i.e(96436)]).then(i.bind(i,96436)),{root:o,mediaInfo:s}=e,{type:l}=s,a=(null===s||void 0===s?void 0:s.altText)||(null===s||void 0===s?void 0:s.title)||"",d=o.container.children.push(n.new(o,{ariaLabel:a,focusable:!0,panX:!0,panY:!0}));d.set("cursor",r.new(o,{})),"column-chart"===l&&await this._createColumnChart(d,e,t),"bar-chart"===l&&await this._createBarChart(d,e,t),"line-chart"===l&&await this._createLineChart(d,e,t),d.root.dom.classList.toggle(W.mediaChartRendered,!0)}_clearMediaRefreshTimer(){const{_refreshTimer:e}=this;e&&(clearTimeout(e),this._refreshTimer=null)}_updateMediaInfoTimestamp(e){const t=Date.now();this._refreshIntervalInfo={timestamp:t,sourceURL:e&&this._getImageSource(e,t)}}_setupMediaRefreshTimer(){this._clearMediaRefreshTimer();const{activeMediaInfo:e}=this.viewModel;"image"===(null===e||void 0===e?void 0:e.type)&&(null===e||void 0===e?void 0:e.refreshInterval)>0&&this._setRefreshTimeout(e)}_setRefreshTimeout(e){const{refreshInterval:t,value:i}=e,n=6e4*t;this._updateMediaInfoTimestamp(i.sourceURL);const r=setInterval((()=>{this._updateMediaInfoTimestamp(i.sourceURL)}),n);this._refreshTimer=r}_getImageSource(e,t){const i=e.includes("?")?"&":"?",[n,r=""]=e.split("#");return"".concat(n).concat(i,"timestamp=").concat(t).concat(r?"#":"").concat(r)}};(0,n._)([(0,o.Cb)()],J.prototype,"_refreshIntervalInfo",void 0),(0,n._)([(0,o.Cb)()],J.prototype,"attributes",null),(0,n._)([(0,o.Cb)()],J.prototype,"activeMediaInfoIndex",null),(0,n._)([(0,o.Cb)()],J.prototype,"description",null),(0,n._)([(0,o.Cb)()],J.prototype,"fieldInfoMap",null),(0,n._)([(0,o.Cb)()],J.prototype,"layer",null),(0,n._)([(0,o.Cb)()],J.prototype,"mediaInfos",null),(0,n._)([(0,o.Cb)()],J.prototype,"popupTemplate",null),(0,n._)([(0,o.Cb)()],J.prototype,"relatedInfos",null),(0,n._)([(0,o.Cb)()],J.prototype,"title",null),(0,n._)([(0,o.Cb)({type:V.Z})],J.prototype,"viewModel",void 0),(0,n._)([(0,o.Cb)(),(0,S.H)("esri/widgets/Feature/t9n/Feature")],J.prototype,"messages",void 0),J=(0,n._)([(0,l.j)("esri.widgets.Feature.FeatureMedia")],J);const X=J;var $=i(57240);const U="esri-feature",Y={base:"".concat(U,"-expression"),loadingSpinnerContainer:"".concat(U,"__loading-container")};let Q=class extends a.Z{constructor(e,t){super(e,t),this._contentWidget=null,this.viewModel=new $.Z}initialize(){this.addHandles((0,r.watch)((()=>{var e;return null===(e=this.viewModel)||void 0===e?void 0:e.contentElementViewModel}),(()=>this._setupExpressionWidget()),r.initial))}loadDependencies(){return(0,j.h)({loader:()=>i.e(92382).then(i.bind(i,92382))})}destroy(){this._destroyContentWidget()}render(){var e;const{state:t}=this.viewModel;return(0,h.u)("div",{class:Y.base},"loading"===t?this._renderLoading():"disabled"===t?null:null===(e=this._contentWidget)||void 0===e?void 0:e.render())}_renderLoading(){return(0,h.u)("div",{class:Y.loadingSpinnerContainer,key:"loading-container"},(0,h.u)("calcite-loader",{inline:!0,label:""}))}_destroyContentWidget(){const{_contentWidget:e}=this;e&&(e.viewModel=null,e.destroy()),this._contentWidget=null}_setupExpressionWidget(){const{contentElementViewModel:e,contentElement:t}=this.viewModel,i=null===t||void 0===t?void 0:t.type;this._destroyContentWidget();const n=e?"fields"===i?new k({viewModel:e}):"media"===i?new X({viewModel:e}):"text"===i?new F({viewModel:e}):null:null;this._contentWidget=n,this.scheduleRender()}};(0,n._)([(0,o.Cb)({type:$.Z})],Q.prototype,"viewModel",void 0),Q=(0,n._)([(0,l.j)("esri.widgets.Feature.FeatureExpression")],Q);const G=Q;var K=i(92026),ee=i(66978),te=i(67667);const ie="esri-feature",ne="".concat(ie,"-relationship"),re={base:ne,listContainer:"".concat(ne,"__list"),listItem:"".concat(ne,"__list-item"),listItemHidden:"".concat(ne,"__list-item--hidden"),listContainerQuerying:"".concat(ne,"__list--querying"),featureObserver:"".concat(ie,"__feature-observer"),stickySpinnerContainer:"".concat(ie,"__sticky-loading-container"),loadingSpinnerContainer:"".concat(ie,"__loading-container")},oe={title:!0,description:!0};let se=class extends a.Z{constructor(e,t){super(e,t),this._featureElementInfo=null,this._relatedFeatureIntersectionObserverNode=null,this._relatedFeatureIntersectionObserver=new IntersectionObserver((e=>{let[t]=e;(null===t||void 0===t?void 0:t.isIntersecting)&&this._increaseFeaturePage()}),{root:window.document}),this.headingLevel=2,this.viewModel=new te.Z,this.messages=null,this.messagesCommon=null,this.visibleElements={...oe},this._increaseFeaturePage=()=>{const{state:e,showAllEnabled:t,relatedFeatures:i,featuresPerPage:n,featurePage:r}=this.viewModel;"ready"===e&&t&&i.length>=n*r&&this.viewModel.featurePage++}}initialize(){this._featureElementInfo=new _,this.addHandles([(0,r.watch)((()=>[this.viewModel.description,this.viewModel.title,this.headingLevel]),(()=>this._setupFeatureElementInfo()),r.initial),(0,r.watch)((()=>[this.viewModel.state,this.viewModel.showAllEnabled,this._relatedFeatureIntersectionObserverNode]),(()=>this._handleRelatedFeatureObserverChange())),(0,r.on)((()=>this.viewModel.relatedFeatureViewModels),"change",(()=>this._setupRelatedFeatureViewModels()))])}loadDependencies(){return(0,j.h)({icon:()=>Promise.all([i.e(92358),i.e(87474)]).then(i.bind(i,87474)),list:()=>Promise.all([i.e(92358),i.e(46895),i.e(54438),i.e(34504),i.e(8715),i.e(38782)]).then(i.bind(i,38782)),"list-item":()=>Promise.all([i.e(92358),i.e(46895),i.e(65138),i.e(21340)]).then(i.bind(i,67994)),loader:()=>i.e(92382).then(i.bind(i,92382)),notice:()=>Promise.all([i.e(92358),i.e(46895),i.e(15669)]).then(i.bind(i,15669))})}destroy(){this._unobserveRelatedFeatureObserver(),this._featureElementInfo=(0,K.SC)(this._featureElementInfo)}get displayShowAllButton(){const{showAllEnabled:e,featureCount:t,displayCount:i,state:n}=this.viewModel;return!e&&!!t&&"ready"===n&&(t>i||0===i)}get displayListItems(){return this.displayShowAllButton||this.viewModel.relatedFeatureViewModels.length>0}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get featureCountDescription(){const{messages:e}=this,{featureCount:t}=this.viewModel;return(0,D.n)(null===e||void 0===e?void 0:e.numberRecords,{number:t})}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}castVisibleElements(e){return{...oe,...e}}render(){var e;const{state:t}=this.viewModel;return(0,h.u)("div",{class:this.classes(re.base,T.z.widget)},null===(e=this._featureElementInfo)||void 0===e?void 0:e.render(),"loading"===t?this._renderLoading():"disabled"===t?this._renderRelationshipNotFound():this._renderRelatedFeatures())}_renderStickyLoading(){return"querying"===this.viewModel.state?(0,h.u)("div",{class:re.stickySpinnerContainer,key:"sticky-loader"},this._renderLoadingIcon()):null}_renderLoadingIcon(){return(0,h.u)("calcite-loader",{inline:!0,label:""})}_renderLoading(){return(0,h.u)("div",{class:re.loadingSpinnerContainer,key:"loading-container"},this._renderLoadingIcon())}_renderShowAllIconNode(){return(0,h.u)("calcite-icon",{icon:"list",scale:"s",slot:"content-end"})}_renderChevronIconNode(){const e=(0,p.dZ)(this.container)?"chevron-left":"chevron-right";return(0,h.u)("calcite-icon",{icon:e,scale:"s",slot:"content-end"})}_renderRelatedFeature(e){var t,i;const{itemDescriptionFieldName:n}=this.viewModel,r=e.title;e.description=n&&(null===(t=e.formattedAttributes)||void 0===t?void 0:t.global[n]);const o="loading"===e.state;return(0,h.u)("calcite-list-item",{class:this.classes(re.listItem,{[re.listItemHidden]:o}),description:null!==(i=e.description)&&void 0!==i?i:"",key:e.uid,label:r,onCalciteListItemSelect:()=>this.emit("select-record",{featureViewModel:e})},this._renderChevronIconNode())}_renderShowAllListItem(){var e;return this.displayShowAllButton?(0,h.u)("calcite-list-item",{description:this.featureCountDescription,key:"show-all-item",label:null===(e=this.messages)||void 0===e?void 0:e.showAll,onCalciteListItemSelect:()=>this.emit("show-all-records")},this._renderShowAllIconNode()):null}_renderNoRelatedFeaturesMessage(){var e;return(0,h.u)("calcite-notice",{icon:"information",key:"no-related-features-message",kind:"brand",open:!0,scale:"s",width:"full"},(0,h.u)("div",{slot:"message"},null===(e=this.messages)||void 0===e?void 0:e.noRelatedFeatures))}_renderFeatureObserver(){return(0,h.u)("div",{afterCreate:this._relatedFeatureIntersectionObserverCreated,bind:this,class:re.featureObserver,key:"feature-observer"})}_renderList(){const{relatedFeatureViewModels:e}=this.viewModel;return(0,h.u)("calcite-list",null,e.toArray().map((e=>this._renderRelatedFeature(e))),this._renderShowAllListItem())}_renderRelatedFeatures(){const{displayListItems:e}=this,{state:t}=this.viewModel;return(0,h.u)("div",{class:this.classes(re.listContainer,{[re.listContainerQuerying]:"querying"===t}),key:"list-container"},e?this._renderList():"ready"===t?this._renderNoRelatedFeaturesMessage():null,this._renderStickyLoading(),this._renderFeatureObserver())}_renderRelationshipNotFound(){var e;return(0,h.u)("calcite-notice",{icon:"exclamation-mark-triangle",key:"relationship-not-found",kind:"danger",open:!0,scale:"s",width:"full"},(0,h.u)("div",{slot:"message"},null===(e=this.messages)||void 0===e?void 0:e.relationshipNotFound))}_setupRelatedFeatureViewModels(){const{relatedFeatureViewModels:e}=this.viewModel,t="related-feature-viewmodels";this.removeHandles(t),null!==e&&void 0!==e&&e.forEach((e=>{this.addHandles((0,r.watch)((()=>[e.title,e.state]),(()=>this.scheduleRender()),r.initial),t)})),this.scheduleRender()}_setupFeatureElementInfo(){var e;const{headingLevel:t,visibleElements:i}=this,n=i.description&&this.description,r=i.title&&this.title;null===(e=this._featureElementInfo)||void 0===e||e.set({description:n,title:r,headingLevel:t})}async _handleRelatedFeatureObserverChange(){this._unobserveRelatedFeatureObserver();const{state:e,showAllEnabled:t}=this.viewModel;await(0,ee.e4)(0),this._relatedFeatureIntersectionObserverNode&&"ready"===e&&t&&this._relatedFeatureIntersectionObserver.observe(this._relatedFeatureIntersectionObserverNode)}_relatedFeatureIntersectionObserverCreated(e){this._relatedFeatureIntersectionObserverNode=e}_unobserveRelatedFeatureObserver(){this._relatedFeatureIntersectionObserverNode&&this._relatedFeatureIntersectionObserver.unobserve(this._relatedFeatureIntersectionObserverNode)}};(0,n._)([(0,o.Cb)()],se.prototype,"_relatedFeatureIntersectionObserverNode",void 0),(0,n._)([(0,o.Cb)({readOnly:!0})],se.prototype,"displayShowAllButton",null),(0,n._)([(0,o.Cb)({readOnly:!0})],se.prototype,"displayListItems",null),(0,n._)([(0,o.Cb)()],se.prototype,"description",null),(0,n._)([(0,o.Cb)({readOnly:!0})],se.prototype,"featureCountDescription",null),(0,n._)([(0,o.Cb)()],se.prototype,"headingLevel",void 0),(0,n._)([(0,o.Cb)()],se.prototype,"title",null),(0,n._)([(0,o.Cb)({type:te.Z})],se.prototype,"viewModel",void 0),(0,n._)([(0,o.Cb)(),(0,S.H)("esri/widgets/Feature/t9n/Feature")],se.prototype,"messages",void 0),(0,n._)([(0,o.Cb)(),(0,S.H)("esri/t9n/common")],se.prototype,"messagesCommon",void 0),(0,n._)([(0,o.Cb)()],se.prototype,"visibleElements",void 0),(0,n._)([(0,s.p)("visibleElements")],se.prototype,"castVisibleElements",null),se=(0,n._)([(0,l.j)("esri.widgets.Feature.FeatureRelationship")],se);const le=se;var ae,de=i(71045),ce=i(29845),ue=i(72221);const pe={title:!0,content:!0,lastEditedInfo:!0},he="relationship-handles";let ve=ae=class extends((0,ue.q)(a.Z)){constructor(e,t){super(e,t),this._contentWidgets=[],this.flowItems=null,this.headingLevel=2,this.messages=null,this.messagesCommon=null,this.visibleElements={...pe},this.viewModel=new de.Z}initialize(){this.addHandles((0,r.watch)((()=>{var e;return null===(e=this.viewModel)||void 0===e?void 0:e.contentViewModels}),(()=>this._setupContentWidgets()),r.initial))}loadDependencies(){return(0,j.h)({notice:()=>Promise.all([i.e(92358),i.e(46895),i.e(15669)]).then(i.bind(i,15669)),loader:()=>i.e(92382).then(i.bind(i,92382))})}destroy(){this._destroyContentWidgets()}get graphic(){return this.viewModel.graphic}set graphic(e){this.viewModel.graphic=e}get defaultPopupTemplateEnabled(){return this.viewModel.defaultPopupTemplateEnabled}set defaultPopupTemplateEnabled(e){this.viewModel.defaultPopupTemplateEnabled=e}get isTable(){return this.viewModel.isTable}get icon(){return"polygon"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e,t;return null!==(e=null===(t=this.messages)||void 0===t?void 0:t.widgetLabel)&&void 0!==e?e:""}set label(e){this._overrideIfSome("label",e)}get spatialReference(){return this.viewModel.spatialReference}set spatialReference(e){this.viewModel.spatialReference=e}get timeZone(){return this.viewModel.timeZone}set timeZone(e){this.viewModel.timeZone=e}get title(){return this.viewModel.title}castVisibleElements(e){return{...pe,...e}}get map(){return this.viewModel.map}set map(e){this.viewModel.map=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}setActiveMedia(e,t){return this.viewModel.setActiveMedia(e,t)}nextMedia(e){return this.viewModel.nextMedia(e)}previousMedia(e){return this.viewModel.previousMedia(e)}render(){const{state:e}=this.viewModel,t=(0,h.u)("div",{class:ce.i.container,key:"container"},this._renderTitle(),"error"===e?this._renderError():"loading"===e?this._renderLoading():this._renderContentContainer());return(0,h.u)("div",{class:this.classes(ce.i.base,T.z.widget)},t)}_renderError(){const{messagesCommon:e,messages:t,visibleElements:i}=this;return(0,h.u)("calcite-notice",{icon:"exclamation-mark-circle",kind:"danger",open:!0,scale:"s"},i.title?(0,h.u)("div",{key:"error-title",slot:"title"},e.errorMessage):null,(0,h.u)("div",{key:"error-message",slot:"message"},t.loadingError))}_renderLoading(){return(0,h.u)("div",{class:ce.i.loadingSpinnerContainer,key:"loading-container"},(0,h.u)("calcite-loader",{inline:!0,label:""}))}_renderContentContainer(){const{visibleElements:e}=this;return e.content?(0,h.u)("div",{class:ce.i.main},[this._renderContent(),this._renderLastEditInfo()]):null}_renderTitle(){const{visibleElements:e,title:t}=this;return e.title?(0,h.u)(u.X,{class:ce.i.title,innerHTML:t,level:this.headingLevel}):null}_renderContent(){const e=this.viewModel.content,t="content";if(!e)return null;if(Array.isArray(e))return e.length?(0,h.u)("div",{class:ce.i.contentNode,key:"".concat(t,"-content-elements")},e.map(this._renderContentElement,this)):null;if("string"==typeof e){const e=this._contentWidgets[0];return!e||e.destroyed?null:(0,h.u)("div",{class:this.classes(ce.i.contentNode,ce.i.contentNodeText),key:"".concat(t,"-content")},e.render())}return this.renderNodeContent(e)}_renderContentElement(e,t){var i;const{visibleElements:n}=this;if("boolean"!=typeof n.content&&(null===(i=n.content)||void 0===i||!i[e.type]))return null;switch(e.type){case"attachments":return this._renderAttachments(t);case"custom":return this._renderCustom(e,t);case"fields":return this._renderFields(t);case"media":return this._renderMedia(t);case"text":return this._renderText(e,t);case"expression":return this._renderExpression(t);case"relationship":return this._renderRelationship(t);default:return null}}_renderAttachments(e){const t=this._contentWidgets[e];if(!t||t.destroyed)return null;const{state:i,attachmentInfos:n}=t.viewModel;return"loading"===i||n.length>0?(0,h.u)("div",{class:this.classes(ce.i.contentElement),key:this._buildKey("attachments-element",e)},t.render()):null}_renderRelationship(e){const t=this._contentWidgets[e];return t&&!t.destroyed&&this.flowItems?(0,h.u)("div",{class:ce.i.contentElement,key:this._buildKey("relationship-element",e)},t.render()):null}_renderExpression(e){const t=this._contentWidgets[e];return!t||t.destroyed?null:(0,h.u)("div",{class:ce.i.contentElement,key:this._buildKey("expression-element",e)},t.render())}_renderCustom(e,t){const{creator:i}=e,n=this._contentWidgets[t];return!n||n.destroyed?null:i?(0,h.u)("div",{class:ce.i.contentElement,key:this._buildKey("custom-element",t)},n.render()):null}_renderFields(e){const t=this._contentWidgets[e];return!t||t.destroyed?null:(0,h.u)("div",{class:ce.i.contentElement,key:this._buildKey("fields-element",e)},t.render())}_renderMedia(e){const t=this._contentWidgets[e];return!t||t.destroyed?null:(0,h.u)("div",{class:ce.i.contentElement,key:this._buildKey("media-element",e)},t.render())}_renderLastEditInfo(){const{visibleElements:e,messages:t}=this,{lastEditInfo:i}=this.viewModel;if(!i||!e.lastEditedInfo)return null;const{date:n,user:r}=i,o="edit"===i.type?r?t.lastEditedByUser:t.lastEdited:r?t.lastCreatedByUser:t.lastCreated,s=(0,D.n)(o,{date:n,user:r});return(0,h.u)("div",{class:this.classes(ce.i.lastEditedInfo,ce.i.contentElement),key:"edit-info-element"},s)}_renderText(e,t){const i=e.text,n=this._contentWidgets[t];return!n||n.destroyed?null:i?(0,h.u)("div",{class:this.classes(ce.i.contentElement,ce.i.text),key:this._buildKey("text-element",t)},n.render()):null}_buildKey(e){for(var t,i=arguments.length,n=new Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];return"".concat(e,"__").concat((null===(t=this.viewModel)||void 0===t||null===(t=t.graphic)||void 0===t?void 0:t.uid)||"0","-").concat(n.join("-"))}_destroyContentWidget(e){e&&(e.viewModel=null,!e.destroyed&&e.destroy())}_destroyContentWidgets(){this.removeHandles(he),this._contentWidgets.forEach((e=>this._destroyContentWidget(e))),this._contentWidgets=[]}_addFeatureRelationshipHandles(e){const{flowItems:t,visibleElements:i}=this;this.addHandles([(0,r.on)((()=>e),"select-record",(e=>{let{featureViewModel:n}=e;t&&(n.abilities={relationshipContent:!0},t.push(new ae({flowItems:t,viewModel:n,visibleElements:i})))})),(0,r.on)((()=>e),"show-all-records",(()=>{if(!t)return;const{viewModel:i}=e;i.showAllEnabled=!0;const n=new le({visibleElements:{title:!1,description:!1},viewModel:i});this._addFeatureRelationshipHandles(n),t.push(n)}))],he)}_setupContentWidgets(){var e;this._destroyContentWidgets();const{headingLevel:t,visibleElements:i}=this,n=null===(e=this.viewModel)||void 0===e?void 0:e.content,{contentViewModels:r}=this.viewModel;if(Array.isArray(n))n.forEach(((e,n)=>{if("attachments"===e.type&&(this._contentWidgets[n]=new b({displayType:e.displayType,headingLevel:i.title&&t<6?t+1:t,viewModel:r[n]})),"fields"===e.type&&(this._contentWidgets[n]=new k({viewModel:r[n]})),"media"===e.type&&(this._contentWidgets[n]=new X({viewModel:r[n]})),"text"===e.type&&(this._contentWidgets[n]=new F({viewModel:r[n]})),"custom"===e.type&&(this._contentWidgets[n]=new F({viewModel:r[n]})),"expression"===e.type&&(this._contentWidgets[n]=new G({viewModel:r[n]})),"relationship"===e.type){const e=new le({viewModel:r[n]});this._addFeatureRelationshipHandles(e),this._contentWidgets[n]=e}}),this);else{const e=r[0];e&&!e.destroyed&&(this._contentWidgets[0]=new F({viewModel:e}))}this.scheduleRender()}};(0,n._)([(0,o.Cb)()],ve.prototype,"graphic",null),(0,n._)([(0,o.Cb)()],ve.prototype,"defaultPopupTemplateEnabled",null),(0,n._)([(0,o.Cb)()],ve.prototype,"flowItems",void 0),(0,n._)([(0,o.Cb)()],ve.prototype,"headingLevel",void 0),(0,n._)([(0,o.Cb)({readOnly:!0})],ve.prototype,"isTable",null),(0,n._)([(0,o.Cb)()],ve.prototype,"icon",null),(0,n._)([(0,o.Cb)()],ve.prototype,"label",null),(0,n._)([(0,o.Cb)(),(0,S.H)("esri/widgets/Feature/t9n/Feature")],ve.prototype,"messages",void 0),(0,n._)([(0,o.Cb)(),(0,S.H)("esri/t9n/common")],ve.prototype,"messagesCommon",void 0),(0,n._)([(0,o.Cb)()],ve.prototype,"spatialReference",null),(0,n._)([(0,o.Cb)()],ve.prototype,"timeZone",null),(0,n._)([(0,o.Cb)({readOnly:!0})],ve.prototype,"title",null),(0,n._)([(0,o.Cb)()],ve.prototype,"visibleElements",void 0),(0,n._)([(0,s.p)("visibleElements")],ve.prototype,"castVisibleElements",null),(0,n._)([(0,o.Cb)()],ve.prototype,"map",null),(0,n._)([(0,o.Cb)()],ve.prototype,"view",null),(0,n._)([(0,o.Cb)({type:de.Z})],ve.prototype,"viewModel",void 0),ve=ae=(0,n._)([(0,l.j)("esri.widgets.Feature")],ve);const fe=ve},83244:(e,t,i)=>{i.d(t,{Z:()=>a});var n=i(27366),r=i(49861),o=(i(93169),i(32718),i(84936),i(69912)),s=i(4819);let l=class extends s.Z{constructor(e){super(e),this.description=null,this.title=null}};(0,n._)([(0,r.Cb)()],l.prototype,"description",void 0),(0,n._)([(0,r.Cb)()],l.prototype,"title",void 0),l=(0,n._)([(0,o.j)("esri.widgets.Feature.FeatureAttachments.FeatureAttachmentsViewModel")],l);const a=l},50267:(e,t,i)=>{i.d(t,{Z:()=>u});var n=i(27366),r=i(52639),o=i(7138),s=i(94172),l=i(49861),a=(i(93169),i(32718),i(84936),i(69912)),d=i(45276);let c=class extends o.default{constructor(e){super(e),this._loadingPromise=null,this.created=null,this.creator=null,this.destroyer=null,this.graphic=null,this.addHandles((0,s.watch)((()=>this.creator),(e=>{this._destroyContent(),this._createContent(e)}),s.initial))}destroy(){this._destroyContent()}get state(){return this._loadingPromise?"loading":"ready"}_destroyContent(){const{created:e,graphic:t,destroyer:i}=this;e&&t&&((0,d.vD)({type:"content",value:i,event:{graphic:t}}),this._set("created",null))}async _createContent(e){const t=this.graphic;if(!t||!e)return;const i=(0,d.vD)({type:"content",value:e,event:{graphic:t}});this._loadingPromise=i,this.notifyChange("state");const n=await i;i===this._loadingPromise&&(this._loadingPromise=null,this.notifyChange("state"),this._set("created",n))}};(0,n._)([(0,l.Cb)({readOnly:!0})],c.prototype,"created",void 0),(0,n._)([(0,l.Cb)()],c.prototype,"creator",void 0),(0,n._)([(0,l.Cb)()],c.prototype,"destroyer",void 0),(0,n._)([(0,l.Cb)({type:r.Z})],c.prototype,"graphic",void 0),(0,n._)([(0,l.Cb)({readOnly:!0})],c.prototype,"state",null),c=(0,n._)([(0,a.j)("esri.widgets.Feature.FeatureContent.FeatureContentViewModel")],c);const u=c},57240:(e,t,i)=>{i.d(t,{Z:()=>b});var n=i(27366),r=(i(59486),i(52639)),o=i(7138),s=i(94172),l=i(14916),a=i(49861),d=(i(93169),i(32718),i(84936),i(69912)),c=(i(26418),i(23046),i(1374),i(39384),i(29230)),u=i(29514),p=(i(44051),i(98752)),h=i(26538),v=i(50267),f=i(86836),m=i(21516),_=i(83819),y=i(848);let g=class extends o.default{constructor(e){super(e),this._abortController=null,this.expressionInfo=null,this.graphic=null,this.contentElement=null,this.contentElementViewModel=null,this.interceptor=null,this.location=null,this.view=null,this._cancelQuery=()=>{const{_abortController:e}=this;e&&e.abort(),this._abortController=null},this._createVM=()=>{var e,t;const i=null===(e=this.contentElement)||void 0===e?void 0:e.type;null===(t=this.contentElementViewModel)||void 0===t||t.destroy();const n="fields"===i?new f.Z:"media"===i?new m.Z:"text"===i?new v.Z:null;this._set("contentElementViewModel",n)},this._compile=async()=>{this._cancelQuery();const e=new AbortController;this._abortController=e,await this._compileExpression(),this._abortController===e&&(this._abortController=null)},this._compileThrottled=(0,l.P)(this._compile,1,this),this._compileExpression=async()=>{const{expressionInfo:e,graphic:t,interceptor:i,spatialReference:n,map:r,location:o,view:s,_abortController:l}=this;if(!e||!t)return void this._set("contentElement",null);const a=await(0,_.LC)();if(l!==this._abortController)return;const d=await(0,_.Rq)({arcade:a,expressionInfo:e,graphic:t,location:o,interceptor:i,map:r,spatialReference:n,view:s});if(!d||"esri.arcade.Dictionary"!==d.declaredClass)return void this._set("contentElement",null);const h=await d.castAsJsonAsync(null===l||void 0===l?void 0:l.signal),v=null===h||void 0===h?void 0:h.type,f="media"===v?u.Z.fromJSON(h):"text"===v?p.Z.fromJSON(h):"fields"===v?c.Z.fromJSON(h):null;this._set("contentElement",f)},this.addHandles([(0,s.watch)((()=>[this.expressionInfo,this.graphic,this.map,this.spatialReference,this.view]),(()=>this._compileThrottled()),s.initial),(0,s.watch)((()=>[this.contentElement]),(()=>this._createVM()),s.initial)])}initialize(){this.addHandles(this._compileThrottled)}destroy(){var e;this._cancelQuery(),null!==(e=this.contentElementViewModel)&&void 0!==e&&e.destroy(),this._set("contentElementViewModel",null),this._set("contentElement",null)}get spatialReference(){var e,t;return null!==(e=null===(t=this.view)||void 0===t?void 0:t.spatialReference)&&void 0!==e?e:null}set spatialReference(e){this._override("spatialReference",e)}get state(){const{_abortController:e,contentElement:t,contentElementViewModel:i}=this;return e?"loading":t||i?"ready":"disabled"}get map(){var e,t;return null!==(e=null===(t=this.view)||void 0===t?void 0:t.map)&&void 0!==e?e:null}set map(e){this._override("map",e)}};(0,n._)([(0,a.Cb)()],g.prototype,"_abortController",void 0),(0,n._)([(0,a.Cb)({type:h.Z})],g.prototype,"expressionInfo",void 0),(0,n._)([(0,a.Cb)({type:r.Z})],g.prototype,"graphic",void 0),(0,n._)([(0,a.Cb)({readOnly:!0})],g.prototype,"contentElement",void 0),(0,n._)([(0,a.Cb)({readOnly:!0})],g.prototype,"contentElementViewModel",void 0),(0,n._)([(0,a.Cb)()],g.prototype,"interceptor",void 0),(0,n._)([(0,a.Cb)({type:y.Z})],g.prototype,"location",void 0),(0,n._)([(0,a.Cb)()],g.prototype,"spatialReference",null),(0,n._)([(0,a.Cb)({readOnly:!0})],g.prototype,"state",null),(0,n._)([(0,a.Cb)()],g.prototype,"map",null),(0,n._)([(0,a.Cb)()],g.prototype,"view",void 0),g=(0,n._)([(0,d.j)("esri.widgets.Feature.FeatureExpression.FeatureExpressionViewModel")],g);const b=g},86836:(e,t,i)=>{i.d(t,{Z:()=>u});var n=i(27366),r=i(7138),o=i(49861),s=(i(93169),i(32718),i(84936),i(69912)),l=i(89860),a=i(16698),d=i(45276);let c=class extends r.default{constructor(e){super(e),this.attributes=null,this.expressionInfos=null,this.description=null,this.fieldInfos=null,this.title=null}get formattedFieldInfos(){const{expressionInfos:e,fieldInfos:t}=this,i=[];return null!==t&&void 0!==t&&t.forEach((t=>{if(t.hasOwnProperty("visible")&&!t.visible)return;const n=t.clone();n.label=(0,d.JD)(n,e),i.push(n)})),i}};(0,n._)([(0,o.Cb)()],c.prototype,"attributes",void 0),(0,n._)([(0,o.Cb)({type:[l.Z]})],c.prototype,"expressionInfos",void 0),(0,n._)([(0,o.Cb)()],c.prototype,"description",void 0),(0,n._)([(0,o.Cb)({type:[a.Z]})],c.prototype,"fieldInfos",void 0),(0,n._)([(0,o.Cb)({readOnly:!0})],c.prototype,"formattedFieldInfos",null),(0,n._)([(0,o.Cb)()],c.prototype,"title",void 0),c=(0,n._)([(0,s.j)("esri.widgets.Feature.FeatureFields.FeatureFieldsViewModel")],c);const u=c},21516:(e,t,i)=>{i.d(t,{Z:()=>f});var n=i(27366),r=i(7138),o=i(63780),s=i(49861),l=i(89125),a=(i(93169),i(69912)),d=i(16698),c=i(60260),u=i(45276),p=i(16490);const h={chartAnimation:!0};let v=class extends r.default{constructor(e){super(e),this.abilities={...h},this.activeMediaInfoIndex=0,this.attributes=null,this.description=null,this.fieldInfoMap=null,this.formattedAttributes=null,this.expressionAttributes=null,this.isAggregate=!1,this.layer=null,this.mediaInfos=null,this.popupTemplate=null,this.relatedInfos=null,this.title=null}castAbilities(e){return{...h,...e}}get activeMediaInfo(){return this.formattedMediaInfos[this.activeMediaInfoIndex]||null}get formattedMediaInfos(){return this._formatMediaInfos()||[]}get formattedMediaInfoCount(){return this.formattedMediaInfos.length}setActiveMedia(e){this._setContentElementMedia(e)}next(){this._pageContentElementMedia(1)}previous(){this._pageContentElementMedia(-1)}_setContentElementMedia(e){const{formattedMediaInfoCount:t}=this,i=(e+t)%t;this.activeMediaInfoIndex=i}_pageContentElementMedia(e){const{activeMediaInfoIndex:t}=this,i=t+e;this._setContentElementMedia(i)}_formatMediaInfos(){var e,t,i,n,r;const{mediaInfos:s,layer:l}=this,a=null!==(e=this.attributes)&&void 0!==e?e:{},d=null!==(t=this.formattedAttributes)&&void 0!==t?t:{},c=null!==(i=this.expressionAttributes)&&void 0!==i?i:{},p=null!==(n=this.fieldInfoMap)&&void 0!==n?n:new Map;return null!==(r=null===s||void 0===s?void 0:s.map((e=>{const t=null===e||void 0===e?void 0:e.clone();if(!t)return null;if(t.title=(0,u.S$)({attributes:a,fieldInfoMap:p,globalAttributes:d,expressionAttributes:c,layer:l,text:t.title}),t.caption=(0,u.S$)({attributes:a,fieldInfoMap:p,globalAttributes:d,expressionAttributes:c,layer:l,text:t.caption}),t.altText=(0,u.S$)({attributes:a,fieldInfoMap:p,globalAttributes:d,expressionAttributes:c,layer:l,text:t.altText}),"image"===t.type){if(!t.value)return;return this._setImageValue({value:t.value,formattedAttributes:d,layer:l}),t.value.sourceURL?t:void 0}if("pie-chart"===t.type||"line-chart"===t.type||"column-chart"===t.type||"bar-chart"===t.type){if(!t.value)return;return this._setChartValue({value:t.value,chartType:t.type,attributes:a,formattedAttributes:d,layer:l,expressionAttributes:c}),t}return null})).filter(o.pC))&&void 0!==r?r:[]}_setImageValue(e){var t;const i=null!==(t=this.fieldInfoMap)&&void 0!==t?t:new Map,{value:n,formattedAttributes:r,layer:o}=e,{linkURL:s,sourceURL:l}=n;if(l){const e=(0,u.Qu)(l,o);n.sourceURL=(0,u.ar)({formattedAttributes:r,template:e,fieldInfoMap:i})}if(s){const e=(0,u.Qu)(s,o);n.linkURL=(0,u.ar)({formattedAttributes:r,template:e,fieldInfoMap:i})}}_setChartValue(e){var t;const{value:i,attributes:n,formattedAttributes:r,chartType:o,layer:s,expressionAttributes:l}=e,{popupTemplate:a,relatedInfos:d}=this,{fields:c,normalizeField:p}=i,h=s;if(i.fields=(0,u.iJ)(c,h),p&&(i.normalizeField=(0,u.k6)(p,h)),!c.some((e=>!!(null!=r[e]||(0,u.oM)(e)&&null!==d&&void 0!==d&&d.size))))return;const v=null!==(t=null===a||void 0===a?void 0:a.fieldInfos)&&void 0!==t?t:[];c.forEach(((e,t)=>{var s;const a=null===(s=i.colors)||void 0===s?void 0:s[t];if((0,u.oM)(e))return void(i.series=[...i.series,...this._getRelatedChartInfos({fieldInfos:v,fieldName:e,formattedAttributes:r,chartType:o,value:i,color:a})]);const d=this._getChartOption({value:i,attributes:n,chartType:o,formattedAttributes:r,expressionAttributes:l,fieldName:e,fieldInfos:v,color:a});i.series.push(d)}))}_getRelatedChartInfos(e){var t;const{fieldInfos:i,fieldName:n,formattedAttributes:r,chartType:o,value:s,color:l}=e,a=[],d=(0,p.Bt)(n),c=d&&(null===(t=this.relatedInfos)||void 0===t?void 0:t.get(d.layerId.toString()));if(!c)return a;const{relatedFeatures:u,relation:h}=c;if(!h||!u)return a;const{cardinality:v}=h;return u.forEach((e=>{const{attributes:t}=e;t&&Object.keys(t).forEach((e=>{e===d.fieldName&&a.push(this._getChartOption({value:s,attributes:t,formattedAttributes:r,fieldName:n,chartType:o,relatedFieldName:e,hasMultipleRelatedFeatures:(null===u||void 0===u?void 0:u.length)>1,fieldInfos:i,color:l}))}))})),"one-to-many"===v||"many-to-many"===v?a:[a[0]]}_getTooltip(e){let{label:t,value:i,chartType:n}=e;return"pie-chart"===n?"".concat(t):"".concat(t,": ").concat(i)}_getChartOption(e){var t,i;const{value:n,attributes:r,formattedAttributes:o,expressionAttributes:s,fieldName:l,relatedFieldName:a,fieldInfos:h,chartType:v,hasMultipleRelatedFeatures:f,color:m}=e,_=this.layer,y=null!==(t=this.fieldInfoMap)&&void 0!==t?t:new Map,{normalizeField:g,tooltipField:b}=n,w=g?(0,u.oM)(g)?r[(0,p.Bt)(g).fieldName]:r[g]:null,I=(0,u.Rd)(l)&&s&&void 0!==s[l]?s[l]:a&&void 0!==r[a]?r[a]:void 0!==r[l]?r[l]:o[l],M=new c.Z({fieldName:l,color:m,value:void 0===I?null:I&&w?I/w:I});if((0,u.oM)(l)){var C,A,x,F,E;const e=y.get(l.toLowerCase()),t=b&&y.get(b.toLowerCase()),i=null!==(C=null===e||void 0===e?void 0:e.fieldName)&&void 0!==C?C:l,n=f&&b?(0,p.Bt)(b).fieldName:null!==(A=null===t||void 0===t?void 0:t.fieldName)&&void 0!==A?A:b,s=f&&n?r[n]:null!==(x=null!==(F=null!==(E=o[n])&&void 0!==E?E:null===e||void 0===e?void 0:e.label)&&void 0!==F?F:null===e||void 0===e?void 0:e.fieldName)&&void 0!==x?x:a,d=f&&a?r[a]:o[i];return M.tooltip=this._getTooltip({label:s,value:d,chartType:v}),M}const T=(0,u._R)(h,l),R=(0,u.k6)(l,_),S=b&&void 0!==o[b]?o[b]:(0,u.JD)(T||new d.Z({fieldName:R}),null===(i=this.popupTemplate)||void 0===i?void 0:i.expressionInfos),L=o[R];return M.tooltip=this._getTooltip({label:S,value:L,chartType:v}),M}};(0,n._)([(0,s.Cb)()],v.prototype,"abilities",void 0),(0,n._)([(0,l.p)("abilities")],v.prototype,"castAbilities",null),(0,n._)([(0,s.Cb)()],v.prototype,"activeMediaInfoIndex",void 0),(0,n._)([(0,s.Cb)({readOnly:!0})],v.prototype,"activeMediaInfo",null),(0,n._)([(0,s.Cb)()],v.prototype,"attributes",void 0),(0,n._)([(0,s.Cb)()],v.prototype,"description",void 0),(0,n._)([(0,s.Cb)()],v.prototype,"fieldInfoMap",void 0),(0,n._)([(0,s.Cb)()],v.prototype,"formattedAttributes",void 0),(0,n._)([(0,s.Cb)()],v.prototype,"expressionAttributes",void 0),(0,n._)([(0,s.Cb)({readOnly:!0})],v.prototype,"formattedMediaInfos",null),(0,n._)([(0,s.Cb)()],v.prototype,"isAggregate",void 0),(0,n._)([(0,s.Cb)()],v.prototype,"layer",void 0),(0,n._)([(0,s.Cb)({readOnly:!0})],v.prototype,"formattedMediaInfoCount",null),(0,n._)([(0,s.Cb)()],v.prototype,"mediaInfos",void 0),(0,n._)([(0,s.Cb)()],v.prototype,"popupTemplate",void 0),(0,n._)([(0,s.Cb)()],v.prototype,"relatedInfos",void 0),(0,n._)([(0,s.Cb)()],v.prototype,"title",void 0),v=(0,n._)([(0,a.j)("esri.widgets.Feature.FeatureMedia.FeatureMediaViewModel")],v);const f=v},71045:(e,t,i)=>{i.d(t,{Z:()=>L});var n=i(27366),r=(i(59486),i(52639));var o,s=i(7138),l=i(63780),a=i(79056),d=i(32718),c=i(66978),u=i(94172),p=i(14916),h=i(49861),v=i(89125),f=(i(93169),i(69912)),m=i(98752),_=i(6701),y=i(83244),g=i(50267),b=i(57240),w=i(86836),I=i(21516),M=i(67667),C=i(83819),A=i(45276),x=i(16490),F=i(848);const E="content-view-models",T="relationship-view-models",R={attachmentsContent:!0,chartAnimation:!0,customContent:!0,expressionContent:!0,fieldsContent:!0,mediaContent:!0,textContent:!0,relationshipContent:!0};let S=o=class extends((0,a.IG)(s.default)){constructor(e){super(e),this._error=null,this._featureAbortController=null,this._graphicChangedThrottled=(0,p.P)(this._graphicChanged,1,this),this._expressionAttributes=null,this._graphicExpressionAttributes=null,this.abilities={...R},this.content=null,this.contentViewModels=[],this.description=null,this.defaultPopupTemplateEnabled=!1,this.formattedAttributes=null,this.lastEditInfo=null,this.location=null,this.relatedInfos=new Map,this.title="",this.view=null,this._isAllowedContentType=e=>{const{abilities:t}=this;return"attachments"===e.type&&!!t.attachmentsContent||"custom"===e.type&&!!t.customContent||"fields"===e.type&&!!t.fieldsContent||"media"===e.type&&!!t.mediaContent||"text"===e.type&&!!t.textContent||"expression"===e.type&&!!t.expressionContent||"relationship"===e.type&&!!t.relationshipContent},this.addHandles((0,u.watch)((()=>[this.graphic,this._effectivePopupTemplate,this.abilities,this.timeZone]),(()=>this._graphicChangedThrottled()),u.initial))}initialize(){this.addHandles(this._graphicChangedThrottled)}destroy(){this._clear(),this._cancelFeatureQuery(),this._error=null,this.graphic=null,this._destroyContentViewModels(),this.relatedInfos.clear()}get _effectivePopupTemplate(){return null!=this.graphic?this.graphic.getEffectivePopupTemplate(this.defaultPopupTemplateEnabled):null}get _fieldInfoMap(){return(0,A.EB)((0,A.Hs)(this._effectivePopupTemplate),this._sourceLayer)}get _sourceLayer(){return(0,A.l$)(this.graphic)}castAbilities(e){return{...R,...e}}get isTable(){var e;return(null===(e=this._sourceLayer)||void 0===e?void 0:e.isTable)||!1}get state(){return this.graphic?this._error?"error":this.waitingForContent?"loading":"ready":"disabled"}set graphic(e){var t;this._set("graphic",null!==(t=null===e||void 0===e?void 0:e.clone())&&void 0!==t?t:null)}get spatialReference(){var e,t;return null!==(e=null===(t=this.view)||void 0===t?void 0:t.spatialReference)&&void 0!==e?e:null}set spatialReference(e){this._override("spatialReference",e)}get timeZone(){var e,t;return null!==(e=null===(t=this.view)||void 0===t?void 0:t.timeZone)&&void 0!==e?e:_.By}set timeZone(e){this._overrideIfSome("timeZone",e)}get map(){var e;return(null===(e=this.view)||void 0===e?void 0:e.map)||null}set map(e){this._override("map",e)}get waitingForContent(){return!!this._featureAbortController}setActiveMedia(e,t){const i=this.contentViewModels[e];i instanceof I.Z&&i.setActiveMedia(t)}nextMedia(e){const t=this.contentViewModels[e];t instanceof I.Z&&t.next()}previousMedia(e){const t=this.contentViewModels[e];t instanceof I.Z&&t.previous()}async updateGeometry(){var e;const{graphic:t,spatialReference:i,_sourceLayer:n}=this;await(null===n||void 0===n?void 0:n.load());const r=null===n||void 0===n?void 0:n.objectIdField;if(!r||!t||!n)return;const o=null===t||void 0===t||null===(e=t.attributes)||void 0===e?void 0:e[r];if(null==o)return;const s=[o];if(!t.geometry){const e=await(0,A.K7)({layer:n,graphic:t,outFields:[],objectIds:s,returnGeometry:!0,spatialReference:i}),r=null===e||void 0===e?void 0:e.geometry;r&&(t.geometry=r)}}_clear(){this._set("title",""),this._set("content",null),this._set("formattedAttributes",null)}async _graphicChanged(){this._cancelFeatureQuery(),this._error=null,this._clear();const{graphic:e}=this;if(!e)return;const t=new AbortController;this._featureAbortController=t;try{await this._queryFeature({signal:t.signal})}catch(i){(0,c.D_)(i)||(this._error=i,d.Z.getLogger(this).error("error","The popupTemplate could not be displayed for this feature.",{error:i,graphic:e,popupTemplate:this._effectivePopupTemplate}))}this._featureAbortController===t&&(this._featureAbortController=null)}_cancelFeatureQuery(){const{_featureAbortController:e}=this;e&&e.abort(),this._featureAbortController=null}_compileContentElement(e,t){return"attachments"===e.type?this._compileAttachments(e,t):"custom"===e.type?this._compileCustom(e,t):"fields"===e.type?this._compileFields(e,t):"media"===e.type?this._compileMedia(e,t):"text"===e.type?this._compileText(e,t):"expression"===e.type?this._compileExpression(e,t):"relationship"===e.type?this._compileRelationship(e,t):void 0}_compileContent(e){if(this._destroyContentViewModels(),this.graphic)return Array.isArray(e)?e.filter(this._isAllowedContentType).map(((e,t)=>this._compileContentElement(e,t))).filter(l.pC):"string"==typeof e?this._compileText(new m.Z({text:e}),0).text:e}_destroyContentViewModels(){this.removeHandles(T),this.removeHandles(E),this.contentViewModels.forEach((e=>e&&!e.destroyed&&e.destroy())),this._set("contentViewModels",[])}_matchesFeature(e,t){var i;const n=null===e||void 0===e||null===(i=e.graphic)||void 0===i?void 0:i.getObjectId(),r=null===t||void 0===t?void 0:t.getObjectId();return null!=n&&null!=r&&n===r}_setRelatedFeaturesViewModels(e){let{relatedFeatureViewModels:t,relatedFeatures:i,map:n}=e;const{view:r,spatialReference:s,timeZone:l}=this;null!==i&&void 0!==i&&i.filter(Boolean).forEach((e=>{t.some((t=>this._matchesFeature(t,e)))||t.add(new o({abilities:{relationshipContent:!1},map:n,view:r,spatialReference:s,timeZone:l,graphic:e}))})),t.forEach((e=>{const n=null===i||void 0===i?void 0:i.find((t=>this._matchesFeature(e,t)));n||t.remove(e)}))}_setExpressionContentVM(e,t){const i=this.formattedAttributes,{contentElement:n,contentElementViewModel:r}=e,o=null===n||void 0===n?void 0:n.type;r&&o&&("fields"===o&&(this._createFieldsFormattedAttributes({contentElement:n,contentElementIndex:t,formattedAttributes:i}),r.set(this._createFieldsVMParams(n,t))),"media"===o&&(this._createMediaFormattedAttributes({contentElement:n,contentElementIndex:t,formattedAttributes:i}),r.set(this._createMediaVMParams(n,t))),"text"===o&&r.set(this._createTextVMParams(n)))}_compileRelationship(e,t){const{displayCount:i,orderByFields:n,relationshipId:r,title:o,description:s}=e,{_sourceLayer:l,graphic:a,map:d}=this;if(!(0,A.Um)(l))return;const c=new M.Z({displayCount:i,graphic:a,orderByFields:n,relationshipId:r,layer:l,map:d,...this._compileTitleAndDesc({title:o,description:s})});return this.contentViewModels[t]=c,this.addHandles((0,u.on)((()=>c.relatedFeatures),"change",(()=>this._setRelatedFeaturesViewModels(c))),T),e}_compileExpression(e,t){const{expressionInfo:i}=e,{graphic:n,map:r,spatialReference:s,view:l,location:a}=this,d=new b.Z({expressionInfo:i,graphic:n,interceptor:o.interceptor,map:r,spatialReference:s,view:l,location:a});return this.contentViewModels[t]=d,this.addHandles((0,u.watch)((()=>d.contentElementViewModel),(()=>this._setExpressionContentVM(d,t)),u.initial),E),e}_compileAttachments(e,t){const{graphic:i}=this,{description:n,title:r}=e;return this.contentViewModels[t]=new y.Z({graphic:i,...this._compileTitleAndDesc({title:r,description:n})}),e}_compileCustom(e,t){const{graphic:i}=this,{creator:n,destroyer:r}=e;return this.contentViewModels[t]=new g.Z({graphic:i,creator:n,destroyer:r}),e}_compileTitleAndDesc(e){let{title:t,description:i}=e;const{_fieldInfoMap:n,_sourceLayer:r,graphic:o,formattedAttributes:s}=this,l=null===o||void 0===o?void 0:o.attributes,a=this._expressionAttributes,d=s.global;return{title:(0,A.S$)({attributes:l,fieldInfoMap:n,globalAttributes:d,expressionAttributes:a,layer:r,text:t}),description:(0,A.S$)({attributes:l,fieldInfoMap:n,globalAttributes:d,expressionAttributes:a,layer:r,text:i})}}_createFieldsVMParams(e,t){const i=this._effectivePopupTemplate,n=this.formattedAttributes,r={...null===n||void 0===n?void 0:n.global,...null===n||void 0===n?void 0:n.content[t]},o=(null===e||void 0===e?void 0:e.fieldInfos)||(null===i||void 0===i?void 0:i.fieldInfos),s=null===o||void 0===o?void 0:o.filter((e=>{let{fieldName:t}=e;return!!t&&((0,A.Rd)(t)||(0,A.oM)(t)||r.hasOwnProperty(t))})),l=null===i||void 0===i?void 0:i.expressionInfos,{description:a,title:d}=e;return{attributes:r,expressionInfos:l,fieldInfos:s,...this._compileTitleAndDesc({title:d,description:a})}}_compileFields(e,t){const i=e.clone(),n=new w.Z(this._createFieldsVMParams(e,t));return this.contentViewModels[t]=n,i.fieldInfos=n.formattedFieldInfos.slice(0),i}_createMediaVMParams(e,t){var i;const{abilities:n,graphic:r,_fieldInfoMap:o,_effectivePopupTemplate:s,relatedInfos:l,_sourceLayer:a,_expressionAttributes:d}=this,c=this.formattedAttributes,u=null!==(i=null===r||void 0===r?void 0:r.attributes)&&void 0!==i?i:{},{description:p,mediaInfos:h,title:v}=e;return{abilities:{chartAnimation:n.chartAnimation},activeMediaInfoIndex:e.activeMediaInfoIndex||0,attributes:u,isAggregate:null===r||void 0===r?void 0:r.isAggregate,layer:a,fieldInfoMap:o,formattedAttributes:{...null===c||void 0===c?void 0:c.global,...null===c||void 0===c?void 0:c.content[t]},expressionAttributes:d,mediaInfos:h,popupTemplate:s,relatedInfos:l,...this._compileTitleAndDesc({title:v,description:p})}}_compileMedia(e,t){const i=e.clone(),n=new I.Z(this._createMediaVMParams(e,t));return i.mediaInfos=n.formattedMediaInfos.slice(0),this.contentViewModels[t]=n,i}_createTextVMParams(e){const{graphic:t,_fieldInfoMap:i,_sourceLayer:n,_expressionAttributes:r}=this;if(e&&e.text){var o,s,l;const a=null!==(o=null===t||void 0===t?void 0:t.attributes)&&void 0!==o?o:{},d=null!==(s=null===(l=this.formattedAttributes)||void 0===l?void 0:l.global)&&void 0!==s?s:{};e.text=(0,A.S$)({attributes:a,fieldInfoMap:i,globalAttributes:d,expressionAttributes:r,layer:n,text:e.text})}return{graphic:t,creator:e.text}}_compileText(e,t){const i=e.clone();return this.contentViewModels[t]=new g.Z(this._createTextVMParams(i)),i}_compileLastEditInfo(){const{_effectivePopupTemplate:e,_sourceLayer:t,graphic:i,timeZone:n}=this;if(!e)return;const{lastEditInfoEnabled:r}=e,o=null===t||void 0===t?void 0:t.editFieldsInfo;return r&&o?(0,A.Tj)(o,null===i||void 0===i?void 0:i.attributes,n,t):void 0}_compileTitle(e){var t,i,n;const{_fieldInfoMap:r,_sourceLayer:o,graphic:s,_expressionAttributes:l}=this,a=null!==(t=null===s||void 0===s?void 0:s.attributes)&&void 0!==t?t:{},d=null!==(i=null===(n=this.formattedAttributes)||void 0===n?void 0:n.global)&&void 0!==i?i:{};return(0,A.S$)({attributes:a,fieldInfoMap:r,globalAttributes:d,expressionAttributes:l,layer:o,text:e})}async _getTitle(){const{_effectivePopupTemplate:e,graphic:t}=this;return t?(0,A.vD)({type:"title",value:null===e||void 0===e?void 0:e.title,event:{graphic:t}}):null}async _getContent(){const{_effectivePopupTemplate:e,graphic:t}=this;return t?(0,A.vD)({type:"content",value:null===e||void 0===e?void 0:e.content,event:{graphic:t}}):null}async _queryFeature(e){const{_featureAbortController:t,_sourceLayer:i,graphic:n,_effectivePopupTemplate:r}=this,s=this.map,l=this.view,a=this.spatialReference,d=this.location;if(t!==this._featureAbortController||!n)return;await(0,A.Xh)({graphic:n,popupTemplate:r,layer:i,spatialReference:a},e);const{content:{value:u},title:{value:p}}=await(0,c.as)({content:this._getContent(),title:this._getTitle()}),{expressionAttributes:{value:h}}=await(0,c.as)({checkForRelatedFeatures:this._checkForRelatedFeatures(e),expressionAttributes:(0,C.Um)({expressionInfos:null===r||void 0===r?void 0:r.expressionInfos,spatialReference:a,graphic:n,map:s,interceptor:o.interceptor,view:l,options:e,location:d})});t===this._featureAbortController&&n&&(this._expressionAttributes=h,this._graphicExpressionAttributes={...n.attributes,...h},this._set("formattedAttributes",this._createFormattedAttributes(u)),this._set("title",this._compileTitle(p)),this._set("lastEditInfo",this._compileLastEditInfo()||null),this._set("content",this._compileContent(u)||null))}_createMediaFormattedAttributes(e){let{contentElement:t,contentElementIndex:i,formattedAttributes:n}=e;const{_effectivePopupTemplate:r,graphic:o,relatedInfos:s,_sourceLayer:l,_fieldInfoMap:a,_graphicExpressionAttributes:d,timeZone:c}=this;n.content[i]=(0,A.uI)({fieldInfos:null===r||void 0===r?void 0:r.fieldInfos,graphic:o,attributes:{...d,...t.attributes},layer:l,fieldInfoMap:a,relatedInfos:s,timeZone:c})}_createFieldsFormattedAttributes(e){let{contentElement:t,contentElementIndex:i,formattedAttributes:n}=e;if(t.fieldInfos){const{graphic:e,relatedInfos:r,_sourceLayer:o,_fieldInfoMap:s,_graphicExpressionAttributes:l,timeZone:a}=this;n.content[i]=(0,A.uI)({fieldInfos:t.fieldInfos,graphic:e,attributes:{...l,...t.attributes},layer:o,fieldInfoMap:s,relatedInfos:r,timeZone:a})}}_createFormattedAttributes(e){const{_effectivePopupTemplate:t,graphic:i,relatedInfos:n,_sourceLayer:r,_fieldInfoMap:o,_graphicExpressionAttributes:s,timeZone:l}=this,a=null===t||void 0===t?void 0:t.fieldInfos,d={global:(0,A.uI)({fieldInfos:a,graphic:i,attributes:s,layer:r,fieldInfoMap:o,relatedInfos:n,timeZone:l}),content:[]};return Array.isArray(e)&&e.forEach(((e,t)=>{"fields"===e.type&&this._createFieldsFormattedAttributes({contentElement:e,contentElementIndex:t,formattedAttributes:d}),"media"===e.type&&this._createMediaFormattedAttributes({contentElement:e,contentElementIndex:t,formattedAttributes:d})})),d}_checkForRelatedFeatures(e){const{graphic:t,_effectivePopupTemplate:i}=this;return this._queryRelatedInfos(t,(0,A.Hs)(i),e)}async _queryRelatedInfos(e,t,i){const{relatedInfos:n,_sourceLayer:r}=this;n.clear();const o=null!=(null===r||void 0===r?void 0:r.associatedLayer)?await(null===r||void 0===r?void 0:r.associatedLayer.load(i)):r;if(!o||!e)return;const s=t.filter((e=>!!e.fieldName&&(0,A.oM)(e.fieldName)));if(null===s||void 0===s||!s.length)return;t.forEach((e=>this._configureRelatedInfo(e,o)));const l=await(0,x.Vb)({relatedInfos:n,layer:o},i);Object.keys(l).forEach((e=>{var t;const i=n.get(e.toString()),r=null===(t=l[e])||void 0===t?void 0:t.value;i&&r&&(i.layerInfo=r.data)}));const a=await(0,x.kp)({graphic:e,relatedInfos:n,layer:o},i);Object.keys(a).forEach((e=>{var t;(0,x.lg)(null===(t=a[e])||void 0===t?void 0:t.value,n.get(e.toString()))}))}_configureRelatedInfo(e,t){const{relatedInfos:i}=this,n=(0,x.Bt)(e.fieldName||"");if(!n)return;const{layerId:r,fieldName:o}=n;if(!r)return;const s=i.get(r.toString())||(0,x.uc)(r,t);s&&((0,x.NF)({relatedInfo:s,fieldName:o,fieldInfo:e}),this.relatedInfos.set(r,s))}};S.interceptor=new class{constructor(e,t){this.preLayerQueryCallback=e,this.preRequestCallback=t,this.preLayerQueryCallback||(this.preLayerQueryCallback=e=>{}),this.preRequestCallback||(this.preLayerQueryCallback=e=>{})}}(A.s5,A.Ns),(0,n._)([(0,h.Cb)()],S.prototype,"_error",void 0),(0,n._)([(0,h.Cb)()],S.prototype,"_featureAbortController",void 0),(0,n._)([(0,h.Cb)({readOnly:!0})],S.prototype,"_effectivePopupTemplate",null),(0,n._)([(0,h.Cb)({readOnly:!0})],S.prototype,"_fieldInfoMap",null),(0,n._)([(0,h.Cb)({readOnly:!0})],S.prototype,"_sourceLayer",null),(0,n._)([(0,h.Cb)()],S.prototype,"abilities",void 0),(0,n._)([(0,v.p)("abilities")],S.prototype,"castAbilities",null),(0,n._)([(0,h.Cb)({readOnly:!0})],S.prototype,"content",void 0),(0,n._)([(0,h.Cb)({readOnly:!0})],S.prototype,"contentViewModels",void 0),(0,n._)([(0,h.Cb)()],S.prototype,"description",void 0),(0,n._)([(0,h.Cb)({type:Boolean})],S.prototype,"defaultPopupTemplateEnabled",void 0),(0,n._)([(0,h.Cb)({readOnly:!0})],S.prototype,"isTable",null),(0,n._)([(0,h.Cb)({readOnly:!0})],S.prototype,"state",null),(0,n._)([(0,h.Cb)({readOnly:!0})],S.prototype,"formattedAttributes",void 0),(0,n._)([(0,h.Cb)({type:r.Z,value:null})],S.prototype,"graphic",null),(0,n._)([(0,h.Cb)({readOnly:!0})],S.prototype,"lastEditInfo",void 0),(0,n._)([(0,h.Cb)({type:F.Z})],S.prototype,"location",void 0),(0,n._)([(0,h.Cb)({readOnly:!0})],S.prototype,"relatedInfos",void 0),(0,n._)([(0,h.Cb)()],S.prototype,"spatialReference",null),(0,n._)([(0,h.Cb)()],S.prototype,"timeZone",null),(0,n._)([(0,h.Cb)({readOnly:!0})],S.prototype,"title",void 0),(0,n._)([(0,h.Cb)()],S.prototype,"map",null),(0,n._)([(0,h.Cb)({readOnly:!0})],S.prototype,"waitingForContent",null),(0,n._)([(0,h.Cb)()],S.prototype,"view",void 0),S=o=(0,n._)([(0,f.j)("esri.widgets.Feature.FeatureViewModel")],S);const L=S},29845:(e,t,i)=>{i.d(t,{i:()=>r});const n="esri-feature",r={base:n,container:"".concat(n,"__size-container"),title:"".concat(n,"__title"),main:"".concat(n,"__main-container"),btn:"".concat(n,"__button"),icon:"".concat(n,"__icon"),content:"".concat(n,"__content"),contentNode:"".concat(n,"__content-node"),contentNodeText:"".concat(n,"__content-node--text"),contentElement:"".concat(n,"__content-element"),text:"".concat(n,"__text"),lastEditedInfo:"".concat(n,"__last-edited-info"),fields:"".concat(n,"__fields"),fieldHeader:"".concat(n,"__field-header"),fieldData:"".concat(n,"__field-data"),fieldDataDate:"".concat(n,"__field-data--date"),loadingSpinnerContainer:"".concat(n,"__loading-container")}},72221:(e,t,i)=>{i.d(t,{q:()=>a});var n=i(27366),r=(i(32718),i(93169),i(84936),i(10064),i(69912)),o=i(29845),s=i(53963),l=i(67005);const a=e=>{let t=class extends e{constructor(){super(...arguments),this.renderNodeContent=e=>(0,s.Qd)(e)&&!e.destroyed?(0,l.u)("div",{class:o.i.contentNode,key:e},e.render()):e instanceof HTMLElement?(0,l.u)("div",{afterCreate:this._attachToNode,bind:e,class:o.i.contentNode,key:e}):(0,s.o)(e)?(0,l.u)("div",{afterCreate:this._attachToNode,bind:e.domNode,class:o.i.contentNode,key:e}):null}_attachToNode(e){e.appendChild(this)}};return t=(0,n._)([(0,r.j)("esri.widgets.Feature.support.FeatureContentMixin")],t),t}},83819:(e,t,i)=>{i.d(t,{LC:()=>c,Rq:()=>p,Um:()=>h});var n=i(32718),r=i(66978),o=i(64326),s=i(45276),l=i(7021);const a=()=>n.Z.getLogger("esri.widgets.Feature.support.arcadeFeatureUtils");function d(e){return"string"==typeof e?(0,s.qD)((0,s.M3)(e)):Array.isArray(e)?function(e){return'<ul class="esri-widget__list">'.concat(e.map((e=>"<li>".concat("string"==typeof e?(0,s.qD)((0,s.M3)(e)):e,"</li>"))).join(""),"</ul>")}(e):"esri.arcade.Dictionary"===(null===e||void 0===e?void 0:e.declaredClass)?function(e){const t=e.keys().map((t=>{const i=e.field(t);return"<tr><th>".concat(t,"</th><td>").concat("string"==typeof i?(0,s.qD)((0,s.M3)(i)):i,"</td></tr>")})).join("");return'<table class="'.concat(l.z.table,'">').concat(t,"</table>")}(e):e}function c(){return Promise.all([i.e(45026),i.e(55515)]).then(i.bind(i,55515))}async function u(e){let{graphic:t,view:i,options:n}=e;const{isAggregate:r,layer:o}=t;if(!r||!o||"2d"!==(null===i||void 0===i?void 0:i.type))return[];const s=await i.whenLayerView(o);if(!function(e){return"createQuery"in e&&"queryFeatures"in e}(s))return[];const l=s.createQuery(),a=t.getObjectId();l.aggregateIds=null!=a?[a]:[];const{features:d}=await s.queryFeatures(l,n);return d}async function p(e){var t,i,n;let{expressionInfo:r,arcade:s,interceptor:l,spatialReference:d,map:c,graphic:p,location:h,view:v,options:f}=e;if(null===r||void 0===r||!r.expression)return null;const{isAggregate:m}=p,_=null!==(t=p.sourceLayer||p.layer)&&void 0!==t?t:void 0,y=m?"feature-reduction-popup":"popup",g=s.createArcadeProfile(y),b=s.createArcadeExecutor(r.expression,g).catch((e=>a().error("arcade-executor-error",{error:e,expressionInfo:r}))),[w,I]=await Promise.all([u({graphic:p,view:v,options:f}),b]);if(!I)return null;const M="feature-reduction-popup"===y?function(e){let{layer:t,aggregatedFeatures:i,interceptor:n}=e;const{fields:r,objectIdField:s,geometryType:l,spatialReference:a,displayField:d}=t;return new o.default({fields:r,objectIdField:s,geometryType:l,spatialReference:a,displayField:d,interceptor:n,..."feature"===t.type?{templates:t.templates,typeIdField:t.typeIdField,types:t.types}:null,source:i})}({layer:_,aggregatedFeatures:w,interceptor:l}):void 0,C={..."feature-reduction-popup"===y?{$aggregatedFeatures:M}:{$datastore:null===_||void 0===_?void 0:_.url,$layer:"feature"===(null===_||void 0===_?void 0:_.type)||"subtype-sublayer"===(null===_||void 0===_?void 0:_.type)||"catalog-footprint"===(null===_||void 0===_?void 0:_.type)||"oriented-imagery"===(null===_||void 0===_?void 0:_.type)?_:"scene"===(null===_||void 0===_?void 0:_.type)&&null!=_.associatedLayer?_.associatedLayer:void 0,$map:c,$userInput:h,$graph:"knowledge-graph-sublayer"===(null===_||void 0===_?void 0:_.type)?null===_||void 0===_||null===(i=_.parentCompositeLayer)||void 0===i?void 0:i.knowledgeGraph:void 0},$feature:p},A={abortSignal:null!==(n=null===f||void 0===f?void 0:f.signal)&&void 0!==n?n:void 0,interceptor:null!==l&&void 0!==l?l:void 0,rawOutput:!0,spatialReference:null!==d&&void 0!==d?d:void 0,timeZone:null===v||void 0===v?void 0:v.timeZone};return await I.executeAsync(C,A).catch((e=>a().error("arcade-execution-error",{error:e,graphic:p,expressionInfo:r}))).finally((()=>null===M||void 0===M?void 0:M.destroy()))}async function h(e){let{expressionInfos:t,spatialReference:i,graphic:n,interceptor:o,map:s,view:l,location:a,options:u}=e;if(null===t||void 0===t||!t.length)return{};const h=await c(),v={};for(const r of t)v["expression/".concat(r.name)]=p({expressionInfo:r,arcade:h,interceptor:o,spatialReference:i,map:s,graphic:n,location:a,view:l,options:u});const f=await(0,r.as)(v),m={};for(const r in f)m[r]=d(f[r].value);return m}},16490:(e,t,i)=>{i.d(t,{Bt:()=>m,NF:()=>I,Vb:()=>b,kp:()=>w,lg:()=>y,uc:()=>_});var n=i(76200),r=i(63780),o=i(10064),s=i(32718),l=i(66978),a=i(37270),d=(i(93169),i(64020),i(77946)),c=(i(42265),i(19545),i(35995),i(68860),i(83448),i(92975),i(41414),i(16889),i(53866),i(32238),i(77577),i(848),i(80885),i(29909),i(76335),i(78952),i(22186),i(59486),i(78084),i(49818),i(21149)),u=(i(11812),i(99837),i(99086)),p=(i(54307),i(33997)),h=i(45276);const v=()=>s.Z.getLogger("esri.widgets.Feature.support.relatedFeatureUtils"),f=new Map;function m(e){if(!(0,h.oM)(e))return null;const[t,i]=e.split("/").slice(1);return{layerId:t,fieldName:i}}function _(e,t){const i=function(e,t){if(!t.relationships)return null;let i=null;const{relationships:n}=t;return n.some((t=>t.id===parseInt(e,10)&&(i=t,!0))),i}(e,t);if(i)return{url:"".concat(t.url,"/").concat(i.relatedTableId),sourceSpatialReference:t.spatialReference,relation:i,relatedFields:[],outStatistics:[]}}function y(e,t){if(!t)return;if(!e)return;const{features:i,statsFeatures:n}=e,r=null===i||void 0===i?void 0:i.value;t.relatedFeatures=r?r.features:[];const o=null===n||void 0===n?void 0:n.value;t.relatedStatsFeatures=o?o.features:[]}async function g(e,t,i,n){const o=i.layerId.toString(),{layerInfo:s,relation:p,relatedFields:h,outStatistics:v,url:f,sourceSpatialReference:m}=t,_=function(e){return e?(0,r.Tw)(e):void 0}(h),y=function(e){return e?(0,r.Tw)(e,((e,t)=>JSON.stringify(e.toJSON())===JSON.stringify(t.toJSON()))):void 0}(v);if(!s||!p)return null;const g=function(e){var t;let{originRelationship:i,relationships:n,layerId:r}=e;return null!==(t=n.find((e=>{let{relatedTableId:t,id:n}=e;return"".concat(t)===r&&n===(null===i||void 0===i?void 0:i.id)})))&&void 0!==t?t:null}({originRelationship:p,relationships:s.relationships,layerId:o});if(null!==g&&void 0!==g&&g.relationshipTableId&&g.keyFieldInRelationshipTable){const t=(await function(e,t,i,n){var r,o,s,l;const a=new u.default;return a.outFields=["*"],a.relationshipId="number"==typeof t.id?t.id:parseInt(t.id,10),a.objectIds=[e.attributes[i.objectIdField]],a.gdbVersion=null!==(r=i.gdbVersion)&&void 0!==r?r:null,a.historicMoment=null!==(o=i.historicMoment)&&void 0!==o?o:null,null!==(s=null===(l=i.queryRelatedFeatures)||void 0===l?void 0:l.call(i,a,n))&&void 0!==s?s:Promise.resolve({})}(e,g,i,n))[e.attributes[i.objectIdField]];if(!t)return null;const r=t.features.map((e=>e.attributes[s.objectIdField]));if(null!==y&&void 0!==y&&y.length&&s.supportsStatistics){const e=new c.Z;e.where=function(e,t,i){let n=0;const r=[];for(;n<t.length;)r.push("".concat(e," IN (").concat(t.slice(n,i+n),")")),n+=i;return r.join(" OR ")}(s.objectIdField,r,1e3),e.outFields=_,e.outStatistics=y,e.sourceSpatialReference=m;const i={features:Promise.resolve(t),statsFeatures:(0,d.e)(f,e)};return(0,l.as)(i)}}const b=null===g||void 0===g?void 0:g.keyField;if(b){const t=(0,a.H7)(function(e,t){if(null!=e){t=t.toLowerCase();for(const i of e)if(i&&i.name.toLowerCase()===t)return i}return null}(s.fields,b)),r=function(e,t){const i=t.toLowerCase();for(const n in e)if(n.toLowerCase()===i)return e[n];return null}(e.attributes,p.keyField),o=t?"".concat(b,"=").concat(r):"".concat(b,"='").concat(r,"'"),u=i.historicMoment,h=i.gdbVersion,v=(0,d.e)(f,new c.Z({where:o,outFields:_,sourceSpatialReference:m,historicMoment:u,gdbVersion:h}),n),g=null!==y&&void 0!==y&&y.length&&s.supportsStatistics?(0,d.e)(f,new c.Z({where:o,outFields:_,outStatistics:y,sourceSpatialReference:m}),n):null,w={features:v};return g&&(w.statsFeatures=g),(0,l.as)(w)}return null}function b(e,t){let{relatedInfos:i,layer:r}=e;const s={};return i.forEach(((e,t)=>{const{relation:i}=e;if(!i){const e=new o.Z("relation-required","A relation is required on a layer to retrieve related records.");throw v().error(e),e}const{relatedTableId:l}=i;if("number"!=typeof l){const e=new o.Z("A related table ID is required on a layer to retrieve related records.");throw v().error(e),e}const a="".concat(r.url,"/").concat(l),d=f.get(a),c=null!==d&&void 0!==d?d:function(e,t){return(0,n.Z)(e,{query:{f:"json"},signal:null===t||void 0===t?void 0:t.signal})}(a);d||f.set(a,c),s[t]=c})),(0,l.Hl)((0,l.as)(s),t)}function w(e,t){let{graphic:i,relatedInfos:n,layer:r}=e;const o={};return n.forEach(((e,n)=>{e.layerInfo&&(o[n]=g(i,e,r,t))})),(0,l.as)(o)}function I(e){var t;let{relatedInfo:i,fieldName:n,fieldInfo:r}=e;if(null!==(t=i.relatedFields)&&void 0!==t&&t.push(n),r.statisticType){var o;const e=new p.Z({statisticType:r.statisticType,onStatisticField:n,outStatisticFieldName:n});null===(o=i.outStatistics)||void 0===o||o.push(e)}}},30333:(e,t,i)=>{i.d(t,{q:()=>o});var n=i(643);const r=[{pattern:/^\s*(https?:\/\/([^\s]+))\s*$/i,target:"_blank",label:"{messages.view}"},{pattern:/^\s*(tel:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(mailto:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"App Studio Player"},{pattern:/^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Collector"},{pattern:/^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Explorer"},{pattern:/^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Navigator"},{pattern:/^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Survey123"},{pattern:/^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Trek2There"},{pattern:/^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Workforce"},{pattern:/^\s*(iform:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"iForm"},{pattern:/^\s*(flow:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"FlowFinity"},{pattern:/^\s*(lfmobile:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Laserfische"},{pattern:/^\s*(mspbi:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Microsoft Power Bi"}];function o(e,t){if("string"!=typeof t||!t)return t;const i=r.find((e=>e.pattern.test(t)));if(!i)return t;const o=t.match(i.pattern),s=null===o||void 0===o?void 0:o[2],l=(0,n.gx)((0,n.gx)(i.label,{messages:e,hierPart:s}),{appName:i.appName}),a=i.target?' target="'.concat(i.target,'"'):"",d="_blank"===i.target?' rel="noreferrer"':"";return t.replace(i.pattern,"<a".concat(a,' href="$1"').concat(d,">").concat(l,"</a>"))}},53963:(e,t,i)=>{i.d(t,{Qd:()=>n,o:()=>r});i(78088),i(67005),i(80975);function n(e){return e&&"function"==typeof e.render}function r(e){return e&&"function"==typeof e.postMixInProperties&&"function"==typeof e.buildRendering&&"function"==typeof e.postCreate&&"function"==typeof e.startup}}}]);
//# sourceMappingURL=46639.96f842ab.chunk.js.map