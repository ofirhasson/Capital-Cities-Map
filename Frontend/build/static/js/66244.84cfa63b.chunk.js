"use strict";(self.webpackChunknorthwind=self.webpackChunknorthwind||[]).push([[66244,70116],{70116:(e,t,i)=>{var o;i.d(t,{Y:()=>o}),function(e){e[e.KILOBYTES=1024]="KILOBYTES",e[e.MEGABYTES=1048576]="MEGABYTES",e[e.GIGABYTES=1073741824]="GIGABYTES"}(o||(o={}))},47898:(e,t,i)=>{i.d(t,{Fp:()=>c,GJ:()=>r,M1:()=>a,MQ:()=>h,Ww:()=>y,bA:()=>d,hw:()=>p,mE:()=>u,ne:()=>l,nn:()=>s,qF:()=>v,yG:()=>n,yP:()=>m});var o=i(68860);function a(e){return{value:e}}function n(e,t){return{type:(0,o.UF)(t),value:e,unit:t}}function l(e,t){return{type:(0,o.UF)(t),value:e,unit:t}}function r(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"arithmetic";return{type:(0,o.UF)(t),value:e,unit:t,rotationType:i}}function s(e,t){const i=u(e,t);return"angle"===e.type?r(i,t,e.rotationType):function(e,t){return{type:(0,o.UF)(t),value:e,unit:t}}(i,t)}function u(e,t){return(0,o.En)(e.value,e.unit,t)}function c(e,t){return null==e?t:null==t||e.value>(0,o.En)(t.value,t.unit,e.unit)?e:t}function d(e,t){return null==e?null:{...e,value:e.value*t}}function p(e,t,i){if(t===i)return e;switch(i){case"arithmetic":case"geographic":return 90-e}}const m=n(0,"meters"),h=l(0,"square-meters"),y=(r(0,"radians"),r(0,"degrees")),v=r(0,"degrees","geographic")},5163:(e,t,i)=>{i.d(t,{L4:()=>C,LO:()=>p,Qv:()=>c,Rd:()=>m,Ud:()=>f,VG:()=>d,Wv:()=>y,Zv:()=>g,_o:()=>I,aC:()=>w,h9:()=>v,ld:()=>_,mg:()=>h,q6:()=>b,sS:()=>P,yc:()=>T});var o=i(70116),a=i(17768),n=i(16889),l=i(47898),r=i(643),s=i(68860),u=i(6291);function c(e,t,i){return e.units[t][i]}function d(e,t,i){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";return"".concat((0,u.uf)(t,{minimumFractionDigits:o,maximumFractionDigits:o,signDisplay:t>0?"never":"exceptZero"})," ").concat(c(e,i,a))}function p(e,t,i){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";return"".concat((0,u.uf)(t,{minimumFractionDigits:o,maximumFractionDigits:o,signDisplay:"exceptZero"})," ").concat(c(e,i,a))}function m(e,t,i){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const n=(0,s.Y8)(t,i);return d(e,(0,s.En)(t,i,n),n,o,a)}function h(e,t,i){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const n=(0,s.Y8)(t,i);return p(e,(0,s.En)(t,i,n),n,o,a)}function y(e,t,i){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const n=(0,s.Dw)(t,i);return d(e,(0,s.En)(t,i,n),n,o,a)}function v(e,t,i){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const n=(0,s.Dw)(t,i);return p(e,(0,s.En)(t,i,n),n,o,a)}function f(e,t,i){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const n=(0,s.Q7)(t,i);return d(e,(0,s.En)(t,i,n),n,o,a)}function b(e,t,i){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const n=(0,s.Q7)(t,i);return p(e,(0,s.En)(t,i,n),n,o,a)}function g(e,t,i){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const n=(0,s.jl)(t,i);return d(e,(0,s.En)(t,i,n),n,o,a)}function w(e,t,i){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const n=(0,s.jl)(t,i);return p(e,(0,s.En)(t,i,n),n,o,a)}function _(e,t,i){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const n=(0,s.ZI)(t,i);return d(e,(0,s.En)(t,i,n),n,o,a)}function T(e,t,i){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const n=(0,s.LV)(t,i);return d(e,(0,s.En)(t,i,n),n,o,a)}const S=(e,t)=>({style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:t,minimumFractionDigits:t,signDisplay:e>0?"never":"exceptZero"});function C(e,t,i,o,n){let r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:a.BV,c=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],d=r.normalize((0,l.hw)((0,s.En)(e,t,"degrees"),i,o),0,c);const p=S(d,null!==n&&void 0!==n?n:2);return d=O(d,p),(0,u.uf)(d,p)}function I(e,t,i,o,a){var n;i!==o&&(e=-e);const l={style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:a=null!==(n=a)&&void 0!==n?n:2,minimumFractionDigits:a,signDisplay:"exceptZero"};let r=(0,s.En)(e,t,"degrees")%360;return r=O(r,l),(0,u.uf)(r,l)}const x=new Map;function O(e,t){const i=JSON.stringify(t);let o=x.get(i);return o||(o=new Intl.NumberFormat("en-US",t),x.set(i,o)),/^[-+]?360\.?0*\xb0?$/.test(o.format(e))?0:e}const k=["B","kB","MB","GB","TB"];function P(e,t){let i=0===(t=Math.round(t))?0:Math.floor(Math.log(t)/Math.log(o.Y.KILOBYTES));i=(0,n.uZ)(i,0,k.length-1);const a=(0,u.uf)(t/o.Y.KILOBYTES**i,{maximumFractionDigits:2});return(0,r.gx)(e.units.bytes[k[i]],{fileSize:a})}},2429:(e,t,i)=>{i.d(t,{Z:()=>c});var o=i(27366),a=i(43404),n=i(46784),l=i(49861),r=(i(93169),i(32718),i(84936),i(69912));const s=new a.X({esriJobMessageTypeInformative:"informative",esriJobMessageTypeProcessDefinition:"process-definition",esriJobMessageTypeProcessStart:"process-start",esriJobMessageTypeProcessStop:"process-stop",esriJobMessageTypeWarning:"warning",esriJobMessageTypeError:"error",esriJobMessageTypeEmpty:"empty",esriJobMessageTypeAbort:"abort"});let u=class extends n.wq{constructor(e){super(e),this.description=null,this.type=null}};(0,o._)([(0,l.Cb)({type:String,json:{write:!0}})],u.prototype,"description",void 0),(0,o._)([(0,l.Cb)({type:String,json:{read:s.read,write:s.write}})],u.prototype,"type",void 0),u=(0,o._)([(0,r.j)("esri.rest.support.GPMessage")],u);const c=u},49022:(e,t,i)=>{i.d(t,{$7:()=>c,BW:()=>f,D$:()=>S,DJ:()=>m,Dd:()=>g,E2:()=>P,GX:()=>s,KA:()=>k,Ks:()=>L,RK:()=>l,S7:()=>O,SS:()=>v,Ul:()=>I,W7:()=>h,WP:()=>T,ZI:()=>C,cW:()=>w,dg:()=>u,dh:()=>r,ip:()=>p,kL:()=>x,no:()=>d,oi:()=>b,q$:()=>n,td:()=>_,yP:()=>y});var o=i(43404);const a={esriCentimeters:"centimeters",esriDecimalDegrees:"decimal-degrees",esriDecimeters:"decimeters",esriFeet:"feet",esriInches:"inches",esriKilometers:"kilometers",esriMeters:"meters",esriMiles:"miles",esriMillimeters:"millimeters",esriNauticalMiles:"nautical-miles",esriPoints:"points",esriUnknownUnits:"unknown",esriYards:"yards"},n=(0,o.w)()(a),l=(0,o.w)()({...a,esriIntFeet:"international-feet",esriIntInches:"international-inches",esriIntMiles:"international-miles",esriIntNauticalMiles:"international-nautical-miles",esriIntYards:"international-yards"}),r=(0,o.w)()({esriAcres:"international-acres",esriAcresUS:"us-acres",esriAres:"ares",esriHectares:"hectares",esriSquareCentimeters:"square-centimeters",esriSquareDecimeters:"square-decimeters",esriSquareFeet:"square-international-feet",esriSquareFeetUS:"square-us-feet",esriSquareInches:"square-international-inches",esriSquareInchesUS:"square-us-inches",esriSquareKilometers:"square-kilometers",esriSquareMeters:"square-meters",esriSquareMiles:"square-international-miles",esriSquareMilesUS:"square-us-miles",esriSquareMillimeters:"square-millimeters",esriSquareYards:"square-international-yards",esriSquareYardsUS:"square-us-yards",esriUnknownAreaUnits:"unknown"}),s=(0,o.w)()({esriNAUCentimeters:"centimeters",esriNAUDecimalDegrees:"decimal-degrees",esriNAUDecimeters:"decimeters",esriNAUFeet:"feet",esriNAUInches:"inches",esriNAUKilometers:"kilometers",esriNAUMeters:"meters",esriNAUMiles:"miles",esriNAUMillimeters:"millimeters",esriNAUNauticalMiles:"nautical-miles",esriNAUPoints:"points",esriNAUYards:"yards"}),u=((0,o.w)()({esriNAUDays:"days",esriNAUHours:"hours",esriNAUMinutes:"minutes",esriNAUSeconds:"seconds"}),(0,o.w)()({esriNAUCentimeters:"centimeters",esriNAUDecimalDegrees:"decimal-degrees",esriNAUDecimeters:"decimeters",esriNAUFeet:"feet",esriNAUInches:"inches",esriNAUKilometers:"kilometers",esriNAUMeters:"meters",esriNAUMiles:"miles",esriNAUMillimeters:"millimeters",esriNAUNauticalMiles:"nautical-miles",esriNAUPoints:"points",esriNAUYards:"yards",esriNAUDays:"days",esriNAUHours:"hours",esriNAUMinutes:"minutes",esriNAUSeconds:"seconds",esriNAUKilometersPerHour:"kilometers-per-hour",esriNAUMilesPerHour:"miles-per-hour",esriNAUUnknown:"unknown"})),c=(0,o.w)()({esriDOTComplete:"complete",esriDOTCompleteNoEvents:"complete-no-events",esriDOTFeatureSets:"featuresets",esriDOTInstructionsOnly:"instructions-only",esriDOTStandard:"standard",esriDOTSummaryOnly:"summary-only"}),d=(0,o.w)()({esriNAOutputLineNone:"none",esriNAOutputLineStraight:"straight",esriNAOutputLineTrueShape:"true-shape",esriNAOutputLineTrueShapeWithMeasure:"true-shape-with-measure"}),p=((0,o.w)()({esriNAOutputPolygonNone:"none",esriNAOutputPolygonSimplified:"simplified",esriNAOutputPolygonDetailed:"detailed"}),(0,o.w)()({esriNFSBAllowBacktrack:"allow-backtrack",esriNFSBAtDeadEndsOnly:"at-dead-ends-only",esriNFSBNoBacktrack:"no-backtrack",esriNFSBAtDeadEndsAndIntersections:"at-dead-ends-and-intersections"})),m=((0,o.w)()({esriNATravelDirectionFromFacility:"from-facility",esriNATravelDirectionToFacility:"to-facility"}),(0,o.w)()({esriNATimeOfDayNotUsed:"not-used",esriNATimeOfDayUseAsStartTime:"start",esriNATimeOfDayUseAsEndTime:"end"}),(0,o.w)()({AUTOMOBILE:"automobile",TRUCK:"truck",WALK:"walk",OTHER:"other"})),h=(0,o.w)()({0:"either-side-of-vehicle",1:"right-side-of-vehicle",2:"left-side-of-vehicle",3:"no-u-turn"},{useNumericKeys:!0}),y=(0,o.w)()({0:"stop",1:"waypoint",2:"break"},{useNumericKeys:!0}),v=(0,o.w)()({0:"ok",1:"not-located",2:"network-element-not-located",3:"element-not-traversable",4:"invalid-field-values",5:"not-reached",6:"time-window-violation",7:"not-located-on-closest"},{useNumericKeys:!0}),f=(0,o.w)()({1:"right",2:"left"},{useNumericKeys:!0}),b=(0,o.w)()({0:"restriction",1:"scaled-cost",2:"added-cost"},{useNumericKeys:!0}),g=(0,o.w)()({0:"permit",1:"restrict"},{useNumericKeys:!0}),w=(0,o.w)()({1:"header",50:"arrive",51:"depart",52:"straight",100:"on-ferry",101:"off-ferry",102:"central-fork",103:"roundabout",104:"u-turn",150:"door",151:"stairs",152:"elevator",153:"escalator",154:"pedestrian-ramp",200:"left-fork",201:"left-ramp",202:"clockwise-roundabout",203:"left-handed-u-turn",204:"bear-left",205:"left-turn",206:"sharp-left",207:"left-turn-and-immediate-left-turn",208:"left-turn-and-immediate-right-turn",300:"right-fork",301:"right-ramp",302:"counter-clockwise-roundabout",303:"right-handed-u-turn",304:"bear-right",305:"right-turn",306:"sharp-right",307:"right-turn-and-immediate-left-turn",308:"right-turn-and-immediate-right-turn",400:"up-elevator",401:"up-escalator",402:"up-stairs",500:"down-elevator",501:"down-escalator",502:"down-stairs",1e3:"general-event",1001:"landmark",1002:"time-zone-change",1003:"traffic-event",1004:"scaled-cost-barrier-event",1005:"boundary-crossing",1006:"restriction-violation",1007:"lane"},{useNumericKeys:!0}),_=(0,o.w)()({0:"unknown",1:"segment",2:"maneuver-segment",3:"restriction-violation",4:"scaled-cost-barrier",5:"heavy-traffic",6:"slow-traffic",7:"moderate-traffic"},{useNumericKeys:!0}),T=(0,o.w)()({"NA Campus":"campus","NA Desktop":"desktop","NA Navigation":"navigation"}),S=(0,o.w)()({Kilometers:"kilometers",Miles:"miles",Meters:"meters"},{ignoreUnknown:!1}),C=(0,o.w)()({Minutes:"minutes",TimeAt1KPH:"time-at-1-kph",TravelTime:"travel-time",TruckMinutes:"truck-minutes",TruckTravelTime:"truck-travel-time",WalkTime:"walk-time"},{ignoreUnknown:!1}),I=(0,o.w)()({Kilometers:"kilometers",Miles:"miles",Meters:"meters",Minutes:"minutes",TimeAt1KPH:"time-at-1-kph",TravelTime:"travel-time",TruckMinutes:"truck-minutes",TruckTravelTime:"truck-travel-time",WalkTime:"walk-time"},{ignoreUnknown:!1}),x=(0,o.w)()({"Any Hazmat Prohibited":"any-hazmat-prohibited","Avoid Carpool Roads":"avoid-carpool-roads","Avoid Express Lanes":"avoid-express-lanes","Avoid Ferries":"avoid-ferries","Avoid Gates":"avoid-gates","Avoid Limited Access Roads":"avoid-limited-access-roads","Avoid Private Roads":"avoid-private-roads","Avoid Roads Unsuitable for Pedestrians":"avoid-roads-unsuitable-for-pedestrians","Avoid Stairways":"avoid-stairways","Avoid Toll Roads":"avoid-toll-roads","Avoid Toll Roads for Trucks":"avoid-toll-roads-for-trucks","Avoid Truck Restricted Roads":"avoid-truck-restricted-roads","Avoid Unpaved Roads":"avoid-unpaved-roads","Axle Count Restriction":"axle-count-restriction","Driving a Bus":"driving-a-bus","Driving a Taxi":"driving-a-taxi","Driving a Truck":"driving-a-truck","Driving an Automobile":"driving-an-automobile","Driving an Emergency Vehicle":"driving-an-emergency-vehicle","Height Restriction":"height-restriction","Kingpin to Rear Axle Length Restriction":"kingpin-to-rear-axle-length-restriction","Length Restriction":"length-restriction","Preferred for Pedestrians":"preferred-for-pedestrians","Riding a Motorcycle":"riding-a-motorcycle","Roads Under Construction Prohibited":"roads-under-construction-prohibited","Semi or Tractor with One or More Trailers Prohibited":"semi-or-tractor-with-one-or-more-trailers-prohibited","Single Axle Vehicles Prohibited":"single-axle-vehicles-prohibited","Tandem Axle Vehicles Prohibited":"tandem-axle-vehicles-prohibited","Through Traffic Prohibited":"through-traffic-prohibited","Truck with Trailers Restriction":"truck-with-trailers-restriction","Use Preferred Hazmat Routes":"use-preferred-hazmat-routes","Use Preferred Truck Routes":"use-preferred-truck-routes",Walking:"walking","Weight Restriction":"weight-restriction"},{ignoreUnknown:!1}),O=(0,o.w)()({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),k=(0,o.w)()({esriGeometryPoint:"point",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"envelope",esriGeometryMultipoint:"multipoint"}),P=(0,o.w)()({esriNAUTCost:"cost",esriNAUTDescriptor:"descriptor",esriNAUTRestriction:"restriction",esriNAUTHierarchy:"hierarchy"}),L=(0,o.w)()({esriDSTAltName:"alt-name",esriDSTArrive:"arrive",esriDSTBranch:"branch",esriDSTCrossStreet:"cross-street",esriDSTCumulativeLength:"cumulative-length",esriDSTDepart:"depart",esriDSTEstimatedArrivalTime:"estimated-arrival-time",esriDSTExit:"exit",esriDSTGeneral:"general",esriDSTLength:"length",esriDSTServiceTime:"service-time",esriDSTStreetName:"street-name",esriDSTSummary:"summary",esriDSTTime:"time",esriDSTTimeWindow:"time-window",esriDSTToward:"toward",esriDSTViolationTime:"violation-time",esriDSTWaitTime:"wait-time"})},66244:(e,t,i)=>{i.r(t),i.d(t,{default:()=>ii});var o=i(27366),a=(i(59166),i(80987)),n=i(43404),l=i(84652),r=i(94172),s=i(5163),u=i(35995),c=i(49861),d=(i(93169),i(32718),i(69912)),p=i(80139),m=i(23084);const h=new n.X({PDF:"pdf",PNG32:"png32",PNG8:"png8",JPG:"jpg",GIF:"gif",EPS:"eps",SVG:"svg",SVGZ:"svgz"}),y=h.fromJSON.bind(h),v=h.toJSON.bind(h);var f=i(33565),b=i(7138);i(84936);let g=class extends b.default{constructor(e){super(e),this.state="pending",this.url=""}initialize(){this.addHandles((0,r.watch)((()=>[this.extension,this.name]),(()=>this._setFormattedFileName()),r.initial))}_setFormattedFileName(){this.name&&this.extension&&(this.formattedName=this.count?"".concat(this.name,"(").concat(this.count,")").concat(this.extension):"".concat(this.name,".").concat(this.extension))}};(0,o._)([(0,c.Cb)()],g.prototype,"count",void 0),(0,o._)([(0,c.Cb)()],g.prototype,"error",void 0),(0,o._)([(0,c.Cb)()],g.prototype,"extension",void 0),(0,o._)([(0,c.Cb)()],g.prototype,"formattedName",void 0),(0,o._)([(0,c.Cb)()],g.prototype,"name",void 0),(0,o._)([(0,c.Cb)()],g.prototype,"state",void 0),(0,o._)([(0,c.Cb)()],g.prototype,"url",void 0),g=(0,o._)([(0,d.j)("esri.widgets.Print.FileLink")],g);const w=g;i(59486);var _,T=i(19545),S=i(76200),C=i(63780),I=i(10064),x=i(54472),O=i(66978),k=i(18442),P=i(17842),L=i(68860),D=i(76969),A=i(36257),M=i(7575),E=i(65694),N=i(25243),F=i(53866),U=i(78952);let R=_=class extends b.default{constructor(e){super(e),this.outSpatialReference=null,this.processExtent=null,this.processSpatialReference=null,this.returnColumnName=!1,this.returnFeatureCollection=!1,this.returnM=!1,this.returnZ=!1}static from(e){return(0,N.TJ)(_,e)}};(0,o._)([(0,c.Cb)({type:U.Z})],R.prototype,"outSpatialReference",void 0),(0,o._)([(0,c.Cb)({type:F.Z})],R.prototype,"processExtent",void 0),(0,o._)([(0,c.Cb)({type:U.Z})],R.prototype,"processSpatialReference",void 0),(0,o._)([(0,c.Cb)({nonNullable:!0})],R.prototype,"returnColumnName",void 0),(0,o._)([(0,c.Cb)({nonNullable:!0})],R.prototype,"returnFeatureCollection",void 0),(0,o._)([(0,c.Cb)({nonNullable:!0})],R.prototype,"returnM",void 0),(0,o._)([(0,c.Cb)({nonNullable:!0})],R.prototype,"returnZ",void 0),R=_=(0,o._)([(0,d.j)("esri.rest.geoprocessor.GPOptions")],R);const j=R;var V=i(91340),G=i(83040),J=i(46784);let q=class extends J.wq{constructor(){super(...arguments),this.extent=null,this.height=null,this.href=null,this.opacity=1,this.rotation=0,this.scale=null,this.visible=!0,this.width=null}};(0,o._)([(0,c.Cb)({type:F.Z})],q.prototype,"extent",void 0),(0,o._)([(0,c.Cb)()],q.prototype,"height",void 0),(0,o._)([(0,c.Cb)()],q.prototype,"href",void 0),(0,o._)([(0,c.Cb)()],q.prototype,"opacity",void 0),(0,o._)([(0,c.Cb)()],q.prototype,"rotation",void 0),(0,o._)([(0,c.Cb)()],q.prototype,"scale",void 0),(0,o._)([(0,c.Cb)()],q.prototype,"visible",void 0),(0,o._)([(0,c.Cb)()],q.prototype,"width",void 0),q=(0,o._)([(0,d.j)("esri.layers.support.MapImage")],q);const B=q;var H=i(27135),W=i(49022);let Z=class extends J.wq{constructor(e){super(e),this.area=0,this.units=null}};(0,o._)([(0,c.Cb)({json:{write:!0}})],Z.prototype,"area",void 0),(0,o._)([(0,H.J)(W.dh)],Z.prototype,"units",void 0),Z=(0,o._)([(0,d.j)("esri.rest.support.ArealUnit")],Z);const z=Z;let K=class extends J.wq{constructor(e){super(e),this.itemId=null,this.url=null}};(0,o._)([(0,c.Cb)({type:String,json:{read:{source:"itemID"},write:{target:"itemID"}}})],K.prototype,"itemId",void 0),(0,o._)([(0,c.Cb)({type:String,json:{write:!0}})],K.prototype,"url",void 0),K=(0,o._)([(0,d.j)("esri.rest.support.DataFile")],K);const Y=K;var X=i(49818);let Q=class extends J.wq{constructor(e){super(e),this.distance=0,this.units=null}};(0,o._)([(0,c.Cb)({json:{write:!0}})],Q.prototype,"distance",void 0),(0,o._)([(0,H.J)(W.RK)],Q.prototype,"units",void 0),Q=(0,o._)([(0,d.j)("esri.rest.support.LinearUnit")],Q);const $=Q,ee="multi-value-",te=new n.X({GPArealUnit:"areal-unit",GPBoolean:"boolean",GPComposite:"composite",GPDataFile:"data-file",GPDate:"date",GPDouble:"double",GPFeatureRecordSetLayer:"feature-record-set-layer",Field:"field",GPLinearUnit:"linear-unit",GPLong:"long",GPRasterData:"raster-data",GPRasterDataLayer:"raster-data-layer",GPRecordSet:"record-set",GPString:"string",GPValueTable:"value-table","GPMultiValue:GPArealUnit":"".concat(ee,"areal-unit"),"GPMultiValue:GPBoolean":"".concat(ee,"boolean"),"GPMultiValue:GPComposite":"".concat(ee,"composite"),"GPMultiValue:GPDataFile":"".concat(ee,"data-file"),"GPMultiValue:GPDate":"".concat(ee,"date"),"GPMultiValue:GPDouble":"".concat(ee,"double"),"GPMultiValue:GPFeatureRecordSetLayer":"".concat(ee,"feature-record-set-layer"),"GPMultiValue:Field":"".concat(ee,"field"),"GPMultiValue:GPLinearUnit":"".concat(ee,"linear-unit"),"GPMultiValue:GPLong":"".concat(ee,"long"),"GPMultiValue:GPRasterData":"".concat(ee,"raster-data"),"GPMultiValue:GPRasterDataLayer":"".concat(ee,"raster-data-layer"),"GPMultiValue:GPRecordSet":"".concat(ee,"record-set"),"GPMultiValue:GPString":"".concat(ee,"string")});let ie=class extends J.wq{constructor(e){super(e),this.dataType=null,this.paramName=null,this.value=null}};(0,o._)([(0,H.J)(te,{ignoreUnknown:!1})],ie.prototype,"dataType",void 0),(0,o._)([(0,c.Cb)()],ie.prototype,"paramName",void 0),(0,o._)([(0,c.Cb)()],ie.prototype,"value",void 0),ie=(0,o._)([(0,d.j)("esri.rest.support.ParameterValue")],ie);const oe=ie;let ae=class extends J.wq{constructor(e){super(e),this.format=null,this.itemId=null,this.url=null}};(0,o._)([(0,c.Cb)()],ae.prototype,"format",void 0),(0,o._)([(0,c.Cb)({json:{read:{source:"itemID"},write:{target:"itemID"}}})],ae.prototype,"itemId",void 0),(0,o._)([(0,c.Cb)()],ae.prototype,"url",void 0),ae=(0,o._)([(0,d.j)("esri.rest.support.RasterData")],ae);const ne=ae;async function le(e,t,i,o,a){const n={},l={},r=[];return function(e,t,i){for(const o in e){const a=e[o];if(a&&"object"==typeof a&&a instanceof X.Z){const{features:e}=a;i[o]=[t.length,t.length+e.length],e.forEach((e=>{t.push(e.geometry)}))}}}(o,r,n),(0,V.aX)(r).then((r=>{const{outSpatialReference:s,processExtent:u,processSpatialReference:c,returnColumnName:d,returnFeatureCollection:p,returnM:h,returnZ:y}=i,{path:v}=(0,m.en)(e);for(const e in n){const[t,i]=n[e];l[e]=r.slice(t,i)}const f=s?s.wkid||s:null,b=c?c.wkid||c:null,g="execute"===t?{returnColumnName:d||void 0,returnFeatureCollection:p||void 0,returnM:h||void 0,returnZ:y||void 0}:null,w=de({...u?{context:{extent:u,outSR:f,processSR:b}}:{"env:outSR":f,"env:processSR":b},...o,...g,f:"json"},null,l),_={...a,query:w};return(0,S.Z)("".concat(v,"/").concat(t),_)}))}async function re(e,t){switch(e){case"areal-unit":return z.fromJSON(t);case"boolean":case"double":case"long":case"string":case"value-table":return t;case"date":return new Date(t);case"data-file":return Y.fromJSON(t);case"linear-unit":return $.fromJSON(t);case"feature-record-set-layer":if("url"in t)return Y.fromJSON(t);if("layerDefinition"in t){var o,a;const e=new(0,(await Promise.resolve().then(i.bind(i,64326))).default),{layerDefinition:n,featureSet:l}=t;return e.read({layerDefinition:n,featureSet:l},{origin:"portal-item"}),e.spatialReference=U.Z.fromJSON(null!==(o=null!==(a=l.spatialReference)&&void 0!==a?a:n.spatialReference)&&void 0!==o?o:n.extent.spatialReference),e}return X.Z.fromJSON(t);case"record-set":return"url"in t?Y.fromJSON(t):X.Z.fromJSON(t);case"raster-data":case"raster-data-layer":return"mapImage"in t?B.fromJSON(t.mapImage):ne.fromJSON(t);case"field":return G.Z.fromJSON(t)}}function se(e){return e.startsWith(ee)}function ue(e){return e.replace(ee,"")}async function ce(e){const t=te.fromJSON(e.dataType),{paramName:i}=e,o=se(t)?await async function(e,t){const i=ue(e),o="composite"===i?t.map((e=>re(te.fromJSON(e.dataType),e.value))):t.map((e=>re(i,e)));return Promise.all(o)}(t,e.value):await re(t,e.value);return new oe({dataType:t,paramName:i,value:o})}function de(e,t,i){for(const o in e){const t=e[o];Array.isArray(t)?e[o]=JSON.stringify(t.map((e=>de({item:e},!0).item))):t instanceof Date&&(e[o]=t.getTime())}return(0,m.cv)(e,t,i)}var pe,me=i(2429);async function he(e,t,i,o){return le(e,"execute",i=j.from(i||{}),null!==t&&void 0!==t?t:{},o).then((async e=>{var t,i,o,a;let{data:n}=e;return{results:await Promise.all(null!==(t=null===(i=n.results)||void 0===i?void 0:i.map(ce))&&void 0!==t?t:[]),messages:null!==(o=null===(a=n.messages)||void 0===a?void 0:a.map((e=>me.Z.fromJSON(e))))&&void 0!==o?o:[]}}))}const ye=(0,n.w)()({esriJobCancelled:"job-cancelled",esriJobCancelling:"job-cancelling",esriJobDeleted:"job-deleted",esriJobDeleting:"job-deleting",esriJobTimedOut:"job-timed-out",esriJobExecuting:"job-executing",esriJobFailed:"job-failed",esriJobNew:"job-new",esriJobSubmitted:"job-submitted",esriJobSucceeded:"job-succeeded",esriJobWaiting:"job-waiting"},{ignoreUnknown:!1});let ve=pe=class extends J.wq{constructor(e){super(e),this.jobId=null,this.jobStatus=null,this.messages=null,this.progress=null,this.requestOptions=null,this.sourceUrl=null,this._timer=void 0}async cancelJob(e){const{jobId:t,sourceUrl:i}=this,{path:o}=(0,m.en)(i),a={...this.requestOptions,...e,query:{f:"json"}};this._clearTimer();const n="".concat(o,"/jobs/").concat(t,"/cancel"),{data:l}=await(0,S.Z)(n,a),{messages:r,jobStatus:s,progress:u}=pe.fromJSON(l);return this.set({messages:r,jobStatus:s,progress:u}),this}destroy(){clearInterval(this._timer)}async checkJobStatus(e){const{path:t}=(0,m.en)(this.sourceUrl),i={...this.requestOptions,...e,query:{f:"json"}},o="".concat(t,"/jobs/").concat(this.jobId),{data:a}=await(0,S.Z)(o,i),{messages:n,jobStatus:l,progress:r}=pe.fromJSON(a);return this.set({messages:n,jobStatus:l,progress:r}),this}async fetchResultData(e,t,i){t=j.from(t||{});const{returnColumnName:o,returnFeatureCollection:a,returnM:n,returnZ:l,outSpatialReference:r}=t,{path:s}=(0,m.en)(this.sourceUrl),u=de({returnColumnName:o||null,returnFeatureCollection:a||null,returnM:n||null,returnZ:l||null,outSR:r,returnType:"data",f:"json"},null),c={...this.requestOptions,...i,query:u},d="".concat(s,"/jobs/").concat(this.jobId,"/results/").concat(e),{data:p}=await(0,S.Z)(d,c);return ce(p)}async fetchResultImage(e,t,i){const{path:o}=(0,m.en)(this.sourceUrl),a=de({...t.toJSON(),f:"json"}),n={...this.requestOptions,...i,query:a},l="".concat(o,"/jobs/").concat(this.jobId,"/results/").concat(e),{data:r}=await(0,S.Z)(l,n);return ce(r)}async fetchResultMapImageLayer(){const{path:e}=(0,m.en)(this.sourceUrl),t=e.indexOf("/GPServer/"),o="".concat(e.substring(0,t),"/MapServer/jobs/").concat(this.jobId);return new(0,(await Promise.all([i.e(83406),i.e(27607),i.e(89623),i.e(20680),i.e(19583)]).then(i.bind(i,19583))).default)({url:o})}async waitForJobCompletion(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{interval:t=1e3,signal:i,statusCallback:o}=e;return new Promise(((e,a)=>{(0,O.fu)(i,(()=>{this._clearTimer(),a((0,O.zE)())})),this._clearTimer();const n=setInterval((()=>{this._timer||a((0,O.zE)()),this.checkJobStatus(this.requestOptions).then((t=>{const{jobStatus:i}=t;switch(this.jobStatus=i,i){case"job-succeeded":this._clearTimer(),e(this);break;case"job-submitted":case"job-executing":case"job-waiting":case"job-new":o&&o(this);break;case"job-cancelled":case"job-cancelling":case"job-deleted":case"job-deleting":case"job-timed-out":case"job-failed":this._clearTimer(),a(this)}}))}),t);this._timer=n}))}_clearTimer(){clearInterval(this._timer),this._timer=void 0}};(0,o._)([(0,c.Cb)()],ve.prototype,"jobId",void 0),(0,o._)([(0,H.J)(ye,{ignoreUnknown:!1})],ve.prototype,"jobStatus",void 0),(0,o._)([(0,c.Cb)({type:[me.Z]})],ve.prototype,"messages",void 0),(0,o._)([(0,c.Cb)()],ve.prototype,"progress",void 0),(0,o._)([(0,c.Cb)()],ve.prototype,"requestOptions",void 0),(0,o._)([(0,c.Cb)({json:{write:!0}})],ve.prototype,"sourceUrl",void 0),ve=pe=(0,o._)([(0,d.j)("esri.rest.support.JobInfo")],ve);const fe=ve;async function be(e,t,i,o){return i=j.from(i||{}),le(e,"submitJob",i,null!==t&&void 0!==t?t:{},o).then((t=>{let{data:i}=t;const o=fe.fromJSON(i);return o.sourceUrl=e,o}))}var ge=i(80885),we=i(37270),_e=i(87072),Te=i(56011);const Se=new n.X({MAP_ONLY:"map-only","A3 Landscape":"a3-landscape","A3 Portrait":"a3-portrait","A4 Landscape":"a4-landscape","A4 Portrait":"a4-portrait","Letter ANSI A Landscape":"letter-ansi-a-landscape","Letter ANSI A Portrait":"letter-ansi-a-portrait","Tabloid ANSI B Landscape":"tabloid-ansi-b-landscape","Tabloid ANSI B Portrait":"tabloid-ansi-b-portrait"}),Ce=Se.fromJSON.bind(Se),Ie=Se.toJSON.bind(Se);var xe=i(51995),Oe=i(61459),ke=i(14404),Pe=i(16072),Le=i(69787);function De(e){return"bing-maps"===(null===e||void 0===e?void 0:e.type)}function Ae(e){return e&&"blendMode"in e&&"effect"in e}function Me(e){return"csv"===(null===e||void 0===e?void 0:e.type)}function Ee(e){return"catalog"===e.layer.type}function Ne(e){return"group"===e.layer.type}function Fe(e){const t=e.layer;if(Ae(t)){const i=t.blendMode;if((!i||"normal"===i)&&(t.effect||"featureEffect"in e&&e.featureEffect))return!0}return!1}var Ue=i(98995);let Re=class extends b.default{constructor(e){super(e),this.attributionVisible=!0,this.exportOptions={width:800,height:1100,dpi:96},this.forceFeatureAttributes=!1,this.format="png32",this.includeCharts=!1,this.includeTables=!1,this.label=null,this.layout="map-only",this.layoutItem=null,this.layoutOptions=null,this.outScale=0,this.report=null,this.reportItem=null,this.reportOptions=null,this.scalePreserved=!0,this.showLabels=!0}};(0,o._)([(0,c.Cb)()],Re.prototype,"attributionVisible",void 0),(0,o._)([(0,c.Cb)()],Re.prototype,"exportOptions",void 0),(0,o._)([(0,c.Cb)()],Re.prototype,"forceFeatureAttributes",void 0),(0,o._)([(0,c.Cb)()],Re.prototype,"format",void 0),(0,o._)([(0,c.Cb)()],Re.prototype,"includeCharts",void 0),(0,o._)([(0,c.Cb)()],Re.prototype,"includeTables",void 0),(0,o._)([(0,c.Cb)()],Re.prototype,"label",void 0),(0,o._)([(0,c.Cb)()],Re.prototype,"layout",void 0),(0,o._)([(0,c.Cb)({type:Ue.default})],Re.prototype,"layoutItem",void 0),(0,o._)([(0,c.Cb)()],Re.prototype,"layoutOptions",void 0),(0,o._)([(0,c.Cb)()],Re.prototype,"outScale",void 0),(0,o._)([(0,c.Cb)()],Re.prototype,"report",void 0),(0,o._)([(0,c.Cb)({type:Ue.default})],Re.prototype,"reportItem",void 0),(0,o._)([(0,c.Cb)()],Re.prototype,"reportOptions",void 0),(0,o._)([(0,c.Cb)()],Re.prototype,"scalePreserved",void 0),(0,o._)([(0,c.Cb)()],Re.prototype,"showLabels",void 0),Re=(0,o._)([(0,d.j)("esri.rest.support.PrintTemplate")],Re);const je=Re,Ve=new n.X({"Attribute List Letter ANSI A Landscape":"attribute-list-letter-ansi-a-landscape","Attribute List Letter ANSI A Portrait":"attribute-list-letter-ansi-a-portrait","Attribute List With Group Letter ANSI A Landscape":"attribute-list-with-group-letter-ansi-a-landscape","Attribute List With Group Letter ANSI A Portrait":"attribute-list-with-group-letter-ansi-a-portrait","Page per Feature Letter ANSI A Landscape":"page-per-feature-letter-ansi-a-landscape","Page per Feature Letter ANSI A Portrait":"page-per-feature-letter-ansi-a-portrait"}),Ge=(Ve.fromJSON.bind(Ve),Ve.toJSON.bind(Ve)),Je={Feet:"ft",Kilometers:"km",Meters:"m",Miles:"mi"},qe=new n.X({esriFeet:"Feet",esriKilometers:"Kilometers",esriMeters:"Meters",esriMiles:"Miles"}),Be=new n.X({esriExecutionTypeSynchronous:"sync",esriExecutionTypeAsynchronous:"async"}),He=new Map;async function We(e,t,i){const o=await Ze(e,i),a=await async function(e,t){t=t||{is11xService:!1,legendLayerNameMap:{},legendLayers:[]};const i=e.template||new je;null==i.showLabels&&(i.showLabels=!0);const o=i.exportOptions;let a;const n=Ie(i.layout);if(o&&(a={dpi:o.dpi},"map_only"===n.toLowerCase()||""===n)){const e=o.width,t=o.height;a.outputSize=null!=e&&null!=t?[e,t]:void 0}const l=i.layoutOptions;let r;if(l){let e,t;"Miles"===l.scalebarUnit||"Kilometers"===l.scalebarUnit?(e="Kilometers",t="Miles"):"Meters"!==l.scalebarUnit&&"Feet"!==l.scalebarUnit||(e="Meters",t="Feet"),r={titleText:l.titleText,authorText:l.authorText,copyrightText:l.copyrightText,customTextElements:l.customTextElements,elementOverrides:l.elementOverrides,scaleBarOptions:{metricUnit:qe.toJSON(e),metricLabel:e?Je[e]:void 0,nonMetricUnit:qe.toJSON(t),nonMetricLabel:t?Je[t]:void 0}}}let s=null;(null===l||void 0===l?void 0:l.legendLayers)&&(s=l.legendLayers.map((e=>{const i=e.layerId;t.legendLayerNameMap[i]=e.title;const o={id:i};return e.subLayerIds&&(o.subLayerIds=e.subLayerIds),o})));const u=await async function(e,t,i){var o;const a=e.view;let n=a.spatialReference;const l={operationalLayers:await Ke(a,t,i)};t.includeTables&&(l.tables=await async function(e){const t=[],i=[];for(const l of e.map.allTables)"feature"!==l.type||l.loaded||i.push(l.load());i.length&&await Promise.allSettled(i);for(const l of e.map.allTables){var o;if("feature"===l.type&&l.loaded&&l.isTable&&"feature-layer"===(null===(o=l.source)||void 0===o?void 0:o.type)){var a;const e={id:(n=gt(l)).id,title:n.title,customParameters:n.customParameters,layerDefinition:{definitionExpression:null===(a=n.layerDefinition)||void 0===a?void 0:a.definitionExpression},url:n.url};yt(e,l),t.push(e)}}var n;return t.length?t:void 0}(a));let r=e.extent||i.ssExtent||a.extent;if(null!==(o=n)&&void 0!==o&&o.isWrappable&&(r=r.clone()._normalize(!0),n=r.spatialReference),l.mapOptions={extent:r&&r.toJSON(),spatialReference:n&&n.toJSON(),showAttribution:t.attributionVisible},i.ssExtent=null,a.background&&(l.background=a.background.toJSON()),a.rotation&&(l.mapOptions.rotation=-a.rotation),t.scalePreserved&&(l.mapOptions.scale=t.outScale||a.scale),null!=a.timeExtent){const e=null!=a.timeExtent.start?a.timeExtent.start.getTime():null,t=null!=a.timeExtent.end?a.timeExtent.end.getTime():null;l.mapOptions.time=[e,t]}return t.reportOptions&&(l.reportOptions=t.reportOptions),l}(e,i,t);if(u.operationalLayers){const e=new RegExp("[\\u4E00-\\u9FFF\\u0E00-\\u0E7F\\u0900-\\u097F\\u3040-\\u309F\\u30A0-\\u30FF\\u31F0-\\u31FF]"),t=/[\u0600-\u06FF]/,i=i=>{var o;const a=i.text,n=i.font,l=null===n||void 0===n||null===(o=n.family)||void 0===o?void 0:o.toLowerCase();a&&n&&("arial"===l||"arial unicode ms"===l)&&(n.family=e.test(a)?"Arial Unicode MS":"Arial","normal"!==n.style&&t.test(a)&&(n.family="Arial Unicode MS"))};for(const o of u.operationalLayers){var c;if(null!==(c=o.featureCollection)&&void 0!==c&&c.layers)for(const e of o.featureCollection.layers){var d,p;if(null!==(d=e.layerDefinition)&&void 0!==d&&null!==(d=d.drawingInfo)&&void 0!==d&&null!==(d=d.renderer)&&void 0!==d&&d.symbol){const t=e.layerDefinition.drawingInfo.renderer;"esriTS"===t.symbol.type&&i(t.symbol)}if(null!==(p=e.featureSet)&&void 0!==p&&p.features)for(const t of e.featureSet.features)t.symbol&&"esriTS"===t.symbol.type&&i(t.symbol)}}}e.outSpatialReference&&(u.mapOptions.spatialReference=e.outSpatialReference.toJSON()),Object.assign(u,{exportOptions:a,layoutOptions:r||{}}),Object.assign(u.layoutOptions,{legendOptions:{operationalLayers:null!=s?s:t.legendLayers.slice()}}),t.legendLayers.length=0,He.set(t.gpServerUrl,t);const m={Web_Map_as_JSON:JSON.stringify(u),Format:v(i.format),Layout_Template:n,Layout_Item_ID:void 0,Report_Template:Ge(i.report),Report_Item_ID:void 0};if(i.layoutItem){delete m.Layout_Template;const e=i.layoutItem;await e.load(),"public"!==e.access&&T.id&&await T.id.getCredential(t.gpServerUrl),m.Layout_Item_ID=JSON.stringify({id:e.id})}if(i.reportItem){delete m.Report_Template;const e=i.reportItem;await e.load(),"public"!==e.access&&T.id&&await T.id.getCredential(t.gpServerUrl),m.Report_Item_ID=JSON.stringify({id:e.id})}return e.extraParameters&&Object.assign(m,e.extraParameters),m}(t,o);if("sync"===await ze(e,i)){var n;const{results:t}=await he(e,a,void 0,i);return null===t||void 0===t||null===(n=t[0])||void 0===n?void 0:n.value}const l=await be(e,a,void 0,i);await l.waitForJobCompletion({interval:t.updateDelay});const{value:r}=await l.fetchResultData("Output_File",null,i);return r}async function Ze(e,t){var i,o;const a=function(e){let t=e;const i=t.lastIndexOf("/GPServer/");return i>0&&(t=t.slice(0,i+9)),t}(e),n=null!==(i=He.get(a))&&void 0!==i?i:{gpServerUrl:a,legendLayerNameMap:{},legendLayers:[]};return null!==(o=n.gpMetadata)&&void 0!==o||(n.gpMetadata=(await(0,S.Z)(a,(0,m.lA)({f:"json"},t))).data),n.cimVersion=n.gpMetadata.cimVersion,He.set(a,n),n}async function ze(e,t){return function(e){var t;return null!==(t=e.gpMetadata)&&void 0!==t&&t.executionType?Be.fromJSON(e.gpMetadata.executionType):"sync"}(await Ze(e,t))}async function Ke(e,t,i){var o;const a=[],n={layerView:null,printTemplate:t,view:e};let l=0;t.scalePreserved&&(l=t.outScale||e.scale);const r=function(e,t){const i=e.allLayerViews.items;if(t===e.scale)return i.filter((e=>!e.suspended));const o=new Array;for(const a of i){const e=a.parent;e&&e!==a.view&&(Ee(e)||Ne(e))&&!o.includes(e)||a.visible&&a.visibleAtCurrentTimeExtent&&(0,Le.GB)(a.layer.effectiveScaleRange,t)&&o.push(a)}return o}(e,l);for(const s of r){const e=s.layer;if(!e.loaded||"layers"in e)continue;let t;n.layerView=s,t=Fe(s)?await st(e,n,i):De(e)?Ye(e):Me(e)?await Qe(e,n,i):"catalog-footprint"===(null===e||void 0===e?void 0:e.type)?await Xe(e,n,i):"feature"===(null===e||void 0===e?void 0:e.type)?await et(e,n,i):"geojson"===(null===e||void 0===e?void 0:e.type)?await tt(e,n,i):"graphics"===(null===e||void 0===e?void 0:e.type)?await it(e,n,i):"imagery"===(null===e||void 0===e?void 0:e.type)?ot(e,i):"imagery-tile"===(null===e||void 0===e?void 0:e.type)?await at(e,n,i):"kml"===(null===e||void 0===e?void 0:e.type)?await nt(e,n,i):"map-image"===(null===e||void 0===e?void 0:e.type)?lt(e,n,i):"map-notes"===(null===e||void 0===e?void 0:e.type)?await rt(n,i):"open-street-map"===(null===e||void 0===e?void 0:e.type)?{type:"OpenStreetMap"}:"stream"===(null===e||void 0===e?void 0:e.type)?await ut(e,n,i):"tile"===(null===e||void 0===e?void 0:e.type)?ct(e,i):"vector-tile"===(null===e||void 0===e?void 0:e.type)?await dt(e,n,i):"web-tile"===(null===e||void 0===e?void 0:e.type)?pt(e):"wms"===(null===e||void 0===e?void 0:e.type)?mt(e,i):"wmts"===(null===e||void 0===e?void 0:e.type)?ht(e):await st(e,n,i),t&&(Array.isArray(t)?a.push(...t):(t.id=e.id,t.title=i.legendLayerNameMap[e.id]||e.title,t.opacity=s.fullOpacity,t.minScale=e.minScale||0,t.maxScale=e.maxScale||0,Ae(e)&&e.blendMode&&"normal"!==e.blendMode&&(t.blendMode=e.blendMode),a.push(t)))}if(l)for(const s of a)s.minScale=0,s.maxScale=0;if(null!==(o=e.graphics)&&void 0!==o&&o.length){const o=await $e(null,e.graphics,t,i);o&&a.push(o)}return a}function Ye(e){return{culture:e.culture,key:e.key,type:"BingMaps"+("aerial"===e.style?"Aerial":"hybrid"===e.style?"Hybrid":"Road")}}async function Xe(e,t,i){let{layerView:o,printTemplate:a}=t;if(parseFloat(i.cimVersion)<3.1)return $e(e,await bt(o),a,i);const n=e.parent,l={id:(r=gt(n,"web-map")).id,url:r.url,layerType:r.layerType,customParameters:r.customParameters,dynamicGroupLayer:{visibility:!1},footprintLayer:r.footprintLayer,layerDefinition:r.layerDefinition};var r;return yt(l,n),l}async function Qe(e,t,i){e.legendEnabled&&i.legendLayers.push({id:e.id});const o=t.layerView,a=t.printTemplate;if(!(o.filter||e.portalItem&&"public"!==e.portalItem.access)){const t=gt(e,"web-map");return t.type="CSV",delete t.popupInfo,delete t.layerType,t.showLabels=a.showLabels&&e.labelsVisible,t}return $e(e,await bt(o),a,i)}async function $e(e,t,i,o){var a;let n;const l={layerDefinition:{name:"polygonLayer",geometryType:"esriGeometryPolygon",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPolygon",features:[]}},r={layerDefinition:{name:"polylineLayer",geometryType:"esriGeometryPolyline",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPolyline",features:[]}},s={layerDefinition:{name:"pointLayer",geometryType:"esriGeometryPoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPoint",features:[]}},u={layerDefinition:{name:"multipointLayer",geometryType:"esriGeometryMultipoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryMultipoint",features:[]}},c={layerDefinition:{name:"pointLayer",geometryType:"esriGeometryPoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPoint",features:[]}};if(c.layerDefinition.name="textLayer",delete c.layerDefinition.drawingInfo,e){if("esri.layers.FeatureLayer"===e.declaredClass||"esri.layers.StreamLayer"===e.declaredClass?l.layerDefinition.name=r.layerDefinition.name=s.layerDefinition.name=u.layerDefinition.name=o.legendLayerNameMap[e.id]||e.get("arcgisProps.title")||e.title:"esri.layers.GraphicsLayer"===e.declaredClass&&(t=e.graphics.items),e.renderer){const t=e.renderer.toJSON(),i=l.layerDefinition.drawingInfo;i&&(i.renderer=t);const o=r.layerDefinition.drawingInfo;o&&(o.renderer=t);const a=s.layerDefinition.drawingInfo;a&&(a.renderer=t);const n=u.layerDefinition.drawingInfo;n&&(n.renderer=t)}if(i.showLabels&&e.labelsVisible&&"function"==typeof e.write){var d;const t=null===(d=gt(e,"web-map").layerDefinition)||void 0===d||null===(d=d.drawingInfo)||void 0===d?void 0:d.labelingInfo;if(t){n=!0;const e=l.layerDefinition.drawingInfo;e&&(e.labelingInfo=t);const i=r.layerDefinition.drawingInfo;i&&(i.labelingInfo=t);const o=s.layerDefinition.drawingInfo;o&&(o.labelingInfo=t);const a=u.layerDefinition.drawingInfo;a&&(a.labelingInfo=t)}}}let p;(null===e||void 0===e?void 0:e.renderer)||n||(delete l.layerDefinition.drawingInfo,delete r.layerDefinition.drawingInfo,delete s.layerDefinition.drawingInfo,delete u.layerDefinition.drawingInfo);const m=null===e||void 0===e?void 0:e.fieldsIndex,h=null===e||void 0===e?void 0:e.renderer;if(m){const t=new Set;n&&await(0,we.Mu)(t,e),h&&"function"==typeof h.collectRequiredFields&&await h.collectRequiredFields(t,m),p=Array.from(t);const i=m.fields.map((e=>e.toJSON()));l.layerDefinition.fields=i,r.layerDefinition.fields=i,s.layerDefinition.fields=i,u.layerDefinition.fields=i}const y=null===(a=t)||void 0===a?void 0:a.length;let v;for(let S=0;S<y;S++){const e=t[S]||t.at(S);if(!1!==e.visible&&e.geometry){var f,b,g;if(v=e.toJSON(),v.hasOwnProperty("popupTemplate")&&delete v.popupTemplate,null!==(f=v.geometry)&&void 0!==f&&f.z&&delete v.geometry.z,v.symbol&&(v.symbol.angle||delete v.symbol.angle,wt(v.symbol)?v.symbol=await vt(v.symbol,o):v.symbol.text&&delete v.attributes),(!i||!i.forceFeatureAttributes)&&null!==(b=p)&&void 0!==b&&b.length){const e={};for(const t of p){var w;(null===(w=v.attributes)||void 0===w?void 0:w.hasOwnProperty(t))&&(e[t]=v.attributes[t])}v.attributes=e}"polygon"===e.geometry.type?l.featureSet.features.push(v):"polyline"===e.geometry.type?r.featureSet.features.push(v):"point"===e.geometry.type?null!==(g=v.symbol)&&void 0!==g&&g.text?c.featureSet.features.push(v):s.featureSet.features.push(v):"multipoint"===e.geometry.type?u.featureSet.features.push(v):"extent"===e.geometry.type&&(v.geometry=ge.Z.fromExtent(e.geometry).toJSON(),l.featureSet.features.push(v))}}const _=[l,r,u,s,c].filter((e=>e.featureSet.features.length>0));for(const S of _){var T;const e=S.featureSet.features.every((e=>e.symbol));if(e&&(!i||!i.forceFeatureAttributes))for(const t of S.featureSet.features)delete t.attributes;e&&delete S.layerDefinition.drawingInfo,(null===(T=S.layerDefinition.drawingInfo)||void 0===T?void 0:T.renderer)&&await ft(S.layerDefinition.drawingInfo.renderer,o)}return _.length?{featureCollection:{layers:_},showLabels:n}:null}async function et(e,t,i){var o,a,n,l;let r;const s=e.renderer,u=parseFloat(i.cimVersion);if("binning"===(null===(o=e.featureReduction)||void 0===o?void 0:o.type)||"cluster"===(null===(a=e.featureReduction)||void 0===a?void 0:a.type)&&u<2.9||"pie-chart"===(null===s||void 0===s?void 0:s.type)||"dot-density"===(null===s||void 0===s?void 0:s.type)&&u<2.6)return st(e,t,i);e.legendEnabled&&i.legendLayers.push({id:e.id});const c=t.layerView,{printTemplate:d,view:p}=t,m="feature-layer"!==(null===(n=e.source)||void 0===n?void 0:n.type)&&"ogc-feature"!==(null===(l=e.source)||void 0===l?void 0:l.type);if(c.filter||m||!s||"field"in s&&null!=s.field&&!e.getField(s.field)){const t=await bt(c);r=await $e(e,t,d,i)}else{var h,y,v,f,b,g;if(r={id:(_=gt(e)).id,title:_.title,url:_.url,layerType:_.layerType,customParameters:_.customParameters,layerDefinition:_.layerDefinition,charts:d.includeCharts?_.charts:void 0},r.showLabels=d.showLabels&&e.labelsVisible,yt(r,e),null!==(h=r.layerDefinition)&&void 0!==h&&null!==(h=h.drawingInfo)&&void 0!==h&&h.renderer&&(delete r.layerDefinition.minScale,delete r.layerDefinition.maxScale,await ft(r.layerDefinition.drawingInfo.renderer,i),"visualVariables"in s&&s.visualVariables&&s.visualVariables[0])){const e=s.visualVariables[0];if("size"===e.type&&e.maxSize&&"number"!=typeof e.maxSize&&e.minSize&&"number"!=typeof e.minSize){const t=(0,Te.getSizeRangeAtScale)(e,p.scale);r.layerDefinition.drawingInfo.renderer.visualVariables[0].minSize=t.minSize,r.layerDefinition.drawingInfo.renderer.visualVariables[0].maxSize=t.maxSize}}const t=(0,_e.c)(c);if(t&&(null!==(v=(y=r).layerDefinition)&&void 0!==v||(y.layerDefinition={}),r.layerDefinition.definitionExpression=r.layerDefinition.definitionExpression?"(".concat(r.layerDefinition.definitionExpression,") AND (").concat(t,")"):t),e.gdbVersion&&(null!==(b=(f=r).layerDefinition)&&void 0!==b||(f.layerDefinition={}),r.layerDefinition.gdbVersion=e.gdbVersion),null!==(g=c.hasHighlight)&&void 0!==g&&g.call(c)&&"getHighlightIds"in c){var w;const t=c;r.selectionObjectIds=t.getHighlightIds(),r.selectionSymbol=function(e,t){var i,o,a,n,l;const r=null!==(i=null===(o=t.color)||void 0===o?void 0:o.clone())&&void 0!==i?i:new xe.Z([0,255,255]),s=null!==(a=null===(n=t.haloColor)||void 0===n?void 0:n.clone())&&void 0!==a?a:r.clone();switch(e){case"envelope":case"polygon":return r.a*=null!==(l=t.fillOpacity)&&void 0!==l?l:.25,new Oe.default({color:r,outline:new ke.default({color:s}),style:"solid"});case"polyline":return new ke.default({color:s});default:return s.a=1,new Pe.default({color:s,outline:null})}}(e.geometryType,null!==(w=t.highlightOptions)&&void 0!==w?w:p.highlightOptions)}}var _;return r}async function tt(e,t,i){var o,a;return"binning"===(null===(o=e.featureReduction)||void 0===o?void 0:o.type)||"cluster"===(null===(a=e.featureReduction)||void 0===a?void 0:a.type)?st(e,t,i):(e.legendEnabled&&i.legendLayers.push({id:e.id}),$e(e,await bt(t.layerView),t.printTemplate,i))}async function it(e,t,i){let{printTemplate:o}=t;return $e(e,null,o,i)}function ot(e,t){var i,o,a;e.legendEnabled&&t.legendLayers.push({id:e.id});const n={layerType:(l=gt(e)).layerType,customParameters:l.customParameters};var l;return n.bandIds=e.bandIds,n.compressionQuality=e.compressionQuality,n.format=e.format,n.interpolation=e.interpolation,(e.mosaicRule||e.definitionExpression)&&(n.mosaicRule=e.exportImageServiceParameters.mosaicRule.toJSON()),e.rasterFunction&&(n.renderingRule=e.rasterFunction.toJSON()),e.renderer&&(null!==(i=n.layerDefinition)&&void 0!==i||(n.layerDefinition={}),null!==(a=(o=n.layerDefinition).drawingInfo)&&void 0!==a||(o.drawingInfo={}),n.layerDefinition.drawingInfo.renderer=e.renderer.toJSON()),yt(n,e),n}async function at(e,t,i){var o;if("flow"===(null===(o=e.renderer)||void 0===o?void 0:o.type))return st(e,t,i);e.legendEnabled&&i.legendLayers.push({id:e.id});const a={bandIds:(n=gt(e)).bandIds,customParameters:n.customParameters,interpolation:n.interpolation,layerDefinition:n.layerDefinition};var n;return a.layerType="ArcGISImageServiceLayer",yt(a,e),a}async function nt(e,t,i){const o=t.printTemplate;if(!e.portalItem||"public"===e.portalItem.access){const t=gt(e,"web-map");return t.type="kml",delete t.layerType,t.url=(0,u.Fv)(e.url),t}const a=[],n=t.layerView;n.allVisibleMapImages.forEach(((t,i)=>{const o={id:"".concat(e.id,"_image").concat(i),type:"image",title:e.id,minScale:e.minScale||0,maxScale:e.maxScale||0,opacity:n.fullOpacity,extent:t.extent};"data:image/png;base64,"===t.href.substr(0,22)?o.imageData=t.href.substr(22):o.url=t.href,a.push(o)}));const l=[...n.allVisiblePoints.items,...n.allVisiblePolylines.items,...n.allVisiblePolygons.items],r={id:e.id,...await $e(null,l,o,i)};return a.push(r),a}function lt(e,t,i){var o;let a,{view:n}=t;const l={id:e.id,subLayerIds:[]};let r=[];const s=n.scale,u=e=>{const t=0===s,i=0===e.minScale||s<=e.minScale,o=0===e.maxScale||s>=e.maxScale;if(e.visible&&(t||i&&o))if(e.sublayers)e.sublayers.forEach(u);else{const t=e.toExportImageJSON(),i={id:e.id,name:e.title,layerDefinition:{drawingInfo:t.drawingInfo,definitionExpression:t.definitionExpression,source:t.source}};r.unshift(i),l.subLayerIds.push(e.id)}};var c;return e.sublayers&&e.sublayers.forEach(u),r.length&&(r=r.map((e=>{let{id:t,name:i,layerDefinition:o}=e;return{id:t,name:i,layerDefinition:o}})),a={layerType:(c=gt(e)).layerType,customParameters:c.customParameters},a.layers=r,a.visibleLayers=null!==(o=e.capabilities)&&void 0!==o&&null!==(o=o.exportMap)&&void 0!==o&&o.supportsDynamicLayers?void 0:l.subLayerIds,e.gdbVersion&&(a.gdbVersion=e.gdbVersion),yt(a,e),e.legendEnabled&&i.legendLayers.push(l)),a}async function rt(e,t){let{layerView:i,printTemplate:o}=e;const a=[],n=i.layer;if(null!=n.featureCollections)for(const l of n.featureCollections){const e=await $e(l,l.source,o,t);e&&a.push(...e.featureCollection.layers)}else if(null!=n.sublayers)for(const l of n.sublayers){const e=await $e(null,l.graphics,o,t);e&&a.push(...e.featureCollection.layers)}return{featureCollection:{layers:a}}}async function st(e,t,i){var o;let{printTemplate:a,view:n}=t;const l={type:"image"},r={format:"png",ignoreBackground:!0,ignorePadding:!0,layers:[e]};0!==n.rotation&&(r.rotation=0);const s=i.ssExtent||n.state.extent.clone();let c=96,d=!0,p=!0;if(a.exportOptions){const e=a.exportOptions;null!=e.dpi&&e.dpi>0&&(c=e.dpi),null!=e.width&&e.width>0&&(d=e.width%2==n.width%2),null!=e.height&&e.height>0&&(p=e.height%2==n.height%2)}if("map-only"===a.layout&&a.scalePreserved&&(!a.outScale||a.outScale===n.scale)&&96===c&&(!d||!p)&&n.state.extent.equals(n.extent)&&(r.area={x:0,y:0,width:n.width,height:n.height},d||(r.area.width-=1),p||(r.area.height-=1),!i.ssExtent)){const e=n.toMap((0,P.vW)(r.area.width,r.area.height));s.ymin=e.y,s.xmax=e.x,i.ssExtent=s}l.extent=s.clone()._normalize(!0).toJSON();const m=await n.takeScreenshot(r);return l.imageData=null===(o=(0,u.sJ)(m.dataUrl))||void 0===o?void 0:o.data,l}async function ut(e,t,i){let{layerView:o,printTemplate:a}=t;return e.legendEnabled&&i.legendLayers.push({id:e.id}),$e(e,await bt(o),a,i)}function ct(e,t){e.legendEnabled&&t.legendLayers.push({id:e.id});const i={layerType:(o=gt(e)).layerType,customParameters:o.customParameters};var o;return yt(i,e),i}async function dt(e,t,i){if(e.serviceUrl&&e.styleUrl){const t=(0,m.LP)(e.styleUrl,e.apiKey),o=(0,m.LP)(e.serviceUrl,e.apiKey);if(!t&&!o||"2.1.0"!==i.cimVersion){const i={type:"VectorTileLayer"};return i.styleUrl=(0,u.Fv)(e.styleUrl),i.token=t,o!==t&&(i.additionalTokens=[{url:e.serviceUrl,token:o}]),i}}return st(e,t,i)}function pt(e){var t;const i={type:"WebTiledLayer",urlTemplate:null===(t=e.urlTemplate)||void 0===t?void 0:t.replace(/\${/g,"{"),credits:e.copyright};return e.subDomains&&e.subDomains.length>0&&(i.subDomains=e.subDomains),i}function mt(e,t){let i;const o=[],a=e=>{e.visible&&(e.sublayers?e.sublayers.forEach(a):e.name&&o.unshift(e.name))};return e.sublayers&&e.sublayers.forEach(a),o.length&&(e.legendEnabled&&t.legendLayers.push({id:e.id,subLayerIds:o}),i={type:"wms",customLayerParameters:e.customLayerParameters,customParameters:e.customParameters,transparentBackground:e.imageTransparency,visibleLayers:o,url:(0,u.Fv)(e.url),version:e.version}),i}function ht(e){const t=e.activeLayer;return{type:"wmts",customLayerParameters:e.customLayerParameters,customParameters:e.customParameters,format:t.imageFormat,layer:t.id,style:t.styleId,tileMatrixSet:t.tileMatrixSetId,url:(0,u.Fv)(e.url)}}function yt(e,t){t.url&&(e.url=(0,u.Fv)(e.url||t.url),e.token=(0,m.LP)(e.url,t.apiKey))}async function vt(e,t){t.canvas||(t.canvas=document.createElement("canvas"));const i=1024;t.canvas.width=i,t.canvas.height=i;const o=t.canvas.getContext("2d");let a,n;if(e.path){var l;const t=new Path2D(e.path);t.closePath(),o.fillStyle=Array.isArray(e.color)?"rgba(".concat(e.color[0],",").concat(e.color[1],",").concat(e.color[2],",").concat(e.color[3]/255,")"):"rgb(0,0,0)",o.fill(t);const r=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15;const i=e.canvas.width,o=e.canvas.height,a=e.getImageData(0,0,i,o).data;let n,l,r,s,u,c;e:for(l=o;l--;)for(n=i;n--;)if(a[4*(i*l+n)+3]>t){c=l;break e}if(!c)return null;e:for(n=i;n--;)for(l=c+1;l--;)if(a[4*(i*l+n)+3]>t){u=n;break e}e:for(n=0;n<=u;++n)for(l=c+1;l--;)if(a[4*(i*l+n)+3]>t){r=n;break e}e:for(l=0;l<=c;++l)for(n=r;n<=u;++n)if(a[4*(i*l+n)+3]>t){s=l;break e}return{x:r,y:s,width:u-r,height:c-s}}(o);if(!r)return null;o.clearRect(0,0,i,i);const s=(0,P.F2)(e.size)/Math.max(r.width,r.height);o.scale(s,s);const u=i/s,c=u/2-r.width/2-r.x,d=u/2-r.height/2-r.y;if(o.translate(c,d),Array.isArray(e.color)&&o.fill(t),null!==(l=e.outline)&&void 0!==l&&l.width&&Array.isArray(e.outline.color)){const i=e.outline;o.lineWidth=(0,P.F2)(i.width)/s,o.lineJoin="round",o.strokeStyle="rgba(".concat(i.color[0],",").concat(i.color[1],",").concat(i.color[2],",").concat(i.color[3]/255,")"),o.stroke(t),r.width+=o.lineWidth,r.height+=o.lineWidth}r.width*=s,r.height*=s;const p=o.getImageData(512-r.width/2,512-r.height/2,Math.ceil(r.width),Math.ceil(r.height));a=p.width,n=p.height,o.canvas.width=a,o.canvas.height=n,o.putImageData(p,0,0)}else{const t="image/svg+xml"===e.contentType?"data:image/svg+xml;base64,"+e.imageData:e.url,i=(await(0,S.Z)(t,{responseType:"image"})).data;a=(0,P.F2)(e.width),n=(0,P.F2)(e.height),o.canvas.width=a,o.canvas.height=n,o.drawImage(i,0,0,o.canvas.width,o.canvas.height)}return{type:"esriPMS",imageData:o.canvas.toDataURL("image/png").substr(22),angle:e.angle,contentType:"image/png",height:(0,P.Wz)(n),width:(0,P.Wz)(a),xoffset:e.xoffset,yoffset:e.yoffset}}async function ft(e,t){const i=e.type;if("simple"===i&&wt(e.symbol))e.symbol=await vt(e.symbol,t);else if("uniqueValue"===i||"classBreaks"===i){wt(e.defaultSymbol)&&(e.defaultSymbol=await vt(e.defaultSymbol,t));const o=e["uniqueValue"===i?"uniqueValueInfos":"classBreakInfos"];if(o)for(const e of o)wt(e.symbol)&&(e.symbol=await vt(e.symbol,t))}}async function bt(e){return e.queryFeatures(e.createQuery()).then((e=>e.features))}function gt(e,t){var i;return null!==(i=e.write({},{ignorePersistenceEnabled:!0,origin:t}))&&void 0!==i?i:{}}function wt(e){var t;return e&&(e.path||"image/svg+xml"===e.contentType||(null===(t=e.url)||void 0===t?void 0:t.endsWith(".svg")))}let _t=class extends b.default{constructor(e){super(e),this.extent=null,this.extraParameters=null,this.outSpatialReference=null,this.template=null,this.updateDelay=1e3,this.view=null}};(0,o._)([(0,c.Cb)()],_t.prototype,"extent",void 0),(0,o._)([(0,c.Cb)()],_t.prototype,"extraParameters",void 0),(0,o._)([(0,c.Cb)()],_t.prototype,"outSpatialReference",void 0),(0,o._)([(0,c.Cb)()],_t.prototype,"template",void 0),(0,o._)([(0,c.Cb)()],_t.prototype,"updateDelay",void 0),(0,o._)([(0,c.Cb)()],_t.prototype,"view",void 0),_t=(0,o._)([(0,d.j)("esri.rest.support.PrintParameters")],_t);const Tt=_t;var St=i(86226),Ct=i(1614),It=i(80975),xt=i(67005);let Ot=class extends b.default{constructor(e){super(e),this.strokeDash=[],this.strokeWidth=2,this.strokeColor=[0,0,0,1],this.strokeBackgroundColor=[0,0,0,0],this.fillColor=[0,0,0,0],this.backgroundFillColor=[0,0,0,.5],this.visible=!0,this.isDecoration=!1,this.boxWidth=0,this.boxHeight=0,this.backgroundWidth=0,this.backgroundHeight=0,this.padding={left:0,top:0,right:0,bottom:0}}get _strokeStyle(){return"rgba(".concat(this.strokeColor.join(),")")}get _strokeBackgroundStyle(){return"rgba(".concat(this.strokeBackgroundColor.join(),")")}get _fillStyle(){return"rgba(".concat(this.fillColor.join(),")")}get _backgroundFillStyle(){return"rgba(".concat(this.backgroundFillColor.join(),")")}render(){var e,t;const{backgroundWidth:i,backgroundHeight:o,boxWidth:a,boxHeight:n,padding:l}=this,r=l.left,s=l.top,u=null!==(e=this.x)&&void 0!==e?e:r+i/2-a/2,c=null!==(t=this.y)&&void 0!==t?t:s+o/2-n/2,d=u+a,p=c+n;return(0,xt.u)("div",{classes:{"esri-box-overlay-item":!0},styles:{left:"0px",top:"0px",width:"100%",height:"100%",visibility:this.visible?"visible":"hidden"}},(0,xt.u)("svg",{styles:{width:"100%",height:"100%"}},(0,xt.u)("path",{d:"M ".concat(r," ").concat(s," L ").concat(i+r," ").concat(s," L ").concat(i+r," ").concat(o+s," L ").concat(r," ").concat(o+s," Z M ").concat(u," ").concat(c," L ").concat(u," ").concat(p," L ").concat(d," ").concat(p," L ").concat(d," ").concat(c," Z"),fill:this._backgroundFillStyle,stroke:this._strokeBackgroundStyle,"stroke-width":this.strokeWidth}),(0,xt.u)("rect",{fill:this._fillStyle,height:n,stroke:this._strokeStyle,"stroke-dasharray":this.strokeDash.join(" ")||void 0,"stroke-width":this.strokeWidth,width:a,x:u,y:c})))}renderCanvas(){}};(0,o._)([(0,c.Cb)()],Ot.prototype,"strokeDash",void 0),(0,o._)([(0,c.Cb)()],Ot.prototype,"strokeWidth",void 0),(0,o._)([(0,c.Cb)()],Ot.prototype,"strokeColor",void 0),(0,o._)([(0,c.Cb)()],Ot.prototype,"strokeBackgroundColor",void 0),(0,o._)([(0,c.Cb)()],Ot.prototype,"fillColor",void 0),(0,o._)([(0,c.Cb)()],Ot.prototype,"backgroundFillColor",void 0),(0,o._)([(0,c.Cb)()],Ot.prototype,"visible",void 0),(0,o._)([(0,c.Cb)()],Ot.prototype,"isDecoration",void 0),(0,o._)([(0,c.Cb)()],Ot.prototype,"boxWidth",void 0),(0,o._)([(0,c.Cb)()],Ot.prototype,"boxHeight",void 0),(0,o._)([(0,c.Cb)()],Ot.prototype,"backgroundWidth",void 0),(0,o._)([(0,c.Cb)()],Ot.prototype,"backgroundHeight",void 0),(0,o._)([(0,c.Cb)()],Ot.prototype,"x",void 0),(0,o._)([(0,c.Cb)()],Ot.prototype,"y",void 0),(0,o._)([(0,c.Cb)()],Ot.prototype,"padding",void 0),(0,o._)([(0,c.Cb)({readOnly:!0})],Ot.prototype,"_strokeStyle",null),(0,o._)([(0,c.Cb)({readOnly:!0})],Ot.prototype,"_strokeBackgroundStyle",null),(0,o._)([(0,c.Cb)({readOnly:!0})],Ot.prototype,"_fillStyle",null),(0,o._)([(0,c.Cb)({readOnly:!0})],Ot.prototype,"_backgroundFillStyle",null),Ot=(0,o._)([(0,d.j)("esri.views.overlay.BoxOverlayItem")],Ot);const kt=Ot;let Pt=class extends J.wq{constructor(e){super(e),this.description=null,this.format=null,this.label=null,this.layout=null,this.layoutItem=null,this.layoutOptions=null,this.layoutTemplateInfo=null}};(0,o._)([(0,c.Cb)()],Pt.prototype,"description",void 0),(0,o._)([(0,c.Cb)({json:{read:y}})],Pt.prototype,"format",void 0),(0,o._)([(0,c.Cb)()],Pt.prototype,"label",void 0),(0,o._)([(0,c.Cb)({json:{read:Ce}})],Pt.prototype,"layout",void 0),(0,o._)([(0,c.Cb)({type:Ue.default})],Pt.prototype,"layoutItem",void 0),(0,o._)([(0,c.Cb)()],Pt.prototype,"layoutOptions",void 0),(0,o._)([(0,c.Cb)()],Pt.prototype,"layoutTemplateInfo",void 0),Pt=(0,o._)([(0,d.j)("esri.widgets.Print.CustomTemplate")],Pt);const Lt=Pt;let Dt=class extends b.default{constructor(e){super(e),this.attributionEnabled=!0,this.author=null,this.copyright=null,this.customTextElements=null,this.dpi=96,this.fileName=null,this.forceFeatureAttributes=!1,this.format="pdf",this.height=null,this.includeTables=!0,this.layout="letter-ansi-a-landscape",this.layoutItem=null,this.legendEnabled=!0,this.northArrowEnabled=!1,this.scale=null,this.scaleEnabled=!1,this.title=null,this.width=null}};(0,o._)([(0,c.Cb)()],Dt.prototype,"attributionEnabled",void 0),(0,o._)([(0,c.Cb)()],Dt.prototype,"author",void 0),(0,o._)([(0,c.Cb)()],Dt.prototype,"copyright",void 0),(0,o._)([(0,c.Cb)()],Dt.prototype,"customTextElements",void 0),(0,o._)([(0,c.Cb)()],Dt.prototype,"dpi",void 0),(0,o._)([(0,c.Cb)()],Dt.prototype,"fileName",void 0),(0,o._)([(0,c.Cb)()],Dt.prototype,"forceFeatureAttributes",void 0),(0,o._)([(0,c.Cb)()],Dt.prototype,"format",void 0),(0,o._)([(0,c.Cb)()],Dt.prototype,"height",void 0),(0,o._)([(0,c.Cb)()],Dt.prototype,"includeTables",void 0),(0,o._)([(0,c.Cb)()],Dt.prototype,"layout",void 0),(0,o._)([(0,c.Cb)({type:Ue.default})],Dt.prototype,"layoutItem",void 0),(0,o._)([(0,c.Cb)()],Dt.prototype,"legendEnabled",void 0),(0,o._)([(0,c.Cb)()],Dt.prototype,"northArrowEnabled",void 0),(0,o._)([(0,c.Cb)()],Dt.prototype,"scale",void 0),(0,o._)([(0,c.Cb)()],Dt.prototype,"scaleEnabled",void 0),(0,o._)([(0,c.Cb)()],Dt.prototype,"title",void 0),(0,o._)([(0,c.Cb)()],Dt.prototype,"width",void 0),Dt=(0,o._)([(0,d.j)("esri.widgets.Print.TemplateOptions")],Dt);const At=Dt,Mt=new Set(["GISProfessionalStdUT","GISProfessionalAdvUT"]),Et=/(\/GPServer\/).+/i,Nt=new n.X({inch:"inches",foot:"feet",yard:"yards",mile:"miles","nautical-mile":"nautical-miles",millimeter:"millimeters",centimeter:"centimeters",decimeter:"decimeters",meter:"meters",kilometer:"kilometers"}),Ft=a.Z.ofType(Lt);let Ut=class extends x.Z{constructor(e){super(e),this._serviceTemplateCustomTextElements=null,this._layoutToTemplateInfo=new k.Z,this._isFreeHand=!1,this._freeHandWidth=0,this._freehandHeight=0,this._asyncPrintTaskUrl=null,this._layoutInfoTaskUrl=null,this.allowedFormats="all",this.allowedLayouts="all",this.browseTemplates=new Ft,this.defaultTemplates=new Ft,this.error=null,this.extraParameters=null,this.includeDefaultTemplates=!0,this.portal=M.Z.getDefault(),this.portalTemplateIds=[],this.showPrintAreaEnabled=!1,this.printServiceUrl=null,this.printTimeout=12e4,this.templatesInfo=null,this.updateDelay=1e3,this.view=null,this.templateCustomTextElements=null,this.templateOptions=new At}initialize(){this.addHandles((0,r.watch)((()=>this.showPrintAreaEnabled),(e=>{var t;e?this._enablePrintPreview():(this.removeHandles("overlay-handler"),null===(t=this.view)||void 0===t||null===(t=t.overlay)||void 0===t||t.removeItem(this._getOverlayItem()))})))}destroy(){var e;this.removeHandles("overlay-handler"),this.view&&(this._overlayItem&&(null!==(e=this.view.overlay)&&void 0!==e&&e.removeItem(this._overlayItem),this._overlayItem.destroy(),this._overlayItem=null),this.view=null)}get effectivePrintServiceUrl(){var e;return null!==(e=this.printServiceUrl)&&void 0!==e?e:null}get effectiveTemplateCustomTextElements(){if(!this._serviceTemplateCustomTextElements)return{};const e=(0,l.d9)(this._serviceTemplateCustomTextElements);return this.templateCustomTextElements&&Object.keys(this.templateCustomTextElements).forEach((t=>{const i=e[t];if(i){var o;const e=null===(o=this.templateCustomTextElements)||void 0===o?void 0:o[t];i.forEach((t=>{const[i]=Object.entries(t)[0];null===e||void 0===e||e.forEach((e=>{const[o,a]=Object.entries(e)[0];i===o&&(t[i]=a)}))}))}})),Object.freeze(e)}get layoutTemplateInfo(){var e,t;const i=null!==(e=null===(t=this.templateOptions.layoutItem)||void 0===t?void 0:t.id)&&void 0!==e?e:this.templateOptions.layout;return i?this._layoutToTemplateInfo.get(i):null}get state(){var e;return"loading"===this.loadStatus?"initializing":"failed"===this.loadStatus||this.error?"error":"loaded"===this.loadStatus&&null!==(e=this.view)&&void 0!==e&&e.ready?"ready":"disabled"}get layoutTemplateNorthArrowInfo(){var e;return null!==(e=this.layoutTemplateInfo)&&void 0!==e&&null!==(e=e.layoutOptions)&&void 0!==e&&e.mapSurroundInfos?this.layoutTemplateInfo.layoutOptions.mapSurroundInfos.find((e=>"CIMMarkerNorthArrow"===e.type)):null}async load(e){return this.addResolvingPromise(this._loadResources(e).catch((e=>this.error=e))),this}async print(e){const{view:t,extraParameters:i,updateDelay:o}=this;if(!t)throw new I.Z("print:view-required","view is not set");!function(e){var t,i,o;if(null!==(t=e.layoutOptions)&&void 0!==t||(e.layoutOptions={}),null!==(o=(i=e.layoutOptions).customTextElements)&&void 0!==o||(i.customTextElements=[]),!e.layoutOptions.customTextElements.find((e=>"date"in e))){const{customTextElements:t}=e.layoutOptions;let i=(0,D.p6)(Date.now(),(0,D.Ze)("short-date"));"ar"===(0,A.G3)()&&(i="\u200f"+i),t.push({date:i})}}(e);const a=this._getOverlayItem(),n=e.scalePreserved||!this.showPrintAreaEnabled?void 0:(0,St.bk)(new F.Z,t.viewpoint,"MAP_ONLY"===e.layout?[e.exportOptions.width,e.exportOptions.height]:[a.boxWidth,a.boxHeight]),l=new Tt({view:t,template:e,extent:n,extraParameters:i,updateDelay:o});try{var r;const t=!(null===(r=e.layoutItem)||void 0===r||!r.id)&&(this.portalTemplateIds.includes(e.layoutItem.id)||this.browseTemplates.some((t=>{var i,o;return(null===(i=t.layoutItem)||void 0===i?void 0:i.id)===(null===(o=e.layoutItem)||void 0===o?void 0:o.id)})));return await We(t&&this._asyncPrintTaskUrl?this._asyncPrintTaskUrl:this.effectivePrintServiceUrl,l,{timeout:this.printTimeout})}catch(y){throw new I.Z("print:export-error","An error occurred while exporting the web map.",{error:y})}}toPrintTemplate(e){let{attributionEnabled:t,author:i,copyright:o,customTextElements:a,dpi:n,forceFeatureAttributes:l,format:r,height:s,includeTables:u,layout:c,layoutItem:d,legendEnabled:p,northArrowEnabled:m,scale:h,scaleEnabled:y,title:v,width:f}=e;if(!c)throw new I.Z("print:layout-required","layout is not set");const b=new je({attributionVisible:t,forceFeatureAttributes:l,format:r,includeTables:u,layout:c,layoutItem:d,layoutOptions:{authorText:i||"",copyrightText:o||"",customTextElements:a,titleText:v||""},outScale:null!==h&&void 0!==h?h:0,scalePreserved:y});f&&(b.exportOptions.width=f),s&&(b.exportOptions.height=s),n&&(b.exportOptions.dpi=n),!p&&b.layoutOptions&&(b.layoutOptions.legendLayers=[]);const g=this.layoutTemplateNorthArrowInfo;return g&&g.visible!==m&&b.layoutOptions&&(b.layoutOptions.elementOverrides={[g.name]:{visible:m}}),b}async fetchLayoutTemplateInfo(e,t){var i,o;if(null===(i=e.layoutItem)||void 0===i||!i.id)return;const a=await this._fetchPortalLayoutTemplateInfo(e.layoutItem,t);this._layoutToTemplateInfo.set(e.layoutItem.id,a),e.layoutTemplateInfo=a;const{hasLegend:n,mapSurroundInfos:r,customTextElements:s}=a.layoutOptions,u=r.some((e=>{let{type:t,visible:i}=e;return"CIMMarkerNorthArrow"===t&&i}));e.layoutOptions={legend:n,northArrow:u};const c=null!==(o=(0,l.d9)(this._serviceTemplateCustomTextElements))&&void 0!==o?o:{};c[e.layoutItem.id]=s,this._serviceTemplateCustomTextElements=Object.freeze(c)}getLayoutTemplateInfo(e){return this._layoutToTemplateInfo.get(e)}async addPortalTemplate(e){const t=new Lt({label:e.title,layoutItem:e});this.browseTemplates.add(t)}removePortalTemplate(e){var t,i,o;null!==(t=e.layoutItem)&&void 0!==t&&t.id&&(null===(i=this.templateOptions.layoutItem)||void 0===i?void 0:i.id)===e.layoutItem.id&&(this.templateOptions.layout=this.defaultTemplates.length||this.browseTemplates.length?null:null===(o=this.templatesInfo)||void 0===o||null===(o=o.layout)||void 0===o?void 0:o.defaultValue,this.templateOptions.layoutItem=null),this._layoutToTemplateInfo.delete(e.layoutItem.id),this.browseTemplates.remove(e)}async _loadResources(e){var t,i;let o=[];if(this.printServiceUrl)this._set("effectivePrintServiceUrl",this.printServiceUrl),await this._updateLayoutInfoTaskUrl(this.effectivePrintServiceUrl);else{if(this.destroyed)return;try{await this.portal.load(e)}catch(j){throw new I.Z("print:could-not-load-portal","Cannot load print resource information from portal",{error:j,url:this.effectivePrintServiceUrl})}if(this.portal.helperServices){var a,n;const{asyncPrintTask:e,layoutInfoTask:t,printTask:i}=this.portal.helperServices;i&&(this._set("effectivePrintServiceUrl",i.url),o=null!==(a=null===(n=i.templates)||void 0===n?void 0:n.map((e=>Lt.fromJSON(e))))&&void 0!==a?a:[]),this._asyncPrintTaskUrl=null===e||void 0===e?void 0:e.url,await this._updateLayoutInfoTaskUrl((null===t||void 0===t?void 0:t.url)||this.effectivePrintServiceUrl)}}this.defaultTemplates.addMany(o);const l=null===(t=this.effectivePrintServiceUrl)||void 0===t?void 0:t.toLowerCase().split("/");if(null===l||void 0===l||!l.includes("gpserver"))throw new I.Z("print:invalid-print-service-url","Can't fetch print templates information from provided URL",{url:this.effectivePrintServiceUrl});const[r,s,u]=await Promise.all([this._getPrintServiceLayouts(e),this._getPrintServiceTemplates(e),this._getPortalCustomTemplates(e)]);if(this._processPrintServiceLayouts(r),this._processPrintServiceTemplates(s),this._processPortalTemplates(u),null!==(i=this.templateOptions.layoutItem)&&void 0!==i&&i.id){const t=this.templateOptions.layoutItem.id;let i=this.defaultTemplates.find((e=>{var i;return(null===(i=e.layoutItem)||void 0===i?void 0:i.id)===t}));i||(i=new Lt({label:this.templateOptions.layoutItem.title,layoutItem:this.templateOptions.layoutItem})),await this.fetchLayoutTemplateInfo(i,e),this.templateOptions.layout=t}this._updateOverLayItem()}async _updateLayoutInfoTaskUrl(e,t){if(!e)return;const i=(await async function(e,t){return(await Ze(e,t)).gpMetadata.tasks}(e,t)).find((e=>e.includes("Get Layout Templates Info")));i&&(this._layoutInfoTaskUrl=e.replace(Et,"$1".concat(encodeURI(i))))}async _getPortalCustomTemplates(e){var t;if(this.printServiceUrl||!this.portal)return[];const{layoutGroupQuery:i,user:o}=this.portal,a=p.HR.test(this.portal.url),n=null===o||void 0===o?void 0:o.userLicenseTypeId,l=n&&Mt.has(n);if(!i||a&&!l)return[];const r=new E.Z({query:i,disableExtraQuery:!0}),s=await this.portal.queryGroups(r,e);if(!s.total)return[];const u=s.results[0],c=new E.Z({num:100,query:"type:Layout",sortField:u.sortField,sortOrder:null!==(t=u.sortOrder)&&void 0!==t?t:void 0}),d=(await u.queryItems(c,e)).results;return d.length?d.map((e=>new Lt({label:e.title,layoutItem:e}))):[]}async _fetchPortalLayoutTemplateInfo(e,t){const{id:i}=e,o=this._layoutInfoTaskUrl;if(!o)throw new I.Z("print:invalid-layout-info-task-url","Can't fetch layout template info",{url:o});"public"!==e.access&&T.id&&await T.id.getCredential(o);const a={Layout_Item_ID:JSON.stringify({id:i})};return(await this._fetchLayoutTemplateInfos(a,t))[0]}async _fetchLayoutTemplateInfos(e,t){const i=this._layoutInfoTaskUrl;if(!i)throw new I.Z("print:invalid-layout-info-task-url","Can't fetch layout template info",{url:i});if("async"===await ze(i)){const o=await be(i,e,void 0,t||void 0);return await o.waitForJobCompletion({interval:1e3}),(await o.fetchResultData("Output_JSON")).value}return(await he(i,e,null,t)).results[0].value}_processPortalTemplates(e){if(e){this.defaultTemplates.addMany(e);for(const i of e){var t;(null===(t=i.layoutItem)||void 0===t?void 0:t.id)&&this.portalTemplateIds.push(i.layoutItem.id)}}}_processPrintServiceTemplates(e){this._set("templatesInfo",e)}async _getPrintServiceLayouts(e){let t=[];try{t=await this._fetchLayoutTemplateInfos(void 0,e)}catch{}return t}_processPrintServiceLayouts(e){const t={};for(const i of e){const{layoutTemplate:e,layoutOptions:o}=i,a=Ce(e);this._layoutToTemplateInfo.set(a,i),t[a]=o.customTextElements}this._serviceTemplateCustomTextElements=Object.freeze(t)}async _getPrintServiceTemplates(e){let t;try{({data:t}=await(0,S.Z)(this.effectivePrintServiceUrl,{...e,query:{f:"json"},timeout:this.printTimeout}))}catch(j){throw(0,O.D_)(j)?j:new I.Z("print:unavailable-service-info","Can't fetch templates info from service",{error:j})}const{parameters:i}=t,o=i.find((e=>{let{name:t}=e;return"Format"===t})),a=i.find((e=>{let{name:t}=e;return"Layout_Template"===t}));return{format:this._getFormat(o),layout:this._getLayout(a)}}_getFormat(e){const t="all"===this.allowedFormats?e.choiceList:e.choiceList.filter((e=>this.allowedFormats.includes(y(e)))),i=(t.length?t:e.choiceList).map(y).filter(C.pC),o=y(e.defaultValue),a=i.includes(o)?o:i[0];return{choiceList:i,defaultValue:a}}_getLayout(e){var t,i;const o=e.choiceList.filter((e=>"map_only"!==e.toLowerCase())),a="all"===this.allowedLayouts?o:o.filter((e=>this.allowedLayouts.includes(Ce(e)))),n=(a.length?a:o).map(Ce).filter(C.pC),l=Ce(e.defaultValue),r=n.includes(l)?l:null!==(t=null!==(i=n.find((e=>/(?=.*letter)(?=.*landscape)/i.test(e))))&&void 0!==i?i:n.find((e=>/(?=.*a4)(?=.*landscape)/i.test(e))))&&void 0!==t?t:n[0];return{choiceList:n,defaultValue:r}}_getOverlayItem(){return this._overlayItem||(this._overlayItem=new kt({strokeDash:[5],strokeWidth:2,strokeColor:[30,144,255,255]})),this._overlayItem}_enablePrintPreview(){var e,t,i;if(null===(e=this.view)||void 0===e||!e.overlay)return;const o=this.templateOptions,a=this._getOverlayItem();this.addHandles([(0,r.watch)((()=>{var e,t,i,a;return[o.width,o.height,o.scaleEnabled,o.scale,o.layout,o.layoutItem,null===(e=this.view)||void 0===e?void 0:e.scale,null===(t=this.view)||void 0===t?void 0:t.size,null===(i=this.view)||void 0===i?void 0:i.state.paddedViewState.size,null===(a=this.view)||void 0===a?void 0:a.state.padding]}),(()=>this._updateOverLayItem()),r.initial),null===(t=this.view)||void 0===t?void 0:t.on("drag",["Shift"],(e=>this._handleDrag(e)),Ct.f.WIDGET),null===(i=this.view)||void 0===i?void 0:i.on("key-down",["Escape"],(()=>this._resetDrag()),Ct.f.WIDGET)],"overlay-handler"),this.view.overlay.addItem(a)}_updateOverLayItem(){var e,t;if(!this.view)return;const i=this.templateOptions,o=this._getOverlayItem(),a=null!==(e=null===(t=i.layoutItem)||void 0===t?void 0:t.id)&&void 0!==e?e:i.layout,n=this.view,l=n.spatialReference,[r,s]=n.state.paddedViewState.size,u=n.state.padding;let c=0,d=0;if("MAP_ONLY"===a)null!=i.width&&null!=i.height&&(c=i.width,d=i.height);else if(a){var p;const{webMapFrameSize:e,pageUnits:t}=null!==(p=this._layoutToTemplateInfo.get(a))&&void 0!==p?p:{};let o=!1;if(e&&t)if(this._isFreeHand){const t=e[0]/e[1];c=this._freeHandWidth,d=this._freehandHeight,c>d?d=c/t:c=d*t}else{const i=Nt.fromJSON(t.toLowerCase()),a=l.unit;(0,L.UF)(i)===(0,L.UF)(a)?(c=(0,L.En)(e[0],i,a),d=(0,L.En)(e[1],i,a)):(o=!0,c=e[0],d=e[1])}if(!this._isFreeHand)if(i.scaleEnabled&&i.scale){const e=o?Math.min(r/c,s/d):(0,L.c9)(l)*L.hd*i.dpi;c*=e,d*=e}else if(0===c||0===d)c=r,d=s;else{const e=(r-.1*r)/c,t=(s-.1*s)/d,i=Math.min(e,t);c*=i,d*=i}}const{scaleEnabled:m,scale:h}=i,y=m&&h?h/this.view.scale:1;o.boxWidth=c*y||r,o.boxHeight=d*y||s,u&&(o.padding=u),o.backgroundWidth=null!==r&&void 0!==r?r:0,o.backgroundHeight=null!==s&&void 0!==s?s:0}_resetDrag(){this._isFreeHand=!1,this._updateOverLayItem()}_handleDrag(e){switch(e.action){case"start":this._start();break;case"update":this._update(e);break;case"end":this._end()}e.stopPropagation()}_start(){this._isFreeHand=!0}_update(e){const t=this._getOverlayItem(),{x:i,y:o}=e,{x:a,y:n}=e.origin;i>a?(t.x=a,t.boxWidth=i-a):(t.x=i,t.boxWidth=a-i),o>n?(t.y=n,t.boxHeight=o-n):(t.y=o,t.boxHeight=n-o)}_end(){const e=this._getOverlayItem();if(!this.view||null==e.x||null==e.y)return;const t=this.view,i=t.toMap((0,P.vW)(e.x+.5*e.boxWidth,e.y+.5*e.boxHeight));e.x=null,e.y=null,t.goTo({center:i}),this._freeHandWidth=e.boxWidth,this._freehandHeight=e.boxHeight,"MAP_ONLY"===this.templateOptions.layout&&(this.templateOptions.width=this._freeHandWidth,this.templateOptions.height=this._freehandHeight),this.templateOptions.scale=this.view.scale,this._updateOverLayItem()}};(0,o._)([(0,c.Cb)()],Ut.prototype,"_serviceTemplateCustomTextElements",void 0),(0,o._)([(0,c.Cb)()],Ut.prototype,"_layoutToTemplateInfo",void 0),(0,o._)([(0,c.Cb)()],Ut.prototype,"allowedFormats",void 0),(0,o._)([(0,c.Cb)()],Ut.prototype,"allowedLayouts",void 0),(0,o._)([(0,c.Cb)({type:Ft})],Ut.prototype,"browseTemplates",void 0),(0,o._)([(0,c.Cb)({type:Ft})],Ut.prototype,"defaultTemplates",void 0),(0,o._)([(0,c.Cb)()],Ut.prototype,"error",void 0),(0,o._)([(0,c.Cb)()],Ut.prototype,"extraParameters",void 0),(0,o._)([(0,c.Cb)()],Ut.prototype,"includeDefaultTemplates",void 0),(0,o._)([(0,c.Cb)({readOnly:!0})],Ut.prototype,"effectivePrintServiceUrl",null),(0,o._)([(0,c.Cb)()],Ut.prototype,"effectiveTemplateCustomTextElements",null),(0,o._)([(0,c.Cb)()],Ut.prototype,"layoutTemplateInfo",null),(0,o._)([(0,c.Cb)({type:M.Z})],Ut.prototype,"portal",void 0),(0,o._)([(0,c.Cb)()],Ut.prototype,"portalTemplateIds",void 0),(0,o._)([(0,c.Cb)()],Ut.prototype,"showPrintAreaEnabled",void 0),(0,o._)([(0,c.Cb)()],Ut.prototype,"printServiceUrl",void 0),(0,o._)([(0,c.Cb)()],Ut.prototype,"printTimeout",void 0),(0,o._)([(0,c.Cb)({readOnly:!0})],Ut.prototype,"state",null),(0,o._)([(0,c.Cb)({readOnly:!0})],Ut.prototype,"templatesInfo",void 0),(0,o._)([(0,c.Cb)()],Ut.prototype,"updateDelay",void 0),(0,o._)([(0,c.Cb)()],Ut.prototype,"view",void 0),(0,o._)([(0,c.Cb)()],Ut.prototype,"templateCustomTextElements",void 0),(0,o._)([(0,c.Cb)({type:At})],Ut.prototype,"templateOptions",void 0),(0,o._)([(0,c.Cb)()],Ut.prototype,"layoutTemplateNorthArrowInfo",null),Ut=(0,o._)([(0,d.j)("esri.widgets.Print.PrintViewModel")],Ut);const Rt=Ut;var jt=i(8905),Vt=i(7021),Gt=i(96919),Jt=i(33095),qt=i(80532),Bt=i(6291);const Ht=a.Z.ofType(w),Wt="MAP_ONLY";var Zt;!function(e){e.layout="layoutTab",e.mapOnly="mapOnlyTab",e.export="exportTab"}(Zt||(Zt={}));const zt="esri-print",Kt="".concat(zt,"__advanced-options-button"),Yt={base:zt,headerTitle:"".concat(zt,"__header-title"),layoutTabList:"".concat(zt,"__layout-tab-list"),layoutTab:"".concat(zt,"__layout-tab"),layoutSection:"".concat(zt,"__layout-section"),mapOnlySection:"".concat(zt,"__map-only-section"),panelItemsCentered:"".concat(zt,"__panel-items--centered"),loader:"".concat(zt,"__loader"),advancedOptionsButton:Kt,advancedOptionsButtonContainer:"".concat(Kt,"-container"),advancedOptionsButtonTitle:"".concat(Kt,"-title"),advancedOptionsButtonIconOpened:"".concat(Kt,"-icon--opened"),advancedOptionsButtonIconClosed:"".concat(Kt,"-icon--closed"),advancedOptionsButtonIconClosed_RTL:"".concat(Kt,"-icon--closed-rtl"),swapButton:"".concat(zt,"__swap-button"),printButton:"".concat(zt,"__export-button"),templateSelectContainer:"".concat(zt,"__template-select-container"),templateSelectBlock:"".concat(zt,"__template-select-block"),templateSelectIcon:"".concat(zt,"__template-select-icon"),formSectionContainer:"".concat(zt,"__form-section-container"),formCheckboxLabel:"".concat(zt,"__form-checkbox-label"),advancedOptionsSection:"".concat(zt,"__advanced-options-section"),advancedOptionsContainer:"".concat(zt,"__advanced-options-container"),browseTemplateButtonContainer:"".concat(zt,"__browse-template-button-container"),exportedFilesContainer:"".concat(zt,"__export-panel-container"),exportedFilesTitle:"".concat(zt,"__export-title"),exportedFile:"".concat(zt,"__exported-file"),exportedFileLink:"".concat(zt,"__exported-file-link"),exportedFileLinkTitle:"".concat(zt,"__exported-file-link-title"),exportedFilesEmpty:"".concat(zt,"__exported-files-empty"),printWidgetContainer:"".concat(zt,"__container"),content:"".concat(zt,"__content"),panelContainer:"".concat(zt,"__panel-container"),scaleInfoContainer:"".concat(zt,"__scale-info-container"),scaleInputContainer:"".concat(zt,"__scale-input-container"),scaleInput:"".concat(zt,"__scale-input"),sizeContainer:"".concat(zt,"__size-container"),panelError:"".concat(zt,"__panel--error"),exportedFileError:"".concat(zt,"__exported-file--error"),exportedFileLoader:"".concat(zt,"__exported-file--loader"),exportSection:"".concat(zt,"__export-section"),exportSectionCentered:"".concat(zt,"__export-section--centered"),templateButtonContainer:"".concat(zt,"__template-button-container"),templateDoneButton:"".concat(zt,"__template-done-button"),templateSelectFlowItemContainer:"".concat(zt,"__template-select-flow-item-container"),templateSelectFlowItemContent:"".concat(zt,"__template-select-flow-item-content"),templateSelectFlowItemListHeading:"".concat(zt,"__template-select-flow-item-list-heading")};function Xt(e){return(null===e||void 0===e?void 0:e.toUpperCase())===Wt}function Qt(e){var t;const{state:i,extension:o}=e;switch(i){case"pending":return"spinner";case"error":return"exclamation-mark-circle";default:return null!==o&&void 0!==o&&null!==(t=o.toLowerCase())&&void 0!==t&&t.includes("pdf")?"file-pdf":"file"}}function $t(e,t){return!!t&&e.some((e=>{var i;return(null===(i=e.layoutItem)||void 0===i?void 0:i.id)===t||e.layout===t}))}const ei=new n.X({inch:"inches",foot:"feet",yard:"yards",mile:"miles","nautical-mile":"nautical-miles",millimeter:"millimeters",centimeter:"centimeters",decimeter:"decimeters",meter:"meters",kilometer:"kilometers"});let ti=class extends f.Z{constructor(e,t){super(e,t),this._activeTabFocusRequested=!1,this._awaitingServerResponse=!1,this._exportedFileNameMap={},this._selectedTab=Zt.layout,this._pendingExportScroll=!1,this._rootNode=null,this._selectedLayout=null,this._abortController=null,this._showTemplates=!1,this.browseTemplateButtonOnClick=null,this.exportedLinks=new Ht,this.headingLevel=3,this.messagesCommon=null,this.messagesUnits=null,this.viewModel=new Rt,this._onInput=e=>{this._selectedTab===Zt.layout?this.templateOptions.title=e.target.value:this._selectedTab===Zt.mapOnly&&(this.templateOptions.fileName=e.target.value)},this._removeLink=e=>{const t=e.currentTarget["data-item"];t&&this.exportedLinks.remove(t)},this._handleLinkClick=e=>{var t;const i=e.currentTarget["data-item"];if(!i||"ready"!==i.state||!i.url)return;const o=(0,m.LP)(this.viewModel.effectivePrintServiceUrl),a=i.url,n=document.createElement("a");if(n.target="_blank",n.href=a,n.rel="noreferrer",n.download=null!==(t=i.formattedName)&&void 0!==t?t:"",!o)return n.click(),void e.stopPropagation();e.preventDefault();const l=new URL(a);l.searchParams.set("token",o),n.href=l.href,n.click(),n.href=a},this._focusOnTabChange=this._focusOnTabChange.bind(this)}initialize(){this.addHandles([(0,r.watch)((()=>{var e;return[this.templateOptions.format,null===(e=this.viewModel.templatesInfo)||void 0===e?void 0:e.format.defaultValue]}),(e=>{let[t,i]=e;if(i&&!t)return void(this.templateOptions.format=i);if(!t||!i||!this.viewModel.templatesInfo)return;if(this.viewModel.templatesInfo.format.choiceList.includes(t))return;const o=this.viewModel.templatesInfo.format.choiceList.find((e=>e.toUpperCase().includes("(".concat(t.toUpperCase(),")"))));this.templateOptions.format=null!==o&&void 0!==o?o:i})),(0,r.watch)((()=>{var e;return[this.templateOptions.layout,null===(e=this.viewModel.templatesInfo)||void 0===e?void 0:e.layout.defaultValue]}),(async e=>{let[t,i]=e;if(this._selectedTab=Xt(t)?Zt.mapOnly:Zt.layout,this._selectedTab!==Zt.layout)return;const{includeDefaultTemplates:o,viewModel:a,_selectedLayout:n}=this,{portalTemplateIds:r,browseTemplates:s,templatesInfo:u}=a,c=a.defaultTemplates.filter((e=>{let{layoutItem:t}=e;return r.includes(null===t||void 0===t?void 0:t.id)})),d=a.defaultTemplates.filter((e=>{let{layoutItem:t}=e;return!r.includes(null===t||void 0===t?void 0:t.id)})),p=o&&d.length;t?(p?$t(d,t):null===u||void 0===u?void 0:u.layout.choiceList.includes(t))||$t(c,t)||$t(s,t)||(this.templateOptions.layout=null,this.templateOptions.layoutItem=null):(n&&((p?$t(d,n):null===u||void 0===u?void 0:u.layout.choiceList.includes(n))||$t(c,n)||$t(s,n))?await this._applyTemplate(n):(this.templateOptions.layout=null,this.templateOptions.layoutItem=null),this.templateOptions.layout||p||!i||await this._applyTemplate(i)),this._selectedLayout=this.templateOptions.layout;const m=!!this.templateOptions.layout&&this.viewModel.effectiveTemplateCustomTextElements[this.templateOptions.layout];this.templateOptions.customTextElements=m?(0,l.d9)(m):null})),(0,r.watch)((()=>this.templateOptions.dpi),(e=>{e<=0&&(this.templateOptions.dpi=1)})),(0,r.watch)((()=>{var e;return null===(e=this.viewModel.view)||void 0===e?void 0:e.scale}),(e=>{!e||this.templateOptions.scaleEnabled&&this.templateOptions.scale||(this.templateOptions.scale=e)}))]);const{height:e,width:t}=this.templateOptions;this.templateOptions.width=t||800,this.templateOptions.height=e||1100;const i=setTimeout((()=>{this._awaitingServerResponse=!0,this.scheduleRender()}),500);this.viewModel.load().then((()=>{clearTimeout(i),this._awaitingServerResponse=!1}))}loadDependencies(){return(0,jt.h)({action:()=>Promise.all([i.e(92358),i.e(46895),i.e(65138),i.e(91741)]).then(i.bind(i,6814)),block:()=>Promise.all([i.e(92358),i.e(46895),i.e(89219),i.e(63839),i.e(65138),i.e(2654),i.e(23635),i.e(4758)]).then(i.bind(i,4758)),button:()=>Promise.all([i.e(92358),i.e(46895),i.e(54438),i.e(14105),i.e(32275)]).then(i.bind(i,32275)),checkbox:()=>Promise.all([i.e(92358),i.e(54438),i.e(12424)]).then(i.bind(i,12424)),combobox:()=>Promise.all([i.e(92358),i.e(46895),i.e(54438),i.e(89219),i.e(1579),i.e(34504),i.e(63017),i.e(70419)]).then(i.bind(i,70419)),"combobox-item":()=>Promise.all([i.e(92358),i.e(15862)]).then(i.bind(i,15862)),flow:()=>i.e(53049).then(i.bind(i,53049)),"flow-item":()=>Promise.all([i.e(92358),i.e(46895),i.e(89219),i.e(63839),i.e(65138),i.e(2654),i.e(23635),i.e(89524),i.e(48926)]).then(i.bind(i,48926)),icon:()=>Promise.all([i.e(92358),i.e(87474)]).then(i.bind(i,87474)),input:()=>Promise.all([i.e(92358),i.e(46895),i.e(54438),i.e(8715),i.e(16746)]).then(i.bind(i,75655)),label:()=>Promise.all([i.e(92358),i.e(35738)]).then(i.bind(i,35738)),list:()=>Promise.all([i.e(92358),i.e(46895),i.e(54438),i.e(34504),i.e(8715),i.e(38782)]).then(i.bind(i,38782)),"list-item":()=>Promise.all([i.e(92358),i.e(46895),i.e(65138),i.e(21340)]).then(i.bind(i,67994)),loader:()=>i.e(92382).then(i.bind(i,92382)),switch:()=>Promise.all([i.e(92358),i.e(54438),i.e(40206)]).then(i.bind(i,40206)),chip:()=>Promise.all([i.e(92358),i.e(46895),i.e(1579),i.e(12386)]).then(i.bind(i,53607))})}destroy(){this.viewModel.destroy()}get allowedFormats(){return this.viewModel.allowedFormats}set allowedFormats(e){this.viewModel.allowedFormats=e}get allowedLayouts(){return this.viewModel.allowedLayouts}set allowedLayouts(e){this.viewModel.allowedLayouts=e}get error(){return this.viewModel.error}get extraParameters(){return this.viewModel.extraParameters}set extraParameters(e){this.viewModel.extraParameters=e}get icon(){return"print"}set icon(e){this._overrideIfSome("icon",e)}get includeDefaultTemplates(){return this.viewModel.includeDefaultTemplates}set includeDefaultTemplates(e){this.viewModel.includeDefaultTemplates=e}get label(){var e,t;return null!==(e=null===(t=this.messages)||void 0===t?void 0:t.widgetLabel)&&void 0!==e?e:""}set label(e){this._overrideIfSome("label",e)}get portal(){return this.viewModel.portal}set portal(e){this.viewModel.portal=e}get showPrintAreaEnabled(){return this.viewModel.showPrintAreaEnabled}set showPrintAreaEnabled(e){this.viewModel.showPrintAreaEnabled=e}get printServiceUrl(){return this.viewModel.printServiceUrl}set printServiceUrl(e){this.viewModel.printServiceUrl=e}get templateCustomTextElements(){return this.viewModel.templateCustomTextElements}set templateCustomTextElements(e){this.viewModel.templateCustomTextElements=e}get templateOptions(){return this.viewModel.templateOptions}set templateOptions(e){this.viewModel.templateOptions=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){var e,t,i,o,a,n,l,r,s;const{messages:u,templateOptions:c,viewModel:d,view:p}=this,{attributionEnabled:m,author:h,copyright:y,dpi:f,format:b,height:g,layout:w,legendEnabled:_,northArrowEnabled:T,scaleEnabled:S,scale:C,width:I}=c,x="ready"!==d.state||this._awaitingServerResponse||!w,O=this._renderTitleOrFileNameSection(),k=(0,xt.u)("div",{class:Yt.formSectionContainer},(0,xt.u)("calcite-label",null,u.fileFormatTitle,(0,xt.u)("calcite-combobox",{clearDisabled:!0,label:u.formatDefaultOption,maxItems:6,placeholder:u.formatDefaultOption,selectionMode:"single-persist",onCalciteComboboxChange:e=>{let{target:t}=e;this.templateOptions.format=t.selectedItems[0].value}},null===(e=d.templatesInfo)||void 0===e||null===(e=e.format)||void 0===e?void 0:e.choiceList.sort().map(((e,t)=>(0,xt.u)("calcite-combobox-item",{key:"file-format-".concat(t),selected:e===this.templateOptions.format,textLabel:v(e),value:e})))))),P=(0,xt.u)("calcite-label",{layout:"inline"},(0,xt.u)("calcite-switch",{checked:this.showPrintAreaEnabled,onCalciteSwitchChange:e=>{this.showPrintAreaEnabled=!!e.target.checked}}),u.printPreview),L=(0,xt.u)("div",null,(0,xt.u)("div",{class:Yt.formSectionContainer},(0,xt.u)("calcite-label",null,u.template,(0,xt.u)("div",{class:Yt.templateSelectContainer,onclick:()=>{this._showTemplates=!0}},(0,xt.u)("calcite-block",{class:Yt.templateSelectBlock,description:this._getPageSizeLabel(w),heading:this._getTemplateLabel()}),(0,xt.u)("calcite-icon",{class:Yt.templateSelectIcon,icon:(0,It.dZ)()?"chevron-left":"chevron-right",scale:"s"})))),P),D=(0,xt.u)("div",{class:Yt.formSectionContainer},(0,xt.u)("calcite-label",null,u.dpi,(0,xt.u)("calcite-input",{bind:this,"data-input-name":"dpi",min:1,tabIndex:0,type:"number",value:"".concat(f),onCalciteInputInput:this._handleDPIChange}))),A=(0,xt.u)("div",{class:this.classes(Yt.scaleInfoContainer,Yt.formSectionContainer)},(0,xt.u)("calcite-label",{layout:"inline"},(0,xt.u)("calcite-checkbox",{bind:this,checked:S,"data-option-name":"scaleEnabled",tabIndex:0,onCalciteCheckboxChange:this._toggleInputValue}),u.scale),(0,xt.u)("div",{class:Yt.scaleInputContainer},(0,xt.u)("calcite-input",{"aria-label":u.scaleLabel,"aria-valuenow":"".concat(C),bind:this,class:Yt.scaleInput,"data-input-name":"scale",disabled:!S,tabIndex:0,type:"number",value:"".concat(C),onCalciteInputInput:this._updateInputValue}),(0,xt.u)("calcite-button",{appearance:"outline","aria-label":u.reset,bind:this,disabled:!S,iconStart:"refresh",kind:"neutral",onclick:this._resetToCurrentScale,tabIndex:0}))),M=(0,xt.u)("div",{"aria-labelledby":"".concat(this.id,"__advancedOptionsForLayout"),class:Yt.advancedOptionsContainer,key:"advanced-section-for-layout"},A,null===(t=null===(i=this.viewModel.layoutTemplateInfo)||void 0===i||null===(i=i.layoutOptions)||void 0===i?void 0:i.hasAuthorText)||void 0===t||t?(0,xt.u)("div",{class:Yt.formSectionContainer,key:"author-info"},(0,xt.u)("calcite-label",null,u.author,(0,xt.u)("calcite-input",{bind:this,"data-input-name":"author",tabIndex:0,value:null!==h&&void 0!==h?h:"",onCalciteInputInput:this._updateInputValue}))):null,null===(o=null===(a=this.viewModel.layoutTemplateInfo)||void 0===a||null===(a=a.layoutOptions)||void 0===a?void 0:a.hasCopyrightText)||void 0===o||o?(0,xt.u)("div",{class:Yt.formSectionContainer,key:"copyright-text"},(0,xt.u)("calcite-label",null,u.copyright,(0,xt.u)("calcite-input",{bind:this,"data-input-name":"copyright",tabIndex:0,value:null!==y&&void 0!==y?y:"",onCalciteInputInput:this._updateInputValue}))):null,D,this._renderCustomTextElementSection(),null===(n=null===(l=this.viewModel.layoutTemplateInfo)||void 0===l||null===(l=l.layoutOptions)||void 0===l?void 0:l.hasLegend)||void 0===n||n?(0,xt.u)("div",{class:Yt.formSectionContainer,key:"legend-info"},(0,xt.u)("calcite-label",{layout:"inline"},(0,xt.u)("calcite-checkbox",{bind:this,checked:_,"data-option-name":"legendEnabled",tabIndex:0,onCalciteCheckboxChange:this._toggleInputValue}),u.legend)):null,this.viewModel.layoutTemplateNorthArrowInfo?(0,xt.u)("div",{class:Yt.formSectionContainer,key:"north-arrow"},(0,xt.u)("calcite-label",{layout:"inline"},(0,xt.u)("calcite-checkbox",{bind:this,checked:T,"data-option-name":"northArrowEnabled",tabIndex:0,onCalciteCheckboxChange:this._toggleInputValue}),u.northArrow)):null),E=(0,xt.u)("div",{"aria-labelledby":"".concat(this.id,"__advancedOptionsForMapOnly"),class:Yt.advancedOptionsContainer},A,D,(0,xt.u)("div",{class:Yt.formSectionContainer},(0,xt.u)("calcite-label",{layout:"inline"},(0,xt.u)("calcite-checkbox",{bind:this,checked:m,"data-option-name":"attributionEnabled",tabIndex:0,onCalciteCheckboxChange:this._toggleInputValue}),u.attribution)),this._renderCustomTextElementSection()),N=this.exportedLinks.toArray(),F=this._renderExportedLink(N),U={[Yt.exportSectionCentered]:!N.length},R=this._selectedTab===Zt.layout?(0,xt.u)("section",{"aria-labelledby":"".concat(this.id,"__layoutTab"),class:Yt.layoutSection,id:"".concat(this.id,"__layoutContent"),key:"esri-print__layoutContent",role:"tabpanel"},(0,xt.u)("div",{class:Yt.panelContainer},null===(r=null===(s=this.viewModel.layoutTemplateInfo)||void 0===s||null===(s=s.layoutOptions)||void 0===s?void 0:s.hasTitleText)||void 0===r||r?O:null,L,this._selectedTab===Zt.layout?k:null,(0,xt.u)("calcite-block",{"aria-label":u.advancedOptions,class:this.classes(Yt.panelContainer,Yt.advancedOptionsSection),collapsible:!0,disabled:!w,heading:u.advancedOptions,id:"advancedOptionsForLayout",key:"advanced-options-for-layout"},M))):this._selectedTab===Zt.mapOnly?(0,xt.u)("section",{"aria-labelledby":"".concat(this.id,"__mapOnlyTab"),class:Yt.mapOnlySection,id:"".concat(this.id,"__mapOnlyContent"),key:"esri-print__mapOnlyContent",role:"tabpanel"},(0,xt.u)("div",{class:Yt.panelContainer},O,k,(0,xt.u)("div",null,(0,xt.u)("div",{class:this.classes(Yt.sizeContainer,Yt.formSectionContainer)},(0,xt.u)("calcite-label",null,u.width,(0,xt.u)("calcite-input",{bind:this,"data-input-name":"width",tabIndex:0,type:"number",value:"".concat(I),onCalciteInputInput:this._updateInputValue})),(0,xt.u)("calcite-label",null,u.height,(0,xt.u)("calcite-input",{bind:this,"data-input-name":"height",tabIndex:0,type:"number",value:"".concat(g),onCalciteInputInput:this._updateInputValue})),(0,xt.u)("button",{"aria-label":u.swap,bind:this,class:this.classes(Vt.z.widgetButton,Yt.swapButton,Jt.W.swap),onclick:this._switchInput,tabIndex:0,type:"button"})),P),(0,xt.u)("calcite-block",{"aria-label":u.advancedOptions,class:this.classes(Yt.panelContainer,Yt.advancedOptionsSection),collapsible:!0,heading:u.advancedOptions,id:"advancedOptionsForMapOnly",key:"advanced-options-for-map-only"},E))):(0,xt.u)("section",{"aria-labelledby":"".concat(this.id,"__exportTab"),class:this.classes(Yt.exportSection,U),id:"".concat(this.id,"__exportContent"),key:"esri-print__exportContent",role:"tabpanel"},(0,xt.u)("div",{class:Yt.panelContainer},(0,xt.u)("div",{afterUpdate:this._scrollExportIntoView,bind:this,class:Yt.exportedFilesContainer},0===N.length?(0,xt.u)("div",{class:Yt.exportedFilesEmpty},(0,xt.u)("calcite-icon",{icon:"file",scale:"l"}),(0,xt.u)("div",null,(0,xt.u)(Gt.X,{class:Yt.exportedFilesTitle,level:this.headingLevel},u.noExportedFiles),(0,xt.u)("div",null,u.exportHint))):F))),j={[Vt.z.buttonDisabled]:x||!w&&!b},V=!p||"2d"!==p.type,G=(0,xt.u)("div",{class:Yt.panelError},V?u.sceneViewError:u.serviceError),J=N.some((e=>{let{state:t}=e;return"pending"===t})),q=(0,xt.u)("div",{class:Yt.content,key:"panel"},(0,xt.u)("div",null,(0,xt.u)("ul",{bind:this,class:Yt.layoutTabList,onclick:this._toggleLayoutPanel,onkeydown:this._handleLayoutPanelKeyDown,role:"tablist"},(0,xt.u)("li",{afterCreate:this._focusOnTabChange,afterUpdate:this._focusOnTabChange,"aria-selected":"".concat(this._selectedTab===Zt.layout),class:Yt.layoutTab,"data-tab-id":Zt.layout,id:"".concat(this.id,"__layoutTab"),role:"tab",tabIndex:0},u.layoutTab),(0,xt.u)("li",{afterCreate:this._focusOnTabChange,afterUpdate:this._focusOnTabChange,"aria-selected":"".concat(this._selectedTab===Zt.mapOnly),class:Yt.layoutTab,"data-tab-id":Zt.mapOnly,id:"".concat(this.id,"__mapOnlyTab"),role:"tab",tabIndex:0},u.mapOnlyTab),(0,xt.u)("li",{afterCreate:this._focusOnTabChange,afterUpdate:this._focusOnTabChange,"aria-selected":"".concat(this._selectedTab===Zt.export),class:Yt.layoutTab,"data-tab-id":Zt.export,id:"".concat(this.id,"__exportedFilesTab"),role:"tab",tabIndex:0},J?(0,xt.u)("calcite-loader",{inline:!0,label:"loading",scale:"s"}):null,u.exportsTab)),R),this._selectedTab!==Zt.export?(0,xt.u)("button",{"aria-label":u.exportDescription,bind:this,class:this.classes(Yt.printButton,Vt.z.button,j),disabled:x,onclick:this._handlePrintMap,tabIndex:0,type:"button"},u.export):null),B=(0,xt.u)("calcite-flow",{key:"root-flow"},(0,xt.u)("calcite-flow-item",{bind:this,key:"root-flow-item"},(0,xt.u)("div",{class:Yt.printWidgetContainer},(0,xt.u)("header",{class:Yt.headerTitle},u.export),this.error||V||!p?G:q)),this._renderChooseTemplateFlowItem()),H="initializing"===d.state,W=H?this._renderLoader():B,Z={[Yt.panelItemsCentered]:H};return(0,xt.u)("div",{bind:this,class:this.classes(Yt.base,Vt.z.widget,Vt.z.panel,Z)},W)}_getPageSizeLabel(e){if(!e)return;const t=this.viewModel.getLayoutTemplateInfo(e);if(!t)return;const i=ei.fromJSON(t.pageUnits.toLowerCase());return"".concat((0,Bt.uf)(t.pageSize[0])," x ").concat((0,Bt.uf)(t.pageSize[1])," ").concat((0,s.Qv)(this.messagesUnits,i,"abbr"))}_getTemplateLabel(){var e,t,i,o,a;const{messages:n,includeDefaultTemplates:l,templateOptions:r,viewModel:s}=this,{layout:u}=r,c=u?null!==(e=l?s.defaultTemplates.find((e=>{let{layoutItem:t,layout:i}=e;return u===(null===t||void 0===t?void 0:t.id)||u===i})):null)&&void 0!==e?e:s.browseTemplates.find((e=>{let{layoutItem:t}=e;return u===(null===t||void 0===t?void 0:t.id)})):null;return null!==(t=null!==(i=null!==(o=null===c||void 0===c||null===(a=c.label)||void 0===a?void 0:a.replaceAll("_"," "))&&void 0!==o?o:n[u])&&void 0!==i?i:null===u||void 0===u?void 0:u.replaceAll("_"," "))&&void 0!==t?t:n.selectTemplate}_renderChooseTemplateFlowItem(){var e,t,i,o,a,n;if(!this._showTemplates)return null;const{includeDefaultTemplates:l,messages:r,viewModel:s}=this,{defaultTemplates:u,templatesInfo:c,browseTemplates:d,portalTemplateIds:m}=s,h=p.HR.test(null===(e=this.portal)||void 0===e?void 0:e.url),y=d.length?d.toArray().sort(((e,t)=>{var i,o;return(null!==(i=e.label)&&void 0!==i?i:"")>(null!==(o=t.label)&&void 0!==o?o:"")?1:-1})).map(((e,t)=>{var i,o,a,n,l,u;const c=null!==(i=null===(o=e.layoutItem)||void 0===o?void 0:o.id)&&void 0!==i?i:e.layout,d=this._getPageSizeLabel(c),p=c===this.templateOptions.layout;return(0,xt.u)("calcite-list-item",{description:d,key:"browse-template-".concat(t),label:null!==(a=null===e||void 0===e||null===(n=e.label)||void 0===n?void 0:n.replaceAll("_"," "))&&void 0!==a?a:r.untitled,selected:p,title:null!==(l=e.description)&&void 0!==l?l:"",value:c},!d&&p&&null!==(u=e.layoutItem)&&void 0!==u&&u.id?(0,xt.u)("calcite-loader",{inline:!0,key:"browse-template-loader-".concat(t),label:"loading",scale:"s",slot:"content-end"}):null,(0,xt.u)("calcite-action",{icon:"trash",onclick:()=>s.removePortalTemplate(e),slot:"actions-end",text:"delete"}))})):null,v=u.length&&l?u.toArray().filter((e=>{let{label:t,layoutItem:i}=e;return!Xt(t)&&m.includes(null===i||void 0===i?void 0:i.id)})).map(((e,t)=>{var i,o,a,n,l,s;const u=null!==(i=null===(o=e.layoutItem)||void 0===o?void 0:o.id)&&void 0!==i?i:e.layout,c=this._getPageSizeLabel(u),d=u===this.templateOptions.layout;return(0,xt.u)("calcite-list-item",{description:c,key:"portal-template-".concat(u,"-").concat(d),label:null!==(a=null===e||void 0===e||null===(n=e.label)||void 0===n?void 0:n.replaceAll("_"," "))&&void 0!==a?a:r.untitled,selected:d,title:null!==(l=e.description)&&void 0!==l?l:"",value:u},!c&&d&&null!==(s=e.layoutItem)&&void 0!==s&&s.id?(0,xt.u)("calcite-loader",{inline:!0,key:"portal-template-loader-".concat(t),label:"loading",scale:"s",slot:"content-end"}):null)})):null,f=u.length&&l?u.toArray().filter((e=>{let{label:t,layoutItem:i}=e;return!Xt(t)&&!m.includes(null===i||void 0===i?void 0:i.id)})).sort(((e,t)=>{var i,o;return(null!==(i=e.label)&&void 0!==i?i:"")>(null!==(o=t.label)&&void 0!==o?o:"")?1:-1})).map(((e,t)=>{var i,o,a,n,l,s;const u=null!==(i=null===(o=e.layoutItem)||void 0===o?void 0:o.id)&&void 0!==i?i:e.layout,c=this._getPageSizeLabel(u),d=u===this.templateOptions.layout;return(0,xt.u)("calcite-list-item",{description:c,key:"default-template-".concat(t),label:null!==(a=null===e||void 0===e||null===(n=e.label)||void 0===n?void 0:n.replaceAll("_"," "))&&void 0!==a?a:r.untitled,selected:d,title:null!==(l=e.description)&&void 0!==l?l:"",value:u},!c&&d&&null!==(s=e.layoutItem)&&void 0!==s&&s.id?(0,xt.u)("calcite-loader",{inline:!0,key:"default-template-loader-".concat(t),label:"loading",scale:"s",slot:"content-end"}):null)})):null,b=null===c||void 0===c||null===(t=c.layout)||void 0===t||!t.choiceList.length||l&&null!==f&&void 0!==f&&f.length?null:c.layout.choiceList.map((e=>{var t;return{label:null!==(t=r[e])&&void 0!==t?t:e.replaceAll("_"," "),value:e}})).sort(((e,t)=>e.label>t.label?1:0)).map(((e,t)=>{let{label:i,value:o}=e;return(0,xt.u)("calcite-list-item",{description:this._getPageSizeLabel(o),key:"service-template-".concat(t),label:i,selected:o===this.templateOptions.layout,value:o})})),g=(null!==(i=null===y||void 0===y?void 0:y.length)&&void 0!==i?i:0)+(null!==(o=null===v||void 0===v?void 0:v.length)&&void 0!==o?o:0)+(null!==(a=null===f||void 0===f?void 0:f.length)&&void 0!==a?a:0)+(null!==(n=null===b||void 0===b?void 0:b.length)&&void 0!==n?n:0)>15;return(0,xt.u)("calcite-flow-item",{bind:this,closable:!1,heading:r.chooseTemplate,key:"template-flow-item",onCalciteFlowItemBack:e=>{e.preventDefault(),this._showTemplates=!1}},(0,xt.u)("div",{class:Yt.templateSelectFlowItemContainer},(0,xt.u)("div",{class:Yt.templateSelectFlowItemContent},this.browseTemplateButtonOnClick?(0,xt.u)("calcite-button",{appearance:"outline",class:Yt.browseTemplateButtonContainer,key:"browse-template-button",onclick:this.browseTemplateButtonOnClick},"Browse Templates"):null,(0,xt.u)("calcite-list",{filterEnabled:g,key:"template-list",selectionMode:"single-persist",onCalciteListChange:e=>{let{target:t}=e;return this._applyTemplate(t.selectedItems[0].value)}},null!==y&&void 0!==y&&y.length?(0,xt.u)("div",{key:"my-templates"},(0,xt.u)("div",{class:Yt.templateSelectFlowItemListHeading},r.myTemplates,(0,xt.u)("calcite-chip",{appearance:"outline",kind:"neutral",scale:"s",value:r.beta},r.beta)),y):null,null!==v&&void 0!==v&&v.length?(0,xt.u)("div",{key:"org-templates"},(0,xt.u)("div",{class:Yt.templateSelectFlowItemListHeading},r.organizationTemplates,h?(0,xt.u)("calcite-chip",{appearance:"outline",kind:"neutral",scale:"s",value:r.beta},r.beta):null),v):null,null!==y&&void 0!==y&&y.length||null!==v&&void 0!==v&&v.length?null!==f&&void 0!==f&&f.length?(0,xt.u)("div",{key:"default-templates"},(0,xt.u)("div",{class:Yt.templateSelectFlowItemListHeading},r.defaultTemplates),f):null:f,null!==y&&void 0!==y&&y.length||null!==v&&void 0!==v&&v.length?null!==b&&void 0!==b&&b.length?(0,xt.u)("div",{key:"service-templates"},(0,xt.u)("div",{class:Yt.templateSelectFlowItemListHeading},r.defaultTemplates),b):null:b)),(0,xt.u)("div",{class:Yt.templateButtonContainer},(0,xt.u)("calcite-button",{class:Yt.templateDoneButton,onclick:()=>this._showTemplates=!1},this.messagesCommon.done))))}_renderCustomTextElementSection(){const{customTextElements:e}=this.templateOptions;return e?(0,xt.u)("div",{class:Yt.formSectionContainer,key:"custom-text-elements"},e.map(((e,t)=>{const[i,o]=Object.entries(e)[0];return"date"===i?null:(0,xt.u)("calcite-label",{key:"custom-text-elements-".concat(i,"-").concat(t)},i,(0,xt.u)("calcite-input",{bind:this,"data-input-custom":!0,"data-input-name":i,value:null!==o&&void 0!==o?o:"",onCalciteInputInput:this._updateInputValue}))}))):null}async _applyTemplate(e){var t,i,o,a,n,r,s,u;if(this._abortController&&(this._abortController.abort(),this._abortController=null),!e)return;const c=null!==(t=this.viewModel.defaultTemplates.find((t=>{let{layoutItem:i}=t;return e===(null===i||void 0===i?void 0:i.id)})))&&void 0!==t?t:this.viewModel.browseTemplates.find((t=>{let{layoutItem:i}=t;return e===(null===i||void 0===i?void 0:i.id)}));if(!c)return this.templateOptions.layout=e,void(this.templateOptions.layoutItem=null);const{layoutItem:d}=c,p=null!==(i=c.format)&&void 0!==i?i:this.templateOptions.format,m=null!==(o=null!==(a=null===d||void 0===d?void 0:d.id)&&void 0!==a?a:c.layout)&&void 0!==o?o:this.templateOptions.layout;if(this.templateOptions.layout=m,!c.layoutOptions)try{this._abortController=new AbortController,await this.viewModel.fetchLayoutTemplateInfo(c,{signal:this._abortController.signal})}catch(h){return}finally{this._abortController=null}const y=null!==(n=null===(r=c.layoutOptions)||void 0===r?void 0:r.legend)&&void 0!==n?n:this.templateOptions.legendEnabled,v=null!==(s=null===(u=c.layoutOptions)||void 0===u?void 0:u.northArrow)&&void 0!==s?s:this.templateOptions.northArrowEnabled,f=m?this.viewModel.effectiveTemplateCustomTextElements[m]:null,b=f?(0,l.d9)(f):null;this.templateOptions.set({customTextElements:b,format:p,layout:m,layoutItem:d,legendEnabled:y,northArrowEnabled:v})}_renderTitleOrFileNameSection(){const{title:e,fileName:t,titlePlaceHolder:i,fileNamePlaceHolder:o}=this.messages,a=this._selectedTab===Zt.layout?e:t,n=this._selectedTab===Zt.layout?i:o,l=this._selectedTab===Zt.layout?this.templateOptions.title:this.templateOptions.fileName;return(0,xt.u)("div",{class:Yt.formSectionContainer,key:a},(0,xt.u)("calcite-label",null,a,(0,xt.u)("calcite-input",{placeholder:n,value:null!==l&&void 0!==l?l:"",onCalciteInputInput:this._onInput})))}_focusOnTabChange(e){if(!this._activeTabFocusRequested)return;const t=e.getAttribute("data-tab-id");("layoutTab"===t&&this._selectedTab===Zt.layout||"mapOnlyTab"===t&&this._selectedTab===Zt.mapOnly||"exportTab"===t&&this._selectedTab===Zt.export)&&(e.focus(),this._activeTabFocusRequested=!1)}_renderLoader(){const e={[Yt.loader]:this._awaitingServerResponse};return(0,xt.u)("div",{class:this.classes(e),key:"loader"})}_createFileLink(e,t){const i=t||this.messages.untitled,o=e.format.toLowerCase(),a=o.includes("png")?"png":o,n=i+a;return void 0!==this._exportedFileNameMap[n]?this._exportedFileNameMap[n]++:this._exportedFileNameMap[n]=0,new w({name:i,extension:a,count:this._exportedFileNameMap[n]})}_resetToCurrentScale(){var e;this.templateOptions.scale=null===(e=this.viewModel.view)||void 0===e?void 0:e.scale}_updateCustomTextElementValue(e,t,i){e.find((e=>{const[i]=Object.entries(e)[0];return i===t}))[t]=i}_updateInputValue(e){const t=e.target,i=t.getAttribute("data-input-name"),o=!!t["data-input-custom"],{templateOptions:a}=this;if(o)return void this._updateCustomTextElementValue(a.customTextElements,i,t.value);let n;if("number"===t.type){const e=Number(t.value);if(!function(e){return!isNaN(e)&&e>0}(e)){const e=a[i];return void(t.value="".concat(e))}n=e}else n=t.value;a[i]=n}_handleDPIChange(e){const{templateOptions:t}=this,i=t.dpi;this._updateInputValue(e);const o=t.dpi,{height:a,width:n}=function(e,t,i,o){const a=i/t,n=o/t;return{width:Math.round(e*a),height:Math.round(e*n)}}(o,i,t.width,t.height);t.height=a,t.width=n}_handlePrintMap(){var e;this._pendingExportScroll=!0;const{templateOptions:t}=this,i=this.viewModel.toPrintTemplate(t),o=this._selectedTab===Zt.layout?null===(e=i.layoutOptions)||void 0===e?void 0:e.titleText:t.fileName,a=this._createFileLink(i,o);this.exportedLinks.add(a),this.emit("submit",{link:a}),this._selectedTab=Zt.export,this.viewModel.print(i).then((e=>{a.set({url:e&&e.url,state:"ready"})})).catch((e=>{a.set({error:e,state:"error"})})).then((()=>{this.emit("complete",{link:a}),this.scheduleRender()}))}_switchInput(){[this.templateOptions.width,this.templateOptions.height]=[this.templateOptions.height,this.templateOptions.width]}_scrollExportIntoView(){if(!this._pendingExportScroll)return;this._pendingExportScroll=!1;const e=this._rootNode;if(!e)return;const{clientHeight:t,scrollHeight:i}=e,o=i-t;o>0&&(e.scrollTop=o)}_toggleInputValue(e){const t=e.target,i=t.getAttribute("data-option-name");this.templateOptions[i]=t.checked,"scaleEnabled"===i&&this._resetToCurrentScale()}_renderExportedLink(e){const t=this.messages,i=e.map((e=>{var i;const{error:o,url:a,state:n}=e,l=null!==(i=e.formattedName)&&void 0!==i?i:"",r="error"===n,s="pending"===n,c="ready"===n;let d=a||null;d&&(d=(0,u.qg)(d));const p=(0,u.D6)(a,location.href);let m;m=s?t.pending:c?t.ready:t.errorMessage;const h=r?"print-task:cim-symbol-unsupported"===(null===o||void 0===o?void 0:o.name)?t.exportWebMapCIMError:t.exportWebMapError:"";return(0,xt.u)("calcite-list-item",{"aria-label":m,class:Yt.exportedFile,"data-item":e,description:s?t.generatingExport:h||(p?t.ready:t.linkReady),key:l,label:l,title:h,onCalciteListItemSelect:this._handleLinkClick},s?(0,xt.u)("calcite-loader",{class:Yt.exportedFileLoader,inline:!0,key:"".concat(l,"-loader"),label:t.generatingExport,scale:"m",slot:"content-start"}):(0,xt.u)("calcite-icon",{icon:Qt(e),key:"".concat(l,"-start-icon"),scale:"s",slot:"content-start"}),c?(0,xt.u)("calcite-icon",{"aria-label":"".concat(l,". ").concat(t.linkReady),icon:p?"download-to":"launch",key:"".concat(l,"-end-icon"),scale:"s",slot:"content-end"}):null,s?null:(0,xt.u)("calcite-action",{"aria-label":"".concat(h),"data-item":e,icon:"x",key:"".concat(l,"-action"),onclick:this._removeLink,slot:"actions-end",text:"".concat(h)}))}));return(0,xt.u)("calcite-list",{filterEnabled:(null===e||void 0===e?void 0:e.length)>10},i)}_toggleLayoutPanel(e){const t=e.target;this._toggleTab(t.getAttribute("data-tab-id"))}_toggleTab(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this._selectedTab=e,this._selectedTab===Zt.mapOnly)this.templateOptions.layout=Wt,this.templateOptions.layoutItem=null,this.templateOptions.customTextElements=null;else if(this._selectedTab===Zt.layout){var i,o;const e=null!==(i=this._selectedLayout)&&void 0!==i?i:this.includeDefaultTemplates&&this.viewModel.defaultTemplates.length?null:null===(o=this.viewModel.templatesInfo)||void 0===o||null===(o=o.layout)||void 0===o?void 0:o.defaultValue;e?this._applyTemplate(e):(this.templateOptions.layout=null,this.templateOptions.layoutItem=null,this.templateOptions.customTextElements=null)}t&&(this._activeTabFocusRequested=!0)}_handleLayoutPanelKeyDown(e){const{key:t}=e,i=e.target.getAttribute("data-tab-id");if((0,It.pf)(t))return this._toggleTab(i),e.preventDefault(),void e.stopPropagation();if("ArrowLeft"===t||"ArrowRight"===t){switch(i){case Zt.layout:this._toggleTab("ArrowLeft"===t?Zt.export:Zt.mapOnly);break;case Zt.mapOnly:this._toggleTab("ArrowLeft"===t?Zt.layout:Zt.export);break;case Zt.export:this._toggleTab("ArrowLeft"===t?Zt.mapOnly:Zt.layout)}e.preventDefault(),e.stopPropagation()}}};(0,o._)([(0,c.Cb)()],ti.prototype,"_showTemplates",void 0),(0,o._)([(0,c.Cb)()],ti.prototype,"allowedFormats",null),(0,o._)([(0,c.Cb)()],ti.prototype,"allowedLayouts",null),(0,o._)([(0,c.Cb)()],ti.prototype,"browseTemplateButtonOnClick",void 0),(0,o._)([(0,c.Cb)()],ti.prototype,"error",null),(0,o._)([(0,c.Cb)({type:Ht})],ti.prototype,"exportedLinks",void 0),(0,o._)([(0,c.Cb)()],ti.prototype,"extraParameters",null),(0,o._)([(0,c.Cb)()],ti.prototype,"headingLevel",void 0),(0,o._)([(0,c.Cb)()],ti.prototype,"icon",null),(0,o._)([(0,c.Cb)()],ti.prototype,"includeDefaultTemplates",null),(0,o._)([(0,c.Cb)()],ti.prototype,"label",null),(0,o._)([(0,c.Cb)(),(0,qt.H)("esri/widgets/Print/t9n/Print")],ti.prototype,"messages",void 0),(0,o._)([(0,c.Cb)(),(0,qt.H)("esri/t9n/common")],ti.prototype,"messagesCommon",void 0),(0,o._)([(0,c.Cb)(),(0,qt.H)("esri/core/t9n/Units")],ti.prototype,"messagesUnits",void 0),(0,o._)([(0,c.Cb)()],ti.prototype,"portal",null),(0,o._)([(0,c.Cb)()],ti.prototype,"showPrintAreaEnabled",null),(0,o._)([(0,c.Cb)()],ti.prototype,"printServiceUrl",null),(0,o._)([(0,c.Cb)()],ti.prototype,"templateCustomTextElements",null),(0,o._)([(0,c.Cb)()],ti.prototype,"templateOptions",null),(0,o._)([(0,c.Cb)()],ti.prototype,"view",null),(0,o._)([(0,c.Cb)({type:Rt})],ti.prototype,"viewModel",void 0),ti=(0,o._)([(0,d.j)("esri.widgets.Print")],ti);const ii=ti}}]);
//# sourceMappingURL=66244.84cfa63b.chunk.js.map