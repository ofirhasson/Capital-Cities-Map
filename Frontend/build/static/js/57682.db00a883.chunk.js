"use strict";(self.webpackChunknorthwind=self.webpackChunknorthwind||[]).push([[57682,45739],{50863:(t,e,i)=>{i.d(e,{h:()=>n});var r=i(45739);function n(t,e,i){if(null==(null===t||void 0===t?void 0:t.timeInfo))return null;const{datesInUnknownTimezone:n=!1,timeOffset:s,useViewTime:a}=t;let o=t.timeExtent;n&&(o=(0,r.Jb)(o));let l=a?e&&o?e.intersection(o):e||o:o;return!l||l.isEmpty||l.isAllTime?l:(s&&(l=l.offset(-s.value,s.unit)),n&&(l=(0,r.b3)(l)),l.equals(i)?i:l)}},83217:(t,e,i)=>{i.d(e,{x:()=>r});const r=Symbol("WebScene")},45739:(t,e,i)=>{i.d(e,{getTimeSliderSettingsFromWebDocument:()=>c,Jb:()=>g,b3:()=>m});var r=i(62044),n=i(63780),s=(i(44927),i(84652)),a=(i(32718),i(86710)),o=i(38675),l=i(83217);function h(t){return void 0!==t.timeInfo}async function d(t,e){var i,s;return null!==(i=null===(s=t.widgets)||void 0===s||null===(s=s.timeSlider)||void 0===s?void 0:s.fullTimeExtent)&&void 0!==i?i:async function(t,e){if(0===t.length)return r.Z.allTime;await Promise.all(t.map((t=>t.load({signal:e}))));const i=t.filter(h),s=t.filter((t=>!h(t)&&null!=t.visibilityTimeExtent));if(0===i.length&&0===s.length)return r.Z.allTime;const a=[],o=[];for(const r of i){var l;"feature"!==(null===r||void 0===r?void 0:r.type)&&"map-image"!==(null===r||void 0===r?void 0:r.type)||null===(l=r.timeInfo)||void 0===l||!l.hasLiveData?o.push(r):a.push(r)}const d=t=>null==t||t.isAllTime,u=[...o.map((t=>{var e,i;const r=null===(e=t.timeInfo)||void 0===e?void 0:e.fullTimeExtent,{visibilityTimeExtent:n}=t;return null!==(i=null===r||void 0===r?void 0:r.intersection(n))&&void 0!==i?i:n})),...s.map((t=>t.visibilityTimeExtent))];if(u.some(d))return r.Z.allTime;const p=a.map((async t=>{var i,r,n,s;const a=null!==(i=null===(r=await t.fetchRecomputedExtents({signal:e}))||void 0===r?void 0:r.timeExtent)&&void 0!==i?i:null===(n=t.timeInfo)||void 0===n?void 0:n.fullTimeExtent,{visibilityTimeExtent:o}=t;return null!==(s=null===a||void 0===a?void 0:a.intersection(o))&&void 0!==s?s:o})),c=(await Promise.allSettled(p)).map((t=>"fulfilled"===t.status?t.value:null));if(c.some(d))return r.Z.allTime;const m=[...c,...u].filter(n.pC);return 0===m.length?r.Z.allTime:m.reduce(((t,e)=>t.union(e)))}(t.allLayers,e)}function u(t){const{numStops:e,stopInterval:i,stops:r}=t;return r?{dates:(0,s.d9)(r)}:i?{interval:i.clone()}:{count:null!==e&&void 0!==e?e:5}}function p(t,e){var i;const n=t.currentTimeExtent;if(!n)return null;const{start:s,end:a}=n,o=null!==(i=null!==s&&void 0!==s?s:a)&&void 0!==i?i:null;switch(e){case"time-window":return new r.Z({start:s,end:a});case"cumulative-from-start":return new r.Z({start:null,end:o});case"cumulative-from-end":return new r.Z({start:o,end:null});case"instant":return new r.Z({start:o,end:o})}}async function c(t,e){var i,r;if(!(0,o.s)(t)&&!function(t){return null!=t&&"object"==typeof t&&l.x in t}(t))return null;await t.load({signal:e});const n=null===t||void 0===t||null===(i=t.widgets)||void 0===i?void 0:i.timeSlider;if(!n)return null;const s=await d(t,e),a=n.loop,h=function(t){var e;const i=null!==(e=t.numThumbs)&&void 0!==e?e:2,r=t.currentTimeExtent;if(r){const{start:t,end:e}=r;return null!=t&&null!=e&&t.getTime()===e.getTime()?"instant":2===i?"time-window":null==t||0===t.getTime()?"cumulative-from-start":"cumulative-from-end"}return 2===i?"time-window":"cumulative-from-start"}(n);return{fullTimeExtent:s,loop:a,mode:h,playRate:null!==(r=n.stopDelay)&&void 0!==r?r:2e3,stops:u(n),timeExtent:p(n,h)}}function m(t){if(!t)return t;const{start:e,end:i}=t;return new r.Z({start:null!=e?(0,a.Nm)(e,-e.getTimezoneOffset(),"minutes"):e,end:null!=i?(0,a.Nm)(i,-i.getTimezoneOffset(),"minutes"):i})}function g(t){if(!t)return t;const{start:e,end:i}=t;return new r.Z({start:null!=e?(0,a.Nm)(e,e.getTimezoneOffset(),"minutes"):e,end:null!=i?(0,a.Nm)(i,i.getTimezoneOffset(),"minutes"):i})}},90110:(t,e,i)=>{i.d(e,{c:()=>a});var r=i(34702),n=i(80613),s=i(64510);class a extends s.Z{constructor(){super(...arguments),this._hasCrossfade=!1}get requiresDedicatedFBO(){return super.requiresDedicatedFBO||this._hasCrossfade}beforeRender(t){super.beforeRender(t),this._manageFade()}prepareRenderPasses(t){const e=t.registerRenderPass({name:"bitmap",brushes:[r.U.bitmap],target:()=>this.children,drawPhase:n.jx.MAP});return[...super.prepareRenderPasses(t),e]}_manageFade(){this.children.reduce(((t,e)=>t+(e.inFadeTransition?1:0)),0)>=2?(this.children.forEach((t=>t.blendFunction="additive")),this._hasCrossfade=!0):(this.children.forEach((t=>t.blendFunction="standard")),this._hasCrossfade=!1)}}},57682:(t,e,i)=>{i.r(e),i.d(e,{default:()=>w});var r=i(27366),n=i(32718),s=i(66978),a=i(94172),o=i(49861),l=(i(93169),i(84936),i(69912)),h=i(78983),d=i(90110),u=i(65457),p=i(85992),c=i(83978),m=i(9229),g=i(67581),f=i(21881),v=i(13107),y=i(32645),_=i(45008);let x=class extends((0,f.Z)((0,v.Z)((0,u.y)(g.Z)))){constructor(){super(...arguments),this._highlightGraphics=new h.J,this._updateHash=""}fetchPopupFeaturesAtLocation(t,e){return this._popupHighlightHelper.fetchPopupFeaturesAtLocation(t,e)}update(t){const e="".concat(this.exportImageVersion,"/").concat(t.state.id,"/").concat(t.pixelRatio,"/").concat(t.stationary);this._updateHash!==e&&(this._updateHash=e,this.strategy.update(t).catch((t=>{(0,s.D_)(t)||n.Z.getLogger(this).error(t)})),t.stationary&&this._popupHighlightHelper.updateHighlightedFeatures(t.state.resolution)),this._highlightView.processUpdate(t)}attach(){const{imageMaxWidth:t,imageMaxHeight:e,version:i}=this.layer,r=i>=10.3,n=i>=10;this._bitmapContainer=new d.c,this.container.addChild(this._bitmapContainer),this._highlightView=new p.Z({view:this.view,graphics:this._highlightGraphics,requestUpdateCallback:()=>this.requestUpdate(),container:new c.Z(this.view.featuresTilingScheme),defaultPointSymbolEnabled:!1}),this.container.addChild(this._highlightView.container),this._popupHighlightHelper=new y.VF({createFetchPopupFeaturesQueryGeometry:(t,e)=>(0,_.K)(t,e,this.view),highlightGraphics:this._highlightGraphics,highlightGraphicUpdated:(t,e)=>{this._highlightView.graphicUpdateHandler({graphic:t,property:e})},layerView:this,updatingHandles:this._updatingHandles}),this.strategy=new m.Z({container:this._bitmapContainer,fetchSource:this.fetchImageBitmap.bind(this),requestUpdate:this.requestUpdate.bind(this),imageMaxWidth:t,imageMaxHeight:e,imageRotationSupported:r,imageNormalizationSupported:n,hidpi:!0}),this.addAttachHandles((0,a.watch)((()=>this.exportImageVersion),(()=>this.requestUpdate()))),this.requestUpdate()}detach(){this.strategy.destroy(),this.container.removeAllChildren(),this._bitmapContainer.removeAllChildren(),this._highlightView.destroy(),this._popupHighlightHelper.destroy()}viewChange(){}moveEnd(){this.requestUpdate()}supportsSpatialReference(t){return this.layer.serviceSupportsSpatialReference(t)}async doRefresh(){this._updateHash="",this.requestUpdate()}isUpdating(){return this.strategy.updating||this.updateRequested}fetchImage(t,e,i,r){return this.layer.fetchImage(t,e,i,{timeExtent:this.timeExtent,floors:this.floors,...r})}fetchImageBitmap(t,e,i,r){return this.layer.fetchImageBitmap(t,e,i,{timeExtent:this.timeExtent,floors:this.floors,...r})}highlight(t){return this._popupHighlightHelper.highlight(t)}};(0,r._)([(0,o.Cb)()],x.prototype,"strategy",void 0),(0,r._)([(0,o.Cb)()],x.prototype,"updating",void 0),x=(0,r._)([(0,l.j)("esri.views.2d.layers.MapImageLayerView2D")],x);const w=x},83978:(t,e,i)=>{i.d(e,{Z:()=>h});var r=i(27366),n=(i(32718),i(93169),i(84936),i(10064),i(69912)),s=i(80613),a=i(39444),o=i(39594);let l=class extends a.K{get hasHighlight(){return this.children.some((t=>t.hasData))}renderChildren(t){this.attributeView.update(),t.drawPhase===s.jx.HIGHLIGHT&&this.children.some((t=>t.hasData))&&(super.renderChildren(t),t.context.setColorMask(!0,!0,!0,!0),(0,o.P9)(t,!0,(t=>{this._renderChildren(t,s.Xq.All)})))}};l=(0,r._)([(0,n.j)("esri.views.2d.layers.graphics.HighlightGraphicContainer")],l);const h=l},9229:(t,e,i)=>{i.d(e,{Z:()=>S});var r=i(27366),n=i(7138),s=(i(93169),i(66978)),a=i(49861),o=(i(32718),i(84936),i(69912)),l=i(65156),h=i(92975),d=i(22824);const u=Math.PI/180;function p(t){return t*u}function c(t,e){const i=p(e.rotation),r=Math.abs(Math.cos(i)),n=Math.abs(Math.sin(i)),[s,a]=e.size;return t[0]=Math.round(a*n+s*r),t[1]=Math.round(a*r+s*n),t}var m=i(45956),g=i(37995),f=i(73828);const v=(0,l.Ue)(),y=[0,0],_=new f.Z(0,0,0,0),x=2048,w=2048,b=!1,C=!1,E=!1;let P=class extends n.default{constructor(t){super(t),this._imagePromise=null,this.bitmaps=[],this.hidpi=E,this.imageMaxWidth=x,this.imageMaxHeight=w,this.imageRotationSupported=b,this.imageNormalizationSupported=C,this.update=(0,s.Ds)((async(t,e)=>{var i,r;if((0,s.k_)(e),!t.stationary||this.destroyed)return;const n=t.state,a=(0,h.C5)(n.spatialReference),o=this.hidpi?t.pixelRatio:1,l=n.worldScreenWidth>0,d=l&&this.imageNormalizationSupported&&n.worldScreenWidth<n.size[0],u=Math.round((null!==(i=this.imageMaxWidth)&&void 0!==i?i:0)/o),p=Math.round((null!==(r=this.imageMaxHeight)&&void 0!==r?r:0)/o);d?(y[0]=n.worldScreenWidth,y[1]=n.size[1]):this.imageRotationSupported?(y[0]=n.size[0],y[1]=n.size[1]):c(y,n);const m=Math.floor(y[0])>u||Math.floor(y[1])>p,g=a&&(n.extent.xmin<a.valid[0]||n.extent.xmax>a.valid[1]),f=!this.imageNormalizationSupported&&g,v=!m&&!f,_=this.imageRotationSupported?n.rotation:0,x=this.container.children.slice();if(v){const t=d?n.paddedViewState.center:n.center;this._imagePromise=this._singleExport(n,y,t,n.resolution,_,o,e)}else{let t=Math.min(u,p);l&&(t=Math.min(n.worldScreenWidth,t),t=Math.round(n.worldScreenWidth/Math.ceil(n.worldScreenWidth/t))),this._imagePromise=this._tiledExport(n,t,o,e)}try{var w;const t=null!==(w=await this._imagePromise)&&void 0!==w?w:[];(0,s.k_)(e);const i=[];if(this._imagePromise=null,this.destroyed)return;this.bitmaps=t;for(const e of x)t.includes(e)||i.push(e.fadeOut().then((()=>{e.remove(),e.destroy()})));for(const e of t)i.push(e.fadeIn());await Promise.all(i)}catch(b){this._imagePromise=null,(0,s.r9)(b)}}),5e3),this.updateExports=(0,s.Ds)((async t=>{const e=[];for(const i of this.container.children){if(!i.visible||!i.stage)return;e.push(t(i).then((()=>{i.invalidateTexture(),i.requestRender()})))}this._imagePromise=(0,s.as)(e).then((()=>this._imagePromise=null)),await this._imagePromise}))}destroy(){this.bitmaps.forEach((t=>t.destroy())),this.bitmaps=[]}get updating(){return!this.destroyed&&null!==this._imagePromise}async _export(t,e,i,r,n,a){const o=await this.fetchSource(t,Math.floor(e*n),Math.floor(i*n),{rotation:r,pixelRatio:n,signal:a});(0,s.k_)(a);const l=new m.eY(null,!0);return l.x=t.xmin,l.y=t.ymax,l.resolution=t.width/e,l.rotation=r,l.pixelRatio=n,l.opacity=0,this.container.addChild(l),await l.setSourceAsync(o,a),(0,s.k_)(a),l}async _singleExport(t,e,i,r,n,s,a){!function(t,e,i,r){const[n,s]=e,[a,o]=r,l=.5*i;t[0]=n-l*a,t[1]=s-l*o,t[2]=n+l*a,t[3]=s+l*o}(v,i,r,e);const o=(0,l.HH)(v,t.spatialReference);return[await this._export(o,e[0],e[1],n,s,a)]}_tiledExport(t,e,i,r){const n=d.Z.create({size:e,spatialReference:t.spatialReference,scales:[t.scale]}),s=new g.Z(n),a=s.getTileCoverage(t);if(!a)return null;const o=[];return a.forEach(((n,a,h,d)=>{_.set(n,a,h,0),s.getTileBounds(v,_);const u=(0,l.HH)(v,t.spatialReference);o.push(this._export(u,e,e,0,i,r).then((t=>(0!==d&&(_.set(n,a,h,d),s.getTileBounds(v,_),t.x=v[0],t.y=v[3]),t))))})),Promise.all(o)}};(0,r._)([(0,a.Cb)()],P.prototype,"_imagePromise",void 0),(0,r._)([(0,a.Cb)()],P.prototype,"bitmaps",void 0),(0,r._)([(0,a.Cb)()],P.prototype,"container",void 0),(0,r._)([(0,a.Cb)()],P.prototype,"fetchSource",void 0),(0,r._)([(0,a.Cb)()],P.prototype,"hidpi",void 0),(0,r._)([(0,a.Cb)()],P.prototype,"imageMaxWidth",void 0),(0,r._)([(0,a.Cb)()],P.prototype,"imageMaxHeight",void 0),(0,r._)([(0,a.Cb)()],P.prototype,"imageRotationSupported",void 0),(0,r._)([(0,a.Cb)()],P.prototype,"imageNormalizationSupported",void 0),(0,r._)([(0,a.Cb)()],P.prototype,"requestUpdate",void 0),(0,r._)([(0,a.Cb)()],P.prototype,"updating",null),P=(0,r._)([(0,o.j)("esri.views.2d.layers.support.ExportStrategy")],P);const S=P},21881:(t,e,i)=>{i.d(e,{Z:()=>l});var r=i(27366),n=i(49861),s=(i(93169),i(32718),i(84936),i(69912)),a=i(44041),o=i(50863);const l=t=>{let e=class extends t{initialize(){this.exportImageParameters=new a.R({layer:this.layer})}destroy(){this.exportImageParameters.destroy(),this.exportImageParameters=null}get floors(){var t,e;return null!==(t=null===(e=this.view)||void 0===e?void 0:e.floors)&&void 0!==t?t:null}get exportImageVersion(){var t;return null!==(t=this.exportImageParameters)&&void 0!==t&&t.commitProperty("version"),this.commitProperty("timeExtent"),this.commitProperty("floors"),(this._get("exportImageVersion")||0)+1}get timeExtent(){var t;return(0,o.h)(this.layer,null===(t=this.view)||void 0===t?void 0:t.timeExtent,this._get("timeExtent"))}canResume(){var t;return!!super.canResume()&&!(null!==(t=this.timeExtent)&&void 0!==t&&t.isEmpty)}};return(0,r._)([(0,n.Cb)()],e.prototype,"exportImageParameters",void 0),(0,r._)([(0,n.Cb)({readOnly:!0})],e.prototype,"floors",null),(0,r._)([(0,n.Cb)({readOnly:!0})],e.prototype,"exportImageVersion",null),(0,r._)([(0,n.Cb)()],e.prototype,"layer",void 0),(0,r._)([(0,n.Cb)()],e.prototype,"suspended",void 0),(0,r._)([(0,n.Cb)({readOnly:!0})],e.prototype,"timeExtent",null),e=(0,r._)([(0,s.j)("esri.views.layers.MapImageLayerView")],e),e}},13107:(t,e,i)=>{i.d(e,{Z:()=>l});var r=i(27366),n=i(32718),s=i(66978),a=i(94172),o=(i(93169),i(84936),i(10064),i(69912));const l=t=>{let e=class extends t{initialize(){this.addHandles((0,a.on)((()=>this.layer),"refresh",(t=>{this.doRefresh(t.dataChanged).catch((t=>{(0,s.D_)(t)||n.Z.getLogger(this).error(t)}))})),"RefreshableLayerView")}};return e=(0,r._)([(0,o.j)("esri.views.layers.RefreshableLayerView")],e),e}}}]);
//# sourceMappingURL=57682.db00a883.chunk.js.map