"use strict";(self.webpackChunknorthwind=self.webpackChunknorthwind||[]).push([[95643,45276],{96669:(e,t,i)=>{function n(e,t){return t?"xoffset"in t&&t.xoffset?Math.max(e,Math.abs(t.xoffset)):"yoffset"in t&&t.yoffset?Math.max(e,Math.abs(t.yoffset||0)):e:e}function r(e,t){var i;return"number"==typeof e?e:null!==e&&void 0!==e&&null!==(i=e.stops)&&void 0!==i&&i.length?function(e){let t=0,i=0;for(let n=0;n<e.length;n++){const r=e[n].size;"number"==typeof r&&(t+=r,i++)}return t/i}(e.stops):t}function s(e,t){if(!t)return e;const i=t.filter((e=>"size"===e.type)).map((t=>{const{maxSize:i,minSize:n}=t;return(r(i,e)+r(n,e))/2}));let n=0;const s=i.length;if(0===s)return e;for(let r=0;r<s;r++)n+=i[r];const o=Math.floor(n/s);return Math.max(o,e)}function o(e){const t=null===e||void 0===e?void 0:e.renderer,i="touch"===(null===e||void 0===e?void 0:e.pointerType)?9:6;if(!t)return i;const r="visualVariables"in t?s(i,t.visualVariables):i;if("simple"===t.type)return n(r,t.symbol);if("unique-value"===t.type){var o;let e=r;return null!==(o=t.uniqueValueInfos)&&void 0!==o&&o.forEach((t=>{e=n(e,t.symbol)})),e}if("class-breaks"===t.type){let e=r;return t.classBreakInfos.forEach((t=>{e=n(e,t.symbol)})),e}return"dot-density"===t.type||t.type,r}i.d(t,{k:()=>o})},53503:(e,t,i)=>{i.r(t),i.d(t,{default:()=>A});var n=i(27366),r=(i(51508),i(91505)),s=i(84652),o=i(94172),a=i(49861),l=(i(93169),i(32718),i(69912)),c=i(93655),h=i(20008),u=i(74982),d=i(83089);class p{constructor(e,t,i,n,r){this.graphic=e,this.index=t,this.x=i,this.y=n,this.viewEvent=r,this.type="graphic-click"}}class f{constructor(e,t,i,n,r){this.graphic=e,this.index=t,this.x=i,this.y=n,this.viewEvent=r,this.type="graphic-double-click"}}class y{constructor(e,t,i,n,r,s,o,a,l,c){this.graphic=e,this.allGraphics=t,this.index=i,this.x=n,this.y=r,this.dx=s,this.dy=o,this.totalDx=a,this.totalDy=l,this.viewEvent=c,this.defaultPrevented=!1,this.type="graphic-move-start"}preventDefault(){this.defaultPrevented=!0}}class v{constructor(e,t,i,n,r,s,o,a,l,c){this.graphic=e,this.allGraphics=t,this.index=i,this.x=n,this.y=r,this.dx=s,this.dy=o,this.totalDx=a,this.totalDy=l,this.viewEvent=c,this.defaultPrevented=!1,this.type="graphic-move"}preventDefault(){this.defaultPrevented=!0}}class m{constructor(e,t,i,n,r,s,o,a,l,c){this.graphic=e,this.allGraphics=t,this.index=i,this.x=n,this.y=r,this.dx=s,this.dy=o,this.totalDx=a,this.totalDy=l,this.viewEvent=c,this.defaultPrevented=!1,this.type="graphic-move-stop"}preventDefault(){this.defaultPrevented=!0}}class g{constructor(e,t,i,n,r){this.graphic=e,this.index=t,this.x=i,this.y=n,this.viewEvent=r,this.type="graphic-pointer-over"}}class x{constructor(e,t,i,n,r){this.graphic=e,this.index=t,this.x=i,this.y=n,this.viewEvent=r,this.type="graphic-pointer-out"}}class b{constructor(e,t,i,n,r){this.graphic=e,this.index=t,this.x=i,this.y=n,this.viewEvent=r,this.type="graphic-pointer-down"}}class w{constructor(e,t,i,n,r){this.graphic=e,this.index=t,this.x=i,this.y=n,this.viewEvent=r,this.type="graphic-pointer-up"}}var _=i(1614),G=i(2346),I=i(72612),k=i(16072),T=i(14404),M=i(61459);const E="indicator-symbols";let C=class extends r.Z.EventedAccessor{constructor(e){super(e),this._activeGraphic=null,this._dragEvent=null,this._hoverGraphic=null,this._indicators=[],this._initialDragGeometry=null,this._manipulators=[],this._layerViews=null,this.type="graphic-mover",this.callbacks={onGraphicClick(){},onGraphicDoubleClick(){},onGraphicMoveStart(){},onGraphicMove(){},onGraphicMoveStop(){},onGraphicPointerOver(){},onGraphicPointerOut(){},onGraphicPointerDown(){},onGraphicPointerUp(){}},this.enableMoveAllGraphics=!1,this.graphics=[],this.indicatorsEnabled=!1,this.layer=new c.default({listMode:"hide",internal:!0,title:"GraphicMover highlight layer"}),this.view=null}initialize(){(0,d.p)(this.view,this.layer),this._highlightHelper=new u.Z({view:this.view}),this.refresh(),this.addHandles([(0,o.watch)((()=>this.graphics.length),(()=>this.refresh())),(0,o.when)((()=>{var e;return null===(e=this.view)||void 0===e?void 0:e.ready}),(()=>{this.addHandles([this.view.on("immediate-click",(e=>this._clickHandler(e)),_.f.TOOL),this.view.on("double-click",(e=>this._doubleClickHandler(e)),_.f.TOOL),this.view.on("pointer-down",(e=>this._pointerDownHandler(e)),_.f.TOOL),this.view.on("pointer-move",(e=>this._pointerMoveHandler(e)),_.f.TOOL),this.view.on("pointer-up",(e=>this._pointerUpHandler(e)),_.f.TOOL),this.view.on("drag",(e=>this._dragHandler(e)),_.f.TOOL),this.view.on("key-down",(e=>this._keyDownHandler(e)),_.f.TOOL)])}),{once:!0,initial:!0}),(0,o.watch)((()=>this.view),(e=>{this._highlightHelper.removeAll(),this._highlightHelper.view=e}))])}destroy(){var e;this._removeIndicators(),null!==(e=this.view.map)&&void 0!==e&&e.remove(this.layer),this.layer.destroy(),this.reset(),this._manipulators.forEach((e=>e.destroy())),this._manipulators=null}set highlightsEnabled(e){var t,i;null!==(t=this._highlightHelper)&&void 0!==t&&t.removeAll(),this._set("highlightsEnabled",e),e&&(null===(i=this._highlightHelper)||void 0===i||i.add(this.graphics))}get state(){const e=this.view.ready,t=this.graphics.length>0,i=this._activeGraphic;return e&&t?i?"moving":"active":e?"ready":"disabled"}refresh(){this.reset(),this._setup()}reset(){this._activeGraphic=null,this._hoverGraphic=null,this._dragEvent=null,this._highlightHelper.removeAll()}updateGeometry(e,t){const i=this.graphics[e];i&&(i.set("geometry",t),this._setUpIndicators())}_setup(){this._setUpHighlights(),this._setUpIndicators(),this._setUpManipulators(),this._syncLayerViews()}_clickHandler(e){const t=this._findTargetGraphic((0,I.vT)(e));if(t){const i=new p(t,this.graphics.indexOf(t),e.x,e.y,e);this.emit("graphic-click",i),this.callbacks.onGraphicClick&&this.callbacks.onGraphicClick(i)}}_doubleClickHandler(e){const t=this._findTargetGraphic((0,I.vT)(e));if(t){const i=new f(t,this.graphics.indexOf(t),e.x,e.y,e);this.emit("graphic-double-click",i),this.callbacks.onGraphicDoubleClick&&this.callbacks.onGraphicDoubleClick(i)}}_pointerDownHandler(e){const t=this._findTargetGraphic((0,I.vT)(e));if(t){this._activeGraphic=t;const{x:i,y:n}=e,r=new b(t,this.graphics.indexOf(t),i,n,e);this.emit("graphic-pointer-down",r),this.callbacks.onGraphicPointerDown&&this.callbacks.onGraphicPointerDown(r)}else this._activeGraphic=null}_pointerUpHandler(e){if(this._activeGraphic){const{x:t,y:i}=e,n=this.graphics.indexOf(this._activeGraphic),r=new w(this._activeGraphic,n,t,i,e);this.emit("graphic-pointer-up",r),this.callbacks.onGraphicPointerUp&&this.callbacks.onGraphicPointerUp(r)}}_pointerMoveHandler(e){if(this._dragEvent)return;const t=this._findTargetGraphic((0,I.vT)(e));if(t){const{x:i,y:n}=e;if(this._hoverGraphic){if(this._hoverGraphic===t)return;const r=this.graphics.indexOf(this._hoverGraphic),s=new x(this.graphics[r],r,i,n,e);this._hoverGraphic=null,this.emit("graphic-pointer-out",s),this.callbacks.onGraphicPointerOut&&this.callbacks.onGraphicPointerOut(s)}const r=this.graphics.indexOf(t),s=new g(t,r,i,n,e);return this._hoverGraphic=t,this.emit("graphic-pointer-over",s),void(this.callbacks.onGraphicPointerOver&&this.callbacks.onGraphicPointerOver(s))}if(this._hoverGraphic){const{x:t,y:i}=e,n=this.graphics.indexOf(this._hoverGraphic),r=new x(this.graphics[n],n,t,i,e);this._hoverGraphic=null,this.emit("graphic-pointer-out",r),this.callbacks.onGraphicPointerOut&&this.callbacks.onGraphicPointerOut(r)}}_dragHandler(e){var t;if("start"!==e.action&&!this._dragEvent||null===(t=this._activeGraphic)||void 0===t||!t.geometry)return;"start"===e.action&&this._removeIndicators(),e.stopPropagation();const{action:i,x:n,y:r}=e,o=this.graphics.indexOf(this._activeGraphic),a=this._dragEvent?n-this._dragEvent.x:0,l=this._dragEvent?r-this._dragEvent.y:0,c=n-e.origin.x,u=r-e.origin.y,d="start"===i?this._activeGraphic.geometry:this._initialDragGeometry,p=(0,h.e7)(d,c,u,this.view);if(this._activeGraphic.geometry=p,this.enableMoveAllGraphics&&this.graphics.forEach((e=>{e!==this._activeGraphic&&(e.geometry=(0,h.e7)(e.geometry,a,l,this.view))})),this._dragEvent=e,"start"===i){this._initialDragGeometry=(0,s.d9)(d);const t=new y(this._activeGraphic,this.graphics,o,n,r,a,l,c,u,e);this.emit("graphic-move-start",t),this.callbacks.onGraphicMoveStart&&this.callbacks.onGraphicMoveStart(t),t.defaultPrevented&&this._activeGraphic.set("geometry",d)}else if("update"===i){const t=new v(this._activeGraphic,this.graphics,o,n,r,a,l,c,u,e);this.emit("graphic-move",t),this.callbacks.onGraphicMove&&this.callbacks.onGraphicMove(t),t.defaultPrevented&&(this._activeGraphic.geometry=d)}else{const t=new m(this._activeGraphic,this.graphics,o,n,r,a,l,c,u,e);this._dragEvent=null,this._activeGraphic=null,this._setUpIndicators(),this.emit("graphic-move-stop",t),this.callbacks.onGraphicMoveStop&&this.callbacks.onGraphicMoveStop(t),t.defaultPrevented&&(this.graphics[o].set("geometry",this._initialDragGeometry),this._setUpIndicators()),this._initialDragGeometry=null}}_keyDownHandler(e){"a"!==e.key&&"d"!==e.key&&"n"!==e.key||"moving"!==this.state||e.stopPropagation()}_findTargetGraphic(e){const t=this.view.toMap(e),i=this.graphics;let n=null,r=Number.MAX_VALUE;this._syncLayerViews();const s=this._layerViews.flatMap((e=>"graphicsViews"in e?Array.from(e.graphicsViews(),(e=>e.hitTest(t))).flat():e.graphicsView.hitTest(t))).filter((e=>i.includes(e))).sort(((e,t)=>i.indexOf(e)-i.indexOf(t)));return s.length?s[0]:(this._manipulators.forEach((t=>{const i=t.intersectionDistance(e);null!=i&&i<r&&(r=i,n=t.graphic)})),n)}_syncLayerViews(){this._layerViews=[];const e=new Set;for(const t of this.graphics){const i=(0,d.j)(this.view,t.layer);i&&e.add(i)}this._layerViews=[...e]}_setUpManipulators(){const{graphics:e,view:t}=this;this._manipulators.forEach((e=>e.destroy())),this._manipulators=e.length?e.map((e=>new G.L({graphic:e,view:t}))):[]}_setUpHighlights(){this.highlightsEnabled&&this._highlightHelper.add(this.graphics)}_setUpIndicators(){if(this._removeIndicators(),this.indicatorsEnabled){for(const e of this.graphics){const t=e.clone();t.symbol=O(e),this._indicators.push(t),this.addHandles((0,o.watch)((()=>e.symbol),(()=>this._setUpIndicators())),E)}this.layer.addMany(this._indicators)}}_removeIndicators(){this.removeHandles(E),this._indicators.length&&(this.layer.removeMany(this._indicators),this._indicators.forEach((e=>e.destroy())),this._indicators=[])}};function O(e){if(null==e.symbol)return null;switch(e.symbol.type){case"cim":return new k.default({style:"circle",size:12,color:[0,0,0,0],outline:{color:[255,127,0,1],width:1}});case"picture-marker":{const{xoffset:t,yoffset:i,height:n,width:r}=e.symbol,s=n===r?r:Math.max(n,r);return new k.default({xoffset:t,yoffset:i,size:s,style:"square",color:[0,0,0,0],outline:{color:[255,127,0,1],width:1}})}case"simple-marker":{const{xoffset:t,yoffset:i,size:n,style:r}=e.symbol;return new k.default({xoffset:t,yoffset:i,style:"circle"===r?"circle":"square",size:n+2,color:[0,0,0,0],outline:{color:[255,127,0,1],width:1}})}case"simple-fill":return new M.default({color:[0,0,0,0],outline:{style:"dash",color:[255,127,0,1],width:1}});case"simple-line":return new T.default({color:[255,127,0,1],style:"dash",width:1});case"text":{const{xoffset:t,yoffset:i}=e.symbol;return new k.default({xoffset:t,yoffset:i,size:12,color:[0,0,0,0],outline:{color:[255,127,0,1],width:1}})}default:return null}}(0,n._)([(0,a.Cb)()],C.prototype,"_activeGraphic",void 0),(0,n._)([(0,a.Cb)({readOnly:!0})],C.prototype,"type",void 0),(0,n._)([(0,a.Cb)()],C.prototype,"callbacks",void 0),(0,n._)([(0,a.Cb)()],C.prototype,"enableMoveAllGraphics",void 0),(0,n._)([(0,a.Cb)()],C.prototype,"graphics",void 0),(0,n._)([(0,a.Cb)({value:!1})],C.prototype,"highlightsEnabled",null),(0,n._)([(0,a.Cb)()],C.prototype,"indicatorsEnabled",void 0),(0,n._)([(0,a.Cb)()],C.prototype,"layer",void 0),(0,n._)([(0,a.Cb)({readOnly:!0})],C.prototype,"state",null),(0,n._)([(0,a.Cb)()],C.prototype,"view",void 0),C=(0,n._)([(0,l.j)("esri.views.draw.support.GraphicMover")],C);const A=C},74982:(e,t,i)=>{i.d(t,{Z:()=>u});var n=i(27366),r=i(7138),s=i(49861),o=(i(93169),i(32718),i(84936),i(69912)),a=i(83089),l=i(69787),c=i(45276);let h=class extends r.default{constructor(e){super(e),this.view=null}add(e){const t=!e||Array.isArray(e)?e:[e];(null===t||void 0===t?void 0:t.length)&&t.forEach((e=>this._highlight(e)))}remove(e){const t=!e||Array.isArray(e)?e:[e];(null===t||void 0===t?void 0:t.length)&&t.forEach((e=>this._removeHighlight(e)))}removeAll(){this.removeAllHandles()}_highlight(e){const t=(0,a.j)(this.view,e.layer);(0,l.tl)(t)&&this.addHandles(t.highlight(e),(0,c.wi)(e))}_removeHighlight(e){e&&this.removeHandles((0,c.wi)(e))}};(0,n._)([(0,s.Cb)()],h.prototype,"view",void 0),h=(0,n._)([(0,o.j)("esri.views.draw.support.HighlightHelper")],h);const u=h},20008:(e,t,i)=>{i.d(t,{Ru:()=>h,bA:()=>c,cM:()=>u,e7:()=>l});var n=i(16889),r=i(65156),s=i(376),o=i(69662);function a(e,t,i,n){var r,s;if(null==n||e.hasZ||(n=void 0),"point"===e.type)return e.x+=t,e.y+=i,e.hasZ&&null!=n&&(e.z+=n),e;if("multipoint"===e.type){const r=e.points;for(let e=0;e<r.length;e++)r[e]=d(r[e],t,i,n);return e}if("extent"===e.type)return e.xmin+=t,e.xmax+=t,e.ymin+=i,e.ymax+=i,null!=n&&(null!==(r=e.zmin)&&void 0!==r||(e.zmin=0),e.zmin+=n,null!==(s=e.zmax)&&void 0!==s||(e.zmax=0),e.zmax+=n),e;const a=(0,o.nA)(e),l="polyline"===e.type?e.paths:e.rings;for(let o=0;o<a.length;o++){const e=a[o];for(let r=0;r<e.length;r++)e[r]=d(e[r],t,i,n)}return"paths"in e?e.paths=l:e.rings=l,e}function l(e,t,i,n,r){const s=e.clone(),l=n.resolution;if("point"===s.type){if(r)a(s,t*l,-i*l);else{const e=n.state.transform,r=n.state.inverseTransform,o=e[0]*s.x+e[2]*s.y+e[4],a=e[1]*s.x+e[3]*s.y+e[5];s.x=r[0]*(o+t)+r[2]*(a+i)+r[4],s.y=r[1]*(o+t)+r[3]*(a+i)+r[5]}return s}if("multipoint"===s.type){if(r)a(s,t*l,-i*l);else{const e=s.points,r=n.state.transform,o=n.state.inverseTransform;for(let n=0;n<e.length;n++){const s=e[n],a=r[0]*s[0]+r[2]*s[1]+r[4],l=r[1]*s[0]+r[3]*s[1]+r[5],c=o[0]*(a+t)+o[2]*(l+i)+o[4],h=o[1]*(a+t)+o[3]*(l+i)+o[5];e[n]=p(s,c,h,void 0)}}return s}if("extent"===s.type){if(r)a(s,t*l,-i*l);else{const e=n.state.transform,r=n.state.inverseTransform,o=e[0]*s.xmin+e[2]*s.ymin+e[4],a=e[1]*s.xmin+e[3]*s.ymin+e[5],l=e[0]*s.xmax+e[2]*s.ymax+e[4],c=e[1]*s.xmax+e[3]*s.ymax+e[5];s.xmin=r[0]*(o+t)+r[2]*(a+i)+r[4],s.ymin=r[1]*(o+t)+r[3]*(a+i)+r[5],s.xmax=r[0]*(l+t)+r[2]*(c+i)+r[4],s.ymax=r[1]*(l+t)+r[3]*(c+i)+r[5]}return s}if(r)a(s,t*l,-i*l);else{const e=(0,o.nA)(s),r="polyline"===s.type?s.paths:s.rings,a=n.state.transform,l=n.state.inverseTransform;for(let n=0;n<e.length;n++){const r=e[n];for(let e=0;e<r.length;e++){const n=r[e],s=a[0]*n[0]+a[2]*n[1]+a[4],o=a[1]*n[0]+a[3]*n[1]+a[5],c=l[0]*(s+t)+l[2]*(o+i)+l[4],h=l[1]*(s+t)+l[3]*(o+i)+l[5];r[e]=p(n,c,h,void 0)}}"paths"in s?s.paths=r:s.rings=r}return s}function c(e,t,i,n){if("point"===e.type){const{x:r,y:s}=e,o=n?n[0]:r,a=n?n[1]:s,l=e.clone(),c=(r-o)*t+o,h=(s-a)*i+a;return l.x=c,l.y=h,l}if("multipoint"===e.type){const a=(0,o.nA)(e),l=(0,r.Ue)(),[c,h,u,d]=(0,s.C6)(l,[a]),f=n?n[0]:(c+u)/2,y=n?n[1]:(d+h)/2,v=e.clone(),m=v.points;for(let e=0;e<m.length;e++){const n=m[e],[r,s]=n,o=(r-f)*t+f,a=(s-y)*i+y;m[e]=p(n,o,a,void 0)}return v}if("extent"===e.type){const{xmin:r,xmax:s,ymin:o,ymax:a}=e,l=n?n[0]:(r+s)/2,c=n?n[1]:(a+o)/2,h=e.clone();if(h.xmin=(r-l)*t+l,h.ymax=(a-c)*i+c,h.xmax=(s-l)*t+l,h.ymin=(o-c)*i+c,h.xmin>h.xmax){const e=h.xmin,t=h.xmax;h.xmin=t,h.xmax=e}if(h.ymin>h.ymax){const e=h.ymin,t=h.ymax;h.ymin=t,h.ymax=e}return h}const a=(0,o.nA)(e),l=(0,r.Ue)(),[c,h,u,d]=(0,s.C6)(l,a),f=n?n[0]:(c+u)/2,y=n?n[1]:(d+h)/2,v=e.clone(),m="polyline"===v.type?v.paths:v.rings;for(let r=0;r<a.length;r++){const e=a[r];for(let n=0;n<e.length;n++){const s=e[n],[o,a]=s,l=(o-f)*t+f,c=(a-y)*i+y;m[r][n]=p(s,l,c,void 0)}}return"paths"in v?v.paths=m:v.rings=m,v}function h(e,t,i,n,r,s){const o=Math.sqrt((i-e)*(i-e)+(n-t)*(n-t));return Math.sqrt((r-e)*(r-e)+(s-t)*(s-t))/o}function u(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const s=Math.atan2(t.y-i.y,t.x-i.x)-Math.atan2(e.y-i.y,e.x-i.x),o=Math.atan2(Math.sin(s),Math.cos(s));return r?o:(0,n.BV)(o)}function d(e,t,i,n){return p(e,e[0]+t,e[1]+i,null!=e[2]&&null!=n?e[2]+n:void 0)}function p(e,t,i,n){const r=[t,i];return e.length>2&&r.push(null!=n?n:e[2]),e.length>3&&r.push(e[3]),r}},45008:(e,t,i)=>{i.d(t,{D:()=>a,K:()=>o});i(59486);var n=i(68860),r=i(96669),s=i(53866);function o(e,t,i){var r;let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new s.Z,a=0;if("2d"===i.type)a=t*(null!==(r=i.resolution)&&void 0!==r?r:0);else if("3d"===i.type){const r=i.overlayPixelSizeInMapUnits(e),s=i.basemapSpatialReference;a=null==s||s.equals(i.spatialReference)?t*r:(0,n.c9)(s)/(0,n.c9)(i.spatialReference)}const l=e.x-a,c=e.y-a,h=e.x+a,u=e.y+a,{spatialReference:d}=i;return o.xmin=Math.min(l,h),o.ymin=Math.min(c,u),o.xmax=Math.max(l,h),o.ymax=Math.max(c,u),o.spatialReference=d,o}function a(e,t,i){const n=i.toMap(e);return null!=n&&o(n,(0,r.k)(),i,l).intersects(t)}const l=new s.Z},45276:(e,t,i)=>{i.d(t,{EB:()=>j,Hs:()=>S,JD:()=>M,K7:()=>J,M3:()=>V,Ns:()=>ie,Qu:()=>U,Rd:()=>T,S$:()=>D,T2:()=>ne,Tj:()=>R,Um:()=>Z,Xh:()=>X,_R:()=>q,ar:()=>H,iJ:()=>C,k6:()=>E,l$:()=>G,oM:()=>K,or:()=>k,qD:()=>Q,s5:()=>te,tJ:()=>N,uI:()=>B,vD:()=>I,wi:()=>oe});var n=i(32718),r=i(643),s=i(76969),o=i(6291),a=i(37270),l=i(37933),c=i(62734),h=i(819),u=i(6701);const d=()=>n.Z.getLogger("esri.widgets.Feature.support.featureUtils"),p=/href=(""|'')/gi,f=/(\{([^{\r\n]+)\})/g,y=/'/g,v=/^\s*expression\//i,m=/(\n)/gi,g=/[\u00A0-\u9999<>&]/gim,x=/href\s*=\s*(?:"([^"]+)"|'([^']+)')/gi,b=/^(?:mailto:|tel:)/,w="relationships/",_=(0,s.Ze)("short-date-short-time");function G(e){var t;if(null!=e)return null!==(t=e.sourceLayer||e.layer)&&void 0!==t?t:void 0}async function I(e){let{type:t,value:i,event:n}=e;try{return"function"==typeof i?i(n):i}catch(r){return void d().error("error",'An error occurred when calling the "'.concat(t,'" function'),{error:r,graphic:n.graphic,value:i})}}function k(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(e)return!b.test(e.trim().toLowerCase())}function T(e){return!!e&&v.test(e)}function M(e,t){const i=function(e,t){if(!t||!T(t)||!e)return;const i=t.replace(v,"").toLowerCase();return e.find((e=>{let{name:t}=e;return t.toLowerCase()===i}))}(t,null===e||void 0===e?void 0:e.fieldName);return i?i.title||null:e?e.label||e.fieldName:null}function E(e,t){const i=O(t,e);return i?i.name:e}function C(e,t){return e&&e.map((e=>E(e,t)))}function O(e,t){var i;return e&&"function"==typeof e.getField&&t&&null!==(i=e.getField(t))&&void 0!==i?i:null}function A(e){return"".concat(e).trim()}function D(e){let{attributes:t,globalAttributes:i,layer:n,text:r,expressionAttributes:s,fieldInfoMap:o}=e;return r?H({formattedAttributes:i,template:F(r,{...i,...s,...t},n),fieldInfoMap:o}):""}function H(e){let{formattedAttributes:t,template:i,fieldInfoMap:n}=e;return A(function(e){return e.replaceAll(p,"")}((0,r.gx)((0,r.gx)(i,(e=>function(e,t){const i=t.get(e.toLowerCase());return"{".concat((null===i||void 0===i?void 0:i.fieldName)||e,"}")}(e,n))),t)))}function L(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const i={...e};return Object.keys(i).forEach((e=>function(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=t[e];if("string"==typeof n){const r="%27",s=(i?encodeURIComponent(n):n).replaceAll(y,r);t[e]=s}}(e,i,t))),i}function U(e,t){return e.replaceAll(f,((e,i,n)=>{const r=O(t,n);return r?"{".concat(r.name,"}"):i}))}function F(e,t,i){const n=U(e,i);return n?n.replaceAll(x,((e,i,n)=>function(e,t,i){const n=(t=A(t))&&"{"!==t[0];return(0,r.gx)(e,L(i,n||!1))}(e,i||n,t))):n}function Z(e){return function(e){return null!=e&&"object"==typeof e&&"fieldsIndex"in e&&"geometryType"in e&&"getField"in e&&"load"in e&&"loaded"in e&&"objectIdField"in e&&"spatialReference"in e&&"type"in e&&("feature"===e.type||"scene"===e.type||"sublayer"===e.type)&&"when"in e}(e)&&function(e){return null!=e&&"object"==typeof e&&"createQuery"in e&&"queryFeatureCount"in e&&"queryObjectIds"in e&&"queryRelatedFeatures"in e&&"queryRelatedFeaturesCount"in e&&"relationships"in e}(e)}function N(e){return!!e&&"object"==typeof e&&"sourceLayer"in e&&Z(e.sourceLayer)}function P(e,t){const{fieldInfos:i,fieldName:n,preventPlacesFormatting:r,layer:s,timeZone:l}=t,h=q(i,n),u=O(s,n);if(h&&!(0,a.Ec)(n)){var d;const t=null===u||void 0===u?void 0:u.type,i=null===(d=h.format)||void 0===d?void 0:d.dateFormat;if("date"===t||"date-only"===t||"time-only"===t||"timestamp-offset"===t||i)return(0,c.$8)(e,{format:i,fieldType:t,timeZoneOptions:{layerTimeZone:s&&"preferredTimeZone"in s?s.preferredTimeZone:null,viewTimeZone:l,datesInUnknownTimezone:!(!s||!("datesInUnknownTimezone"in s))&&!!s.datesInUnknownTimezone}})}const p=null===h||void 0===h?void 0:h.format;return"string"==typeof e&&(0,a.Ec)(n)&&p?function(e,t){return e=e.trim(),/\d{2}-\d{2}/.test(e)?e:e.includes(",")?z(e,",",", ",t):e.includes(";")?z(e,";","; ",t):e.includes(" ")?z(e," "," ",t):(0,o.uf)(Number(e),(0,o.sh)(t))}(e,p):"string"==typeof(e=function(e,t){if("string"==typeof e&&t&&null==t.dateFormat&&(null!=t.places||null!=t.digitSeparator)){const t=Number(e);if(!isNaN(t))return t}return e}(e,p))||null==e||null==p?Q(e):(0,o.uf)(e,r?{...(0,o.sh)(p),minimumFractionDigits:0,maximumFractionDigits:20}:(0,o.sh)(p))}function z(e,t,i,n){return e.trim().split(t).map((e=>(0,o.uf)(Number(e),(0,o.sh)(n)))).join(i)}function q(e,t){if(null!==e&&void 0!==e&&e.length&&t)return e.find((e=>{var i;return(null===(i=e.fieldName)||void 0===i?void 0:i.toLowerCase())===t.toLowerCase()}))}function R(e,t,i,n){const{creatorField:r,creationDateField:o,editorField:a,editDateField:l}=e;if(!t)return;const c=(0,u.Np)(n&&"preferredTimeZone"in n?n.preferredTimeZone:null,!(!n||!("datesInUnknownTimezone"in n))&&!!n.datesInUnknownTimezone,i,_,"date"),h={..._,...c},d=t[l];if("number"==typeof d){const e=t[a];return{type:"edit",date:(0,s.p6)(d,h),user:e}}const p=t[o];if("number"==typeof p){const e=t[r];return{type:"create",date:(0,s.p6)(p,h),user:e}}return null}function j(e,t){const i=new Map;if(!e)return i;for(const n of e){if(!n.fieldName)continue;const e=E(n.fieldName,t);n.fieldName=e,i.set(e.toLowerCase(),n)}return i}function S(e){const t=[];if(!e)return t;const{fieldInfos:i,content:n}=e;return i&&t.push(...i),n&&Array.isArray(n)?(n.forEach((e=>{if("fields"===e.type){const i=null===e||void 0===e?void 0:e.fieldInfos;i&&t.push(...i)}})),t):t}function V(e){return e.replaceAll(g,(e=>"&#".concat(e.charCodeAt(0),";")))}function Q(e){return"string"==typeof e?e.replaceAll(m,'<br class="esri-text-new-line" />'):e}function $(e){var t;const{value:i,fieldName:n,fieldInfos:r,fieldInfoMap:s,layer:o,graphic:l,timeZone:h}=e;if(null==i)return"";const u=function(e){let{fieldName:t,value:i,graphic:n,layer:r}=e;if(K(t))return null;if(!r||"function"!=typeof r.getFieldDomain)return null;const s=n&&r.getFieldDomain(t,{feature:n});return s&&"coded-value"===s.type?s.getName(i):null}({fieldName:n,value:i,graphic:l,layer:o});if(u)return u;const d=function(e){let{fieldName:t,graphic:i,layer:n}=e;if(K(t))return null;if(!n||"function"!=typeof n.getFeatureType)return null;const{typeIdField:r}=n;if(!r||t!==r)return null;const s=n.getFeatureType(i);return s?s.name:null}({fieldName:n,graphic:l,layer:o});if(d)return d;if(s.get(n.toLowerCase()))return P(i,{fieldInfos:r||Array.from(s.values()),fieldName:n,layer:o,timeZone:h});const p=null===o||void 0===o||null===(t=o.fieldsIndex)||void 0===t?void 0:t.get(n);return p&&((0,c.a8)(p)||(0,a.sX)(p))?(0,c.$8)(i,{fieldType:p.type,timeZoneOptions:{layerTimeZone:o&&"preferredTimeZone"in o?o.preferredTimeZone:null,viewTimeZone:h,datesInUnknownTimezone:!(!o||!("datesInUnknownTimezone"in o))&&!!o.datesInUnknownTimezone}}):Q(i)}function B(e){let{fieldInfos:t,attributes:i,layer:n,graphic:r,fieldInfoMap:s,relatedInfos:o,timeZone:a}=e;const l={};return null!==o&&void 0!==o&&o.forEach((e=>function(e){var t,i;let{attributes:n,relatedInfo:r,fieldInfoMap:s,fieldInfos:o,layer:a,timeZone:l}=e;n&&r&&(null!==(t=r.relatedFeatures)&&void 0!==t&&t.forEach((e=>W({attributes:n,graphic:e,relatedInfo:r,fieldInfoMap:s,fieldInfos:o,layer:a,timeZone:l}))),null===(i=r.relatedStatsFeatures)||void 0===i||i.forEach((e=>W({attributes:n,graphic:e,relatedInfo:r,fieldInfoMap:s,fieldInfos:o,layer:a,timeZone:l}))))}({attributes:l,relatedInfo:e,fieldInfoMap:s,fieldInfos:t,layer:n,timeZone:a}))),i&&Object.keys(i).forEach((e=>{const o=i[e];l[e]=$({fieldName:e,fieldInfos:t,fieldInfoMap:s,layer:n,value:o,graphic:r,timeZone:a})})),l}async function J(e,t){var i;const{layer:n,graphic:r,outFields:s,objectIds:o,returnGeometry:a,spatialReference:c}=e,h=o[0];if("number"!=typeof h&&"string"!=typeof h){const e="Could not query required fields for the specified feature. The feature's ID is invalid.",t={layer:n,graphic:r,objectId:h,requiredFields:s};return d().warn(e,t),null}if(null===(i=(0,l.S1)(n))||void 0===i||null===(i=i.operations)||void 0===i||!i.supportsQuery){const e="The specified layer cannot be queried. The following fields will not be available.",t={layer:n,graphic:r,requiredFields:s,returnGeometry:a};return d().warn(e,t),null}const u=n.createQuery();return u.objectIds=o,u.outFields=null!==s&&void 0!==s&&s.length?s:[n.objectIdField],u.returnGeometry=!!a,u.returnZ=!!a,u.returnM=!!a,u.outSpatialReference=c,(await n.queryFeatures(u,t)).features[0]}async function X(e,t){let{graphic:i,popupTemplate:n,layer:r,spatialReference:s}=e;if(!r||!n)return;if("function"==typeof r.load&&await r.load(t),!i.attributes)return;const o=r.objectIdField,l=i.attributes[o];if(null==l)return;const c=[l],u=await n.getRequiredFields(r.fieldsIndex),d=(0,a.R9)(u,i),p=d?[]:u.includes(o)?u:[...u,o],f=n.returnGeometry||await async function(e){var t;if(null===(t=e.expressionInfos)||void 0===t||!t.length)return!1;const i=await(0,h.LC)(),{arcadeUtils:{hasGeometryFunctions:n}}=i;return n(e)}(n);if(d&&!f)return;const y=await J({layer:r,graphic:i,outFields:p,objectIds:c,returnGeometry:f,spatialReference:s},t);y&&(y.geometry&&(i.geometry=y.geometry),y.attributes&&(i.attributes={...i.attributes,...y.attributes}))}function K(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return!!e&&e.includes(w)}function W(e){let{attributes:t,graphic:i,relatedInfo:n,fieldInfos:r,fieldInfoMap:s,layer:o,timeZone:a}=e;t&&i&&n&&Object.keys(i.attributes).forEach((e=>{const l=function(e){return e?"".concat(w).concat(e.layerId,"/").concat(e.fieldName):""}({layerId:n.relation.id.toString(),fieldName:e}),c=i.attributes[e];t[l]=$({fieldName:l,fieldInfos:r,fieldInfoMap:s,layer:o,value:c,graphic:i,timeZone:a})}))}const Y=e=>{if(!e)return!1;const t=e.toUpperCase();return t.includes("CURRENT_TIMESTAMP")||t.includes("CURRENT_DATE")||t.includes("CURRENT_TIME")},ee=e=>{var t;let{layer:i,method:n,query:r,definitionExpression:s}=e;if(null===(t=i.capabilities)||void 0===t||null===(t=t.query)||void 0===t||!t.supportsCacheHint||"attachments"===n)return;const o=null!=r.where?r.where:null,a=null!=r.geometry?r.geometry:null;Y(s)||Y(o)||"extent"===(null===a||void 0===a?void 0:a.type)||"tile"===r.resultType||(r.cacheHint=!0)},te=e=>{var t;let{query:i,layer:n,method:r}=e;ee({layer:n,method:r,query:i,definitionExpression:"".concat(n.definitionExpression," ").concat(null!==(t=n.serviceDefinitionExpression)&&void 0!==t?t:"")})},ie=e=>{var t;let{queryPayload:i,layer:n,method:r}=e;ee({layer:n,method:r,query:i,definitionExpression:"".concat(n.definitionExpression," ").concat(null!==(t=n.serviceDefinitionExpression)&&void 0!==t?t:"")})};function ne(e,t,i){var n,r;return e&&t&&i?"sublayer"===t.type?se({layers:null===(n=t.layer)||void 0===n?void 0:n.sublayers,map:e,relatedLayer:t,relationship:i})||se({layers:null===(r=t.layer)||void 0===r?void 0:r.subtables,map:e,relatedLayer:t,relationship:i}):se({layers:e.allLayers,map:e,relatedLayer:t,relationship:i})||se({layers:e.allTables,map:e,relatedLayer:t,relationship:i}):null}function re(e,t){return null===e||void 0===e?void 0:e.allTables.find((e=>{var i;return"feature"===e.type&&e.layerId===t.id&&e.url===(null===(i=t.layer)||void 0===i?void 0:i.url)}))}function se(e){let{map:t,relationship:i,relationship:{relatedTableId:n},relatedLayer:r,layers:s}=e;if(!s)return null;for(const a of s){var o;if("map-image"===a.type){const e=se({layers:a.sublayers,map:t,relatedLayer:r,relationship:i})||se({layers:a.subtables,map:t,relatedLayer:r,relationship:i});if(e)return e;continue}if(!Z(a))continue;if("sublayer"===r.type){if(a!==r&&a.id===n)return a.isTable?re(t,a):a;continue}const e="scene"===r.type&&r.associatedLayer?r.associatedLayer.url:r.url;if(!e)return null;if("sublayer"!==a.type){if(a!==r&&a.url===e&&a.layerId===n)return a}else if(a!==r&&(null===(o=a.layer)||void 0===o?void 0:o.url)===e&&a.id===n)return a.isTable?re(t,a):a}return null}function oe(e){const t=e.getObjectId();return null!=t?"oid:".concat(t):"uid:".concat(e.uid)}}}]);
//# sourceMappingURL=95643.e99ac7a2.chunk.js.map