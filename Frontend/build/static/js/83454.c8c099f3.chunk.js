"use strict";(self.webpackChunknorthwind=self.webpackChunknorthwind||[]).push([[83454],{69518:(e,t,o)=>{o.d(t,{default:()=>Q});var r=o(27366),i=o(52639),n=o(49861),s=(o(93169),o(32718)),a=(o(84936),o(69912)),l=o(64326),d=o(12322),u=(o(59486),o(76200)),c=o(10064),p=o(54472),y=o(97642),v=o(66978),m=o(35995),h=o(53866),b=o(77981),w=o(56601),g=o(25899),f=o(43404),C=o(27135),T=o(64267);const I=(0,f.w)()({Pending:"job-waiting",InProgress:"job-executing",Completed:"job-succeeded"});let S=class extends T.Z{constructor(e){super(e),this.statusUrl=null,this.status=null,this.submissionTime=null,this.lastUpdatedTime=null,this._timer=void 0}destroy(){clearInterval(this._timer)}async checkJobStatus(e){const t={...e,query:{f:"json"}},{data:o}=await(0,u.Z)(this.statusUrl,t);return this.read(o),this.editsResolver&&this.editsResolver.resolve({edits:null,addedFeatures:[],updatedFeatures:[],deletedFeatures:[],addedAttachments:[],updatedAttachments:[],deletedAttachments:[],exceededTransferLimit:!0,historicMoment:null}),this}async waitForJobCompletion(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{interval:t=1e3,statusCallback:o}=e;return new Promise(((e,r)=>{this._clearTimer();const i=setInterval((()=>{this._timer||r((0,v.zE)()),this.checkJobStatus().then((t=>{const{status:r}=t;switch(this.status=r,r){case"job-succeeded":this._clearTimer(),e(this);break;case"job-waiting":case"job-executing":o&&o(this)}}),(e=>{this._clearTimer(),r(e)}))}),t);this._timer=i}))}_clearTimer(){clearInterval(this._timer),this._timer=void 0}};(0,r._)([(0,n.Cb)()],S.prototype,"editsResolver",void 0),(0,r._)([(0,n.Cb)({type:String,json:{write:!0}})],S.prototype,"statusUrl",void 0),(0,r._)([(0,C.J)(I)],S.prototype,"status",void 0),(0,r._)([(0,n.Cb)({type:Date,json:{type:Number,write:{writer:(e,t)=>{t.submissionTime=e?e.getTime():null}}}})],S.prototype,"submissionTime",void 0),(0,r._)([(0,n.Cb)({type:Date,json:{type:Number,write:{writer:(e,t)=>{t.lastUpdatedTime=e?e.getTime():null}}}})],S.prototype,"lastUpdatedTime",void 0),S=(0,r._)([(0,a.j)("esri.networks.support.TopologyValidationJobInfo")],S);const _=S;var j=o(4141),N=o(54789),k=o(78952);let E=class extends((0,y.R)(p.Z)){static fromPortalItem(e){return(0,j.zu)(e)}constructor(e){super(e),this.id=null,this.title=null,this.layerUrl=null,this.dataElement=null,this.fullExtent=null,this.spatialReference=null,this.type=null,this.sourceJSON=null,this.gdbVersion=null,this.historicMoment=null,this._applyEditsHandler=e=>{const{serviceUrl:t,gdbVersion:o,result:r}=e,i=t===this.featureServiceUrl,n=(0,w.di)(t,o,this.gdbVersion);i&&n&&r.then((e=>{(0,N.JV)(t,o)&&(this.historicMoment=e.historicMoment)}))},this._updateMomentHandler=e=>{const{serviceUrl:t,gdbVersion:o,moment:r}=e,i=t===this.featureServiceUrl,n=(0,w.di)(t,o,this.gdbVersion);i&&n&&(this.historicMoment=r)},this.when().then((()=>{this.addHandles([(0,w.qH)(this._applyEditsHandler),(0,w.xl)(this._updateMomentHandler)])}),(()=>{}))}initialize(){this.when().catch((e=>{var t,o;(0,v.D_)(e)||s.Z.getLogger(this).error("#load()","Failed to load layer (title: '".concat(null!==(t=this.title)&&void 0!==t?t:"no title","', id: '").concat(null!==(o=this.id)&&void 0!==o?o:"no id","')"),{error:e})}))}get datasetName(){var e,t;return null!==(e=null===(t=this.dataElement)||void 0===t?void 0:t.name)&&void 0!==e?e:null}get owner(){var e,t;return null!==(e=null===(t=this.dataElement)||void 0===t?void 0:t.userIdentity)&&void 0!==e?e:null}get schemaGeneration(){var e,t;return null!==(e=null===(t=this.dataElement)||void 0===t?void 0:t.schemaGeneration)&&void 0!==e?e:null}get parsedUrl(){return(0,m.mN)(this.layerUrl)}get featureServiceUrl(){return(0,g.Qc)(this.parsedUrl.path).url.path}get networkServiceUrl(){return this.featureServiceUrl.replace(/\/FeatureServer/i,"/UtilityNetworkServer")}get layerId(){return(0,g.Qc)(this.parsedUrl.path).sublayer}get networkSystemLayers(){return null}async load(e){return this.addResolvingPromise(this._fetchDataElement(this.featureServiceUrl,this.layerId.toString(),e)),this.addResolvingPromise(this._fetchLayerMetaData(this.layerUrl,e)),this}getLayerIdBySourceId(e){if(this.dataElement){const r=this.dataElement.domainNetworks;for(const i of r){for(const o of null!==(t=i.edgeSources)&&void 0!==t?t:[]){var t;if(o.sourceId===e)return o.layerId}for(const t of null!==(o=i.junctionSources)&&void 0!==o?o:[]){var o;if(t.sourceId===e)return t.layerId}}return null}return null}async queryNamedTraceConfigurations(e,t){var r;const[{queryNamedTraceConfigurations:i},{default:n}]=await Promise.all([o.e(59154).then(o.bind(o,59154)),o.e(222).then(o.bind(o,222))]),s=this.networkServiceUrl,a=n.from(e);return null===(r=await i(s,a,{...t}))||void 0===r?void 0:r.namedTraceConfigurations}async validateTopology(e,t){if(!e.validateArea)throw new c.Z("network:undefined-validateArea","the network must have validateArea defined in the validate network topology parameters.");const[{validateNetworkTopology:r},{default:i}]=await Promise.all([o.e(59130).then(o.bind(o,59130)),o.e(29481).then(o.bind(o,11366))]),n=i.from(e);(0,N.JV)(this.featureServiceUrl,this.gdbVersion||null)?(n.sessionID=N.U8,await(0,N.Px)(this.featureServiceUrl,this.gdbVersion,!0)):n.sessionID=null,n.gdbVersion=this.gdbVersion;const s=this.networkServiceUrl,a=this.featureServiceUrl,l=(0,w.jF)(a,null,this.gdbVersion,!0),d=await r(s,n,{...t});if(null!==d&&void 0!==d&&d.serviceEdits){const e=[];for(const t of d.serviceEdits){var u,p,y;const{editedFeatures:o}=t,r=null!==o&&void 0!==o&&o.spatialReference?new k.Z(o.spatialReference):null;e.push({layerId:t.layerId,editedFeatures:{adds:(null===o||void 0===o||null===(u=o.adds)||void 0===u?void 0:u.map((e=>U(e,r))))||[],updates:(null===o||void 0===o||null===(p=o.updates)||void 0===p?void 0:p.map((e=>({original:U(e[0],r),current:U(e[1],r)}))))||[],deletes:(null===o||void 0===o||null===(y=o.deletes)||void 0===y?void 0:y.map((e=>U(e,r))))||[],spatialReference:r}})}l.resolve({edits:null,addedFeatures:[],updatedFeatures:[],deletedFeatures:[],addedAttachments:[],updatedAttachments:[],deletedAttachments:[],editedFeatures:e,exceededTransferLimit:!1,historicMoment:d.moment})}return d}async submitTopologyValidationJob(e,t){let r=null;if(!e.validateArea)throw new c.Z("network:undefined-validateArea","the network must have validateArea defined in the validate network topology parameters.");if(!this.gdbVersion){const e=this.layerUrl.replace(/\/FeatureServer/i,"/VersionManagementServer").replace(/\/\d*$/,"");r=(await(0,u.Z)(e,{responseType:"json",query:{f:"json"}})).data.defaultVersionName}const[{submitValidateNetworkTopologyJob:i},{default:n}]=await Promise.all([o.e(59130).then(o.bind(o,59130)),o.e(29481).then(o.bind(o,11366))]),s=n.from(e);(0,N.JV)(this.featureServiceUrl,this.gdbVersion||null)?(s.sessionID=N.U8,await(0,N.Px)(this.featureServiceUrl,this.gdbVersion,!0)):s.sessionID=null,s.gdbVersion=this.gdbVersion||r;const a=this.networkServiceUrl,l=this.featureServiceUrl?(0,w.jF)(this.featureServiceUrl,null,this.gdbVersion,!0):void 0,d=await i(a,s,{...t});return new _({statusUrl:d,editsResolver:l})}async _fetchLayerMetaData(e,t){const o=await(0,u.Z)(e,{responseType:"json",query:{f:"json"},...t});this.sourceJSON=o.data,this.read(o.data,{origin:"service"})}async _fetchDataElement(e,t,o){if(this.dataElement)return;const r=await(0,u.Z)("".concat(e,"/queryDataElements"),{responseType:"json",query:{layers:JSON.stringify([t]),f:"json"},...o}).then((e=>{var t;return null===(t=e.data.layerDataElements)||void 0===t?void 0:t[0]}));r&&this.read(r,{origin:"service"})}};function U(e,t){return new i.Z({attributes:e.attributes,geometry:(0,b.im)({...e.geometry,spatialReference:t})})}(0,r._)([(0,n.Cb)({type:String,nonNullable:!0,json:{origins:{"web-map":{read:!0,write:{isRequired:!0}},service:{read:!0}},read:!1}})],E.prototype,"id",void 0),(0,r._)([(0,n.Cb)({type:String,nonNullable:!0,json:{origins:{"web-map":{read:!0,write:{isRequired:!0}},service:{read:{source:"name"}}},read:!1}})],E.prototype,"title",void 0),(0,r._)([(0,n.Cb)({type:String,nonNullable:!0,json:{origins:{"web-map":{read:{source:"url"},write:{target:"url",isRequired:!0}}},read:!1}})],E.prototype,"layerUrl",void 0),(0,r._)([(0,n.Cb)({type:Object,json:{origins:{service:{read:!0}},read:!1}})],E.prototype,"dataElement",void 0),(0,r._)([(0,n.Cb)({type:h.Z,json:{origins:{service:{read:{source:"extent"}}},read:!1}})],E.prototype,"fullExtent",void 0),(0,r._)([(0,n.Cb)({type:k.Z,json:{origins:{service:{read:{source:"extent.spatialReference"}}},read:!1}})],E.prototype,"spatialReference",void 0),(0,r._)([(0,n.Cb)({type:["utility","trace"],readOnly:!0,json:{read:!1,write:!1}})],E.prototype,"type",void 0),(0,r._)([(0,n.Cb)({readOnly:!0})],E.prototype,"datasetName",null),(0,r._)([(0,n.Cb)({readOnly:!0})],E.prototype,"owner",null),(0,r._)([(0,n.Cb)({readOnly:!0})],E.prototype,"schemaGeneration",null),(0,r._)([(0,n.Cb)({readOnly:!0})],E.prototype,"parsedUrl",null),(0,r._)([(0,n.Cb)({readOnly:!0})],E.prototype,"featureServiceUrl",null),(0,r._)([(0,n.Cb)({readOnly:!0})],E.prototype,"networkServiceUrl",null),(0,r._)([(0,n.Cb)({readOnly:!0})],E.prototype,"layerId",null),(0,r._)([(0,n.Cb)()],E.prototype,"sourceJSON",void 0),(0,r._)([(0,n.Cb)({readOnly:!0})],E.prototype,"networkSystemLayers",null),(0,r._)([(0,n.Cb)()],E.prototype,"gdbVersion",void 0),(0,r._)([(0,n.Cb)({type:Date})],E.prototype,"historicMoment",void 0),E=(0,r._)([(0,a.j)("esri.networks.Network")],E);const O=E;var A=o(46784),R=o(18769);let F=class extends((0,A.eC)(p.Z)){constructor(e){super(e),this.rulesCategorized={attachment:[],containment:[],connectivity:[]},this.request=u.Z}initialize(){}async load(e){const t=this.layer.load(e).then((()=>this._initializeRulesTable()));return this.addResolvingPromise(t),this}getFeatureSQL(e,t){var o,r;const i=e.layerId.toString(),n=null===(o=e.fieldsIndex)||void 0===o?void 0:o.normalizeFieldName("assetGroup"),s=null===(r=e.fieldsIndex)||void 0===r?void 0:r.normalizeFieldName("assetType"),a=n?t.attributes[n]:null,l=s?t.attributes[s]:null,d=this.rulesHash[i];if(d){const e=d.assetGroupHash[a];if(e)return e.assetTypeHash[l]||null}return null}async _initializeRulesTable(){const e={};let t;!function(e){e[e.from=0]="from",e[e.to=1]="to",e[e.via=2]="via"}(t||(t={}));const o=[{networkSourceId:"fromNetworkSource",assetGroupId:"fromAssetGroup",assetTypeId:"fromAssetType"},{networkSourceId:"toNetworkSource",assetGroupId:"toAssetGroup",assetTypeId:"toAssetType"},{networkSourceId:"viaNetworkSource",assetGroupId:"viaAssetGroup",assetTypeId:"viaAssetType"}];this.rulesCategorized={attachment:[],containment:[],connectivity:[]};for(const g of this.rules){if(g.ruleType===R.SV.RTAttachment){this.rulesCategorized.attachment.push(g);continue}if(g.ruleType===R.SV.RTContainment){this.rulesCategorized.containment.push(g);continue}if(g.ruleType===R.SV.RTJunctionJunctionConnectivity){this.rulesCategorized.connectivity.push(g);continue}this.rulesCategorized.connectivity.push(g);let f=[[t.from,t.to],[t.to,t.from]];g.ruleType===R.SV.RTEdgeJunctionEdgeConnectivity&&(f=[[t.from,t.via],[t.via,t.from],[t.to,t.via],[t.via,t.to]]);for(const C of f){var r,i,n,s,a,l,d,u,c,p,y,v,m,h;const f=C.shift(),T=C.shift();let I=!1;switch(g.ruleType){case R.SV.RTEdgeJunctionEdgeConnectivity:I=f===t.from||f===t.to;break;case R.SV.RTJunctionEdgeConnectivity:I=f===t.to}const S=o[f],_=null!==(r=null===(i=g[S.networkSourceId])||void 0===i?void 0:i.layerId.toString())&&void 0!==r?r:"",j=null===(n=g[S.assetGroupId])||void 0===n||null===(n=n.assetGroupCode)||void 0===n?void 0:n.toString(),N=g[S.assetTypeId],k=null===N||void 0===N||null===(s=N.assetTypeCode)||void 0===s?void 0:s.toString(),E=o[T],U=null!==(a=null===(l=g[E.networkSourceId])||void 0===l?void 0:l.layerId.toString())&&void 0!==a?a:"",O=null===(d=g[E.assetGroupId])||void 0===d||null===(d=d.assetGroupCode)||void 0===d?void 0:d.toString(),A=g[E.assetTypeId],F=null===A||void 0===A||null===(u=A.assetTypeCode)||void 0===u?void 0:u.toString(),V=null!==(c=e[_])&&void 0!==c?c:{assetGroupHash:{}};if(!(j&&k&&O&&F))continue;const G=null!==(p=V.assetGroupHash[j])&&void 0!==p?p:{assetTypeHash:{}},J=null!==(y=G.assetTypeHash[k])&&void 0!==y?y:{};if(J[U]=null!==(v=J[U])&&void 0!==v?v:{},I){var b,w;J[_]=null!==(b=J[_])&&void 0!==b?b:{};const e="(assetgroup = ".concat(j," AND assettype = ").concat(k,")");J[_].anyVertex=J[_].anyVertex?"".concat(J[_].anyVertex):"".concat(e),"esriNECPEndVertex"===(null===A||void 0===A?void 0:A.connectivityPolicy)&&(J[_].endVertex=null!==(w=J[_])&&void 0!==w&&w.endVertex?"".concat(J[_].endVertex):"".concat(e))}const x="(assetgroup = ".concat(O," AND assettype = ").concat(F,")");J[U].anyVertex=null!==(m=J[U])&&void 0!==m&&m.anyVertex?"".concat(J[U].anyVertex," OR ").concat(x):"".concat(x),"esriNECPEndVertex"===(null===A||void 0===A?void 0:A.connectivityPolicy)&&(J[U].endVertex=null!==(h=J[U])&&void 0!==h&&h.endVertex?"".concat(J[U].endVertex," OR ").concat(x):"".concat(x)),G.assetTypeHash[k]=J,V.assetGroupHash[j]=G,e[_]=V}}this.rulesHash=e}};(0,r._)([(0,n.Cb)({constructOnly:!0})],F.prototype,"layer",void 0),(0,r._)([(0,n.Cb)({constructOnly:!0})],F.prototype,"rules",void 0),(0,r._)([(0,n.Cb)()],F.prototype,"rulesHash",void 0),(0,r._)([(0,n.Cb)()],F.prototype,"rulesCategorized",void 0),(0,r._)([(0,n.Cb)({constructOnly:!0})],F.prototype,"request",void 0),F=(0,r._)([(0,a.j)("esri.networks.RulesTable")],F);const V=F;var G=o(12484),J=o(7138);let x=class extends J.default{constructor(e){super(e),this.rulesTableId=null,this.rulesTableUrl=null,this.subnetworksTableId=null,this.subnetworksTableUrl=null,this.dirtyAreasLayerId=null,this.dirtyAreasLayerUrl=null,this.associationsTableId=null,this.associationsTableUrl=null}};(0,r._)([(0,n.Cb)({constructOnly:!0})],x.prototype,"rulesTableId",void 0),(0,r._)([(0,n.Cb)({constructOnly:!0})],x.prototype,"rulesTableUrl",void 0),(0,r._)([(0,n.Cb)({constructOnly:!0})],x.prototype,"subnetworksTableId",void 0),(0,r._)([(0,n.Cb)({constructOnly:!0})],x.prototype,"subnetworksTableUrl",void 0),(0,r._)([(0,n.Cb)({constructOnly:!0})],x.prototype,"dirtyAreasLayerId",void 0),(0,r._)([(0,n.Cb)({constructOnly:!0})],x.prototype,"dirtyAreasLayerUrl",void 0),(0,r._)([(0,n.Cb)({constructOnly:!0})],x.prototype,"associationsTableId",void 0),(0,r._)([(0,n.Cb)({constructOnly:!0})],x.prototype,"associationsTableUrl",void 0),x=(0,r._)([(0,a.j)("esri.networks.support.NetworkSystemLayers")],x);const L=x;let P=class extends A.wq{constructor(e){super(e),this.id=null,this.name=null}};(0,r._)([(0,n.Cb)({type:Number,json:{read:{source:"terminalId"},write:{target:"terminalId"}}})],P.prototype,"id",void 0),(0,r._)([(0,n.Cb)({type:String,json:{read:{source:"terminalName"},write:{target:"terminalName"}}})],P.prototype,"name",void 0),(0,r._)([(0,n.Cb)({type:Boolean,json:{write:!0}})],P.prototype,"isUpstreamTerminal",void 0),P=(0,r._)([(0,a.j)("esri.networks.support.Terminal")],P);const Z=P,B=new f.X({esriUNTMBidirectional:"bidirectional",esriUNTMDirectional:"directional"});let D=class extends A.wq{constructor(e){super(e),this.defaultConfiguration=null,this.id=null,this.name=null,this.terminals=[],this.traversabilityModel=null}};(0,r._)([(0,n.Cb)({type:String,json:{write:!0}})],D.prototype,"defaultConfiguration",void 0),(0,r._)([(0,n.Cb)({type:Number,json:{read:{source:"terminalConfigurationId"},write:{target:"terminalConfigurationId"}}})],D.prototype,"id",void 0),(0,r._)([(0,n.Cb)({type:String,json:{read:{source:"terminalConfigurationName"},write:{target:"terminalConfigurationName"}}})],D.prototype,"name",void 0),(0,r._)([(0,n.Cb)({type:[Z],json:{write:!0}})],D.prototype,"terminals",void 0),(0,r._)([(0,n.Cb)({type:B.apiValues,json:{type:B.jsonValues,read:B.read,write:B.write}})],D.prototype,"traversabilityModel",void 0),D=(0,r._)([(0,a.j)("esri.networks.support.TerminalConfiguration")],D);const q=D;var M=o(20039);const z=(0,f.w)()({Pending:"job-waiting",InProgress:"job-executing",Completed:"job-succeeded"});let H=class extends M.Z{constructor(e){super(e),this.statusUrl=null,this.status=null,this.submissionTime=null,this.lastUpdatedTime=null,this._timer=void 0}destroy(){clearInterval(this._timer)}async checkJobStatus(e){const t={...e,query:{f:"json"}},{data:o}=await(0,u.Z)(this.statusUrl,t),r=o.traceResults?{...o.traceResults,...o}:o;return this.read(r),this}async waitForJobCompletion(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{interval:t=1e3,statusCallback:o}=e;return new Promise(((e,r)=>{this._clearTimer();const i=setInterval((()=>{this._timer||r((0,v.zE)()),this.checkJobStatus().then((t=>{const{status:r}=t;switch(this.status=r,r){case"job-succeeded":this._clearTimer(),e(this);break;case"job-waiting":case"job-executing":o&&o(this)}}),(e=>{this._clearTimer(),r(e)}))}),t);this._timer=i}))}_clearTimer(){clearInterval(this._timer),this._timer=void 0}};(0,r._)([(0,n.Cb)({type:String,json:{write:!0}})],H.prototype,"statusUrl",void 0),(0,r._)([(0,C.J)(z)],H.prototype,"status",void 0),(0,r._)([(0,n.Cb)({type:Date,json:{type:Number,write:{writer:(e,t)=>{t.submissionTime=e?e.getTime():null}}}})],H.prototype,"submissionTime",void 0),(0,r._)([(0,n.Cb)({type:Date,json:{type:Number,write:{writer:(e,t)=>{t.lastUpdatedTime=e?e.getTime():null}}}})],H.prototype,"lastUpdatedTime",void 0),H=(0,r._)([(0,a.j)("esri.networks.support.TraceJobInfo")],H);const K=H;var X=o(21149);let Y=class extends O{constructor(e){super(e),this.sharedNamedTraceConfigurations=[],this.type="utility"}get serviceTerritoryFeatureLayerId(){var e,t;return null!==(e=null===(t=this.dataElement)||void 0===t?void 0:t.serviceTerritoryFeatureLayerId)&&void 0!==e?e:null}get networkSystemLayers(){var e,t,o,r,i,n,s,a;return new L({rulesTableId:null===(e=this.sourceJSON)||void 0===e?void 0:e.systemLayers.rulesTableId,rulesTableUrl:this.sourceJSON?"".concat(this.featureServiceUrl,"/").concat(null===(t=this.sourceJSON)||void 0===t?void 0:t.systemLayers.rulesTableId):null,subnetworksTableId:null===(o=this.sourceJSON)||void 0===o?void 0:o.systemLayers.subnetworksTableId,subnetworksTableUrl:this.sourceJSON?"".concat(this.featureServiceUrl,"/").concat(null===(r=this.sourceJSON)||void 0===r?void 0:r.systemLayers.subnetworksTableId):null,dirtyAreasLayerId:null===(i=this.sourceJSON)||void 0===i?void 0:i.systemLayers.dirtyAreasLayerId,dirtyAreasLayerUrl:this.sourceJSON?"".concat(this.featureServiceUrl,"/").concat(null===(n=this.sourceJSON)||void 0===n?void 0:n.systemLayers.dirtyAreasLayerId):null,associationsTableId:null===(s=this.sourceJSON)||void 0===s?void 0:s.systemLayers.associationsTableId,associationsTableUrl:this.sourceJSON?"".concat(this.featureServiceUrl,"/").concat(null===(a=this.sourceJSON)||void 0===a?void 0:a.systemLayers.associationsTableId):null})}get terminalConfigurations(){var e;return(null===(e=this.dataElement)||void 0===e?void 0:e.terminalConfigurations.map((e=>q.fromJSON(e))))||[]}get domainNetworkNames(){var e;return(null===(e=this.dataElement)||void 0===e?void 0:e.domainNetworks.map((e=>e.domainNetworkName)))||[]}get _utilityLayerList(){var e;const t=new Set;return null!==(e=this.dataElement)&&void 0!==e&&null!==(e=e.domainNetworks)&&void 0!==e&&e.map((e=>{e.edgeSources.map((e=>{t.add(e.layerId)})),e.junctionSources.map((e=>{t.add(e.layerId)}))})),t}async load(e){return this.addResolvingPromise(super.load(e)),this.addResolvingPromise(this._loadNamedTraceConfigurationsFromNetwork(e)),this}getTerminalConfiguration(e){let t=null,o=null;const r=e.layer;let i=null;if("feature"===(null===r||void 0===r?void 0:r.type)){if(i=r.layerId,null===i)return null}else{var n,s;if("subtype-sublayer"!==(null===r||void 0===r?void 0:r.type))return null;if(i=null!==(n=null===r||void 0===r||null===(s=r.parent)||void 0===s?void 0:s.layerId)&&void 0!==n?n:null,null===i)return null}const a=e.attributes;if(null==a)return null;for(const y of Object.keys(a))"ASSETGROUP"===y.toUpperCase()&&(t=e.getAttribute(y)),"ASSETTYPE"===y.toUpperCase()&&(o=e.getAttribute(y));if(!this.dataElement)return null;let l=null;const d=this.dataElement.domainNetworks;for(const y of d){var u;const e=null===(u=y.junctionSources)||void 0===u?void 0:u.find((e=>e.layerId===i));if(e){var c;const r=null===(c=e.assetGroups)||void 0===c?void 0:c.find((e=>e.assetGroupCode===t));if(r){var p;const e=null===(p=r.assetTypes)||void 0===p?void 0:p.find((e=>e.assetTypeCode===o));if(e){l=e.terminalConfigurationId;break}}}}if(null!=l){const e=this.dataElement.terminalConfigurations,t=null===e||void 0===e?void 0:e.find((e=>e.terminalConfigurationId===l));return t?q.fromJSON(t):null}return null}getTierNames(e){var t;const o=null===(t=this.dataElement)||void 0===t?void 0:t.domainNetworks.find((t=>t.domainNetworkName===e));return(null===o||void 0===o?void 0:o.tiers.map((e=>e.name)))||[]}async getRulesTable(){return this._sharedRulesTable||(this._sharedRulesTable=this._createRulesTable()),await this._sharedRulesTable}isUtilityLayer(e){var t,o;return this._utilityLayerList.has(e.layerId)&&null!==(t=null===(o=e.url)||void 0===o?void 0:o.startsWith(this.featureServiceUrl))&&void 0!==t&&t}async queryAssociations(e){const[{queryAssociations:t},{default:r}]=await Promise.all([o.e(60897).then(o.bind(o,60897)),o.e(40365).then(o.bind(o,40365))]),i=r.from(e);return i.gdbVersion=this.gdbVersion,i.moment=this.historicMoment,(await t(this.networkServiceUrl,i)).associations}async synthesizeAssociationGeometries(e){const[{synthesizeAssociationGeometries:t},{default:r}]=await Promise.all([o.e(17125).then(o.bind(o,17125)),o.e(9704).then(o.bind(o,9704))]),i=r.from(e);return i.gdbVersion=this.gdbVersion,i.moment=this.historicMoment,t(this.networkServiceUrl,i)}async trace(e){const[{trace:t},{default:r}]=await Promise.all([o.e(14254).then(o.bind(o,14254)),o.e(53226).then(o.bind(o,53226))]),i=r.from(e);return i.gdbVersion=this.gdbVersion,i.moment=this.historicMoment,t(this.networkServiceUrl,i)}async submitTraceJob(e){const[{submitTraceJob:t},{default:r}]=await Promise.all([o.e(14254).then(o.bind(o,14254)),o.e(53226).then(o.bind(o,53226))]),i=r.from(e);i.gdbVersion=this.gdbVersion,i.moment=this.historicMoment;const n=await t(this.networkServiceUrl,i);return new K({statusUrl:n})}async canAddAssociation(e){const t=await this.getRulesTable();if(!t)return!1;await t.load();const o=(e,t)=>e?1===e.terminalId?!(null!==t&&void 0!==t&&t.terminalId)||(null===t||void 0===t?void 0:t.terminalId)===e.terminalId:e.terminalId===(null===t||void 0===t?void 0:t.terminalId):!(null!==t&&void 0!==t&&t.terminalId),r=(e,t)=>{var r,i,n,s,a,l,d,u,c,p,y,v;return(null===(r=e.fromNetworkSource)||void 0===r?void 0:r.sourceId)===(null===(i=t.fromNetworkElement)||void 0===i?void 0:i.networkSourceId)&&(null===(n=e.toNetworkSource)||void 0===n?void 0:n.sourceId)===(null===(s=t.toNetworkElement)||void 0===s?void 0:s.networkSourceId)&&(null===(a=e.fromAssetGroup)||void 0===a?void 0:a.assetGroupCode)===(null===(l=t.fromNetworkElement)||void 0===l?void 0:l.assetGroupCode)&&(null===(d=e.fromAssetType)||void 0===d?void 0:d.assetTypeCode)===(null===(u=t.fromNetworkElement)||void 0===u?void 0:u.assetTypeCode)&&(null===(c=e.toAssetGroup)||void 0===c?void 0:c.assetGroupCode)===(null===(p=t.toNetworkElement)||void 0===p?void 0:p.assetGroupCode)&&(null===(y=e.toAssetType)||void 0===y?void 0:y.assetTypeCode)===(null===(v=t.toNetworkElement)||void 0===v?void 0:v.assetTypeCode)&&o(e.fromTerminal,t.fromNetworkElement)&&o(e.toTerminal,t.toNetworkElement)};return"containment"===e.associationType?t.rulesCategorized.containment.some((t=>r(t,e))):"attachment"===e.associationType?t.rulesCategorized.attachment.some((t=>r(t,e))):t.rulesCategorized.connectivity.some((t=>{var i,n,s,a,l,d,u,c,p,y,v,m,h,b,w,g,f,C,T,I,S,_,j,N;return t.viaNetworkSource?(null===(i=t.fromNetworkSource)||void 0===i?void 0:i.sourceId)===(null===(n=e.fromNetworkElement)||void 0===n?void 0:n.networkSourceId)&&(null===(s=t.viaNetworkSource)||void 0===s?void 0:s.sourceId)===(null===(a=e.toNetworkElement)||void 0===a?void 0:a.networkSourceId)&&(null===(l=t.fromAssetGroup)||void 0===l?void 0:l.assetGroupCode)===(null===(d=e.fromNetworkElement)||void 0===d?void 0:d.assetGroupCode)&&(null===(u=t.fromAssetType)||void 0===u?void 0:u.assetTypeCode)===(null===(c=e.fromNetworkElement)||void 0===c?void 0:c.assetTypeCode)&&(null===(p=t.viaAssetGroup)||void 0===p?void 0:p.assetGroupCode)===(null===(y=e.toNetworkElement)||void 0===y?void 0:y.assetGroupCode)&&(null===(v=t.viaAssetType)||void 0===v?void 0:v.assetTypeCode)===(null===(m=e.toNetworkElement)||void 0===m?void 0:m.assetTypeCode)&&o(t.fromTerminal,e.fromNetworkElement)&&o(t.viaTerminal,e.toNetworkElement)||(null===(h=t.viaNetworkSource)||void 0===h?void 0:h.sourceId)===(null===(b=e.fromNetworkElement)||void 0===b?void 0:b.networkSourceId)&&(null===(w=t.toNetworkSource)||void 0===w?void 0:w.sourceId)===(null===(g=e.toNetworkElement)||void 0===g?void 0:g.networkSourceId)&&(null===(f=t.viaAssetGroup)||void 0===f?void 0:f.assetGroupCode)===(null===(C=e.fromNetworkElement)||void 0===C?void 0:C.assetGroupCode)&&(null===(T=t.viaAssetType)||void 0===T?void 0:T.assetTypeCode)===(null===(I=e.fromNetworkElement)||void 0===I?void 0:I.assetTypeCode)&&(null===(S=t.toAssetGroup)||void 0===S?void 0:S.assetGroupCode)===(null===(_=e.toNetworkElement)||void 0===_?void 0:_.assetGroupCode)&&(null===(j=t.toAssetType)||void 0===j?void 0:j.assetTypeCode)===(null===(N=e.toNetworkElement)||void 0===N?void 0:N.assetTypeCode)&&o(t.viaTerminal,e.fromNetworkElement)&&o(t.toTerminal,e.toNetworkElement):r(t,e)}))}generateAddAssociations(e){return{addFeatures:e.map((e=>{var t,o,r,n,s,a;return new i.Z({attributes:{fromnetworksourceid:null===(t=e.fromNetworkElement)||void 0===t?void 0:t.networkSourceId,fromglobalid:null===(o=e.fromNetworkElement)||void 0===o?void 0:o.globalId,fromterminalid:null===(r=e.fromNetworkElement)||void 0===r?void 0:r.terminalId,tonetworksourceid:null===(n=e.toNetworkElement)||void 0===n?void 0:n.networkSourceId,toglobalid:null===(s=e.toNetworkElement)||void 0===s?void 0:s.globalId,toterminalid:null===(a=e.toNetworkElement)||void 0===a?void 0:a.terminalId,associationtype:R.Xu[e.associationType],iscontentvisible:e.isContentVisible?1:0,percentalong:e.percentAlong,globalid:e.globalId}})})),id:this.networkSystemLayers.associationsTableId,identifierFields:{globalIdField:"globalid",objectIdField:"objectid"}}}generateDeleteAssociations(e){return{deleteFeatures:e.map((e=>({globalId:e.globalId}))),id:this.networkSystemLayers.associationsTableId,identifierFields:{globalIdField:"globalid",objectIdField:"objectid"}}}async _loadNamedTraceConfigurationsFromNetwork(e){var t;if(0===(null===(t=this.sharedNamedTraceConfigurations)||void 0===t?void 0:t.length))return;const o=this.sharedNamedTraceConfigurations.map((e=>e.globalId)),r=await this.queryNamedTraceConfigurations({globalIds:o},e);for(const i of this.sharedNamedTraceConfigurations){const e=null===r||void 0===r?void 0:r.find((e=>e.globalId===i.globalId));if(e){const t=e.write({},{origin:"service"});i.read(t,{origin:"service"})}}}async _createRulesTable(){var e;const t=this.networkSystemLayers.rulesTableUrl,o=new l.default({url:t});await o.load();const r=null===(e=this.dataElement)||void 0===e?void 0:e.domainNetworks;if(!r)return null;const i=r.flatMap((e=>[...e.edgeSources||[],...e.junctionSources||[]])),n=(await async function(e){const t=new X.Z({where:"1=1",outFields:["*"]});return(await(0,d.UK)(e,t)).features}(o)).map((e=>this._hydrateRuleInfo(o,i,e)));return new V({layer:o,rules:n})}_hydrateRuleInfo(e,t,o){const r=e.fieldsIndex,i=r.get("RULETYPE"),n=r.get("CREATIONDATE"),s=r.get("FROMNETWORKSOURCEID"),a=r.get("FROMASSETGROUP"),l=r.get("FROMASSETTYPE"),d=r.get("FROMTERMINALID"),u=r.get("TONETWORKSOURCEID"),c=r.get("TOASSETGROUP"),p=r.get("TOASSETTYPE"),y=r.get("TOTERMINALID"),v=r.get("VIANETWORKSOURCEID"),m=r.get("VIAASSETGROUP"),h=r.get("VIAASSETTYPE"),b=r.get("VIATERMINALID"),w=o.attributes[i.name],g=new Date(o.attributes[n.name]),f=[{networkSourceId:o.attributes[s.name],assetGroupId:o.attributes[a.name],assetTypeId:o.attributes[l.name],terminalId:o.attributes[d.name]},{networkSourceId:o.attributes[u.name],assetGroupId:o.attributes[c.name],assetTypeId:o.attributes[p.name],terminalId:o.attributes[y.name]},{networkSourceId:o.attributes[v.name],assetGroupId:o.attributes[m.name],assetTypeId:o.attributes[h.name],terminalId:o.attributes[b.name]}];let C;!function(e){e[e.from=0]="from",e[e.to=1]="to",e[e.via=2]="via"}(C||(C={}));const T={ruleType:w,creationDate:g};for(const I of[C.from,C.to,C.via]){if(w!==R.SV.RTEdgeJunctionEdgeConnectivity&&I===C.via)continue;const e=f[I],o=t.find((t=>t.sourceId===e.networkSourceId)),r=null===o||void 0===o?void 0:o.assetGroups.find((t=>t.assetGroupCode===e.assetGroupId)),i=null===r||void 0===r?void 0:r.assetTypes.find((t=>t.assetTypeCode===e.assetTypeId)),n=this._getTerminal(i,e);let s="";switch(I){case C.from:s="from";break;case C.to:s="to";break;case C.via:s="via"}T["".concat(s,"NetworkSource")]=o,T["".concat(s,"AssetGroup")]=r,T["".concat(s,"AssetType")]=i,T["".concat(s,"Terminal")]=null===n||void 0===n?void 0:n.toJSON()}return T}_getTerminal(e,t){var o,r,i;const n=null===e||void 0===e?void 0:e.terminalConfigurationId,s=null===(o=this.terminalConfigurations)||void 0===o?void 0:o.find((e=>e.id===n));return null!==(r=null===s||void 0===s||null===(i=s.terminals)||void 0===i?void 0:i.find((e=>e.id===t.terminalId)))&&void 0!==r?r:null}};(0,r._)([(0,n.Cb)({type:[G.Z],json:{origins:{"web-map":{read:{source:"traceConfigurations"},write:{target:"traceConfigurations"}},service:{read:{source:"traceConfigurations"}}},read:!1}})],Y.prototype,"sharedNamedTraceConfigurations",void 0),(0,r._)([(0,n.Cb)({type:["utility"],readOnly:!0,json:{read:!1,write:!1}})],Y.prototype,"type",void 0),(0,r._)([(0,n.Cb)({readOnly:!0})],Y.prototype,"serviceTerritoryFeatureLayerId",null),(0,r._)([(0,n.Cb)({readOnly:!0})],Y.prototype,"networkSystemLayers",null),(0,r._)([(0,n.Cb)({readOnly:!0})],Y.prototype,"terminalConfigurations",null),(0,r._)([(0,n.Cb)({readOnly:!0})],Y.prototype,"domainNetworkNames",null),Y=(0,r._)([(0,a.j)("esri.networks.UtilityNetwork")],Y);const Q=Y},12484:(e,t,o)=>{o.d(t,{Z:()=>p});var r=o(27366),i=o(97642),n=o(49861),s=(o(93169),o(32718),o(84936),o(38511)),a=o(69912),l=o(48153),d=o(18769),u=o(29259);let c=class extends i.w{constructor(e){super(e),this.globalId=null,this.title=null,this.traceConfiguration=null,this.creationDate=null,this.creator=null,this.description=null,this.minStartingPoints=null,this.resultTypes=[],this.tags=[],this.traceType=null}readTraceConfiguration(e,t){return void 0!==e.tierName?u.Z.fromJSON(e):l.Z.fromJSON(e)}};(0,r._)([(0,n.Cb)({type:String,nonNullable:!0,json:{origins:{"web-map":{read:{source:"id"},write:{target:"id",isRequired:!0}},service:{read:{source:"globalId"},write:{target:"globalId",isRequired:!0}}},read:!1}})],c.prototype,"globalId",void 0),(0,r._)([(0,n.Cb)({type:String,nonNullable:!0,json:{origins:{"web-map":{read:{source:"title"},write:{target:"title",isRequired:!0}},service:{read:{source:"name"},write:{target:"name",isRequired:!0}}},read:!1}})],c.prototype,"title",void 0),(0,r._)([(0,n.Cb)({type:l.Z,json:{origins:{service:{read:!0,write:!0}},read:!1}})],c.prototype,"traceConfiguration",void 0),(0,r._)([(0,s.r)("service","traceConfiguration")],c.prototype,"readTraceConfiguration",null),(0,r._)([(0,n.Cb)({type:Date,json:{origins:{service:{read:!0,write:!0}},read:!1}})],c.prototype,"creationDate",void 0),(0,r._)([(0,n.Cb)({type:String,json:{origins:{service:{read:!0,write:!0}},read:!1}})],c.prototype,"creator",void 0),(0,r._)([(0,n.Cb)({type:String,json:{origins:{service:{read:!0,write:!0}},read:!1}})],c.prototype,"description",void 0),(0,r._)([(0,n.Cb)({type:["none","one","many"],json:{origins:{service:{read:{source:"minNumStartingPoints"},write:{target:"minNumStartingPoints"}}},read:!1}})],c.prototype,"minStartingPoints",void 0),(0,r._)([(0,n.Cb)({json:{origins:{service:{read:!0,write:!0}},read:!1}})],c.prototype,"resultTypes",void 0),(0,r._)([(0,n.Cb)({type:[String],json:{origins:{service:{read:!0,write:!0}},read:!1}})],c.prototype,"tags",void 0),(0,r._)([(0,n.Cb)({type:d.Fh.apiValues,json:{type:d.Fh.jsonValues,origins:{service:{read:d.Fh.read,write:d.Fh.write}},read:!1}})],c.prototype,"traceType",void 0),c=(0,r._)([(0,a.j)("esri.networks.support.NamedTraceConfiguration")],c);const p=c},48153:(e,t,o)=>{o.d(t,{Z:()=>l});var r=o(27366),i=o(46784),n=o(49861),s=(o(93169),o(32718),o(84936),o(69912));let a=class extends i.wq{constructor(e){super(e),this.conditionBarriers=[],this.outputConditions=[],this.functions=[],this.functionBarriers=[],this.traversabilityScope=null,this.shortestPathNetworkAttributeName=null,this.includeBarriers=null,this.validateConsistency=null,this.ignoreBarriersAtStartingPoints=null}};(0,r._)([(0,n.Cb)({type:[Object],json:{write:!0}})],a.prototype,"conditionBarriers",void 0),(0,r._)([(0,n.Cb)({type:[Object],json:{write:!0}})],a.prototype,"outputConditions",void 0),(0,r._)([(0,n.Cb)({type:[Object],json:{write:!0}})],a.prototype,"functions",void 0),(0,r._)([(0,n.Cb)({type:[Object],json:{write:!0}})],a.prototype,"functionBarriers",void 0),(0,r._)([(0,n.Cb)({type:["junctions","edges","junctionsAndEdges"],json:{write:!0}})],a.prototype,"traversabilityScope",void 0),(0,r._)([(0,n.Cb)({type:String,json:{write:!0}})],a.prototype,"shortestPathNetworkAttributeName",void 0),(0,r._)([(0,n.Cb)({type:Boolean,json:{write:!0}})],a.prototype,"includeBarriers",void 0),(0,r._)([(0,n.Cb)({type:Boolean,json:{write:!0}})],a.prototype,"validateConsistency",void 0),(0,r._)([(0,n.Cb)({type:Boolean,json:{write:!0}})],a.prototype,"ignoreBarriersAtStartingPoints",void 0),a=(0,r._)([(0,s.j)("esri.networks.support.TraceConfiguration")],a);const l=a},29259:(e,t,o)=>{o.d(t,{Z:()=>l});var r=o(27366),i=o(49861),n=(o(93169),o(32718),o(84936),o(69912)),s=o(48153);let a=class extends s.Z{constructor(e){super(e),this.filterBarriers=[],this.arcadeExpressionBarrier=null,this.domainNetworkName=null,this.filterBitsetNetworkAttributeName=null,this.filterFunctionBarriers=[],this.filterScope=null,this.includeContainers=null,this.includeContent=null,this.includeIsolated=null,this.includeStructures=null,this.allowIndeterminateFlow=null,this.includeUpToFirstSpatialContainer=null,this.nearestNeighbor=null,this.outputFilterCategories=[],this.outputFilters=[],this.propagators=[],this.subnetworkName=null,this.targetTierName=null,this.diagramTemplateName=null,this.tierName=null,this.validateLocatability=null}};(0,r._)([(0,i.Cb)({type:[Object],json:{write:!0}})],a.prototype,"filterBarriers",void 0),(0,r._)([(0,i.Cb)({type:String,json:{write:!0}})],a.prototype,"arcadeExpressionBarrier",void 0),(0,r._)([(0,i.Cb)({type:String,json:{write:!0}})],a.prototype,"domainNetworkName",void 0),(0,r._)([(0,i.Cb)({type:String,json:{write:!0}})],a.prototype,"filterBitsetNetworkAttributeName",void 0),(0,r._)([(0,i.Cb)({type:[Object],json:{write:!0}})],a.prototype,"filterFunctionBarriers",void 0),(0,r._)([(0,i.Cb)({type:["junctions","edges","junctionsAndEdges"],json:{write:!0}})],a.prototype,"filterScope",void 0),(0,r._)([(0,i.Cb)({type:Boolean,json:{write:!0}})],a.prototype,"includeContainers",void 0),(0,r._)([(0,i.Cb)({type:Boolean,json:{write:!0}})],a.prototype,"includeContent",void 0),(0,r._)([(0,i.Cb)({type:Boolean,json:{write:!0}})],a.prototype,"includeIsolated",void 0),(0,r._)([(0,i.Cb)({type:Boolean,json:{write:!0}})],a.prototype,"includeStructures",void 0),(0,r._)([(0,i.Cb)({type:Boolean,json:{write:!0}})],a.prototype,"allowIndeterminateFlow",void 0),(0,r._)([(0,i.Cb)({type:Boolean,json:{write:!0}})],a.prototype,"includeUpToFirstSpatialContainer",void 0),(0,r._)([(0,i.Cb)({type:Object,json:{write:!0}})],a.prototype,"nearestNeighbor",void 0),(0,r._)([(0,i.Cb)({type:[Object],json:{write:!0}})],a.prototype,"outputFilterCategories",void 0),(0,r._)([(0,i.Cb)({type:[Object],json:{write:!0}})],a.prototype,"outputFilters",void 0),(0,r._)([(0,i.Cb)({type:[Object],json:{write:!0}})],a.prototype,"propagators",void 0),(0,r._)([(0,i.Cb)({type:String,json:{write:!0}})],a.prototype,"subnetworkName",void 0),(0,r._)([(0,i.Cb)({type:String,json:{write:!0}})],a.prototype,"targetTierName",void 0),(0,r._)([(0,i.Cb)({type:String,json:{write:!0}})],a.prototype,"diagramTemplateName",void 0),(0,r._)([(0,i.Cb)({type:String,json:{write:!0}})],a.prototype,"tierName",void 0),(0,r._)([(0,i.Cb)({type:Boolean,json:{write:!0}})],a.prototype,"validateLocatability",void 0),a=(0,r._)([(0,n.j)("esri.networks.support.UNTraceConfiguration")],a);const l=a},18769:(e,t,o)=>{o.d(t,{By:()=>a,Fh:()=>s,SV:()=>r,Xu:()=>l,k3:()=>d});var r,i,n=o(43404);(i=r||(r={}))[i.RTJunctionJunctionConnectivity=1]="RTJunctionJunctionConnectivity",i[i.RTAttachment=2]="RTAttachment",i[i.RTContainment=3]="RTContainment",i[i.RTJunctionEdgeConnectivity=4]="RTJunctionEdgeConnectivity",i[i.RTEdgeJunctionEdgeConnectivity=5]="RTEdgeJunctionEdgeConnectivity";const s=new n.X({connected:"connected",upstream:"upstream",downstream:"downstream",shortestPath:"shortest-path",subnetwork:"subnetwork",subnetworkController:"subnetwork-controller",loops:"loops",isolation:"isolation"}),a=new n.X({junctionJunctionConnectivity:"junction-junction-connectivity",connectivity:"connectivity",attachment:"attachment",containment:"containment",junctionEdgeFromConnectivity:"junction-edge-from-connectivity",junctionMidspanConnectivity:"junction-midspan-connectivity",junctionEdgeToConnectivity:"junction-edge-to-connectivity"}),l={connectivity:1,"junction-junction-connectivity":1,attachment:2,containment:3,"junction-edge-from-connectivity":4,"junction-midspan-connectivity":5,"junction-edge-to-connectivity":6},d=new n.X({normal:"normal",rebuild:"rebuild",forceRebuild:"force-rebuild"})},4141:(e,t,o)=>{o.d(t,{Cf:()=>l,n7:()=>d,zu:()=>c});var r=o(76200),i=o(10064),n=o(12322),s=o(98995),a=o(49818);function l(e,t){const o=[],r=new Map;for(const n of t){const t=e.getLayerIdBySourceId(n.networkSourceId);if(null==t)continue;let o=r.get(t);void 0===o&&(o=[]),o.push(n.objectId),r.set(t,o)}const i=e.featureServiceUrl;return r.forEach(((e,t)=>o.push({layerUrl:"".concat(i,"/").concat(t),objectIds:e}))),o}async function d(e,t){const o=e.layers,r=e.layerInfos,i=e.returnGeometry||!1,s=e.outSpatialReference;return await Promise.all(o.map((async e=>{await e.load()}))),(await Promise.all(o.map((async e=>{var o;const l=r.find((t=>{var o;return t.layerUrl===(null===(o=e.parsedUrl)||void 0===o?void 0:o.path)}));if(null===l||void 0===l||null===(o=l.objectIds)||void 0===o||!o.length)return{layer:e,featureSet:void 0};const d=e.createQuery();d.returnGeometry=i,d.outFields=l.outFields||["*"],d.outSpatialReference=s,d.gdbVersion=e.gdbVersion,d.objectIds=l.objectIds,t&&(d.where="1=1");const u=a.Z.fromJSON(await(0,n.UK)(e,d));return{layer:e,featureSet:u}})))).filter((e=>void 0!==e.featureSet))}async function u(e,t){if("Utility Network Layer"===e){const{default:e}=await Promise.resolve().then(o.bind(o,69518));return new e({layerUrl:t})}return null}async function c(e){var t;let o="portalItem"in e?e:{portalItem:e};!o.portalItem||o.portalItem instanceof s.default||(o={...o,portalItem:new s.default(o.portalItem)});const n=o.portalItem;if(await n.load(),"Feature Service"!==n.type)throw new i.Z("portal:unknown-item-type","Unknown item type '${type}'",{type:n.type});const a=n.url,l=await(0,r.Z)(a,{responseType:"json",query:{f:"json"}}),d="Network Layer";if(null!==(t=l.data.type)&&void 0!==t&&t.includes(d))return u(l.data.type,a);if(l.data.layers){const e=l.data.layers.find((e=>e.type.includes(d)));if(e){const t="".concat(a,"/").concat(e.id);return u(e.type,t)}}return null}},50656:(e,t,o)=>{o.d(t,{Z:()=>l});var r=o(27366),i=o(46784),n=o(49861),s=(o(93169),o(32718),o(84936),o(69912));let a=class extends i.wq{constructor(e){super(e),this.assetGroupCode=null,this.assetTypeCode=null,this.globalId=null,this.networkSourceId=null,this.objectId=null,this.positionFrom=null,this.positionTo=null,this.terminalId=null}};(0,r._)([(0,n.Cb)({type:Number,json:{write:!0}})],a.prototype,"assetGroupCode",void 0),(0,r._)([(0,n.Cb)({type:Number,json:{write:!0}})],a.prototype,"assetTypeCode",void 0),(0,r._)([(0,n.Cb)({type:String,json:{write:!0}})],a.prototype,"globalId",void 0),(0,r._)([(0,n.Cb)({type:Number,json:{write:!0}})],a.prototype,"networkSourceId",void 0),(0,r._)([(0,n.Cb)({type:Number,json:{write:!0}})],a.prototype,"objectId",void 0),(0,r._)([(0,n.Cb)({type:Number,json:{write:!0}})],a.prototype,"positionFrom",void 0),(0,r._)([(0,n.Cb)({type:Number,json:{write:!0}})],a.prototype,"positionTo",void 0),(0,r._)([(0,n.Cb)({type:Number,json:{write:!0}})],a.prototype,"terminalId",void 0),a=(0,r._)([(0,s.j)("esri.rest.networks.support.NetworkElement")],a);const l=a},20039:(e,t,o)=>{o.d(t,{Z:()=>h});var r=o(27366),i=o(46784),n=o(49861),s=(o(93169),o(32718),o(84936),o(69912)),a=o(77577),l=o(80885),d=o(29909);let u=class extends i.wq{constructor(e){super(e),this.line=null,this.multipoint=null,this.polygon=null}};(0,r._)([(0,n.Cb)({type:d.Z,json:{write:!0},readOnly:!0})],u.prototype,"line",void 0),(0,r._)([(0,n.Cb)({type:a.Z,json:{read:{source:"point"},write:{target:"point"}},readOnly:!0})],u.prototype,"multipoint",void 0),(0,r._)([(0,n.Cb)({type:l.Z,json:{write:!0},readOnly:!0})],u.prototype,"polygon",void 0),u=(0,r._)([(0,s.j)("esri.rest.networks.support.AggregatedGeometry")],u);const c=u;let p=class extends i.wq{constructor(e){super(e),this.functionType=null,this.networkAttributeName=null,this.result=null}};(0,r._)([(0,n.Cb)({type:["add","subtract","average","count","min","max"],json:{write:!0},readOnly:!0})],p.prototype,"functionType",void 0),(0,r._)([(0,n.Cb)({type:String,json:{write:!0},readOnly:!0})],p.prototype,"networkAttributeName",void 0),(0,r._)([(0,n.Cb)({type:Number,json:{write:!0},readOnly:!0})],p.prototype,"result",void 0),p=(0,r._)([(0,s.j)("esri.rest.networks.support.FunctionResult")],p);const y=p;var v=o(50656);let m=class extends i.wq{constructor(e){super(e),this.aggregatedGeometry=null,this.elements=null,this.globalFunctionResults=null,this.kFeaturesForKNNFound=!1,this.startingPointsIgnored=!1,this.warnings=null}};(0,r._)([(0,n.Cb)({type:c,json:{write:!0},readOnly:!0})],m.prototype,"aggregatedGeometry",void 0),(0,r._)([(0,n.Cb)({type:[v.Z],json:{write:!0},readOnly:!0})],m.prototype,"elements",void 0),(0,r._)([(0,n.Cb)({type:[y],json:{write:!0},readOnly:!0})],m.prototype,"globalFunctionResults",void 0),(0,r._)([(0,n.Cb)({type:Boolean,json:{write:!0},readOnly:!0})],m.prototype,"kFeaturesForKNNFound",void 0),(0,r._)([(0,n.Cb)({type:Boolean,json:{write:!0},readOnly:!0})],m.prototype,"startingPointsIgnored",void 0),(0,r._)([(0,n.Cb)({type:[String],json:{write:!0},readOnly:!0})],m.prototype,"warnings",void 0),m=(0,r._)([(0,s.j)("esri.rest.networks.support.TraceResult")],m);const h=m},64267:(e,t,o)=>{o.d(t,{Z:()=>l});var r=o(27366),i=o(46784),n=o(49861),s=(o(93169),o(32718),o(84936),o(69912));let a=class extends i.wq{constructor(e){super(e),this.moment=null,this.fullUpdate=!1,this.validateErrorsCreated=!1,this.dirtyAreaCount=null,this.exceededTransferLimit=null,this.serviceEdits=null,this.discoveredSubnetworks=null}};(0,r._)([(0,n.Cb)({type:Date,json:{type:Number,write:{writer:(e,t)=>{t.moment=e?e.getTime():null}}}})],a.prototype,"moment",void 0),(0,r._)([(0,n.Cb)({type:Boolean,json:{write:!0}})],a.prototype,"fullUpdate",void 0),(0,r._)([(0,n.Cb)({type:Boolean,json:{write:!0}})],a.prototype,"validateErrorsCreated",void 0),(0,r._)([(0,n.Cb)({type:Number,json:{write:!0}})],a.prototype,"dirtyAreaCount",void 0),(0,r._)([(0,n.Cb)({type:Boolean,json:{write:!0}})],a.prototype,"exceededTransferLimit",void 0),(0,r._)([(0,n.Cb)({type:[Object],json:{write:!0}})],a.prototype,"serviceEdits",void 0),(0,r._)([(0,n.Cb)({type:[Object],json:{write:!0}})],a.prototype,"discoveredSubnetworks",void 0),a=(0,r._)([(0,s.j)("esri.rest.networks.support.ValidateNetworkTopologyResult")],a);const l=a}}]);
//# sourceMappingURL=83454.c8c099f3.chunk.js.map